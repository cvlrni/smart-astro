"""
    getWM2(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ)
    Returns the generating function leading to the transformation 
    of variables allowing to average the attitude equations of motion 
    (expressed in Sadov variables) with respect to Sadov fast angles
    -- the perturbation here is the magnetic torque

    INPUT
    IV                = [A,B,C] principal moments of inertia [m^2]
    k                 = (B-A)/(C-A)*C/A
    sadovvar,skm      = sadov variables and sadov related variable **
    equi              = equinoctial elements ***
    muM               = Planet's magnetic dipole strenght [kg km^3/s^2/A]
    IMx,IMy,IMz       = components of the intrinsic magnetic moment in the body reference frame [A m^2]
    [cpa1,cpa2,cpa3]  = Planet's polar axis unit vector in the inertial frame 

    **
    Consider an inertial reference Frame XYZ.
    Consider a body reference frame xyz in principal axes of inertia. 
    The reference frame is such that m belongs to in[0,1] and k>0 where
    k = C/A*(B-A)/(C-B) 
    m = k*(C-delta)/(delta-A)
    with
    A,B,C the moments of inertia, A=int(y^2+z^2)dm, B=int(x^2+z^2)dm and C=int(x^2+y^2)dm.
    delta = G^2/2/Phi, with G the angular momentum of the body and Phi the kinetic energy
    Let GV=diag([A,B,C])omV be angular momentum of the body and G = norm(GV)
    (omV = [p,q,r]^T is the angular velocity) 
    Let N be the node between the inertial reference XY plane and the plane
    perpendicular to GV; let N'' be the node between the plane perpendicular 
    to GV and the xy plane. 
    sadovvar = [Jl,Jg,Jh,psil,psig,psih] or [Jg,Jh,psil,psig,psih]
            with
                Jl   = 2G/pi sqrt{k+m} sqrt{(1+k)/k} (ellP(-k,m)-m/(k+m)ellK(m)) [kg m^2 /s^2]
                Jg   = G [kg m^2 /s^2]
                Jh   = Gcos(delta), delta = inclination angle between [kg m^2 /s^2]
                       the XY plane and the plane perpendicular to GV.
                psil = pi/2 ellK(m)ellF(lambda,m) [rad], lambda = atan(cos(l),sqrt{1+k}sin(l)), l = angle between N'' and x axis
                psig = g - sqrt{(k+m)(1+k)/k}(ellP(-k,m)ellF(lambda,m)/ellK(m)-ellP(-k,lambda,m)) [rad], g = angle between N and N''
                psih = angle between X axis and N [rad]

    skm = k/(m+k)

    ***
    equi = [a,P1,P2,Q1,Q2,TL]  
    a   semi-major axis [km]       
    P1 = ec*sin(OM+om)                   
    P2 = ec*cos(OM+om)                         
    Q1 = tan(i/2)*sin(OM)  
    Q2 = tan(i/2)*cos(OM)  
    TL = nu+om+OM [rad]  
    with 
        e   orbital ecentricity                   
        i   inclination                            
        o   argumentum of pericentre               
        O   right ascension of the ascending node  
        nu  true anomaly                           
    

    OUTPUT
    WM2 = vector 6x1 of Float64 -
        generating function of the transformation 
        [skm,Jg,Jh,psil,psig,psih] -> [skm',Jg',Jh',psil',psig',psih'], 
        allowing to obtain averaged attitude equations of motion with respect to psil and psig
"""
function getWM2(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3)

    WM2 = getWM2procedure(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,1)
    return WM2;
end

"""
    getWM2(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ)
    Returns the generating function leading to the transformation 
    of variables allowing to average the attitude equations of motion 
    (expressed in Sadov-like variables) with respect to Sadov fast angles
    -- the perturbation here is the magnetic torque

    INPUT
    IV                = [A,B,C] principal moments of inertia [m^2]
    k                 = (B-A)/(C-A)*C/A
    sadovvar,skm      = sadov variables and sadov related variable **
    equi              = equinoctial elements ***
    muM               = Planet's magnetic dipole strenght [kg km^3/s^2/A]
    IMx,IMy,IMz       = components of the intrinsic magnetic moment in the body reference frame [A m^2]
    [cpa1,cpa2,cpa3]  = Planet's polar axis unit vector in the inertial frame 

    **
    Consider an inertial reference Frame XYZ.
    Consider a body reference frame xyz in principal axes of inertia. 
    The reference frame is such that m belongs to in[0,1] and k>0 where
    k = C/A*(B-A)/(C-B) 
    m = k*(C-delta)/(delta-A)
    with
    A,B,C the moments of inertia, A=int(y^2+z^2)dm, B=int(x^2+z^2)dm and C=int(x^2+y^2)dm.
    delta = G^2/2/Phi, with G the angular momentum of the body and Phi the kinetic energy
    Let GV=diag([A,B,C])omV be angular momentum of the body and G = norm(GV)
    (omV = [p,q,r]^T is the angular velocity) 
    Let N be the node between the inertial reference XY plane and the plane
    perpendicular to GV; let N'' be the node between the plane perpendicular 
    to GV and the xy plane. 
    sadovvar = [Jl,Jg,Jh,psil,psig,psih] or [Jg,Jh,psil,psig,psih]
            with
                Jl   = 2G/pi sqrt{k+m} sqrt{(1+k)/k} (ellP(-k,m)-m/(k+m)ellK(m)) [kg m^2 /s^2]
                Jg   = G [kg m^2 /s^2]
                Jh   = Gcos(delta), delta = inclination angle between [kg m^2 /s^2]
                       the XY plane and the plane perpendicular to GV.
                psil = pi/2 ellK(m)ellF(lambda,m) [rad], lambda = atan(cos(l),sqrt{1+k}sin(l)), l = angle between N'' and x axis
                psig = g - sqrt{(k+m)(1+k)/k}(ellP(-k,m)ellF(lambda,m)/ellK(m)-ellP(-k,lambda,m)) [rad], g = angle between N and N''
                psih = angle between X axis and N [rad]

    skm = k/(m+k)

    ***
    equi = [a,P1,P2,Q1,Q2,TL]  
    a   semi-major axis [km]       
    P1 = ec*sin(OM+om)                   
    P2 = ec*cos(OM+om)                         
    Q1 = tan(i/2)*sin(OM)  
    Q2 = tan(i/2)*cos(OM)  
    TL = nu+om+OM [rad]  
    with 
        e   orbital ecentricity                   
        i   inclination                            
        o   argumentum of pericentre               
        O   right ascension of the ascending node  
        nu  true anomaly                           
    

    OUTPUT
    WM2 = vector 7x1 of Float64 -
        generating function of the transformation 
        [skm,Jg,Jh,psil,J5,J6,J7] -> [skm',Jg',Jh',psil',J5',J6',J7'], 
        allowing to obtain averaged attitude equations of motion with respect to psil and psig
"""
function getWM2sadovlike(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3)

    WM2 = getWM2procedure(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,2)
    return WM2;
end

"""
    getWM3(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ)
    Returns the generating function leading to the transformation 
    of variables allowing to average the attitude equations of motion 
    (expressed in Sadov variables) with respect to the orbital mean anomaly
    -- the perturbation here is the magnetic torque

    INPUT
    IV                = [A,B,C] principal moments of inertia [m^2]
    k                 = (B-A)/(C-A)*C/A
    sadovvar,skm      = sadov variables and sadov related variable **
    equi              = equinoctial elements ***
    muM               = Planet's magnetic dipole strenght [kg km^3/s^2/A]
    IMx,IMy,IMz       = components of the intrinsic magnetic moment in the body reference frame [A m^2]
    [cpa1,cpa2,cpa3]  = Planet's polar axis unit vector in the inertial frame 

    **
    Consider an inertial reference Frame XYZ.
    Consider a body reference frame xyz in principal axes of inertia. 
    The reference frame is such that m belongs to in[0,1] and k>0 where
    k = C/A*(B-A)/(C-B) 
    m = k*(C-delta)/(delta-A)
    with
    A,B,C the moments of inertia, A=int(y^2+z^2)dm, B=int(x^2+z^2)dm and C=int(x^2+y^2)dm.
    delta = G^2/2/Phi, with G the angular momentum of the body and Phi the kinetic energy
    Let GV=diag([A,B,C])omV be angular momentum of the body and G = norm(GV)
    (omV = [p,q,r]^T is the angular velocity) 
    Let N be the node between the inertial reference XY plane and the plane
    perpendicular to GV; let N'' be the node between the plane perpendicular 
    to GV and the xy plane. 
    sadovvar = [Jl,Jg,Jh,psil,psig,psih] or [Jg,Jh,psil,psig,psih]
            with
                Jl   = 2G/pi sqrt{k+m} sqrt{(1+k)/k} (ellP(-k,m)-m/(k+m)ellK(m)) [kg m^2 /s^2]
                Jg   = G [kg m^2 /s^2]
                Jh   = Gcos(delta), delta = inclination angle between [kg m^2 /s^2]
                       the XY plane and the plane perpendicular to GV.
                psil = pi/2 ellK(m)ellF(lambda,m) [rad], lambda = atan(cos(l),sqrt{1+k}sin(l)), l = angle between N'' and x axis
                psig = g - sqrt{(k+m)(1+k)/k}(ellP(-k,m)ellF(lambda,m)/ellK(m)-ellP(-k,lambda,m)) [rad], g = angle between N and N''
                psih = angle between X axis and N [rad]

    skm = k/(m+k)

    OUTPUT
    WM3 = vector 6x1 of Float64 -
        generating function of the transformation 
        [skm,Jg,Jh,psil,psig,psih] -> [skm',Jg',Jh',psil',psig',psih'], 
        allowing to obtain averaged attitude equations of motion (already averaged with respect to psil and psig) with respect to the orbital mean anomaly 

"""
function getWM3(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,mu)
    WM3 = getWM3procedure(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,mu,1);
    return WM3;
end



"""
    getWM3sadovlike(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ)
    Returns the generating function leading to the transformation 
    of variables allowing to average the attitude equations of motion 
    (expressed in Sadov-like variables) with respect to the orbital mean anomaly
    -- the perturbation here is the magnetic torque

    INPUT
    IV                = [A,B,C] principal moments of inertia [m^2]
    k                 = (B-A)/(C-A)*C/A
    sadovvar,skm      = sadov variables and sadov related variable **
    equi              = equinoctial elements ***
    muM               = Planet's magnetic dipole strenght [kg km^3/s^2/A]
    IMx,IMy,IMz       = components of the intrinsic magnetic moment in the body reference frame [A m^2]
    [cpa1,cpa2,cpa3]  = Planet's polar axis unit vector in the inertial frame 

    **
    Consider an inertial reference Frame XYZ.
    Consider a body reference frame xyz in principal axes of inertia. 
    The reference frame is such that m belongs to in[0,1] and k>0 where
    k = C/A*(B-A)/(C-B) 
    m = k*(C-delta)/(delta-A)
    with
    A,B,C the moments of inertia, A=int(y^2+z^2)dm, B=int(x^2+z^2)dm and C=int(x^2+y^2)dm.
    delta = G^2/2/Phi, with G the angular momentum of the body and Phi the kinetic energy
    Let GV=diag([A,B,C])omV be angular momentum of the body and G = norm(GV)
    (omV = [p,q,r]^T is the angular velocity) 
    Let N be the node between the inertial reference XY plane and the plane
    perpendicular to GV; let N'' be the node between the plane perpendicular 
    to GV and the xy plane. 
    sadovvar = [Jl,Jg,Jh,psil,psig,psih] or [Jg,Jh,psil,psig,psih]
            with
                Jl   = 2G/pi sqrt{k+m} sqrt{(1+k)/k} (ellP(-k,m)-m/(k+m)ellK(m)) [kg m^2 /s^2]
                Jg   = G [kg m^2 /s^2]
                Jh   = Gcos(delta), delta = inclination angle between [kg m^2 /s^2]
                       the XY plane and the plane perpendicular to GV.
                psil = pi/2 ellK(m)ellF(lambda,m) [rad], lambda = atan(cos(l),sqrt{1+k}sin(l)), l = angle between N'' and x axis
                psig = g - sqrt{(k+m)(1+k)/k}(ellP(-k,m)ellF(lambda,m)/ellK(m)-ellP(-k,lambda,m)) [rad], g = angle between N and N''
                psih = angle between X axis and N [rad]

    skm = k/(m+k)

    OUTPUT
    WM3 =  vector 7x1 of Float64 -
        generating function of the transformation 
        [skm,Jg,Jh,psil,J5,J6,J7] -> [skm',Jg',Jh',psil',J5',J6',J7'], 
        allowing to obtain averaged attitude equations of motion (already averaged with respect to psil and psig) with respect to the orbital mean anomaly 

"""
function getWM3sadovlike(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,mu)
    WM3 = getWM3procedure(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,mu,2);
    return WM3;
end


#######################################
function getWM2procedure(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,typeofvariables)
    if skm == 1.0
        WM2 = getWM2procedure_smk0(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,typeofvariables)
        return WM2;
    end
    if size(sadovvar)[1] == 5
        Jg = sadovvar[1];
        Jh = sadovvar[2];
        psil = sadovvar[3];
        psig = sadovvar[4];
        psih = sadovvar[5];
    else
        Jg = sadovvar[2];
        Jh = sadovvar[3];
        psil = sadovvar[4];
        psig = sadovvar[5];
        psih = sadovvar[6];
    end

    cdelta = Jh/Jg;
    sdelta = sqrt(1-cdelta^2.0);
    smk    = 1-skm
    if smk == 0.0
        Base.error("this function is not suitable to convert variables if m=0")
    end

    sma = equi[1];
    P1  = equi[2];
    P2  = equi[3];
    Q1  = equi[4];
    Q2  = equi[5];
    TL  = equi[6];
    
    rc   = sma*(1-P1^2-P2^2)/(1+P1*sin(TL)+P2*cos(TL));
    GG   = 1.0+Q1^2+Q2^2;
    cpa1EQ = (-Q1^2*cpa1 + 2*Q1*Q2*cpa2 + Q2^2*cpa1 - 2*Q1*cpa3 + cpa1)/GG;
    cpa2EQ = (Q1^2*cpa2 + 2*Q1*Q2*cpa1 - Q2^2*cpa2 + 2*Q2*cpa3 + cpa2)/GG;
    cpa3EQ = (-Q1^2*cpa3 - Q2^2*cpa3 + 2*Q1*cpa1 - 2*Q2*cpa2 + cpa3)/GG;



    if k!=0.0

        m     = smk/skm*k;
        KK    = ellF(pi/2,m);
        EE    = ellE(pi/2,m);
        KP    = ellF(pi/2,1-m);
        EP    = ellE(pi/2,1-m);
        PP    = ellP(-k,pi/2,m);
        q     = exp(-pi*KP/KK);
        FA    = ellF(atan(sqrt(k/m)),1-m);
        EA    = ellE(atan(sqrt(k/m)),1-m);
        sigma = pi*FA/2/KK;
        M4    = (PP-KK)*sqrt(1+k)/sqrt(skm)/pi;

        npsig = Jg/IV[1]/IV[3]*((IV[3]-IV[1])PP+IV[1]*KK)/KK;
        npsil = -pi/2.0/sqrt(1+k)*sqrt(skm)*Jg/IV[1]/IV[3]*(IV[3]-IV[1])/KK;

        dskmdJl = sqrt(skm)*pi/(sqrt(1 + k)*KK*Jg);
        dskmdJg = -2*((m + k)*PP - m*KK)/((m + k)*KK*Jg);
        dchim2dJl    = derivativechiM2_Jl(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
        dchim2dJgP1  = derivativechiM2_JgP1(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
        dchim2dJhP1  = derivativechiM2_JhP1(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
        dchim2dJhP2  = derivativechiM2_JhP2(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
        dchim2dpsil  = derivativechiM2_psil(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
        dchim2dpsig  = derivativechiM2_psig(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
        dchim2dpsih  = derivativechiM2_psih(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
       
        if typeofvariables == 1
            dchim2dJgP2  = derivativechiM2_JgP2(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
            dchim2dJg    = dchim2dJgP1 + dchim2dJgP2/sdelta;
            dchim2dJh    = dchim2dJhP1 + dchim2dJhP2/sdelta;
            WM2  =  [-dchim2dpsil*dskmdJl-dchim2dpsig*dskmdJg,-dchim2dpsig,-dchim2dpsih,dchim2dJl ,dchim2dJg ,dchim2dJh ];
        else
            cdeltadchim2dpsigMdchim2dpsihOsdelta =  derivativechiM2_cdeltapsigMpsihOsdelta(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
            WM2 = [-dskmdJl*dchim2dpsil-dskmdJg*dchim2dpsig,
            -dchim2dpsig,
            -dchim2dpsih,
             dchim2dJl, 
             dchim2dJgP1 + cdelta*dchim2dJhP1 + psih/Jg*(cdelta*dchim2dpsig-dchim2dpsih),
            -Jg*sdelta*sin(psih)*dchim2dJhP1 - Jg*sin(psih)*dchim2dJhP2 - sdelta*cos(psih)*dchim2dpsig - cdelta*cos(psih)*cdeltadchim2dpsigMdchim2dpsihOsdelta,
             Jg*sdelta*cos(psih)*dchim2dJhP1 + Jg*cos(psih)*dchim2dJhP2 - sdelta*sin(psih)*dchim2dpsig - cdelta*sin(psih)*cdeltadchim2dpsigMdchim2dpsihOsdelta];


        end   
    else
        npsig = Jg/IV[1]
        npsil = Jg*skm*(1/IV[3]-1/IV[2]);

        dskmdJl = 2*sqrt(skm)/Jg
        dskmdJg = -2*skm/Jg
        dchim2dJlP1     = derivativechiM2_Jl1_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2]);
        dchim2dcsigmaP1 = derivativechiM2_csigma1_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
        dchim2dcsigmaP2 = derivativechiM2_csigma2_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
        dchim2dJl       = (dchim2dcsigmaP1 + dchim2dcsigmaP2/sqrt(smk))/Jg
        dchim2dJgP1     = derivativechiM2_Jg1_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
        dchim2dJgP1     = dchim2dJgP1 - sqrt(skm)*dchim2dJl 
        dchim2dJl       = dchim2dJl + dchim2dJlP1 
        dchim2dcdeltaP1 = derivativechiM2_cdelta1_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
        dchim2dcdeltaP2 = derivativechiM2_cdelta2_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
        dchim2dpsil     = derivativechiM2_psil_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
        dchim2dpsig     = derivativechiM2_psig_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
        dchim2dpsih     = derivativechiM2_psih_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
        
        if typeofvariables == 1
            dchim2dJh       = (dchim2dcdeltaP1 + dchim2dcdeltaP2/sdelta)/Jg;
            dchim2dJg       = -cdelta*dchim2dJh +  dchim2dJgP1;
            WM2  =  [-dchim2dpsil*dskmdJl-dchim2dpsig*dskmdJg,-dchim2dpsig,-dchim2dpsih,dchim2dJl ,dchim2dJg ,dchim2dJh ];
        else
            dchim2dJhP1 = dchim2dcdeltaP1/Jg;
            dchim2dJhP2 = dchim2dcdeltaP2/Jg;
            dchim2dJgP1 = dchim2dJgP1 - cdelta*dchiG2dJhP1;
            cdeltadchim2dpsigMdchim2dpsihOsdelta = derivativechiM2_cdeltapsigMpsihOsdelta_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3]);
            WM2 = [-dskmdJl*dchim2dpsil-dskmdJg*dchim2dpsig,
            -dchim2dpsig,
            -dchim2dpsih,
             dchim2dJl, 
             dchim2dJgP1 + cdelta*dchim2dJhP1 + psih/Jg*(cdelta*dchim2dpsig-dchim2dpsih),
            -Jg*sdelta*sin(psih)*dchim2dJhP1 - Jg*sin(psih)*dchim2dJhP2 - sdelta*cos(psih)*dchim2dpsig + cdelta*cos(psih)*cdeltadchim2dpsigMdchim2dpsihOsdelta,
             Jg*sdelta*cos(psih)*dchim2dJhP1 + Jg*cos(psih)*dchim2dJhP2 - sdelta*sin(psih)*dchim2dpsig + cdelta*sin(psih)*cdeltadchim2dpsigMdchim2dpsihOsdelta];
        end

    end

    return WM2;
end

function getWM3procedure(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,mu,typeofvariables)
    if skm == 1.0
        WM3 = getWM3procedure_smk0(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,mu,typeofvariables)
        return WM3;
    end
    if size(sadovvar)[1] == 5
        Jg = sadovvar[1];
        Jh = sadovvar[2];
        psil = sadovvar[3];
        psig = sadovvar[4];
        psih = sadovvar[5];
    else
        Jg = sadovvar[2];
        Jh = sadovvar[3];
        psil = sadovvar[4];
        psig = sadovvar[5];
        psih = sadovvar[6];
    end

    cdelta = Jh/Jg;
    sdelta = sqrt(1-cdelta^2.0);
    smk    = 1-skm
    if smk == 0.0
        Base.error("this function is not suitable to convert variables if m=0")
    end

    sma = equi[1];
    P1  = equi[2];
    P2  = equi[3];
    Q1  = equi[4];
    Q2  = equi[5];
    TL  = equi[6];
    
    eta  = sqrt(1-P1^2-P2^2);
    phiTA   = equi2equationofthecentre(TL,Q1,Q2,P1,P2)
    GG   = 1.0+Q1^2+Q2^2;
    cpa1EQ = (-Q1^2*cpa1 + 2*Q1*Q2*cpa2 + Q2^2*cpa1 - 2*Q1*cpa3 + cpa1)/GG;
    cpa2EQ = (Q1^2*cpa2 + 2*Q1*Q2*cpa1 - Q2^2*cpa2 + 2*Q2*cpa3 + cpa2)/GG;
    cpa3EQ = (-Q1^2*cpa3 - Q2^2*cpa3 + 2*Q1*cpa1 - 2*Q2*cpa2 + cpa3)/GG;
    n = sqrt(mu/sma^3.0);

    if k!=0.0
        m     = (1-skm)/skm*k;
        KK    = ellF(pi/2,m);
        EE    = ellE(pi/2,m);
        KP    = ellF(pi/2,1-m);
        EP    = ellE(pi/2,1-m);
        PP    = ellP(-k,pi/2,m);
        q     = exp(-pi*KP/KK);
        FA    = ellF(atan(sqrt(k/m)),1-m);
        EA    = ellE(atan(sqrt(k/m)),1-m);
        sigma = pi*FA/2/KK;
        M4    = (PP-KK)*sqrt(1+k)/sqrt(skm)/pi;
        dskmdJl = sqrt(skm)*pi/(sqrt(1 + k)*KK*Jg);
        dskmdJg = -2*((m + k)*PP - m*KK)/((m + k)*KK*Jg);

        dchim3dJl   = derivativechiM3_Jl(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
        dchim3dJgP1 = derivativechiM3_JgP1(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
        
        dchim3dJhP1 = derivativechiM3_JhP1(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
        dchim3dJhP2 = derivativechiM3_JhP2(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
        dchim3dpsil = derivativechiM3_psil(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
        dchim3dpsig = derivativechiM3_psig(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
        dchim3dpsih = derivativechiM3_psih(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
        
        if typeofvariables == 1
            dchim3dJgP2 = derivativechiM3_JgP2(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
            dchim3dJg   = dchim3dJgP1+dchim3dJgP2/sdelta;
            dchim3dJh   = dchim3dJhP1+dchim3dJhP2/sdelta;
            WM3  =  [-dchim3dpsil*dskmdJl-dchim3dpsig*dskmdJg,-dchim3dpsig,-dchim3dpsih,dchim3dJl,dchim3dJg,dchim3dJh];
        else
            cdeltadchim3dpsigMdchim3dpsihOsdelta =  derivativechiM3_cdeltapsigMpsihOsdelta(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
            WM3 = [-dskmdJl*dchim3dpsil-dskmdJg*dchim3dpsig,
            -dchim3dpsig,
            -dchim3dpsih,
             dchim3dJl, 
             dchim3dJgP1 + cdelta*dchim3dJhP1 + psih/Jg*(cdelta*dchim3dpsig-dchim3dpsih),
            -Jg*sdelta*sin(psih)*dchim3dJhP1 - Jg*sin(psih)*dchim3dJhP2 - sdelta*cos(psih)*dchim3dpsig + cdelta*cos(psih)*cdeltadchim3dpsigMdchim3dpsihOsdelta,
             Jg*sdelta*cos(psih)*dchim3dJhP1 + Jg*cos(psih)*dchim3dJhP2 - sdelta*sin(psih)*dchim3dpsig + cdelta*sin(psih)*cdeltadchim3dpsigMdchim3dpsihOsdelta];
        end

    else

        dskmdJl = 2*sqrt(skm)/Jg
        dskmdJg = -2*skm/Jg

        dchim3dcsigmaP1 = derivativechiM3_csigma1_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
        dchim3dcsigmaP2 = derivativechiM3_csigma2_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
        dchim3dJl       = (dchim3dcsigmaP1 + dchim3dcsigmaP2/sqrt(smk))/Jg;
        dchim3dJgP1     = - sqrt(skm)*dchim3dJl;
        dchim3dcdeltaP1 = derivativechiM3_cdelta1_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
        dchim3dcdeltaP2 = derivativechiM3_cdelta2_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
        dchim3dpsil     = derivativechiM3_psil_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
        dchim3dpsig     = derivativechiM3_psig_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
        dchim3dpsih     = derivativechiM3_psih_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
        
        if typeofvariables == 1
            dchim3dJh       = (dchim3dcdeltaP1 + dchim3dcdeltaP2/sdelta)/Jg;
            dchim3dJg       = -cdelta*dchim3dJh +  dchim3dJgP1;
            WM3  =  [-dchim3dpsil*dskmdJl-dchim3dpsig*dskmdJg,-dchim3dpsig,-dchim3dpsih,dchim3dJl,dchim3dJg,dchim3dJh];
        else
            dchim3dJhP1 = dchim3dcdeltaP1/Jg;
            dchim3dJhP2 = dchim3dcdeltaP2/Jg;
            dchim3dJgP1 = dchim3dJgP1 - cdelta*dchim3dJhP1;
            cdeltadchim3dpsigMdchim3dpsihOsdelta = derivativechiM3_cdeltapsigMpsihOsdelta_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
            WM3 = [-dskmdJl*dchim3dpsil-dskmdJg*dchim3dpsig,
            -dchim3dpsig,
            -dchim3dpsih,
             dchim3dJl, 
             dchim3dJgP1 + cdelta*dchim3dJhP1 + psih/Jg*(cdelta*dchim3dpsig-dchim3dpsih),
            -Jg*sdelta*sin(psih)*dchim3dJhP1 - Jg*sin(psih)*dchim3dJhP2 - sdelta*cos(psih)*dchim3dpsig + cdelta*cos(psih)*cdeltadchim3dpsigMdchim3dpsihOsdelta,
             Jg*sdelta*cos(psih)*dchim3dJhP1 + Jg*cos(psih)*dchim3dJhP2 - sdelta*sin(psih)*dchim3dpsig + cdelta*sin(psih)*cdeltadchim3dpsigMdchim3dpsihOsdelta];
        end
    end

    return WM3;

end

function getWM2procedure_smk0(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,typeofvariables)

    if size(sadovvar)[1] == 5
        Jg = sadovvar[1];
        Jh = sadovvar[2];
        psil = sadovvar[3];
        psig = sadovvar[4];
        psih = sadovvar[5];
    else
        Jg = sadovvar[2];
        Jh = sadovvar[3];
        psil = sadovvar[4];
        psig = sadovvar[5];
        psih = sadovvar[6];
    end
    cdelta = Jh/Jg;
    sdelta = sqrt(1-cdelta^2.0);
    cpsih  = cos(psih)
    spsih  = sin(psih)

    sma = equi[1];
    P1  = equi[2];
    P2  = equi[3];
    Q1  = equi[4];
    Q2  = equi[5];
    TL  = equi[6];
    rc   = sma*(1-P1^2-P2^2)/(1+P1*sin(TL)+P2*cos(TL));

    A = IV[1]
    C = IV[3]
    npsig = Jg/A/C*((C-A)/sqrt(1+k)+A);
    npsil = -1/sqrt(1+k)*sqrt(skm)*Jg/A/C*(C-A);
    dnpsildJg  = (A-C)/(A*C*sqrt(1+k));
    dnpsigdJg  = ((C-A)/sqrt(1+k)+A)/(A*C);
    dnpsigdskm = -Jg*(A-C)*(-k/sqrt(1+k)/2.0+1.0)/(2*A*C);
    dnpsildskm = 0.0

    VGT,VGGT =  getgeneratinfunctiontermsW2_allpert_psil_psig_smk0(psil,psig,npsil,npsig)
    CMXb11,CMXb12,CMXb13,CMYb21,CMYb22,CMYb23,CMZb31,CMZb32,CMZb33 = CMterms_M2_smk0_magnetic(cdelta,sdelta,cpsih,spsih,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,IV[1],IV[2],IV[3])
    W21Block  = transpose(-2*1.0/Jg*CMXb13 - 2*1.0/Jg*1.0/(1+k)*CMYb23);
    Tb3Block  = transpose(CMXb13+CMYb23+CMZb33);
    Tb2Block  = transpose(CMXb12+CMYb22+CMZb32);
    Tb1Block  = transpose(CMXb11+CMYb21+CMZb31);

    if typeofvariables==1
        W21 = W21Block*VGT;
        W22 = Tb3Block*VGT;
        W23 = (cdelta*Tb3Block + sdelta*Tb2Block)*VGT;
        W24 = 0.0;
        W25 = - cdelta/sdelta/Jg*Tb1Block*VGT + (dnpsigdskm+dnpsildskm)*W21Block*VGGT + (dnpsigdJg+dnpsildJg)*Tb3Block*VGGT;
        W26 = 1/sdelta/Jg*Tb1Block*VGT;  
        WM2  = [W21,W22,W23,W24,W25,W26];
    else
        W21 = W21Block*VGT;
        W22 = Tb3Block*VGT;
        W23 = (cdelta*Tb3Block + sdelta*Tb2Block)*VGT;
        W24 = 0.0;
        W25 = psih*sdelta/Jg*Tb2Block*VGT + (dnpsigdskm+dnpsildskm)*W21Block*VGGT + (dnpsigdJg+dnpsildJg)*Tb3Block*VGGT;
        W26 = (-spsih*Tb1Block+sdelta*cpsih*Tb3Block-cdelta*spsih*Tb2Block)*VGT  
        W27 = (cpsih*Tb1Block+sdelta*spsih*Tb3Block-cdelta*spsih*Tb2Block)*VGT  
        WM2  = [W21,W22,W23,W24,W25,W26,W27];
    end

    return WM2;

end

function getWM3procedure_smk0(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,mu,typeofvariables)

    if size(sadovvar)[1] == 5
        Jg = sadovvar[1];
        Jh = sadovvar[2];
        psil = sadovvar[3];
        psig = sadovvar[4];
        psih = sadovvar[5];
    else
        Jg = sadovvar[2];
        Jh = sadovvar[3];
        psil = sadovvar[4];
        psig = sadovvar[5];
        psih = sadovvar[6];
    end

    cdelta = Jh/Jg;
    sdelta = sqrt(1-cdelta^2.0);
    cpsih = cos(psih)
    spsih = sin(psih)

    sma = equi[1];
    P1  = equi[2];
    P2  = equi[3];
    Q1  = equi[4];
    Q2  = equi[5];
    TL  = equi[6];
    eta  = sqrt(1-P1^2-P2^2);
    phiTA   = equi2equationofthecentre(TL,Q1,Q2,P1,P2)
    n = sqrt(mu/sma^3.0);

    mxb11,mxb12,mxb13,myb21,myb22,myb23,mzb31,mzb32,mzb33 = CMterms_M3_smk0_magnetic(cdelta,sdelta,cpsih,spsih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,IV[1],IV[2],IV[3])
    W21Block  = -2.0/Jg*mxb13 - 2.0/Jg*1.0/(1+k)*myb23;
    Tb3Block  = mxb13+myb23+mzb33;
    Tb2Block  = mxb12+myb22+mzb32;
    Tb1Block  = mxb11+myb21+mzb31;

    if typeofvariables==1
        W21 = W21Block;
        W22 = Tb3Block;
        W23 = (cdelta*Tb3Block + sdelta*Tb2Block);
        W24 = 0.0;
        W25 = - cdelta/sdelta/Jg*Tb1Block;
        W26 = 1/sdelta/Jg*Tb1Block;  
        WM3  = [W21,W22,W23,W24,W25,W26];
    else
        W21 = W21Block;
        W22 = Tb3Block;
        W23 = (cdelta*Tb3Block + sdelta*Tb2Block);
        W24 = 0.0;
        W25 = psih*sdelta/Jg*Tb2Block;
        W26 = -spsih*Tb1Block+sdelta*cpsih*Tb3Block-cdelta*spsih*Tb2Block  
        W27 = cpsih*Tb1Block+sdelta*spsih*Tb3Block-cdelta*spsih*Tb2Block  
        WM3  = [W21,W22,W23,W24,W25,W26,W27];
    end


    return WM3;

end



###############################################################################################################################################################################################
# generic case k!=0 m!=0

function derivativechiM2_Jl(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)
    contr = zeros(122);
    t1 = cos(psil)
    t2 = cdelta * IMy
    t3 = sqrt(q)
    t5 = -1 + m
    t8 = k + m
    t10 = KK * t5 * k + EE * t8
    t11 = Q1 ^ 2
    t12 = Q2 ^ 2
    t13 = t11 + t12 + 1
    t14 = t13 ^ 2
    t15 = 1 / t14
    t16 = t11 * t15
    t21 = 1 / t13
    t22 = Q1 * t21
    t25 = Q2 * t21
    t31 = -2 * cpa1EQ * t22 + 2 * cpa2EQ * t25 + cpa3EQ * (-t11 - t12 + 1) * t21
    t33 = -t11 + t12 + 1
    t34 = t33 * t21
    t35 = cpa1EQ * t34
    t37 = Q2 * cpa2EQ * t22
    t39 = cpa3EQ * t22
    t41 = t35 + 2 * t37 + 2 * t39
    t42 = t21 * t41
    t43 = t33 * t42
    t45 = Q2 * cpa1EQ * t22
    t47 = t11 - t12 + 1
    t48 = t47 * t21
    t49 = cpa2EQ * t48
    t50 = cpa3EQ * t25
    t52 = 2 * t45 + t49 - 2 * t50
    t53 = t21 * t52
    t54 = Q1 * Q2
    t55 = t54 * t53
    t56 = 2 * t55
    t57 = t43 + t56
    t60 = 2 * Q1 * t21 * t57
    t61 = t54 * t42
    t62 = 2 * t61
    t63 = t47 * t53
    t64 = t62 + t63
    t67 = t31 * (4 * t16 + 4 * t12 * t15 - 2/3) - t60 + 2 * t64 * t25
    t69 = pi ^ 2
    t70 = muM * t69
    t71 = t70 * t67 * t10
    t73 = KK ^ 2
    t75 = 1 / t73 / KK
    t76 = q - 1
    t77 = 0.1e1 / t76
    t79 = rc ^ 2
    t81 = 0.1e1 / t79 / rc
    t82 = 0.1e1 / npsil
    t83 = t82 * t81
    t85 = 1 / m
    t86 = 1 / t5
    t87 = t86 * t85
    t88 = sqrt(k)
    t89 = 0.1e1 / t88
    t90 = 0.1e1 / Jg
    t92 = t90 * t89 * t87
    t96 = 1 + k
    t97 = sqrt(t96)
    t98 = 0.1e1 / t97
    t100 = t3 * cdelta
    t102 = t69 * pi
    t103 = t102 * t67
    t104 = sqrt(t8)
    t105 = 0.1e1 / t104
    t106 = muM * t105
    t107 = t73 ^ 2
    t108 = 1 / t107
    t113 = npsil ^ 2
    t114 = 0.1e1 / t113
    t115 = t10 * t114
    t117 = -C + A
    t118 = 0.1e1 / A
    t120 = 0.1e1 / C
    t123 = t86 * t85 * t120 * t118 * t117
    t129 = 1 + q
    t130 = t102 * t129
    t131 = muM * t8
    t134 = t76 ^ 2
    t141 = KK * (-KP + EP) + EE * KP
    t142 = t141 * t89
    t143 = t90 * t87
    t144 = t143 * t142
    contr[1] = (3/2 * t92 * t83 * t77 * t75 * t71 * t3 * t2 - 3/4 * t123 * t115 * t81 * t77 * t108 * t106 * t103 * t100 * t98 * IMy + 3/4 * t144 * t83 / t134 * t108 * t131 * t130 * t67 * t3 * t2) * t1
    t149 = 2 * TL
    t150 = -psig + t149
    t151 = cos(t150)
    t152 = exp(sigma)
    t153 = t152 * t10
    t155 = IMz * muM
    t156 = t21 * t31
    t157 = Q2 * t156
    t162 = t57 * t25
    t164 = -2 * Q1 * t21 * (t62 + t63 + 4 * t157) + 2 * t162
    t165 = t69 * t164
    t169 = exp(2 * sigma)
    t170 = t169 - 1
    t172 = 0.1e1 / t170 * t81
    t173 = 0.1e1 / npsig
    t176 = t90 * t98
    t177 = t176 * t87
    t178 = t177 * t173 * t75 * t172
    t181 = sdelta * t152
    t182 = t155 * t181
    t185 = npsig ^ 2
    t192 = EE * KK * m - PP * t10
    t193 = t98 * t192
    t195 = t123 * t193 / t185 * t108
    t198 = 1 + t169
    t199 = t198 * t8
    t204 = t170 ^ 2
    t212 = (EE - KK) * FA + KK * EA
    t214 = t143 * t212 * t98
    t215 = t214 * t173 * t108 / t204 * t81
    t218 = 3/8 * t178 * t165 * t155 * sdelta * t153 - 3/8 * t195 * t172 * t165 * t182 - 3/16 * t215 * t102 * t164 * t155 * t199 * t181
    contr[2] = t218 * t151
    t219 = psig + t149
    t220 = cos(t219)
    contr[3] = -t218 * t220
    t222 = -psih + psig
    t223 = cos(t222)
    t224 = IMz * t153
    t225 = t33 ^ 2
    t226 = t225 * t15
    t227 = t12 * t16
    t228 = 4 * t227
    t230 = t41 * (t226 + t228 - 2/3)
    t231 = Q1 * t156
    t235 = t33 * t21 * (2 * t55 - 2 * t231)
    t236 = 2 * t157
    t237 = t63 + t236
    t240 = 2 * t237 * Q2 * t22
    t241 = t230 + t235 + t240
    t242 = cdelta - 1
    t243 = t242 * t241
    t248 = IMz * t152
    t249 = t70 * t248
    t254 = t8 * t152
    t256 = IMz * t198 * t254
    t257 = t102 * muM
    contr[4] = (-3/8 * t178 * t243 * t70 * t224 + 3/8 * t195 * t172 * t243 * t249 + 3/16 * t215 * t243 * t257 * t256) * t223
    t263 = psih + psig
    t264 = cos(t263)
    t265 = cdelta + 1
    t266 = t265 * t241
    contr[5] = (3/8 * t178 * t266 * t70 * t224 - 3/8 * t195 * t172 * t266 * t249 - 3/16 * t215 * t266 * t257 * t256) * t264
    t280 = 2 * psil
    t281 = psih - t280
    t282 = cos(t281)
    t283 = t241 * IMz
    t285 = t69 * sdelta
    t286 = q * muM
    t287 = t286 * t285
    t290 = q ^ 2
    t291 = t290 + 1
    t292 = 0.1e1 / t291
    t295 = t177 * t82 * t292 * t75 * t81
    t298 = t105 * IMz
    t299 = sdelta * t241
    t301 = t102 * t88
    t302 = t81 * t286
    t303 = t302 * t301
    t306 = t117 * t115
    t312 = t86 * t85 / t96 * t120 * t118
    t313 = t312 * t306 * t292 * t108
    t316 = t8 * IMz
    t318 = t129 * t76
    t319 = t81 * t257
    t320 = t319 * t318
    t322 = t291 ^ 2
    t328 = t143 * q * t98
    t329 = t328 * t141 * t82 / t322 * t108
    t332 = -3/8 * t295 * t287 * t10 * t283 + 3/16 * t313 * t303 * t299 * t298 - 3/8 * t329 * t320 * t299 * t316
    contr[6] = t332 * t282
    t333 = psih - psil
    t334 = cos(t333)
    t335 = t10 * muM
    t336 = t69 * t335
    t337 = t33 * t15
    t338 = t54 * t337
    t339 = Q1 * t15
    t340 = t47 * Q2
    t341 = t340 * t339
    t343 = 2 * t338 + 2 * t341
    t345 = t47 ^ 2
    t346 = t345 * t15
    t348 = t52 * (t228 + t346 - 2/3)
    t349 = Q2 * t16
    t352 = Q2 * t47 * t15
    t353 = 2 * t352
    t356 = t41 * t343 + t348 + (-4 * t349 + t353) * t31
    t358 = t97 * t129
    t359 = t358 * IMy * t356
    t360 = t343 * t52
    t361 = Q1 * t337
    t362 = 2 * t361
    t363 = t12 * t339
    t367 = t230 + t360 + (-t362 + 4 * t363) * t31
    t369 = t76 * t367 * IMx
    t372 = t75 * t3
    t375 = t290 - 1
    t376 = 0.1e1 / t375
    t380 = t176 * t89 * t86
    t381 = t380 * t85 * t376 * t83
    t392 = 2 * t41 * t340 * t339
    t393 = t15 * t31
    t394 = Q2 * t11
    t400 = t52 * t12 * t16
    t401 = 4 * t400
    t402 = t52 * t346
    t403 = -4/3 * t45 - 2/3 * t49 + 4/3 * t50 + 2 * t41 * t54 * t337 + t392 - 4 * t394 * t393 + 2 * t340 * t393 + t401 + t402
    t404 = IMy * t403
    t405 = t358 * t404
    t406 = t15 * t41
    t407 = t225 * t406
    t410 = 4 * t12 * t11 * t406
    t414 = t407 + t235 + t410 + t240 - 2/3 * t35 - 4/3 * t37 - 4/3 * t39
    t415 = t414 * IMx
    t416 = t76 * t415
    t421 = t81 * t108
    t422 = t421 * t105 * t3
    t425 = t117 * t10
    t427 = t312 * t425 * t376 * t114
    t430 = t129 ^ 2
    t431 = t430 * t129
    t432 = t97 * t431
    t433 = t432 * t404
    t434 = t134 * t76
    t435 = t434 * t415
    t438 = sdelta * t102
    t440 = t8 * t3
    t441 = t421 * t440
    t443 = t375 ^ 2
    t447 = t177 * t142 / t443 * t82
    contr[7] = (-3/4 * t381 * t372 * (t359 + t369) * sdelta * t336 + 3/8 * t427 * t422 * (t405 + t416) * sdelta * t257 - 3/8 * t447 * t441 * t438 * (t433 + t435) * muM) * t334
    t451 = psih + psil
    t452 = cos(t451)
    t453 = t3 * sdelta
    contr[8] = (3/4 * t381 * t75 * (-t359 + t369) * t453 * t336 - 3/8 * t427 * t421 * t105 * (-t405 + t416) * t453 * t257 + 3/8 * t447 * t441 * t438 * muM * (-t433 + t435)) * t452
    t474 = psih + t280
    t475 = cos(t474)
    contr[9] = -t332 * t475
    t478 = -2 * psil + 2 * TL
    t479 = cos(t478)
    t480 = t164 * IMz
    t482 = t69 * cdelta
    t497 = t15 * t52
    t498 = t12 * Q1
    t508 = t102 * cdelta
    t511 = t81 * t8
    t516 = -3/8 * t295 * t286 * t482 * t10 * t480 + 3/16 * t313 * t303 * cdelta * t164 * t298 - 3/8 * t329 * t511 * t375 * muM * t508 * (-2 * t47 * Q1 * t497 + 2 * Q2 * t33 * t406 - 8 * t54 * t393 - 4 * t394 * t406 + 4 * t498 * t497) * IMz
    contr[10] = t516 * t479
    t517 = -psil + t149
    t518 = cos(t517)
    t520 = 4 * t11 * t393
    t524 = t520 - t60 - 2 * (t62 + t63 + t236) * t25
    t525 = IMy * t524
    t526 = t358 * t525
    t527 = t76 * IMx
    t533 = -2 * Q1 * t21 * (t236 + t61 + t63 / 2) + t162
    t535 = 2 * t533 * t527
    t536 = t526 - t535
    t544 = t421 * t100
    t548 = t432 * t525
    t549 = t434 * IMx
    t551 = 2 * t533 * t549
    contr[11] = (3/4 * t381 * t372 * cdelta * t536 * t336 - 3/8 * t427 * t544 * t536 * t102 * t106 + 3/8 * t447 * t544 * (t548 - t551) * t102 * t131) * t518
    t559 = -psil + psig
    t560 = cos(t559)
    t561 = t3 * IMy
    t562 = sdelta * t10
    t564 = t67 * t152
    t566 = t70 * t564 * t562 * t561
    t567 = t169 + q
    t568 = 0.1e1 / t567
    t569 = t568 * t81
    t570 = -npsil + npsig
    t571 = 0.1e1 / t570
    t572 = t571 * t75
    t579 = t152 * t105
    t580 = muM * t103
    t582 = t580 * t579 * sdelta * t98 * t561
    t583 = t570 ^ 2
    t584 = 0.1e1 / t583
    t585 = t584 * t108
    t591 = t181 * t561
    t592 = t69 * t67
    t593 = t81 * muM
    t597 = t192 * t89
    t602 = t8 * sdelta
    t603 = t602 * t561
    t604 = q - t169
    t607 = t580 * t604 * t152 * t603
    t608 = t567 ^ 2
    t611 = t571 * t108
    t612 = t611 / t608 * t81
    t617 = t143 * t212 * t89
    contr[12] = (-3/4 * t92 * t572 * t569 * t566 - 3/8 * t123 * t10 * t585 * t569 * t582 + 3/4 * t123 * t597 * t585 * t568 * t593 * t592 * t591 - 3/8 * t144 * t612 * t607 - 3/8 * t617 * t612 * t607) * t560
    t622 = psil + t149
    t623 = cos(t622)
    t624 = t526 + t535
    contr[13] = (3/4 * t381 * t372 * t482 * t624 * t335 - 3/8 * t427 * t544 * t102 * t624 * t106 + 3/8 * t447 * t544 * t102 * (t548 + t551) * t131) * t623
    t642 = psil + psig
    t643 = cos(t642)
    t644 = q * t169
    t645 = 1 + t644
    t646 = 0.1e1 / t645
    t647 = t646 * t81
    t648 = npsil + npsig
    t649 = 0.1e1 / t648
    t650 = t649 * t75
    t655 = t648 ^ 2
    t656 = 0.1e1 / t655
    t657 = t656 * t108
    t670 = t644 - 1
    t674 = muM * t670 * t102 * t564 * t603
    t675 = t645 ^ 2
    t678 = t649 * t108
    t679 = t678 / t675 * t81
    contr[14] = (-3/4 * t92 * t650 * t647 * t566 + 3/8 * t123 * t10 * t657 * t647 * t582 + 3/4 * t123 * t597 * t657 * t646 * t593 * t592 * t591 - 3/8 * t144 * t679 * t674 + 3/8 * t617 * t679 * t674) * t643
    t688 = 2 * psil + 2 * TL
    t689 = cos(t688)
    contr[15] = -t516 * t689
    t691 = t149 - psig + t280
    t692 = cos(t691)
    t693 = t181 * t480
    t694 = q * t69
    t695 = t335 * t694
    t696 = t695 * t693
    t697 = t290 - t169
    t698 = 0.1e1 / t697
    t700 = 2 * npsil
    t701 = -t700 + npsig
    t702 = 1 / t701
    t705 = t177 * t702 * t75 * t698 * t81
    t708 = t88 * IMz
    t712 = t102 * t152
    t714 = t302 * t712 * sdelta * t105 * t164 * t708
    t716 = t701 ^ 2
    t717 = 1 / t716
    t719 = t117 * t10 * t717
    t721 = t312 * t719 * t108 * t698
    t724 = t698 * t593
    t725 = t724 * t694
    t729 = t123 * t193 * t717 * t108
    t732 = t290 + t169
    t733 = t8 * t732
    t734 = t733 * t480
    t737 = t697 ^ 2
    t738 = 0.1e1 / t737
    t740 = t141 * t702
    t742 = t328 * t740 * t108 * t738
    t745 = q * t102
    t750 = t702 * t108
    t752 = t214 * t750 * t738 * t81
    t755 = -3/8 * t705 * t696 - 3/8 * t721 * t714 + 3/8 * t729 * t725 * t693 - 3/8 * t742 * t319 * t181 * t734 - 3/16 * t752 * muM * t745 * t181 * t734
    contr[16] = t755 * t692
    t756 = t149 + psig - t280
    t757 = cos(t756)
    contr[17] = -t755 * t757
    t759 = t149 - psil - psig
    t760 = cos(t759)
    t761 = muM * t152
    t763 = t97 * IMy
    t764 = t763 * t670 * t524
    t765 = t645 * IMx
    t767 = 2 * t533 * t765
    t768 = t764 - t767
    t771 = t3 * t69
    t772 = t81 * sdelta
    t773 = t772 * t771
    t776 = exp(4 * sigma)
    t777 = t290 * t776
    t778 = t777 - 1
    t779 = 0.1e1 / t778
    t782 = t380 * t85 * t779 * t650
    t787 = t3 * t102
    t789 = t108 * t772 * t787
    t793 = t312 * t425 * t779 * t656
    t798 = t656 * t421
    t799 = t798 * t453
    t803 = t123 * t193 * t89 * t779
    t807 = t290 * q
    t809 = exp(6 * sigma)
    t810 = t809 * t807
    t811 = 3 * t777
    t812 = 3 * t644
    t813 = t810 - t811 + t812 - 1
    t815 = t763 * t813 * t524
    t816 = t533 * IMx
    t817 = t810 + t811 + t812 + 1
    t819 = 2 * t817 * t816
    t823 = t81 * (t815 - t819) * t602 * t787 * t761
    t824 = t778 ^ 2
    t825 = 0.1e1 / t824
    t829 = t143 * t98 * t141
    t830 = t829 * t89 * t825 * t678
    t835 = t617 * t98 * t825 * t678
    contr[18] = (-3/8 * t782 * t773 * t10 * t768 * t761 + 3/16 * t793 * t789 * t768 * muM * t579 + 3/8 * t803 * t799 * t69 * t768 * t761 - 3/16 * t830 * t823 + 3/16 * t835 * t823) * t760
    t839 = t149 - psil + psig
    t840 = cos(t839)
    t842 = t763 * t604 * t524
    t844 = 2 * t567 * t816
    t845 = t842 - t844
    t846 = t845 * t152
    t849 = t290 - t776
    t850 = 0.1e1 / t849
    t853 = t380 * t85 * t850 * t572
    t861 = t312 * t425 * t850 * t584
    t865 = t584 * t421
    t866 = t865 * t453
    t870 = t123 * t193 * t89 * t850
    t873 = t290 * t169
    t874 = 3 * t873
    t876 = 3 * q * t776
    t877 = t807 - t874 + t876 - t809
    t878 = t97 * t877
    t879 = t878 * t525
    t880 = t807 + t874 + t876 + t809
    t881 = t880 * IMx
    t883 = 2 * t533 * t881
    t887 = t772 * t440
    t888 = t887 * t102 * (t879 - t883) * t761
    t889 = t849 ^ 2
    t890 = 0.1e1 / t889
    t893 = t829 * t89 * t890 * t611
    t898 = t617 * t98 * t890 * t611
    contr[19] = (-3/8 * t853 * t773 * t335 * t846 - 3/16 * t861 * t789 * muM * t845 * t579 + 3/8 * t870 * t866 * t70 * t846 - 3/16 * t893 * t888 - 3/16 * t898 * t888) * t840
    t902 = t149 + psil - psig
    t903 = cos(t902)
    t904 = t842 + t844
    t923 = t887 * t102 * (t879 + t883) * t761
    contr[20] = (-3/8 * t853 * t773 * t10 * t904 * t761 - 3/16 * t861 * t789 * t904 * muM * t579 + 3/8 * t870 * t866 * t69 * t904 * t761 - 3/16 * t893 * t923 - 3/16 * t898 * t923) * t903
    t929 = t149 + psil + psig
    t930 = cos(t929)
    t931 = t764 + t767
    t950 = t887 * t102 * (t815 + t819) * t761
    contr[21] = (-3/8 * t782 * t773 * t931 * t10 * t761 + 3/16 * t793 * t789 * t931 * muM * t579 + 3/8 * t803 * t799 * t69 * t931 * t761 - 3/16 * t830 * t950 + 3/16 * t835 * t950) * t930
    t956 = -psig - psih + t149
    t957 = cos(t956)
    t958 = t47 * t337
    t961 = t47 * t339
    t964 = t31 * (-2 * t361 - 2 * t961)
    t965 = t41 * (t226 + t958) + t964 + t360
    t966 = t965 * t153
    t967 = t265 * t69
    t968 = t967 * t155
    t972 = t965 * t152
    t973 = t155 * t972
    t974 = t172 * t967
    t978 = t199 * t972
    t979 = t265 * t102
    t980 = t979 * t155
    contr[22] = (3/16 * t178 * t968 * t966 - 3/16 * t195 * t974 * t973 - 3/32 * t215 * t980 * t978) * t957
    t985 = -psig + psih + t149
    t986 = cos(t985)
    t987 = 8 * t227
    t993 = t31 * (-t362 - 8 * t363 + 2 * t961)
    t998 = t41 * (t226 - t958 - t987) + t993 + (2 * t338 - 6 * t341) * t52
    t999 = t998 * t153
    t1000 = t242 * t69
    t1001 = t1000 * t155
    t1005 = t998 * t152
    t1006 = t155 * t1005
    t1007 = t172 * t1000
    t1011 = t199 * t1005
    t1012 = t242 * t102
    t1013 = t1012 * t155
    contr[23] = (-3/16 * t178 * t1001 * t999 + 3/16 * t195 * t1007 * t1006 + 3/32 * t215 * t1013 * t1011) * t986
    t1018 = -psig - t280 + t149
    t1019 = cos(t1018)
    t1020 = t873 - 1
    t1021 = 0.1e1 / t1020
    t1023 = t700 + npsig
    t1024 = 1 / t1023
    t1027 = t177 * t1024 * t75 * t1021 * t81
    t1031 = t1023 ^ 2
    t1032 = 1 / t1031
    t1034 = t117 * t10 * t1032
    t1036 = t312 * t1034 * t108 * t1021
    t1039 = t1021 * t593
    t1040 = t1039 * t694
    t1044 = t123 * t193 * t1032 * t108
    t1047 = t602 * t480
    t1048 = 1 + t873
    t1050 = t81 * muM * t1048
    t1053 = t1020 ^ 2
    t1054 = 0.1e1 / t1053
    t1056 = t141 * t1024
    t1058 = t328 * t1056 * t108 * t1054
    t1061 = t1048 * q
    t1062 = muM * t1061
    t1066 = t1024 * t108
    t1068 = t214 * t1066 * t1054 * t81
    t1071 = 3/8 * t1027 * t696 - 3/8 * t1036 * t714 - 3/8 * t1044 * t1040 * t693 + 3/8 * t1058 * t1050 * t712 * t1047 - 3/16 * t1068 * t1062 * t712 * t1047
    contr[24] = t1071 * t1019
    t1072 = psig - psih + t149
    t1073 = cos(t1072)
    contr[25] = (-3/16 * t178 * t1001 * t966 + 3/16 * t195 * t1007 * t973 + 3/32 * t215 * t1013 * t978) * t1073
    t1084 = psig + psih + t149
    t1085 = cos(t1084)
    contr[26] = (3/16 * t178 * t968 * t999 - 3/16 * t195 * t974 * t1006 - 3/32 * t215 * t980 * t1011) * t1085
    t1096 = psig + t280 + t149
    t1097 = cos(t1096)
    contr[27] = -t1071 * t1097
    t1099 = -psih + psig - t280
    t1100 = cos(t1099)
    t1101 = t69 * t152
    t1102 = t1101 * t283
    t1103 = q * t242
    t1104 = t335 * t1103
    t1105 = t1104 * t1102
    t1110 = t152 * t241 * t105 * t708
    t1111 = t302 * t1012
    t1112 = t1111 * t1110
    t1115 = t724 * t1103
    t1119 = t732 * IMz
    t1121 = t241 * t8 * t1119
    t1122 = muM * t242
    t1123 = t81 * t1122
    t1124 = t1123 * t712
    t1129 = muM * t1103 * t712
    contr[28] = (3/8 * t705 * t1105 + 3/8 * t721 * t1112 - 3/8 * t729 * t1115 * t1102 + 3/8 * t742 * t1124 * t1121 + 3/16 * t752 * t1129 * t1121) * t1100
    t1134 = -psih + psig - psil
    t1135 = cos(t1134)
    t1137 = t763 * t604 * t356
    t1138 = t567 * IMx
    t1139 = t367 * t1138
    t1143 = t81 * t3
    t1144 = t1143 * t1000
    t1149 = t763 * t604 * t403
    t1150 = t414 * t1138
    t1153 = t1122 * (-t1149 + t1150) * t152
    t1155 = t108 * t81 * t105
    t1156 = t1155 * t787
    t1160 = t865 * t771
    t1164 = t878 * t404
    t1165 = t414 * t881
    t1169 = t511 * t787
    t1170 = t1169 * t242 * (-t1164 + t1165) * t761
    contr[29] = (3/8 * t853 * t1144 * t335 * (-t1137 + t1139) * t152 + 3/16 * t861 * t1156 * t1153 - 3/8 * t870 * t1160 * t1153 + 3/16 * t893 * t1170 + 3/16 * t898 * t1170) * t1135
    t1176 = -psih + psig + psil
    t1177 = cos(t1176)
    t1179 = t763 * t670 * t356
    t1180 = t367 * t765
    t1188 = t763 * t670 * t403
    t1189 = t414 * t765
    t1192 = t242 * (t1188 + t1189) * t761
    t1196 = t798 * t771
    t1200 = t1012 * t761
    t1202 = t763 * t813 * t403
    t1203 = t817 * t415
    t1207 = t511 * (t1202 + t1203) * t3 * t1200
    contr[30] = (-3/8 * t782 * t1144 * (t1179 + t1180) * t10 * t761 + 3/16 * t793 * t1156 * t1192 + 3/8 * t803 * t1196 * t1192 - 3/16 * t830 * t1207 + 3/16 * t835 * t1207) * t1177
    t1213 = -psih + psig + t280
    t1214 = cos(t1213)
    t1219 = t1039 * t1103
    t1224 = t152 * t241 * t316
    t1225 = t1050 * t1012
    t1229 = t1062 * t1012
    contr[31] = (-3/8 * t1027 * t1105 + 3/8 * t1036 * t1112 + 3/8 * t1044 * t1219 * t1102 - 3/8 * t1058 * t1225 * t1224 + 3/16 * t1068 * t1229 * t1224) * t1214
    t1234 = -psih - psil + t149
    t1235 = cos(t1234)
    t1236 = t129 * IMy
    t1237 = Q2 * t337
    t1239 = 2 * t1237 + 2 * t352
    t1244 = t33 * t21 * t64 + t31 * t1239 + t64 * t48
    t1245 = t97 * t1244
    t1246 = t1245 * t1236
    t1247 = t47 * t42
    t1252 = 2 * t61 + 2 * t63
    t1258 = 2 * t47 * t54 * t497
    t1259 = t964 + t407 + t33 * t21 * (t1247 + t56) + 2 * t54 * t21 * t1252 - t410 - t1258
    t1260 = t1259 * t527
    t1261 = t1246 + t1260
    t1269 = t421 * t453
    t1273 = t431 * IMy
    t1274 = t1245 * t1273
    t1275 = t1259 * t549
    contr[32] = (3/8 * t381 * t372 * sdelta * t1261 * t336 - 3/16 * t427 * t1269 * t1261 * t102 * t106 + 3/16 * t447 * t1269 * t102 * (t1274 + t1275) * t131) * t1235
    t1283 = -psih + psil + t149
    t1284 = cos(t1283)
    t1285 = -t1246 + t1260
    t1288 = t372 * t562
    contr[33] = (-3/8 * t381 * t1288 * t69 * t1285 * muM + 3/16 * t427 * t1269 * t102 * t1285 * t106 - 3/16 * t447 * t1269 * t102 * (-t1274 + t1275) * t131) * t1284
    t1304 = psih + psig - t280
    t1305 = cos(t1304)
    t1306 = t265 * q
    t1307 = t335 * t1306
    t1308 = t1307 * t1102
    t1311 = muM * t265
    t1312 = t81 * t1311
    t1313 = t1312 * t745
    t1314 = t1313 * t1110
    t1317 = t724 * t1306
    t1321 = t254 * t1119
    t1322 = t102 * t241
    t1327 = muM * t1306
    contr[34] = (-3/8 * t705 * t1308 - 3/8 * t721 * t1314 + 3/8 * t729 * t1317 * t1102 - 3/8 * t742 * t1312 * t1322 * t1321 - 3/16 * t752 * t1327 * t1322 * t1321) * t1305
    t1333 = psih + psig - psil
    t1334 = cos(t1333)
    t1344 = t1311 * t152 * (t1149 + t1150)
    t1354 = t1169 * t265 * (t1164 + t1165) * t761
    contr[35] = (-3/8 * t853 * t1143 * t967 * t335 * t152 * (t1137 + t1139) - 3/16 * t861 * t1156 * t1344 + 3/8 * t870 * t1160 * t1344 - 3/16 * t893 * t1354 - 3/16 * t898 * t1354) * t1334
    t1360 = psih + psig + psil
    t1361 = cos(t1360)
    t1363 = t265 * t10 * t761
    t1370 = t979 * t761
    t1372 = (-t1188 + t1189) * t3
    t1377 = t967 * t761
    t1385 = t511 * t3 * (-t1202 + t1203) * t1370
    contr[36] = (3/8 * t782 * t81 * (-t1179 + t1180) * t771 * t1363 - 3/16 * t793 * t1155 * t1372 * t1370 - 3/8 * t803 * t798 * t1372 * t1377 + 3/16 * t830 * t1385 - 3/16 * t835 * t1385) * t1361
    t1391 = psih + psig + t280
    t1392 = cos(t1391)
    t1397 = t1039 * t1306
    t1401 = t1050 * t979
    t1407 = muM * t1048 * t265 * t745
    contr[37] = (3/8 * t1027 * t1308 - 3/8 * t1036 * t1314 - 3/8 * t1044 * t1397 * t1102 + 3/8 * t1058 * t1401 * t1224 - 3/16 * t1068 * t1407 * t1224) * t1392
    t1412 = psih - psil + t149
    t1413 = cos(t1412)
    t1417 = t31 * (2 * t1237 - 8 * t349 - t353)
    t1423 = t1417 + t33 * t21 * (6 * t61 + t63) + 8 * t400 - t392 - t402
    t1424 = IMy * t1423
    t1425 = t358 * t1424
    t1433 = t993 + t407 + t33 * t21 * (-t1247 + t56) - 2 * t54 * t21 * t1252 - t410 - t1258
    t1434 = t1433 * t527
    t1436 = (t1425 + t1434) * muM
    t1441 = t102 * t105
    t1446 = t432 * t1424
    t1447 = t1433 * t549
    contr[38] = (-3/8 * t381 * t1288 * t69 * t1436 + 3/16 * t427 * t1269 * t1441 * t1436 - 3/16 * t447 * t1269 * (t1446 + t1447) * t102 * t131) * t1413
    t1455 = psih + psil + t149
    t1456 = cos(t1455)
    t1457 = -t1425 + t1434
    t1470 = t102 * t8
    contr[39] = (3/8 * t381 * t372 * sdelta * t1457 * t336 - 3/16 * t427 * t1269 * t1457 * t102 * t106 + 3/16 * t447 * t1269 * t1470 * (-t1446 + t1447) * muM) * t1456
    t1476 = -t280 - psih + t149
    t1477 = cos(t1476)
    t1478 = t965 * IMz
    t1483 = sdelta * t965
    t1492 = 3/16 * t295 * t287 * t10 * t1478 - 3/32 * t313 * t303 * t1483 * t298 + 3/16 * t329 * t320 * t1483 * t316
    contr[40] = t1492 * t1477
    t1493 = -t280 + psih + t149
    t1494 = cos(t1493)
    t1495 = t998 * IMz
    t1500 = sdelta * t998
    t1509 = -3/16 * t295 * t287 * t10 * t1495 + 3/32 * t313 * t303 * t1500 * t298 - 3/16 * t329 * t320 * t1500 * t316
    contr[41] = t1509 * t1494
    t1510 = t280 - psih + t149
    t1511 = cos(t1510)
    contr[42] = -t1492 * t1511
    t1513 = t280 + psih + t149
    t1514 = cos(t1513)
    contr[43] = -t1509 * t1514
    t1516 = -psig - t280 - psih + t149
    t1517 = cos(t1516)
    t1518 = t1101 * t1478
    t1519 = t1307 * t1518
    t1524 = t152 * t105 * t965 * t708
    t1525 = t1313 * t1524
    t1531 = t254 * t1478
    contr[44] = (3/16 * t1027 * t1519 - 3/16 * t1036 * t1525 - 3/16 * t1044 * t1397 * t1518 + 3/16 * t1058 * t1401 * t1531 - 3/32 * t1068 * t1407 * t1531) * t1517
    t1539 = psig + t280 - psih + t149
    t1540 = cos(t1539)
    t1541 = t1104 * t1518
    t1544 = t1111 * t1524
    contr[45] = (-3/16 * t1027 * t1541 + 3/16 * t1036 * t1544 + 3/16 * t1044 * t1219 * t1518 - 3/16 * t1058 * t1225 * t1531 + 3/32 * t1068 * t1229 * t1531) * t1540
    t1557 = -psih + t149 - psig + t280
    t1558 = cos(t1557)
    t1566 = t733 * t1478
    t1567 = t1312 * t712
    t1571 = t1327 * t712
    contr[46] = (-3/16 * t705 * t1519 - 3/16 * t721 * t1525 + 3/16 * t729 * t1317 * t1518 - 3/16 * t742 * t1567 * t1566 - 3/32 * t752 * t1571 * t1566) * t1558
    t1576 = -psih + t149 + psig - t280
    t1577 = cos(t1576)
    contr[47] = (3/16 * t705 * t1541 + 3/16 * t721 * t1544 - 3/16 * t729 * t1115 * t1518 + 3/16 * t742 * t1124 * t1566 + 3/32 * t752 * t1129 * t1566) * t1577
    t1592 = psih + t149 - psig - t280
    t1593 = cos(t1592)
    t1594 = t1101 * t1495
    t1595 = t1104 * t1594
    t1600 = t152 * t105 * t998 * t708
    t1601 = t1111 * t1600
    t1607 = t254 * t1495
    contr[48] = (-3/16 * t1027 * t1595 + 3/16 * t1036 * t1601 + 3/16 * t1044 * t1219 * t1594 - 3/16 * t1058 * t1225 * t1607 + 3/32 * t1068 * t1229 * t1607) * t1593
    t1615 = psih + t149 - psig + t280
    t1616 = cos(t1615)
    t1624 = t733 * t1495
    contr[49] = (3/16 * t705 * t1595 + 3/16 * t721 * t1601 - 3/16 * t729 * t1115 * t1594 + 3/16 * t742 * t1124 * t1624 + 3/32 * t752 * t1129 * t1624) * t1616
    t1632 = psih + t149 + psig - t280
    t1633 = cos(t1632)
    t1634 = t1307 * t1594
    t1637 = t1313 * t1600
    contr[50] = (-3/16 * t705 * t1634 - 3/16 * t721 * t1637 + 3/16 * t729 * t1317 * t1594 - 3/16 * t742 * t1567 * t1624 - 3/32 * t752 * t1571 * t1624) * t1633
    t1650 = psih + t149 + psig + t280
    t1651 = cos(t1650)
    contr[51] = (3/16 * t1027 * t1634 - 3/16 * t1036 * t1637 - 3/16 * t1044 * t1397 * t1594 + 3/16 * t1058 * t1401 * t1607 - 3/32 * t1068 * t1407 * t1607) * t1651
    t1666 = -psil - psig - psih + t149
    t1667 = cos(t1666)
    t1668 = IMy * t670
    t1669 = t1245 * t1668
    t1670 = t1259 * t765
    t1671 = t1669 + t1670
    t1673 = t1311 * t152 * t1671
    t1675 = t1143 * t69 * t10
    t1681 = t108 * t1143
    t1682 = t1681 * t979
    t1689 = t813 * IMy
    t1690 = t1245 * t1689
    t1691 = t817 * IMx
    t1692 = t1259 * t1691
    t1696 = t1169 * t265 * (t1690 + t1692) * t761
    contr[52] = (3/16 * t782 * t1675 * t1673 - 3/32 * t793 * t1682 * t761 * t1671 * t105 - 3/16 * t803 * t1196 * t1673 + 3/32 * t830 * t1696 - 3/32 * t835 * t1696) * t1667
    t1702 = -psil - psig + psih + t149
    t1703 = cos(t1702)
    t1705 = t10 * t242 * t761
    t1706 = t97 * t1423
    t1707 = t1706 * t1668
    t1708 = t1433 * t765
    t1709 = t1707 + t1708
    t1715 = t1122 * t579
    t1721 = t1000 * t761
    t1727 = t1706 * t1689
    t1728 = t1433 * t1691
    t1732 = t1169 * t242 * (t1727 + t1728) * t761
    contr[53] = (-3/16 * t782 * t1143 * t1709 * t69 * t1705 + 3/32 * t793 * t1681 * t1709 * t102 * t1715 + 3/16 * t803 * t798 * t3 * t1709 * t1721 - 3/32 * t830 * t1732 + 3/32 * t835 * t1732) * t1703
    t1738 = -psil + psig - psih + t149
    t1739 = cos(t1738)
    t1740 = IMy * t604
    t1741 = t1245 * t1740
    t1742 = t1259 * t1138
    t1743 = t1741 + t1742
    t1760 = t878 * t1244 * IMy
    t1761 = t1259 * t881
    t1765 = t1169 * (t1760 + t1761) * t242 * t761
    contr[54] = (3/16 * t853 * t1143 * t1743 * t69 * t1705 + 3/32 * t861 * t1681 * t1743 * t102 * t1715 - 3/16 * t870 * t865 * t3 * t1743 * t1721 + 3/32 * t893 * t1765 + 3/32 * t898 * t1765) * t1739
    t1771 = -psil + psig + psih + t149
    t1772 = cos(t1771)
    t1773 = t1706 * t1740
    t1774 = t1433 * t1138
    t1775 = t1773 + t1774
    t1777 = t265 * t1775 * t761
    t1789 = t878 * t1424
    t1790 = t1433 * t881
    t1794 = t81 * (t1789 + t1790) * t440 * t1370
    contr[55] = (-3/16 * t853 * t1675 * t1777 - 3/32 * t861 * t1682 * t1775 * muM * t579 + 3/16 * t870 * t1160 * t1777 - 3/32 * t893 * t1794 - 3/32 * t898 * t1794) * t1772
    t1800 = psil - psig - psih + t149
    t1801 = cos(t1800)
    t1802 = -t1741 + t1742
    t1804 = t1311 * t1802 * t152
    t1819 = t511 * t3 * (-t1760 + t1761) * t1370
    contr[56] = (-3/16 * t853 * t1675 * t1804 - 3/32 * t861 * t1682 * muM * t1802 * t579 + 3/16 * t870 * t1160 * t1804 - 3/32 * t893 * t1819 - 3/32 * t898 * t1819) * t1801
    t1825 = psil - psig + psih + t149
    t1826 = cos(t1825)
    t1827 = -t1773 + t1774
    t1829 = t242 * t1827 * t761
    t1835 = t1681 * t1012
    t1845 = t1169 * (-t1789 + t1790) * t242 * t761
    contr[57] = (3/16 * t853 * t1675 * t1829 + 3/32 * t861 * t1835 * t1827 * muM * t579 - 3/16 * t870 * t1160 * t1829 + 3/32 * t893 * t1845 + 3/32 * t898 * t1845) * t1826
    t1851 = psil + psig - psih + t149
    t1852 = cos(t1851)
    t1853 = -t1669 + t1670
    t1855 = t1122 * t152 * t1853
    t1870 = t511 * t3 * (-t1690 + t1692) * t1200
    contr[58] = (-3/16 * t782 * t1675 * t1855 + 3/32 * t793 * t1835 * t761 * t105 * t1853 + 3/16 * t803 * t1196 * t1855 - 3/32 * t830 * t1870 + 3/32 * t835 * t1870) * t1852
    t1876 = psil + psig + psih + t149
    t1877 = cos(t1876)
    t1878 = -t1707 + t1708
    t1884 = t1311 * t579
    t1898 = t1169 * (-t1727 + t1728) * t265 * t761
    contr[59] = (3/16 * t782 * t1143 * t1878 * t69 * t1363 - 3/32 * t793 * t1681 * t1878 * t102 * t1884 - 3/16 * t803 * t798 * t3 * t1878 * t1377 + 3/32 * t830 * t1898 - 3/32 * t835 * t1898) * t1877
    t1904 = sin(psig)
    t1906 = sdelta * IMz
    t1907 = t70 * t1906
    t1912 = t172 * t70
    t1918 = t257 * t316
    contr[60] = (3/4 * t178 * t1907 * t10 * t564 - 3/4 * t195 * t1912 * t1906 * t564 - 3/8 * t215 * t1918 * t198 * sdelta * t564) * t1904
    t1923 = sin(psil)
    t1925 = t10 * t3
    t1930 = 0.1e1 / t129
    t1951 = muM * t67
    contr[61] = (-3/2 * t380 * t85 * t82 * t81 * t1930 * t75 * muM * t592 * t1925 * IMx * cdelta + 3/4 * t312 * t425 * t114 * t81 * t1930 * t108 * muM * t103 * t100 * t105 * IMx - 3/4 * t829 * t89 * t82 * t81 / t430 * t108 * t1951 * t102 * t76 * t100 * t8 * IMx) * t1923
    t1963 = sin(t280)
    t1965 = t10 * cdelta * IMz
    t1970 = t88 * cdelta
    t1972 = t81 * t1951
    t1973 = t1972 * t745
    contr[62] = (-3/4 * t295 * t1951 * t694 * t1965 + 3/8 * t313 * t1973 * t1970 * t298 - 3/4 * t329 * t1972 * t130 * t76 * cdelta * t316) * t1963
    t1984 = sin(t150)
    t1985 = t152 * t524
    t2001 = -2 * Q1 * t33 * t406 - 4 * t12 * t393 - 2 * t340 * t497 - 4 * t394 * t497 - 4 * t498 * t406 + t520
    t2007 = t2001 * t102
    t2012 = -3/8 * t178 * t1907 * t10 * t1985 + 3/8 * t195 * t172 * t2001 * t69 * t182 + 3/16 * t215 * t199 * t2007 * t182
    contr[63] = t2012 * t1984
    t2013 = sin(t219)
    contr[64] = -t2012 * t2013
    t2016 = sin(psig - t280)
    t2017 = t1101 * t1906
    t2018 = t67 * q
    t2020 = t335 * t2018 * t2017
    t2023 = sdelta * t105
    t2026 = t1973 * t152 * t2023 * t708
    t2034 = sdelta * t732 * t316
    t2035 = t1972 * t712
    t2039 = muM * t2018
    contr[65] = (-3/4 * t705 * t2020 - 3/4 * t721 * t2026 + 3/4 * t729 * t724 * t2018 * t2017 - 3/4 * t742 * t2035 * t2034 - 3/8 * t752 * t2039 * t712 * t2034) * t2016
    t2046 = sin(psig + t280)
    t2055 = t181 * t316
    t2056 = t1048 * t102
    contr[66] = (3/4 * t1027 * t2020 - 3/4 * t1036 * t2026 - 3/4 * t1044 * t1039 * t2018 * t2017 + 3/4 * t1058 * t1972 * t2056 * t2055 - 3/8 * t1068 * t2039 * t2056 * t2055) * t2046
    t2066 = sin(t222)
    t2067 = 2 * t231
    t2075 = t348 + 2 * t54 * t21 * (t43 - t2067) + (2 * t61 + 2 * t157) * t48
    t2076 = t152 * t2075
    t2077 = t10 * t2076
    t2081 = IMz * t242
    contr[67] = (3/8 * t178 * t1001 * t2077 - 3/8 * t195 * t1912 * t2081 * t2076 - 3/16 * t215 * t1918 * t242 * t198 * t2076) * t2066
    t2092 = sin(t263)
    t2096 = IMz * t265
    contr[68] = (3/8 * t178 * t968 * t2077 - 3/8 * t195 * t1912 * t2096 * t2076 - 3/16 * t215 * t1918 * t198 * t265 * t2076) * t2092
    t2107 = sin(t281)
    t2108 = t2075 * IMz
    t2113 = sdelta * t2075
    t2122 = -3/8 * t295 * t695 * sdelta * t2108 + 3/16 * t313 * t303 * t2113 * t298 - 3/8 * t329 * t320 * t2113 * t316
    contr[69] = t2122 * t2107
    t2123 = sin(t333)
    t2124 = t97 * t367
    t2125 = t2124 * t1236
    t2126 = t356 * t527
    t2133 = t97 * t414
    t2134 = t2133 * t1236
    t2135 = t403 * t527
    t2142 = t2133 * t1273
    t2143 = t403 * t549
    contr[70] = (3/4 * t381 * t1288 * t69 * (t2125 - t2126) * muM - 3/8 * t427 * t422 * t438 * (t2134 - t2135) * muM + 3/8 * t447 * t441 * (t2142 - t2143) * sdelta * t257) * t2123
    t2151 = sin(t451)
    contr[71] = (3/4 * t381 * t1288 * t69 * muM * (t2125 + t2126) - 3/8 * t427 * t422 * t438 * muM * (t2134 + t2135) + 3/8 * t447 * t441 * t438 * (t2142 + t2143) * muM) * t2151
    t2171 = sin(t474)
    contr[72] = -t2122 * t2171
    t2173 = sin(t478)
    t2180 = t81 * t2001
    t2195 = 3/8 * t295 * t286 * t69 * t524 * t1965 - 3/16 * t312 * t306 * t292 * t105 * t108 * t2180 * t745 * t1970 * t155 + 3/8 * t329 * t511 * t375 * t2001 * t508 * t155
    contr[73] = t2195 * t2173
    t2196 = sin(t517)
    t2198 = t97 * t533
    t2200 = 2 * t2198 * t1236
    t2201 = t524 * IMx
    t2202 = t76 * t2201
    t2203 = t2200 + t2202
    t2216 = 2 * t2198 * t1273
    t2217 = t434 * t2201
    contr[74] = (3/4 * t381 * t75 * t2203 * t1925 * cdelta * t70 - 3/8 * t427 * t421 * t2203 * t3 * t508 * t106 + 3/8 * t447 * t544 * (t2216 + t2217) * t102 * t131) * t2196
    t2225 = sin(t559)
    t2226 = t3 * IMx
    t2227 = t181 * t2226
    t2228 = t71 * t2227
    t2229 = 0.1e1 / t604
    t2234 = t90 * t98 * t89 * t87
    t2239 = t2035 * t2023 * t2226
    t2250 = t98 * t597
    t2255 = t602 * t2226
    t2258 = t580 * t567 * t152 * t2255
    t2259 = t604 ^ 2
    t2261 = 0.1e1 / t2259 * t81
    contr[75] = (-3/4 * t2234 * t572 * t2229 * t81 * t2228 - 3/8 * t312 * t117 * t10 * t584 * t108 * t2229 * t2239 + 3/4 * t123 * t2250 * t585 * t2229 * t593 * t592 * t2227 - 3/8 * t829 * t89 * t611 * t2261 * t2258 - 3/8 * t617 * t98 * t611 * t2261 * t2258) * t2225
    t2273 = sin(t622)
    t2275 = muM * (-t2200 + t2202)
    contr[76] = (-3/4 * t381 * t372 * t10 * cdelta * t69 * t2275 + 3/8 * t427 * t544 * t1441 * t2275 - 3/8 * t447 * t544 * t1470 * muM * (-t2216 + t2217)) * t2273
    t2293 = sin(t642)
    t2294 = 0.1e1 / t670
    t2317 = muM * t645 * t67 * t712 * t2255
    t2318 = t670 ^ 2
    t2320 = 0.1e1 / t2318 * t81
    contr[77] = (3/4 * t2234 * t650 * t2294 * t81 * t2228 - 3/8 * t312 * t117 * t10 * t656 * t108 * t2294 * t2239 - 3/4 * t123 * t2250 * t657 * t2294 * t593 * t592 * t2227 + 3/8 * t829 * t89 * t678 * t2320 * t2317 - 3/8 * t617 * t98 * t678 * t2320 * t2317) * t2293
    t2332 = sin(t688)
    contr[78] = -t2195 * t2332
    t2334 = sin(t691)
    t2336 = t695 * t1985 * t1906
    t2339 = q * sdelta
    t2341 = t88 * t2339 * t155
    t2342 = -t697
    t2344 = 0.1e1 / t2342 * t2180
    t2347 = t108 * t105
    t2352 = t2339 * t155
    t2358 = t2342 ^ 2
    t2359 = 0.1e1 / t2358
    t2363 = t108 * t8
    t2377 = 3/8 * t705 * t2336 - 3/8 * t312 * t719 * t2347 * t2344 * t712 * t2341 + 3/8 * t729 * t2344 * t1101 * t2352 + 3/8 * t328 * t740 * t2363 * t2359 * t81 * t732 * t2007 * t182 + 3/16 * t214 * t750 * t8 * t2359 * t81 * t732 * t2001 * t712 * t2352
    contr[79] = t2377 * t2334
    t2378 = sin(t756)
    contr[80] = -t2377 * t2378
    t2380 = sin(t759)
    t2382 = 2 * t2198 * t1668
    t2383 = t645 * t2201
    t2384 = t2382 + t2383
    t2385 = t2384 * t152
    t2400 = 2 * t2198 * t1689
    t2401 = t817 * t2201
    t2405 = t887 * t102 * (t2400 + t2401) * t761
    contr[81] = (-3/8 * t782 * t773 * t335 * t2385 + 3/16 * t793 * t789 * muM * t2384 * t579 + 3/8 * t803 * t799 * t70 * t2385 - 3/16 * t830 * t2405 + 3/16 * t835 * t2405) * t2380
    t2411 = sin(t839)
    t2413 = 2 * t2198 * t1740
    t2414 = t567 * t2201
    t2415 = t2413 + t2414
    t2431 = t877 * IMy
    t2433 = 2 * t2198 * t2431
    t2434 = t880 * t2201
    t2438 = t887 * t257 * t152 * (t2433 + t2434)
    contr[82] = (-3/8 * t853 * t773 * t10 * t2415 * t761 - 3/16 * t861 * t789 * t2415 * muM * t579 + 3/8 * t870 * t866 * t69 * t2415 * t761 - 3/16 * t893 * t2438 - 3/16 * t898 * t2438) * t2411
    t2444 = sin(t902)
    t2445 = -t2413 + t2414
    t2464 = t887 * t102 * (-t2433 + t2434) * t761
    contr[83] = (3/8 * t853 * t773 * t2445 * t10 * t761 + 3/16 * t861 * t789 * t2445 * muM * t579 - 3/8 * t870 * t866 * t69 * t2445 * t761 + 3/16 * t893 * t2464 + 3/16 * t898 * t2464) * t2444
    t2470 = sin(t929)
    t2471 = -t2382 + t2383
    t2490 = t887 * t257 * (-t2400 + t2401) * t152
    contr[84] = (3/8 * t782 * t773 * t10 * t2471 * t761 - 3/16 * t793 * t789 * t2471 * muM * t579 - 3/8 * t803 * t799 * t69 * t2471 * t761 + 3/16 * t830 * t2490 - 3/16 * t835 * t2490) * t2470
    t2496 = sin(t956)
    t2503 = t52 * (-t958 - t346) - t31 * t1239 - t41 * t343
    t2512 = 2 * t43
    t2519 = t401 + 2 * t54 * t21 * (t43 - t56 - t2067) + 2 * t54 * t21 * (-t2512 - t1247 + t2067) - (t34 + t48) * t237
    t2525 = t152 * t198
    contr[85] = (-3/16 * t178 * t968 * t2503 * t153 + 3/16 * t195 * t1912 * t2096 * t2519 * t152 + 3/32 * t215 * t1918 * t265 * t2519 * t2525) * t2496
    t2532 = sin(t985)
    t2533 = t242 * t152
    t2534 = t10 * t2533
    t2541 = t52 * (t958 + t987 - t346) + t1417 + (6 * t338 - 2 * t341) * t41
    t2542 = t2541 * t69
    t2543 = t2542 * t155
    t2558 = t401 + 2 * t54 * t21 * (t43 + t56 - t2067) + 2 * t54 * t21 * (t2512 - t1247 - t2067) + (t34 - t48) * t237
    t2560 = t172 * t2558 * t69
    t2566 = t8 * t2558 * t257
    contr[86] = (-3/16 * t178 * t2543 * t2534 + 3/16 * t195 * t2560 * t155 * t2533 + 3/32 * t215 * t2566 * t2081 * t2525) * t2532
    t2571 = sin(t1018)
    t2574 = t1021 * t2180
    t2602 = -3/8 * t1027 * t2336 + 3/8 * t312 * t1034 * t2347 * t2574 * t712 * t2341 + 3/8 * t1044 * t2574 * t1101 * t2352 - 3/8 * t328 * t1056 * t2363 * t1054 * t81 * t1048 * t2007 * t182 + 3/16 * t214 * t1066 * t8 * t1054 * t81 * t1048 * t2001 * t712 * t2352
    contr[87] = t2602 * t2571
    t2603 = sin(t1072)
    t2614 = t2519 * t242
    contr[88] = (3/16 * t178 * t70 * IMz * t2503 * t2534 - 3/16 * t195 * t1912 * IMz * t2519 * t2533 - 3/32 * t215 * t1918 * t2614 * t2525) * t2603
    t2620 = sin(t1084)
    t2625 = t265 * t152
    contr[89] = (3/16 * t178 * t2543 * t265 * t153 - 3/16 * t195 * t2560 * t155 * t2625 - 3/32 * t215 * t2566 * t2096 * t2525) * t2620
    t2635 = sin(t1096)
    contr[90] = -t2602 * t2635
    t2637 = sin(t1099)
    t2638 = t1101 * t2108
    t2639 = t1104 * t2638
    t2645 = t1111 * t152 * t2075 * t105 * t708
    t2652 = t732 * t2075 * t316
    contr[91] = (-3/8 * t705 * t2639 - 3/8 * t721 * t2645 + 3/8 * t729 * t1115 * t2638 - 3/8 * t742 * t1124 * t2652 - 3/16 * t752 * t1129 * t2652) * t2637
    t2660 = sin(t1134)
    t2661 = t2124 * t1740
    t2662 = t356 * IMx
    t2663 = t567 * t2662
    t2670 = t2133 * t1740
    t2671 = t403 * IMx
    t2672 = t567 * t2671
    t2674 = (t2670 + t2672) * t3
    t2683 = t2133 * t2431
    t2684 = t880 * t2671
    t2688 = t511 * (t2683 + t2684) * t3 * t1200
    contr[92] = (-3/8 * t853 * t81 * (t2661 + t2663) * t771 * t1705 - 3/16 * t861 * t1155 * t2674 * t1200 + 3/8 * t870 * t865 * t2674 * t1721 - 3/16 * t893 * t2688 - 3/16 * t898 * t2688) * t2660
    t2694 = sin(t1176)
    t2695 = t2124 * t1668
    t2696 = t645 * t2662
    t2703 = t2133 * t1668
    t2704 = t645 * t2671
    t2706 = t3 * (t2703 - t2704)
    t2715 = t2133 * t1689
    t2716 = t817 * t2671
    t2720 = t1169 * t242 * (t2715 - t2716) * t761
    contr[93] = (-3/8 * t782 * t1143 * (t2695 - t2696) * t69 * t1705 + 3/16 * t793 * t1155 * t2706 * t1200 + 3/8 * t803 * t798 * t2706 * t1721 - 3/16 * t830 * t2720 + 3/16 * t835 * t2720) * t2694
    t2726 = sin(t1213)
    t2732 = t242 * t2075
    t2737 = t712 * t316
    contr[94] = (3/8 * t1027 * t2639 - 3/8 * t1036 * t2645 - 3/8 * t1044 * t1039 * t2732 * t694 * t248 + 3/8 * t1058 * t1123 * t2075 * t1048 * t2737 - 3/16 * t1068 * muM * t2732 * t1061 * t2737) * t2726
    t2749 = sin(t1234)
    t2750 = IMy * t1259
    t2751 = t358 * t2750
    t2752 = t1244 * t527
    t2753 = t2751 - t2752
    t2764 = t432 * t2750
    t2765 = t1244 * t549
    contr[95] = (-3/8 * t381 * t372 * sdelta * t2753 * t336 + 3/16 * t427 * t1269 * t2753 * t102 * t106 - 3/16 * t447 * t1269 * (t2764 - t2765) * t102 * t131) * t2749
    t2773 = sin(t1283)
    t2774 = t2751 + t2752
    t2777 = t372 * t285
    contr[96] = (-3/8 * t381 * t2777 * muM * t10 * t2774 + 3/16 * t427 * t1269 * t1441 * muM * t2774 - 3/16 * t447 * t1269 * t1470 * (t2764 + t2765) * muM) * t2773
    t2793 = sin(t1304)
    t2794 = t1101 * t2096
    t2795 = t2075 * q
    t2797 = t335 * t2795 * t2794
    t2804 = t81 * muM * t2075
    t2806 = t2804 * t745 * t152 * t265 * t105 * t708
    t2814 = t265 * t732 * t316
    t2819 = muM * t2795
    contr[97] = (-3/8 * t705 * t2797 - 3/8 * t721 * t2806 + 3/8 * t729 * t724 * t2795 * t2794 - 3/8 * t742 * t2804 * t712 * t2814 - 3/16 * t752 * t2819 * t712 * t2814) * t2793
    t2825 = sin(t1333)
    t2834 = t265 * (t2670 - t2672) * t761
    t2844 = t511 * (t2683 - t2684) * t3 * t1370
    contr[98] = (3/8 * t853 * t1675 * t265 * (t2661 - t2663) * t761 + 3/16 * t861 * t1156 * t2834 - 3/8 * t870 * t1160 * t2834 + 3/16 * t893 * t2844 + 3/16 * t898 * t2844) * t2825
    t2850 = sin(t1360)
    t2859 = (t2703 + t2704) * t265 * t761
    t2869 = t1169 * t265 * (t2715 + t2716) * t761
    contr[99] = (3/8 * t782 * t1675 * (t2695 + t2696) * t265 * t761 - 3/16 * t793 * t1156 * t2859 - 3/8 * t803 * t1196 * t2859 + 3/16 * t830 * t2869 - 3/16 * t835 * t2869) * t2850
    t2875 = sin(t1391)
    t2884 = t2625 * t316
    contr[100] = (3/8 * t1027 * t2797 - 3/8 * t1036 * t2806 - 3/8 * t1044 * t1039 * t2795 * t2794 + 3/8 * t1058 * t2804 * t2056 * t2884 - 3/16 * t1068 * t2819 * t2056 * t2884) * t2875
    t2894 = sin(t1412)
    t2895 = IMy * t1433
    t2896 = t358 * t2895
    t2897 = t1423 * IMx
    t2898 = t76 * t2897
    t2899 = t2896 - t2898
    t2910 = t432 * t2895
    t2911 = t434 * t2897
    contr[101] = (3/8 * t381 * t2777 * muM * t10 * t2899 - 3/16 * t427 * t1269 * t1441 * muM * t2899 + 3/16 * t447 * t1269 * t1470 * (t2910 - t2911) * muM) * t2894
    t2919 = sin(t1455)
    t2920 = t2896 + t2898
    contr[102] = (3/8 * t381 * t2777 * t2920 * t335 - 3/16 * t427 * t1269 * t1441 * t2920 * muM + 3/16 * t447 * t1269 * t1470 * (t2910 + t2911) * muM) * t2919
    t2937 = sin(t1476)
    t2938 = t10 * t1906
    t2945 = t2519 * q
    t2946 = t81 * t106
    t2947 = t2946 * t2945
    t2953 = t81 * t131
    t2954 = t2953 * t2519 * t102
    t2958 = -3/16 * t295 * muM * t2503 * t694 * t2938 + 3/32 * t313 * t2947 * t301 * t1906 - 3/16 * t329 * t2954 * t318 * t1906
    contr[103] = t2958 * t2937
    t2959 = sin(t1493)
    t2966 = t2946 * t745
    t2976 = -3/16 * t295 * t286 * t2542 * t2938 + 3/32 * t313 * t2966 * t2558 * t88 * t1906 - 3/16 * t329 * t2953 * t130 * t76 * t2558 * t1906
    contr[104] = t2976 * t2959
    t2977 = sin(t1510)
    contr[105] = -t2958 * t2977
    t2979 = sin(t1513)
    contr[106] = -t2976 * t2979
    t2981 = sin(t1516)
    t2983 = t335 * t2503 * q
    t2984 = t2983 * t2794
    t2989 = t2947 * t102 * t2625 * t708
    t2992 = t1039 * t2945
    t2996 = t712 * t2096
    t2998 = t2953 * t2519 * t1048
    t3003 = t8 * muM * t2519
    t3004 = t3003 * t1061
    contr[107] = (-3/16 * t1027 * t2984 + 3/16 * t1036 * t2989 + 3/16 * t1044 * t2992 * t2794 - 3/16 * t1058 * t2998 * t2996 + 3/32 * t1068 * t3004 * t2996) * t2981
    t3009 = sin(t1539)
    t3010 = t1000 * t248
    t3011 = t2983 * t3010
    t3016 = t2947 * t242 * t712 * t708
    t3022 = t1012 * t248
    contr[108] = (3/16 * t1027 * t3011 - 3/16 * t1036 * t3016 - 3/16 * t1044 * t2992 * t3010 + 3/16 * t1058 * t2998 * t3022 - 3/32 * t1068 * t3004 * t3022) * t3009
    t3030 = sin(t1557)
    t3035 = t724 * t2945
    t3039 = t2625 * t1119
    contr[109] = (3/16 * t705 * t2984 + 3/16 * t721 * t2989 - 3/16 * t729 * t3035 * t2794 + 3/16 * t742 * t2954 * t3039 + 3/32 * t752 * t3003 * t745 * t3039) * t3030
    t3048 = sin(t1576)
    t3056 = t712 * t1119
    contr[110] = (-3/16 * t705 * t3011 - 3/16 * t721 * t3016 + 3/16 * t729 * t3035 * t3010 - 3/16 * t742 * t2953 * t2614 * t3056 - 3/32 * t752 * t3003 * t1103 * t3056) * t3048
    t3066 = sin(t1592)
    t3069 = t1104 * t1101 * t2541 * IMz
    t3072 = t152 * t2558
    t3076 = t2946 * t1103 * t102 * t3072 * t708
    t3079 = t2558 * IMz
    t3080 = t1101 * t3079
    t3084 = t712 * t3079
    t3085 = t1048 * t242
    t3090 = t8 * t286
    contr[111] = (-3/16 * t1027 * t3069 + 3/16 * t1036 * t3076 + 3/16 * t1044 * t1219 * t3080 - 3/16 * t1058 * t2953 * t3085 * t3084 + 3/32 * t1068 * t3090 * t3085 * t3084) * t3066
    t3096 = sin(t1615)
    t3104 = t3072 * t1119
    contr[112] = (3/16 * t705 * t3069 + 3/16 * t721 * t3076 - 3/16 * t729 * t1115 * t3080 + 3/16 * t742 * t2953 * t1012 * t3104 + 3/32 * t752 * t3090 * t1012 * t3104) * t3096
    t3114 = sin(t1632)
    t3117 = t695 * t152 * t2541 * t2096
    t3120 = t2558 * t265
    t3123 = t2966 * t152 * t3120 * t708
    t3126 = t3072 * t2096
    t3130 = t3120 * t1119
    contr[113] = (-3/16 * t705 * t3117 - 3/16 * t721 * t3123 + 3/16 * t729 * t725 * t3126 - 3/16 * t742 * t2953 * t712 * t3130 - 3/32 * t752 * t3090 * t712 * t3130) * t3114
    t3140 = sin(t1650)
    contr[114] = (3/16 * t1027 * t3117 - 3/16 * t1036 * t3123 - 3/16 * t1044 * t1040 * t3126 + 3/16 * t1058 * t2953 * t2056 * t3126 - 3/32 * t1068 * t3090 * t2056 * t3126) * t3140
    t3157 = sin(t1666)
    t3158 = t97 * t670
    t3159 = t3158 * t2750
    t3160 = t1244 * t765
    t3161 = t3159 - t3160
    t3163 = t265 * t3161 * t761
    t3176 = t763 * t1259 * t813
    t3177 = t1244 * t1691
    t3181 = t1169 * t1311 * (t3176 - t3177) * t152
    contr[115] = (-3/16 * t782 * t1675 * t3163 + 3/32 * t793 * t1682 * t3161 * muM * t579 + 3/16 * t803 * t1196 * t3163 - 3/32 * t830 * t3181 + 3/32 * t835 * t3181) * t3157
    t3187 = sin(t1702)
    t3188 = t3158 * t2895
    t3189 = t1423 * t765
    t3190 = t3188 - t3189
    t3192 = muM * t3190 * t2533
    t3206 = t763 * t1433 * t813
    t3207 = t1423 * t1691
    t3211 = t1169 * (t3206 - t3207) * muM * t2533
    contr[116] = (3/16 * t782 * t1675 * t3192 - 3/32 * t793 * t1681 * t257 * t3190 * t242 * t579 - 3/16 * t803 * t1196 * t3192 + 3/32 * t830 * t3211 - 3/32 * t835 * t3211) * t3187
    t3217 = sin(t1738)
    t3218 = t97 * t604
    t3219 = t3218 * t2750
    t3221 = t567 * t1244 * IMx
    t3222 = t3219 - t3221
    t3224 = t3222 * muM * t2533
    t3237 = t763 * t1259 * t877
    t3238 = t1244 * t881
    t3242 = t1169 * (t3237 - t3238) * muM * t2533
    contr[117] = (-3/16 * t853 * t1675 * t3224 - 3/32 * t861 * t1681 * t102 * t3222 * t1715 + 3/16 * t870 * t1160 * t3224 - 3/32 * t893 * t3242 - 3/32 * t898 * t3242) * t3217
    t3248 = sin(t1771)
    t3249 = t3218 * t2895
    t3250 = t567 * t2897
    t3251 = t3249 - t3250
    t3268 = t763 * t877 * t1433
    t3269 = t1423 * t881
    t3273 = t1169 * t1311 * (t3268 - t3269) * t152
    contr[118] = (3/16 * t853 * t1143 * t3251 * t69 * t1363 + 3/32 * t861 * t1681 * t3251 * t102 * t1884 - 3/16 * t870 * t865 * t3 * t3251 * t1377 + 3/32 * t893 * t3273 + 3/32 * t898 * t3273) * t3248
    t3279 = sin(t1800)
    t3280 = t3219 + t3221
    t3299 = t511 * t3 * (t3237 + t3238) * t1370
    contr[119] = (-3/16 * t853 * t1143 * t3280 * t69 * t1363 - 3/32 * t861 * t1681 * t3280 * t102 * t1884 + 3/16 * t870 * t865 * t3 * t3280 * t1377 - 3/32 * t893 * t3299 - 3/32 * t898 * t3299) * t3279
    t3305 = sin(t1825)
    t3306 = t3249 + t3250
    t3308 = t3306 * muM * t2533
    t3323 = t1169 * (t3268 + t3269) * muM * t2533
    contr[120] = (3/16 * t853 * t1675 * t3308 + 3/32 * t861 * t1681 * t102 * t3306 * t1715 - 3/16 * t870 * t1160 * t3308 + 3/32 * t893 * t3323 + 3/32 * t898 * t3323) * t3305
    t3329 = sin(t1851)
    t3330 = t3159 + t3160
    t3332 = t3330 * muM * t2533
    t3347 = t1169 * (t3176 + t3177) * muM * t2533
    contr[121] = (-3/16 * t782 * t1675 * t3332 + 3/32 * t793 * t1681 * t102 * t3330 * t1715 + 3/16 * t803 * t1196 * t3332 - 3/32 * t830 * t3347 + 3/32 * t835 * t3347) * t3329
    t3353 = sin(t1876)
    t3354 = t3188 + t3189
    t3356 = t1311 * t3354 * t152
    t3371 = t511 * (t3206 + t3207) * t3 * t1370
    contr[122] = (3/16 * t782 * t1675 * t3356 - 3/32 * t793 * t1682 * muM * t3354 * t579 - 3/16 * t803 * t1196 * t3356 + 3/32 * t830 * t3371 - 3/32 * t835 * t3371) * t3353

     der_Jl = sum(contr);
    return der_Jl;

end

function derivativechiM2_JgP1(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)

    contr = zeros(122);
    t1 = cos(psil)
    t3 = sqrt(1 + k)
    t4 = t3 * IMy
    t5 = sqrt(q)
    t6 = t5 * cdelta
    t7 = t6 * t4
    t8 = -1 + m
    t11 = k + m
    t13 = KK * t8 * k + EE * t11
    t14 = Q1 ^ 2
    t15 = Q2 ^ 2
    t16 = t14 + t15 + 1
    t17 = t16 ^ 2
    t18 = 1 / t17
    t19 = t14 * t18
    t24 = 1 / t16
    t25 = Q1 * t24
    t28 = Q2 * t24
    t34 = -2 * cpa1EQ * t25 + 2 * cpa2EQ * t28 + cpa3EQ * (-t14 - t15 + 1) * t24
    t36 = -t14 + t15 + 1
    t37 = t36 * t24
    t38 = cpa1EQ * t37
    t40 = Q2 * cpa2EQ * t25
    t42 = cpa3EQ * t25
    t44 = t38 + 2 * t40 + 2 * t42
    t45 = t24 * t44
    t46 = t36 * t45
    t48 = Q2 * cpa1EQ * t25
    t50 = t14 - t15 + 1
    t51 = t50 * t24
    t52 = cpa2EQ * t51
    t53 = cpa3EQ * t28
    t55 = 2 * t48 + t52 - 2 * t53
    t56 = t24 * t55
    t57 = Q1 * Q2
    t58 = t57 * t56
    t59 = 2 * t58
    t60 = t46 + t59
    t63 = 2 * Q1 * t24 * t60
    t64 = t57 * t45
    t65 = 2 * t64
    t66 = t50 * t56
    t67 = t65 + t66
    t70 = t34 * (4 * t19 + 4 * t15 * t18 - 2/3) - t63 + 2 * t67 * t28
    t72 = sqrt(t11)
    t73 = 0.1e1 / t72
    t74 = t73 * pi
    t78 = KK ^ 2
    t80 = 1 / t78 / KK
    t81 = q - 1
    t82 = 0.1e1 / t81
    t84 = rc ^ 2
    t86 = 0.1e1 / t84 / rc
    t87 = 0.1e1 / npsil
    t88 = t87 * t86
    t90 = 1 / m
    t91 = 1 / t8
    t92 = t91 * t90
    t95 = -m * KK + PP * t11
    t96 = 1 / k
    t98 = 0.1e1 / Jg
    t100 = t98 * t96 * t95 * t92
    t105 = t70 * t5
    t107 = pi ^ 2
    t108 = muM * t107
    t109 = t78 ^ 2
    t110 = 1 / t109
    t114 = npsil ^ 2
    t115 = 0.1e1 / t114
    t116 = t115 * t86
    t117 = sqrt(k)
    t118 = 0.1e1 / t117
    t122 = EE * KK * m
    t123 = -PP * t13 + t122
    t124 = t123 * t118
    t126 = -C + A
    t129 = 1 / C * t90
    t130 = 0.1e1 / A
    t132 = t130 * t129 * t91 * t126
    t136 = 1 + q
    t138 = t72 * t107
    t139 = muM * t138
    t142 = t81 ^ 2
    t150 = KK * (-KP + EP) + EE * KP
    t153 = t98 * t96 * t91
    t154 = t153 * t90 * t150
    t164 = 1 / KK
    t165 = t164 * muM
    t167 = t98 * cdelta
    t168 = t167 * t88
    contr[1] = (-3 * t100 * t88 * t82 * t80 * muM * t74 * t70 * t13 * t7 - 3/2 * t132 * t124 * t116 * t82 * t110 * t108 * t105 * IMy * cdelta - 3/2 * t154 * t95 * t88 / t142 * t110 * t139 * t136 * t70 * t7) * t1 + 3 * t168 * t82 * t165 * t74 * t105 * t3 * IMy * t1
    t172 = 2 * TL
    t173 = -psig + t172
    t174 = cos(t173)
    t175 = exp(sigma)
    t176 = t175 * t13
    t177 = t118 * sdelta
    t179 = IMz * t73
    t180 = t24 * t34
    t181 = Q2 * t180
    t186 = t60 * t28
    t188 = -2 * Q1 * t24 * (t65 + t66 + 4 * t181) + 2 * t186
    t189 = t188 * muM
    t192 = t86 * pi
    t194 = exp(2 * sigma)
    t195 = t194 - 1
    t196 = 0.1e1 / t195
    t197 = t80 * t196
    t199 = 0.1e1 / npsig
    t201 = t95 * t91
    t202 = t98 * t201
    t203 = t202 * t90 * t199
    t204 = t203 * t197 * t192
    t207 = sdelta * t175
    t208 = t73 * t118
    t210 = IMz * muM
    t215 = npsig ^ 2
    t217 = 1 / t215 * t110
    t220 = PP ^ 2
    t235 = -t220 * t126 * t13 * t11 + 2 * PP * t126 * t11 * t122 + m * t78 * (KK * t8 * A * k - t126 * EE * m)
    t237 = t91 * t129
    t238 = t237 * t130 * t235
    t239 = t238 * t217 * t196 * t86
    t242 = t72 * t118
    t244 = 1 + t194
    t245 = IMz * t244
    t249 = t195 ^ 2
    t257 = (EE - KK) * FA + KK * EA
    t260 = t91 * t98 * t90
    t261 = t260 * t257 * t95
    t262 = t261 * t199 * t110 / t249 * t86
    t265 = -3/4 * t204 * t189 * t179 * t177 * t176 + 3/4 * t239 * pi * t188 * t210 * t208 * t207 + 3/8 * t262 * t107 * t189 * t245 * t242 * t207
    contr[2] = t265 * t174
    t266 = psig + t172
    t267 = cos(t266)
    contr[3] = -t265 * t267
    t269 = -psih + psig
    t270 = cos(t269)
    t272 = t36 ^ 2
    t273 = t272 * t18
    t274 = t15 * t19
    t275 = 4 * t274
    t277 = t44 * (t273 + t275 - 2/3)
    t278 = Q1 * t180
    t282 = t36 * t24 * (2 * t58 - 2 * t278)
    t283 = 2 * t181
    t284 = t66 + t283
    t287 = 2 * t284 * Q2 * t25
    t288 = t277 + t282 + t287
    t289 = t288 * pi
    t291 = t289 * t210 * t208 * t176
    t292 = cdelta - 1
    t295 = t203 * t197 * t86 * t292
    t298 = t118 * t175
    t299 = t179 * t298
    t300 = muM * pi
    t306 = t244 * t72
    t307 = t306 * t298
    t308 = t288 * t107
    t318 = t300 * t179
    t323 = t167 * t199 * t164
    t324 = t323 * t196 * t86 * t288
    contr[4] = (3/4 * t295 * t291 - 3/4 * t239 * t292 * t288 * t300 * t299 - 3/8 * t262 * t292 * t308 * t210 * t307) * t270 - 3/4 * t324 * t318 * t117 * t175 * t270
    t327 = psih + psig
    t328 = cos(t327)
    t329 = cdelta + 1
    t332 = t203 * t197 * t86 * t329
    contr[5] = (-3/4 * t332 * t291 + 3/4 * t239 * t329 * t288 * t300 * t299 + 3/8 * t262 * t329 * t308 * t210 * t307) * t328 + 3/4 * t324 * t318 * t117 * t175 * t328
    t352 = 2 * psil
    t353 = psih - t352
    t354 = cos(t353)
    t357 = pi * q
    t358 = t357 * t177
    t360 = t86 * muM
    t361 = q ^ 2
    t362 = t361 + 1
    t363 = 0.1e1 / t362
    t368 = t202 * t90 * t87 * t363 * t80 * t360
    t371 = t288 * IMz
    t372 = t107 * sdelta
    t374 = q * muM
    t375 = t110 * t86
    t376 = t375 * t374
    t379 = 0.1e1 / t3
    t380 = t379 * t123
    t382 = t132 * t380 * t115 * t363
    t385 = t72 * IMz
    t388 = t81 * t118
    t389 = t107 * t136
    t391 = muM * t389 * t388
    t393 = t362 ^ 2
    t394 = 0.1e1 / t393
    t399 = t260 * q * t150
    t400 = t399 * t95 * t87 * t394 * t375
    t403 = 3/4 * t368 * t358 * t13 * t288 * t179 + 3/8 * t382 * t376 * t372 * t371 + 3/4 * t400 * t391 * sdelta * t288 * t385
    contr[6] = t403 * t354
    t404 = psih - psil
    t405 = cos(t404)
    t406 = t13 * muM
    t407 = t74 * t406
    t408 = t36 * t18
    t409 = t57 * t408
    t410 = Q1 * t18
    t411 = t50 * Q2
    t412 = t411 * t410
    t414 = 2 * t409 + 2 * t412
    t415 = t44 * t414
    t416 = t50 ^ 2
    t417 = t416 * t18
    t419 = t55 * (t275 + t417 - 2/3)
    t420 = Q2 * t19
    t423 = Q2 * t50 * t18
    t424 = 2 * t423
    t427 = t415 + t419 + (-4 * t420 + t424) * t34
    t429 = t3 * t136
    t430 = t429 * IMy * t427
    t431 = t414 * t55
    t432 = Q1 * t408
    t433 = 2 * t432
    t434 = t15 * t410
    t438 = t277 + t431 + (-t433 + 4 * t434) * t34
    t440 = t81 * t438 * IMx
    t443 = t80 * t5
    t446 = t361 - 1
    t447 = 0.1e1 / t446
    t450 = t98 * t96
    t452 = t450 * t201 * t90 * t447 * t88
    t463 = 2 * t44 * t411 * t410
    t464 = t18 * t34
    t465 = Q2 * t14
    t471 = t55 * t15 * t19
    t472 = 4 * t471
    t473 = t55 * t417
    t474 = -4/3 * t48 - 2/3 * t52 + 4/3 * t53 + 2 * t44 * t57 * t408 + t463 - 4 * t465 * t464 + 2 * t411 * t464 + t472 + t473
    t475 = IMy * t474
    t476 = t429 * t475
    t477 = t18 * t44
    t478 = t272 * t477
    t481 = 4 * t15 * t14 * t477
    t485 = t478 + t282 + t481 + t287 - 2/3 * t38 - 4/3 * t40 - 4/3 * t42
    t486 = t485 * IMx
    t487 = t81 * t486
    t492 = t116 * t110 * t5
    t496 = t132 * t380 * t118 * t447
    t499 = t136 ^ 2
    t500 = t499 * t136
    t501 = t3 * t500
    t502 = t501 * t475
    t503 = t142 * t81
    t504 = t503 * t486
    t508 = t72 * t5
    t509 = t375 * t508
    t511 = t446 ^ 2
    t517 = t450 * t92 * t150 * t95 / t511 * t87
    contr[7] = (3/2 * t452 * t443 * (t430 + t440) * sdelta * t407 + 3/4 * t496 * t492 * (t476 + t487) * sdelta * t108 + 3/4 * t517 * t509 * t372 * (t502 + t504) * muM) * t405
    t521 = psih + psil
    t522 = cos(t521)
    t523 = t5 * sdelta
    contr[8] = (-3/2 * t452 * t80 * (-t430 + t440) * t523 * t407 - 3/4 * t496 * t116 * t110 * (-t476 + t487) * t523 * t108 - 3/4 * t517 * t509 * t372 * muM * (-t502 + t504)) * t522
    t544 = psih + t352
    t545 = cos(t544)
    contr[9] = -t403 * t545
    t548 = -2 * psil + 2 * TL
    t549 = cos(t548)
    t552 = t118 * cdelta
    t557 = t188 * IMz
    t558 = t107 * cdelta
    t568 = t18 * t55
    t569 = t15 * Q1
    t581 = t86 * t72 * t446
    t585 = t95 * t87
    t587 = t399 * t585 * t394 * t110
    t590 = 3/4 * t368 * t357 * t552 * t13 * t188 * t179 + 3/8 * t382 * t376 * t558 * t557 + 3/4 * t587 * t581 * t108 * t552 * (-2 * t50 * Q1 * t568 + 2 * Q2 * t36 * t477 - 8 * t57 * t464 - 4 * t465 * t477 + 4 * t569 * t568) * IMz
    t592 = t188 * t73
    t596 = t117 * muM * IMz * q
    t598 = pi * cdelta
    t603 = t98 * t87 * t363 * t164 * t86 * t598
    contr[10] = t590 * t549 - 3/4 * t603 * t596 * t549 * t592
    t606 = -psil + t172
    t607 = cos(t606)
    t609 = 4 * t14 * t464
    t613 = t609 - t63 - 2 * (t65 + t66 + t283) * t28
    t614 = IMy * t613
    t615 = t429 * t614
    t616 = t81 * IMx
    t622 = -2 * Q1 * t24 * (t283 + t64 + t66 / 2) + t186
    t624 = 2 * t622 * t616
    t626 = cdelta * (t615 - t624)
    t635 = t72 * muM
    t636 = t501 * t614
    t637 = t503 * IMx
    t639 = 2 * t622 * t637
    t643 = t375 * t6
    t651 = t81 * IMx * t188
    t655 = muM * cdelta * t73
    t661 = t98 * t447 * t87 * t86 * t164 * pi
    contr[11] = (-3/2 * t452 * t443 * t626 * t407 - 3/4 * t496 * t492 * t626 * t108 - 3/4 * t517 * t643 * (t636 - t639) * t107 * t635) * t607 + 3/2 * t661 * t655 * (t615 - t651) * t5 * t607
    t664 = -psil + psig
    t665 = cos(t664)
    t666 = t5 * IMy
    t669 = t73 * sdelta
    t670 = t70 * t175
    t673 = pi * t670 * t669 * t13 * t3 * t666
    t674 = t194 + q
    t675 = 0.1e1 / t674
    t677 = -npsil + npsig
    t678 = 0.1e1 / t677
    t684 = t207 * t666
    t685 = t107 * t70
    t689 = t677 ^ 2
    t690 = 0.1e1 / t689
    t691 = t690 * t110
    t696 = sdelta * t3
    t698 = t175 * t73
    t702 = muM * pi * t70 * t698 * t696 * t666
    t707 = t237 * t130 * t96
    t712 = t72 * t696 * t666
    t713 = q - t194
    t715 = muM * t685
    t717 = t715 * t713 * t175 * t712
    t718 = t674 ^ 2
    t721 = t678 * t110
    t722 = t95 * t721
    t723 = t722 / t718 * t86
    t728 = t153 * t90 * t257
    contr[12] = (3/2 * t100 * t678 * t80 * t675 * t360 * t673 - 3/4 * t132 * t124 * t691 * t675 * t360 * t685 * t684 - 3/2 * t707 * t235 * t691 * t675 * t86 * t702 + 3/4 * t154 * t723 * t717 + 3/4 * t728 * t723 * t717) * t665
    t733 = psil + t172
    t734 = cos(t733)
    t735 = t615 + t624
    contr[13] = (-3/2 * t452 * t443 * t598 * t735 * t73 * t406 - 3/4 * t496 * t492 * t558 * t735 * muM - 3/4 * t517 * t643 * t107 * (t636 + t639) * t635) * t734 + 3/2 * t661 * t655 * (t615 + t651) * t5 * t734
    t761 = psil + psig
    t762 = cos(t761)
    t763 = q * t194
    t764 = 1 + t763
    t765 = 0.1e1 / t764
    t767 = npsil + npsig
    t768 = 0.1e1 / t767
    t777 = t767 ^ 2
    t778 = 0.1e1 / t777
    t779 = t778 * t110
    t790 = t763 - 1
    t794 = muM * t790 * t107 * t670 * t712
    t795 = t764 ^ 2
    t798 = t768 * t110
    t799 = t95 * t798
    t800 = t799 / t795 * t86
    contr[14] = (3/2 * t100 * t768 * t80 * t765 * t360 * t673 + 3/4 * t132 * t124 * t779 * t765 * t360 * t685 * t684 - 3/2 * t707 * t235 * t779 * t765 * t86 * t702 + 3/4 * t154 * t800 * t794 - 3/4 * t728 * t800 * t794) * t762
    t809 = 2 * psil + 2 * TL
    t810 = cos(t809)
    contr[15] = -t590 * t810 + 3/4 * t603 * t596 * t810 * t592
    t817 = t172 - psig + t352
    t818 = cos(t817)
    t819 = t118 * IMz
    t821 = muM * t357
    t823 = t821 * t207 * t592 * t819
    t824 = t86 * t13
    t825 = t361 - t194
    t826 = 0.1e1 / t825
    t829 = 2 * npsil
    t830 = -t829 + npsig
    t831 = 1 / t830
    t834 = t202 * t90 * t831 * t80 * t826 * t824
    t837 = t207 * t557
    t838 = q * t107
    t839 = t826 * t360
    t840 = t839 * t838
    t842 = t830 ^ 2
    t844 = 1 / t842 * t110
    t846 = t132 * t380 * t844
    t849 = t826 * t86
    t851 = t238 * t844 * t849
    t854 = t361 + t194
    t856 = t854 * t188 * t819
    t857 = sdelta * t72
    t858 = t107 * t175
    t862 = t825 ^ 2
    t863 = 0.1e1 / t862
    t866 = t95 * t831 * t110
    t868 = t399 * t866 * t863 * t86
    t875 = t831 * t110 * t863
    t877 = t261 * t875 * t360
    t880 = 3/4 * t834 * t823 - 3/4 * t846 * t840 * t837 - 3/4 * t851 * t823 + 3/4 * t868 * muM * t858 * t857 * t856 + 3/8 * t877 * q * t858 * t857 * t856
    contr[16] = t880 * t818
    t881 = t172 + psig - t352
    t882 = cos(t881)
    contr[17] = -t880 * t882
    t884 = t172 - psil - psig
    t885 = cos(t884)
    t887 = t4 * t790 * t613
    t888 = t764 * IMx
    t890 = 2 * t622 * t888
    t891 = t887 - t890
    t893 = t891 * muM * t698
    t894 = pi * t13
    t895 = t523 * t894
    t897 = t80 * t86
    t899 = exp(4 * sigma)
    t900 = t361 * t899
    t901 = t900 - 1
    t902 = 0.1e1 / t901
    t903 = t902 * t768
    t905 = t100 * t903 * t897
    t908 = muM * t175
    t911 = t778 * t375
    t912 = t911 * t523
    t916 = t132 * t380 * t118 * t902
    t919 = t5 * pi
    t920 = t86 * sdelta
    t921 = t920 * t919
    t925 = t707 * t235 * t902 * t779
    t928 = t5 * t107
    t930 = t361 * q
    t932 = exp(6 * sigma)
    t933 = t932 * t930
    t934 = 3 * t900
    t935 = 3 * t763
    t936 = t933 - t934 + t935 - 1
    t938 = t4 * t936 * t613
    t939 = t622 * IMx
    t940 = t933 + t934 + t935 + 1
    t942 = 2 * t940 * t939
    t946 = t86 * (t938 - t942) * t857 * t928 * t908
    t947 = t901 ^ 2
    t950 = t95 / t947 * t798
    t951 = t154 * t950
    t954 = t728 * t950
    contr[18] = (3/4 * t905 * t895 * t893 + 3/8 * t916 * t912 * t107 * t891 * t908 - 3/4 * t925 * t921 * t893 + 3/8 * t951 * t946 - 3/8 * t954 * t946) * t885
    t958 = t172 - psil + psig
    t959 = cos(t958)
    t961 = t4 * t713 * t613
    t963 = 2 * t674 * t939
    t964 = t961 - t963
    t966 = muM * t964 * t698
    t968 = t361 - t899
    t969 = 0.1e1 / t968
    t970 = t969 * t678
    t972 = t100 * t970 * t897
    t977 = t690 * t375
    t978 = t977 * t523
    t982 = t132 * t380 * t118 * t969
    t988 = t707 * t235 * t969 * t691
    t991 = t361 * t194
    t992 = 3 * t991
    t994 = 3 * q * t899
    t995 = t930 - t992 + t994 - t932
    t996 = t3 * t995
    t997 = t996 * t614
    t998 = t930 + t992 + t994 + t932
    t999 = t998 * IMx
    t1001 = 2 * t622 * t999
    t1005 = t920 * t508
    t1006 = t1005 * t107 * (t997 - t1001) * t908
    t1007 = t968 ^ 2
    t1010 = t95 / t1007 * t721
    t1011 = t154 * t1010
    t1014 = t728 * t1010
    contr[19] = (3/4 * t972 * t895 * t966 - 3/8 * t982 * t978 * t108 * t964 * t175 - 3/4 * t988 * t921 * t966 + 3/8 * t1011 * t1006 + 3/8 * t1014 * t1006) * t959
    t1018 = t172 + psil - psig
    t1019 = cos(t1018)
    t1020 = t961 + t963
    t1022 = t1020 * muM * t698
    t1037 = t1005 * t107 * (t997 + t1001) * t908
    contr[20] = (3/4 * t972 * t895 * t1022 - 3/8 * t982 * t978 * t107 * t1020 * t908 - 3/4 * t988 * t921 * t1022 + 3/8 * t1011 * t1037 + 3/8 * t1014 * t1037) * t1019
    t1043 = t172 + psil + psig
    t1044 = cos(t1043)
    t1045 = t406 * t698
    t1046 = t887 + t890
    t1065 = t1005 * t107 * (t938 + t942) * t908
    contr[21] = (3/4 * t905 * t523 * pi * t1046 * t1045 + 3/8 * t916 * t912 * t107 * t1046 * t908 - 3/4 * t925 * t921 * t1046 * muM * t698 + 3/8 * t951 * t1065 - 3/8 * t954 * t1065) * t1044
    t1071 = -psig - psih + t172
    t1072 = cos(t1071)
    t1073 = t50 * t408
    t1076 = t50 * t410
    t1079 = t34 * (-2 * t432 - 2 * t1076)
    t1080 = t44 * (t273 + t1073) + t1079 + t431
    t1083 = t318 * t1080 * t118 * t176
    t1086 = t73 * t1080
    t1087 = t1086 * t298
    t1088 = t329 * pi
    t1089 = t1088 * t210
    t1093 = t72 * t1080
    t1094 = t1093 * t298
    t1095 = t329 * t108
    t1096 = t1095 * t245
    t1104 = t210 * t1086
    t1107 = t323 * t196 * t192
    contr[22] = (-3/8 * t332 * t1083 + 3/8 * t239 * t1089 * t1087 + 3/16 * t262 * t1096 * t1094) * t1072 + 3/8 * t1107 * t1104 * t117 * t175 * t1072
    t1110 = -psig + psih + t172
    t1111 = cos(t1110)
    t1112 = 8 * t274
    t1118 = t34 * (-t433 - 8 * t434 + 2 * t1076)
    t1123 = t44 * (t273 - t1073 - t1112) + t1118 + (2 * t409 - 6 * t412) * t55
    t1126 = t318 * t118 * t1123 * t176
    t1129 = t1123 * t175
    t1130 = t208 * t1129
    t1131 = t292 * pi
    t1132 = t1131 * t210
    t1136 = t242 * t1129
    t1137 = t292 * t108
    t1138 = t1137 * t245
    t1147 = t210 * t73 * t117
    contr[23] = (3/8 * t295 * t1126 - 3/8 * t239 * t1132 * t1130 - 3/16 * t262 * t1138 * t1136) * t1111 - 3/8 * t1107 * t1147 * t1123 * t175 * t1111
    t1151 = -psig - t352 + t172
    t1152 = cos(t1151)
    t1153 = t991 - 1
    t1154 = 0.1e1 / t1153
    t1157 = t829 + npsig
    t1158 = 1 / t1157
    t1161 = t202 * t90 * t1158 * t80 * t1154 * t824
    t1164 = t1154 * t360
    t1165 = t1164 * t838
    t1167 = t1157 ^ 2
    t1169 = 1 / t1167 * t110
    t1171 = t132 * t380 * t1169
    t1174 = t1154 * t86
    t1176 = t238 * t1169 * t1174
    t1180 = t72 * t188 * t819
    t1181 = 1 + t991
    t1182 = t1181 * t107
    t1186 = t1153 ^ 2
    t1187 = 0.1e1 / t1186
    t1188 = t1187 * t86
    t1190 = t95 * t1158 * t110
    t1192 = t399 * t1190 * t1188
    t1201 = t261 * t1158 * t110 * t1187 * t360
    t1204 = -3/4 * t1161 * t823 - 3/4 * t1171 * t1165 * t837 + 3/4 * t1176 * t823 - 3/4 * t1192 * muM * t1182 * t207 * t1180 + 3/8 * t1201 * t1181 * t838 * t207 * t1180
    contr[24] = t1204 * t1152
    t1205 = psig - psih + t172
    t1206 = cos(t1205)
    contr[25] = (3/8 * t295 * t1083 - 3/8 * t239 * t1132 * t1087 - 3/16 * t262 * t1138 * t1094) * t1206 - 3/8 * t1107 * t1104 * t117 * t175 * t1206
    t1222 = psig + psih + t172
    t1223 = cos(t1222)
    contr[26] = (-3/8 * t332 * t1126 + 3/8 * t239 * t1089 * t1130 + 3/16 * t262 * t1096 * t1136) * t1223 + 3/8 * t1107 * t1147 * t1123 * t175 * t1223
    t1239 = psig + t352 + t172
    t1240 = cos(t1239)
    contr[27] = -t1204 * t1240
    t1242 = -psih + psig - t352
    t1243 = cos(t1242)
    t1244 = t288 * t73
    t1246 = pi * t175
    t1247 = q * t292
    t1248 = muM * t1247
    t1249 = t1248 * t1246
    t1250 = t1249 * t1244 * t819
    t1253 = t858 * t371
    t1254 = t839 * t1247
    t1261 = t72 * t854 * t819
    t1262 = t175 * t288
    t1267 = t292 * t107
    t1268 = q * t1267
    t1277 = t1246 * t1244
    t1282 = t167 * t831 * t164 * t849 * t374
    contr[28] = (-3/4 * t834 * t1250 + 3/4 * t846 * t1254 * t1253 + 3/4 * t851 * t1250 - 3/4 * t868 * t1137 * t1262 * t1261 - 3/8 * t877 * t1268 * t1262 * t1261) * t1243 + 3/4 * t1282 * t1277 * t117 * IMz * t1243
    t1285 = -psih + psig - psil
    t1286 = cos(t1285)
    t1288 = t4 * t713 * t427
    t1289 = t674 * IMx
    t1290 = t438 * t1289
    t1295 = t919 * t292 * t13
    t1300 = t4 * t713 * t474
    t1301 = t485 * t1289
    t1302 = -t1300 + t1301
    t1304 = t292 * muM
    t1305 = t1304 * t1302 * t175
    t1306 = t977 * t928
    t1310 = t86 * t73
    t1311 = t1310 * t919
    t1315 = t996 * t475
    t1316 = t485 * t999
    t1320 = t86 * t72
    t1321 = t1320 * t928
    t1322 = t1321 * t292 * (-t1315 + t1316) * t908
    t1331 = t5 * t300
    t1333 = t164 * t1310
    t1334 = t167 * t970
    t1335 = t1334 * t1333
    contr[29] = (-3/4 * t972 * t1295 * muM * (-t1288 + t1290) * t698 + 3/8 * t982 * t1306 * t1305 + 3/4 * t988 * t1311 * t1305 - 3/8 * t1011 * t1322 - 3/8 * t1014 * t1322) * t1286 + 3/4 * t1335 * t1331 * t1302 * t175 * t1286
    t1338 = -psih + psig + psil
    t1339 = cos(t1338)
    t1341 = t4 * t790 * t427
    t1342 = t438 * t888
    t1350 = t4 * t790 * t474
    t1351 = t485 * t888
    t1352 = t1350 + t1351
    t1354 = t292 * t1352 * t908
    t1355 = t911 * t928
    t1362 = t1267 * t908
    t1364 = t4 * t936 * t474
    t1365 = t940 * t486
    t1369 = t1320 * (t1364 + t1365) * t5 * t1362
    t1381 = t167 * t903
    t1382 = t1381 * t1333
    contr[30] = (3/4 * t905 * t919 * t292 * (t1341 + t1342) * t1045 + 3/8 * t916 * t1355 * t1354 - 3/4 * t925 * t1311 * t1354 + 3/8 * t951 * t1369 - 3/8 * t954 * t1369) * t1339 - 3/4 * t1382 * t5 * pi * t1352 * muM * t175 * t1339
    t1385 = -psih + psig + t352
    t1386 = cos(t1385)
    t1389 = t1164 * t1247
    t1396 = t288 * t72 * t819
    t1397 = t1181 * t292
    t1399 = muM * t1397 * t858
    t1404 = t1181 * t1247 * t858
    t1415 = t167 * t1158 * t164
    t1416 = t1415 * t1174 * t374
    contr[31] = (3/4 * t1161 * t1250 + 3/4 * t1171 * t1389 * t1253 - 3/4 * t1176 * t1250 + 3/4 * t1192 * t1399 * t1396 - 3/8 * t1201 * t1404 * t1396) * t1386 - 3/4 * t1416 * t1277 * t117 * IMz * t1386
    t1419 = -psih - psil + t172
    t1420 = cos(t1419)
    t1421 = t136 * IMy
    t1422 = Q2 * t408
    t1424 = 2 * t1422 + 2 * t423
    t1425 = t34 * t1424
    t1429 = t36 * t24 * t67 + t67 * t51 + t1425
    t1430 = t3 * t1429
    t1431 = t1430 * t1421
    t1432 = t50 * t45
    t1437 = 2 * t64 + 2 * t66
    t1443 = 2 * t50 * t57 * t568
    t1444 = t1079 + t478 + t36 * t24 * (t1432 + t59) + 2 * t57 * t24 * t1437 - t481 - t1443
    t1445 = t1444 * t616
    t1447 = sdelta * (t1431 + t1445)
    t1456 = t500 * IMy
    t1457 = t1430 * t1456
    t1458 = t1444 * t637
    t1462 = t375 * t523
    contr[32] = (-3/4 * t452 * t443 * t1447 * t407 - 3/8 * t496 * t492 * t1447 * t108 - 3/8 * t517 * t1462 * t107 * (t1457 + t1458) * t635) * t1420
    t1467 = -psih + psil + t172
    t1468 = cos(t1467)
    t1469 = t73 * muM
    t1470 = -t1431 + t1445
    t1473 = sdelta * t13
    t1474 = t443 * t1473
    contr[33] = (3/4 * t452 * t1474 * pi * t1470 * t1469 + 3/8 * t496 * t492 * t372 * t1470 * muM + 3/8 * t517 * t1462 * t107 * (-t1457 + t1458) * t635) * t1468
    t1490 = psih + psig - t352
    t1491 = cos(t1490)
    t1492 = t329 * q
    t1493 = muM * t1492
    t1495 = t1493 * t289 * t299
    t1498 = t839 * t1492
    t1508 = t329 * t838
    contr[34] = (3/4 * t834 * t1495 - 3/4 * t846 * t1498 * t1253 - 3/4 * t851 * t1495 + 3/4 * t868 * t1095 * t1262 * t1261 + 3/8 * t877 * t1508 * t1262 * t1261) * t1491 - 3/4 * t1282 * t1277 * t117 * IMz * t1491
    t1520 = psih + psig - psil
    t1521 = cos(t1520)
    t1526 = t919 * t329 * t13
    t1530 = t1300 + t1301
    t1532 = t329 * muM
    t1533 = t1532 * t175 * t1530
    t1543 = t1321 * t329 * (t1315 + t1316) * t908
    contr[35] = (3/4 * t972 * t1526 * t908 * t73 * (t1288 + t1290) - 3/8 * t982 * t1306 * t1533 - 3/4 * t988 * t1311 * t1533 + 3/8 * t1011 * t1543 + 3/8 * t1014 * t1543) * t1521 - 3/4 * t1335 * t1331 * t175 * t1530 * t1521
    t1555 = psih + psig + psil
    t1556 = cos(t1555)
    t1564 = t107 * t329 * t908
    t1565 = -t1350 + t1351
    t1566 = t1565 * t5
    t1579 = t1320 * t5 * (-t1364 + t1365) * t1564
    contr[36] = (-3/4 * t905 * (-t1341 + t1342) * t5 * t1088 * t1045 - 3/8 * t916 * t911 * t1566 * t1564 + 3/4 * t925 * t1310 * t1566 * t1088 * t908 - 3/8 * t951 * t1579 + 3/8 * t954 * t1579) * t1556 + 3/4 * t1382 * t1565 * t919 * muM * t175 * t1556
    t1592 = psih + psig + t352
    t1593 = cos(t1592)
    t1596 = t1164 * t1492
    t1602 = t175 * t72
    t1603 = t1602 * t819
    t1605 = muM * t1181 * t329
    t1610 = t1181 * t1492
    contr[37] = (-3/4 * t1161 * t1495 - 3/4 * t1171 * t1596 * t1253 + 3/4 * t1176 * t1495 - 3/4 * t1192 * t1605 * t308 * t1603 + 3/8 * t1201 * t1610 * t308 * t1603) * t1593 + 3/4 * t1416 * t1277 * t117 * IMz * t1593
    t1622 = psih - psil + t172
    t1623 = cos(t1622)
    t1627 = t34 * (2 * t1422 - 8 * t420 - t424)
    t1633 = t1627 + t36 * t24 * (6 * t64 + t66) + 8 * t471 - t463 - t473
    t1634 = IMy * t1633
    t1635 = t429 * t1634
    t1643 = t1118 + t478 + t36 * t24 * (-t1432 + t59) - 2 * t57 * t24 * t1437 - t481 - t1443
    t1644 = t1643 * t616
    t1646 = (t1635 + t1644) * muM
    t1655 = t501 * t1634
    t1656 = t1643 * t637
    contr[38] = (3/4 * t452 * t1474 * t74 * t1646 + 3/8 * t496 * t492 * t372 * t1646 + 3/8 * t517 * t1462 * (t1655 + t1656) * t107 * t635) * t1623
    t1664 = psih + psil + t172
    t1665 = cos(t1664)
    t1667 = sdelta * (-t1635 + t1644)
    contr[39] = (-3/4 * t452 * t443 * t1667 * t407 - 3/8 * t496 * t492 * t1667 * t108 - 3/8 * t517 * t1462 * t138 * (-t1655 + t1656) * muM) * t1665
    t1683 = -t352 - psih + t172
    t1684 = cos(t1683)
    t1690 = t1080 * IMz
    t1700 = -3/8 * t368 * t358 * t13 * t1080 * t179 - 3/16 * t382 * t376 * t372 * t1690 - 3/8 * t400 * t391 * sdelta * t1080 * t385
    contr[40] = t1700 * t1684
    t1701 = -t352 + psih + t172
    t1702 = cos(t1701)
    t1708 = t1123 * IMz
    t1718 = 3/8 * t368 * t358 * t13 * t1123 * t179 + 3/16 * t382 * t376 * t372 * t1708 + 3/8 * t400 * t391 * sdelta * t1123 * t385
    contr[41] = t1718 * t1702
    t1719 = t352 - psih + t172
    t1720 = cos(t1719)
    contr[42] = -t1700 * t1720
    t1722 = t352 + psih + t172
    t1723 = cos(t1722)
    contr[43] = -t1718 * t1723
    t1725 = -psig - t352 - psih + t172
    t1726 = cos(t1725)
    t1727 = t1086 * t819
    t1728 = t1493 * t1246
    t1729 = t1728 * t1727
    t1732 = t858 * t1690
    t1738 = t1093 * t819
    t1739 = t1605 * t858
    t1743 = t1610 * t858
    t1751 = t1246 * t1086
    contr[44] = (-3/8 * t1161 * t1729 - 3/8 * t1171 * t1596 * t1732 + 3/8 * t1176 * t1729 - 3/8 * t1192 * t1739 * t1738 + 3/16 * t1201 * t1743 * t1738) * t1726 + 3/8 * t1416 * t1751 * t117 * IMz * t1726
    t1755 = psig + t352 - psih + t172
    t1756 = cos(t1755)
    t1757 = t1249 * t1727
    contr[45] = (3/8 * t1161 * t1757 + 3/8 * t1171 * t1389 * t1732 - 3/8 * t1176 * t1757 + 3/8 * t1192 * t1399 * t1738 - 3/16 * t1201 * t1404 * t1738) * t1756 - 3/8 * t1416 * t1751 * t117 * IMz * t1756
    t1778 = -psih + t172 - psig + t352
    t1779 = cos(t1778)
    t1788 = t854 * t1080 * t819
    t1789 = t1095 * t1602
    t1793 = t1508 * t1602
    contr[46] = (3/8 * t834 * t1729 - 3/8 * t846 * t1498 * t1732 - 3/8 * t851 * t1729 + 3/8 * t868 * t1789 * t1788 + 3/16 * t877 * t1793 * t1788) * t1779 - 3/8 * t1282 * t1751 * t117 * IMz * t1779
    t1804 = -psih + t172 + psig - t352
    t1805 = cos(t1804)
    t1813 = t1137 * t1602
    t1817 = t1268 * t1602
    contr[47] = (-3/8 * t834 * t1757 + 3/8 * t846 * t1254 * t1732 + 3/8 * t851 * t1757 - 3/8 * t868 * t1813 * t1788 - 3/16 * t877 * t1817 * t1788) * t1805 + 3/8 * t1282 * t1751 * t117 * IMz * t1805
    t1828 = psih + t172 - psig - t352
    t1829 = cos(t1828)
    t1830 = t73 * t1123
    t1831 = t1830 * t819
    t1832 = t1249 * t1831
    t1835 = t858 * t1708
    t1842 = t72 * t1123 * t819
    t1853 = t1246 * t1830
    contr[48] = (3/8 * t1161 * t1832 + 3/8 * t1171 * t1389 * t1835 - 3/8 * t1176 * t1832 + 3/8 * t1192 * t1399 * t1842 - 3/16 * t1201 * t1404 * t1842) * t1829 - 3/8 * t1416 * t1853 * t117 * IMz * t1829
    t1857 = psih + t172 - psig + t352
    t1858 = cos(t1857)
    t1867 = t854 * t1123 * t819
    contr[49] = (-3/8 * t834 * t1832 + 3/8 * t846 * t1254 * t1835 + 3/8 * t851 * t1832 - 3/8 * t868 * t1813 * t1867 - 3/16 * t877 * t1817 * t1867) * t1858 + 3/8 * t1282 * t1853 * t117 * IMz * t1858
    t1881 = psih + t172 + psig - t352
    t1882 = cos(t1881)
    t1883 = t1728 * t1831
    contr[50] = (3/8 * t834 * t1883 - 3/8 * t846 * t1498 * t1835 - 3/8 * t851 * t1883 + 3/8 * t868 * t1789 * t1867 + 3/16 * t877 * t1793 * t1867) * t1882 - 3/8 * t1282 * t1853 * t117 * IMz * t1882
    t1904 = psih + t172 + psig + t352
    t1905 = cos(t1904)
    contr[51] = (-3/8 * t1161 * t1883 - 3/8 * t1171 * t1596 * t1835 + 3/8 * t1176 * t1883 - 3/8 * t1192 * t1739 * t1842 + 3/16 * t1201 * t1743 * t1842) * t1905 + 3/8 * t1416 * t1853 * t117 * IMz * t1905
    t1926 = -psil - psig - psih + t172
    t1927 = cos(t1926)
    t1928 = IMy * t790
    t1929 = t1430 * t1928
    t1930 = t1444 * t888
    t1931 = t1929 + t1930
    t1933 = t908 * t1931 * t73
    t1942 = t86 * t5
    t1943 = t1942 * t1088
    t1947 = t936 * IMy
    t1948 = t1430 * t1947
    t1949 = t940 * IMx
    t1950 = t1444 * t1949
    t1954 = t1321 * t329 * (t1948 + t1950) * t908
    t1962 = -t34 * t1424
    t1966 = -t36 * t24 * t67 + t1962 - t463 - t473
    t1968 = t3 * t1966 * t1928
    t1972 = t5 * t1469
    t1974 = t86 * t1246
    t1978 = t98 * t902 * t768 * t164 * t1974
    contr[52] = (-3/8 * t905 * t1526 * t1933 - 3/16 * t916 * t1355 * t1532 * t175 * t1931 + 3/8 * t925 * t1943 * t1933 - 3/16 * t951 * t1954 + 3/16 * t954 * t1954) * t1927 + 3/8 * t1978 * t1972 * t1927 * (-t1968 + t1930) * cdelta
    t1981 = -psil - psig + psih + t172
    t1982 = cos(t1981)
    t1983 = t1304 * t698
    t1984 = t3 * t1633
    t1985 = t1984 * t1928
    t1986 = t1643 * t888
    t1987 = t1985 + t1986
    t1988 = t5 * t1987
    t2002 = t1984 * t1947
    t2003 = t1643 * t1949
    t2007 = t1321 * t292 * (t2002 + t2003) * t908
    t2018 = t164 * t1942
    t2019 = t1381 * t2018
    contr[53] = (3/8 * t905 * t1988 * t894 * t1983 + 3/16 * t916 * t911 * t1988 * t1362 - 3/8 * t925 * t1942 * t1987 * pi * t1983 + 3/16 * t951 * t2007 - 3/16 * t954 * t2007) * t1982 - 3/8 * t2019 * t1987 * t300 * t175 * t73 * t1982
    t2022 = -psil + psig - psih + t172
    t2023 = cos(t2022)
    t2024 = IMy * t713
    t2025 = t1430 * t2024
    t2026 = t1444 * t1289
    t2027 = t2025 + t2026
    t2028 = t5 * t2027
    t2043 = t996 * t1429 * IMy
    t2044 = t1444 * t999
    t2048 = t1321 * (t2043 + t2044) * t292 * t908
    t2058 = t3 * t713
    t2059 = t2058 * t1966 * IMy
    t2067 = t98 * t969 * t678 * t164 * t1974
    contr[54] = (-3/8 * t972 * t2028 * t894 * t1983 + 3/16 * t982 * t977 * t2028 * t1362 + 3/8 * t988 * t1942 * t2027 * pi * t1983 - 3/16 * t1011 * t2048 - 3/16 * t1014 * t2048) * t2023 + 3/8 * t2067 * t5 * (-t2059 + t2026) * t73 * muM * t2023 * cdelta
    t2070 = -psil + psig + psih + t172
    t2071 = cos(t2070)
    t2072 = t1984 * t2024
    t2073 = t1643 * t1289
    t2074 = t2072 + t2073
    t2075 = t2074 * muM
    t2076 = t2075 * t698
    t2088 = t996 * t1634
    t2089 = t1643 * t999
    t2093 = t86 * (t2088 + t2089) * t508 * t1564
    t2104 = t1334 * t2018
    contr[55] = (3/8 * t972 * t1526 * t2076 - 3/16 * t982 * t1306 * t329 * t2074 * t908 - 3/8 * t988 * t1943 * t2076 + 3/16 * t1011 * t2093 + 3/16 * t1014 * t2093) * t2071 - 3/8 * t2104 * pi * t2075 * t175 * t73 * t2071
    t2107 = psil - psig - psih + t172
    t2108 = cos(t2107)
    t2109 = -t2025 + t2026
    t2111 = muM * t2109 * t698
    t2126 = t1320 * t5 * (-t2043 + t2044) * t1564
    contr[56] = (3/8 * t972 * t1526 * t2111 - 3/16 * t982 * t1306 * t1532 * t2109 * t175 - 3/8 * t988 * t1943 * t2111 + 3/16 * t1011 * t2126 + 3/16 * t1014 * t2126) * t2108 - 3/8 * t2067 * t1972 * t2108 * cdelta * (t2059 + t2026)
    t2139 = psil - psig + psih + t172
    t2140 = cos(t2139)
    t2141 = -t2072 + t2073
    t2142 = t2141 * muM
    t2143 = t2142 * t698
    t2152 = t1942 * t1131
    t2159 = t1321 * (-t2088 + t2089) * t292 * t908
    contr[57] = (-3/8 * t972 * t1295 * t2143 + 3/16 * t982 * t1306 * t292 * t2141 * t908 + 3/8 * t988 * t2152 * t2143 - 3/16 * t1011 * t2159 - 3/16 * t1014 * t2159) * t2140 + 3/8 * t2104 * pi * t2142 * t175 * t73 * t2140
    t2172 = psil + psig - psih + t172
    t2173 = cos(t2172)
    t2174 = -t1929 + t1930
    t2176 = t908 * t73 * t2174
    t2191 = t1320 * t5 * (-t1948 + t1950) * t1362
    contr[58] = (3/8 * t905 * t1295 * t2176 + 3/16 * t916 * t1355 * t1304 * t175 * t2174 - 3/8 * t925 * t2152 * t2176 + 3/16 * t951 * t2191 - 3/16 * t954 * t2191) * t2173 - 3/8 * t1978 * t5 * (t1968 + t1930) * t73 * muM * t2173 * cdelta
    t2206 = psil + psig + psih + t172
    t2207 = cos(t2206)
    t2208 = t1532 * t698
    t2209 = -t1985 + t1986
    t2210 = t5 * t2209
    t2227 = t1321 * (-t2002 + t2003) * t329 * t908
    contr[59] = (-3/8 * t905 * t2210 * t894 * t2208 - 3/16 * t916 * t911 * t2210 * t1564 + 3/8 * t925 * t1942 * t2209 * pi * t2208 - 3/16 * t951 * t2227 + 3/16 * t954 * t2227) * t2207 + 3/8 * t2019 * t2209 * t300 * t175 * t73 * t2207
    t2240 = sin(psig)
    t2242 = t210 * t208
    t2246 = t177 * t670
    t2250 = t107 * t210
    t2251 = t2250 * t306
    contr[60] = (-3/2 * t204 * t2242 * t1473 * t670 + 3/2 * t239 * t318 * t2246 + 3/4 * t262 * t2251 * t2246) * t2240
    t2256 = sin(psil)
    t2259 = muM * t70
    t2262 = 0.1e1 / t136
    contr[61] = (3 * t100 * t88 * t2262 * t80 * t2259 * t894 * t6 * t73 * IMx + 3/2 * t132 * t380 * t118 * t115 * t86 * t2262 * t110 * t2259 * t928 * IMx * cdelta + 3/2 * t154 * t585 * t86 / t499 * t110 * t2259 * t107 * t81 * t6 * t72 * IMx) * t2256 - 3 * t168 * t2262 * t165 * t70 * t919 * t73 * IMx * t2256
    t2301 = sin(t352)
    t2302 = t552 * t179
    t2303 = t70 * q
    t2315 = t136 * t81
    t2324 = pi * t117
    t2329 = t167 * t87 * t363
    contr[62] = (3/2 * t368 * t2303 * t894 * t2302 + 3/4 * t382 * t375 * t2259 * t838 * IMz * cdelta + 3/2 * t400 * t715 * t2315 * t552 * t385) * t2301 - 3/2 * t2329 * t164 * t360 * t2303 * t2324 * t73 * IMz * t2301
    t2333 = sin(t173)
    t2334 = t175 * t613
    t2339 = t177 * t210
    t2351 = -2 * Q1 * t36 * t477 - 4 * t15 * t464 - 2 * t411 * t568 - 4 * t465 * t568 - 4 * t569 * t477 + t609
    t2352 = t86 * t2351
    t2366 = 3/4 * t204 * t2242 * t1473 * t2334 - 3/4 * t238 * t217 * t73 * t196 * t2352 * t1246 * t2339 - 3/8 * t262 * t72 * t244 * t2351 * t858 * t2339
    contr[63] = t2366 * t2333
    t2367 = sin(t266)
    contr[64] = -t2366 * t2367
    t2370 = sin(psig - t352)
    t2371 = t669 * t819
    t2374 = muM * t2303 * t1246 * t2371
    t2377 = IMz * sdelta
    t2378 = t858 * t2377
    contr[65] = (3/2 * t834 * t2374 - 3/2 * t846 * t839 * t2303 * t2378 - 3/2 * t851 * t2374 + 3/2 * t868 * t715 * t207 * t1261 + 3/4 * t877 * t70 * t838 * t207 * t1261) * t2370
    t2396 = sin(psig + t352)
    t2405 = t857 * t819
    t2412 = q * t1181
    contr[66] = (-3/2 * t1161 * t2374 - 3/2 * t1171 * t1164 * t2303 * t2378 + 3/2 * t1176 * t2374 - 3/2 * t1192 * muM * t70 * t1181 * t858 * t2405 + 3/4 * t1201 * t70 * t2412 * t858 * t2405) * t2396
    t2419 = sin(t269)
    t2420 = 2 * t278
    t2428 = t419 + 2 * t57 * t24 * (t46 - t2420) + (2 * t64 + 2 * t181) * t51
    t2429 = t175 * t2428
    t2430 = t118 * t13
    t2431 = t2430 * t2429
    t2437 = t292 * t118
    contr[67] = (-3/4 * t204 * t210 * t73 * t292 * t2431 + 3/4 * t239 * t318 * t2437 * t2429 + 3/8 * t262 * t2250 * t72 * t292 * t244 * t118 * t2429) * t2419 + 3/4 * t1107 * t1147 * t175 * t2428 * t2419
    t2456 = sin(t327)
    t2457 = t73 * t329
    t2458 = t210 * t2457
    t2462 = t329 * t118
    t2463 = t2462 * t2429
    contr[68] = (-3/4 * t204 * t2458 * t2431 + 3/4 * t239 * t318 * t2463 + 3/8 * t262 * t2251 * t2463) * t2456 + 3/4 * t1107 * t1147 * t175 * t2428 * t2456
    t2477 = sin(t353)
    t2478 = sdelta * t2428
    t2484 = t2428 * IMz
    t2493 = 3/4 * t368 * t357 * t2430 * t2478 * t179 + 3/8 * t382 * t376 * t372 * t2484 + 3/4 * t400 * t391 * t2478 * t385
    contr[69] = t2493 * t2477
    t2494 = sin(t404)
    t2495 = t3 * t438
    t2496 = t2495 * t1421
    t2497 = t427 * t616
    t2504 = t3 * t485
    t2505 = t2504 * t1421
    t2506 = t474 * t616
    t2513 = t2504 * t1456
    t2514 = t474 * t637
    contr[70] = (-3/2 * t452 * t1474 * t74 * (t2496 - t2497) * muM - 3/4 * t496 * t492 * t372 * (t2505 - t2506) * muM - 3/4 * t517 * t509 * (t2513 - t2514) * sdelta * t108) * t2494
    t2522 = sin(t521)
    contr[71] = (-3/2 * t452 * t1474 * t74 * muM * (t2496 + t2497) - 3/4 * t496 * t492 * t372 * muM * (t2505 + t2506) - 3/4 * t517 * t509 * t372 * (t2513 + t2514) * muM) * t2522
    t2542 = sin(t544)
    contr[72] = -t2493 * t2542
    t2544 = sin(t548)
    t2551 = t2351 * q
    t2557 = t2351 * t107
    t2562 = -3/4 * t368 * t357 * t613 * t13 * t2302 - 3/8 * t382 * t375 * t2551 * t558 * t210 - 3/4 * t587 * t581 * t2557 * t552 * t210
    t2566 = t2551 * t2324
    t2568 = t2329 * t1333
    contr[73] = t2562 * t2544 + 3/4 * t2568 * t2566 * muM * IMz * t2544
    t2571 = sin(t606)
    t2574 = t3 * t622
    t2576 = 2 * t2574 * t1421
    t2577 = t613 * IMx
    t2578 = t81 * t2577
    t2579 = t2576 + t2578
    t2592 = 2 * t2574 * t1456
    t2593 = t503 * t2577
    t2605 = t429 * IMy * t188
    contr[74] = (-3/2 * t452 * t80 * t2579 * t5 * t13 * t598 * t1469 - 3/4 * t496 * t116 * t110 * t2579 * t6 * t108 - 3/4 * t517 * t643 * (t2592 + t2593) * t107 * t635) * t2571 + 3/2 * t661 * muM * cdelta * (t2605 + t2578) * t73 * t5 * t2571
    t2612 = sin(t664)
    t2613 = t5 * IMx
    t2614 = t669 * t2613
    t2617 = t13 * t2259 * t1246 * t2614
    t2618 = 0.1e1 / t713
    t2625 = t207 * t2613
    t2629 = t379 * t124
    t2636 = t86 * t2259 * t1246 * t2614
    t2643 = t857 * t2613
    t2646 = t715 * t674 * t175 * t2643
    t2647 = t713 ^ 2
    t2650 = t722 / t2647 * t86
    contr[75] = (3/2 * t100 * t678 * t80 * t2618 * t86 * t2617 - 3/4 * t132 * t2629 * t691 * t2618 * t360 * t685 * t2625 - 3/2 * t707 * t235 * t690 * t110 * t2618 * t2636 + 3/4 * t154 * t2650 * t2646 + 3/4 * t728 * t2650 * t2646) * t2612
    t2658 = sin(t733)
    t2660 = muM * (-t2576 + t2578)
    contr[76] = (3/2 * t452 * t443 * t13 * cdelta * t74 * t2660 + 3/4 * t496 * t492 * t558 * t2660 + 3/4 * t517 * t643 * t138 * muM * (-t2592 + t2593)) * t2658 - 3/2 * t661 * muM * (-t2605 + t2578) * cdelta * t73 * t5 * t2658
    t2687 = sin(t761)
    t2688 = 0.1e1 / t790
    t2711 = muM * t764 * t70 * t858 * t2643
    t2712 = t790 ^ 2
    t2715 = t799 / t2712 * t86
    contr[77] = (-3/2 * t100 * t768 * t80 * t2688 * t86 * t2617 - 3/4 * t132 * t2629 * t779 * t2688 * t360 * t685 * t2625 + 3/2 * t707 * t235 * t778 * t110 * t2688 * t2636 - 3/4 * t154 * t2715 * t2711 + 3/4 * t728 * t2715 * t2711) * t2687
    t2723 = sin(t809)
    contr[78] = -t2562 * t2723 - 3/4 * t2568 * t2566 * muM * IMz * t2723
    t2731 = sin(t817)
    t2733 = t821 * t2334 * t2371
    t2737 = sdelta * q * t210
    t2738 = -t825
    t2739 = 0.1e1 / t2738
    t2748 = t86 * t2351 * pi * t298 * t2737
    t2758 = t2738 ^ 2
    t2759 = 0.1e1 / t2758
    t2769 = t110 * t72
    t2775 = -3/4 * t834 * t2733 - 3/4 * t846 * t2739 * t2352 * t858 * t2737 - 3/4 * t238 * t844 * t73 * t2739 * t2748 - 3/4 * t399 * t866 * t72 * t2759 * t86 * t854 * t2351 * t858 * t2339 - 3/8 * t261 * t831 * t2769 * t2759 * t86 * t854 * t2557 * t298 * t2737
    contr[79] = t2775 * t2731
    t2776 = sin(t881)
    contr[80] = -t2775 * t2776
    t2778 = sin(t884)
    t2780 = 2 * t2574 * t1928
    t2781 = t764 * t2577
    t2782 = t2780 + t2781
    t2784 = muM * t2782 * t698
    t2797 = 2 * t2574 * t1947
    t2798 = t940 * t2577
    t2802 = t1005 * t107 * (t2797 + t2798) * t908
    contr[81] = (3/4 * t905 * t895 * t2784 + 3/8 * t916 * t912 * t108 * t2782 * t175 - 3/4 * t925 * t921 * t2784 + 3/8 * t951 * t2802 - 3/8 * t954 * t2802) * t2778
    t2808 = sin(t958)
    t2810 = 2 * t2574 * t2024
    t2811 = t674 * t2577
    t2812 = t2810 + t2811
    t2814 = t2812 * muM * t698
    t2826 = t995 * IMy
    t2828 = 2 * t2574 * t2826
    t2829 = t998 * t2577
    t2833 = t1005 * t108 * t175 * (t2828 + t2829)
    contr[82] = (3/4 * t972 * t895 * t2814 - 3/8 * t982 * t978 * t107 * t2812 * t908 - 3/4 * t988 * t921 * t2814 + 3/8 * t1011 * t2833 + 3/8 * t1014 * t2833) * t2808
    t2839 = sin(t1018)
    t2840 = -t2810 + t2811
    t2859 = t1005 * t107 * (-t2828 + t2829) * t908
    contr[83] = (-3/4 * t972 * t523 * pi * t2840 * t1045 + 3/8 * t982 * t978 * t107 * t2840 * t908 + 3/4 * t988 * t921 * t2840 * muM * t698 - 3/8 * t1011 * t2859 - 3/8 * t1014 * t2859) * t2839
    t2865 = sin(t1043)
    t2866 = -t2780 + t2781
    t2868 = t2866 * muM * t698
    t2883 = t1005 * t108 * (-t2797 + t2798) * t175
    contr[84] = (-3/4 * t905 * t895 * t2868 - 3/8 * t916 * t912 * t107 * t2866 * t908 + 3/4 * t925 * t921 * t2868 - 3/8 * t951 * t2883 + 3/8 * t954 * t2883) * t2865
    t2889 = sin(t1071)
    t2890 = -t1073 - t417
    t2894 = t55 * t2890 - t44 * t414 + t1962
    t2900 = t46 - t59 - t2420
    t2904 = 2 * t46
    t2905 = -t2904 - t1432 + t2420
    t2910 = (t37 + t51) * t284
    t2911 = 2 * t57 * t24 * t2900 + 2 * t57 * t24 * t2905 - t2910 + t472
    t2917 = t175 * t244
    t2918 = t118 * t2911
    t2920 = IMz * t329
    t2927 = t175 * cdelta
    t2941 = pi * (-2 * t57 * t24 * t2900 - 2 * t57 * t24 * t2905 + t2910 - t472) * t117 * IMz * muM * t2927
    t2946 = t98 * t199 * t164 * t196
    contr[85] = (3/8 * t204 * t2458 * t118 * t2894 * t176 - 3/8 * t239 * t318 * t2462 * t2911 * t175 - 3/16 * t262 * t139 * t2920 * t2918 * t2917) * t2889 + 3/8 * t2946 * t86 * t73 * t2889 * t2941
    t2950 = sin(t1110)
    t2951 = t292 * t175
    t2960 = t55 * (t1073 + t1112 - t417) + t1627 + (6 * t409 - 2 * t412) * t44
    t2963 = t203 * t197 * t86 * t2960
    t2977 = t472 + 2 * t57 * t24 * (t46 + t59 - t2420) + 2 * t57 * t24 * (t2904 - t1432 - t2420) + (t37 - t51) * t284
    t2979 = t73 * t2977 * t300
    t2984 = t2977 * t107
    t2986 = t72 * t2984 * t210
    t2995 = t2977 * pi * t210
    t2998 = t323 * t196 * t1310
    contr[86] = (3/8 * t2963 * t318 * t2430 * t2951 - 3/8 * t239 * t2979 * t819 * t2951 - 3/16 * t262 * t2986 * t2437 * t2917) * t2950 - 3/8 * t2998 * t2995 * t117 * t175 * t2950
    t3001 = sin(t1151)
    t3028 = t261 * t1158 * t2769 * t1188
    t3031 = 3/4 * t1161 * t2733 + 3/4 * t1171 * t1154 * t2352 * t858 * t2737 - 3/4 * t238 * t1169 * t73 * t1154 * t2748 + 3/4 * t399 * t1190 * t72 * t1187 * t86 * t1181 * t2351 * t858 * t2339 - 3/8 * t3028 * t1181 * t2557 * t298 * t2737
    contr[87] = t3031 * t3001
    t3032 = sin(t1205)
    contr[88] = (-3/8 * t204 * t2242 * t2894 * t13 * t2951 + 3/8 * t239 * t318 * t2918 * t2951 + 3/16 * t262 * t139 * t819 * t2911 * t292 * t2917) * t3032 - 3/8 * t2946 * t86 * t73 * t3032 * t2941
    t3055 = sin(t1222)
    t3060 = t2920 * t298
    contr[89] = (-3/8 * t2963 * t318 * t2462 * t176 + 3/8 * t239 * t2979 * t3060 + 3/16 * t262 * t2986 * t2462 * t2917) * t3055 + 3/8 * t2998 * t2995 * t117 * t175 * t3055
    t3075 = sin(t1239)
    contr[90] = -t3031 * t3075
    t3077 = sin(t1242)
    t3078 = t2428 * t73
    t3080 = t1249 * t3078 * t819
    t3090 = t2428 * t72 * t819
    t3091 = t175 * t854
    t3104 = t1246 * t3078
    contr[91] = (3/4 * t834 * t3080 - 3/4 * t846 * t1254 * t858 * t2484 - 3/4 * t851 * t3080 + 3/4 * t868 * t1137 * t3091 * t3090 + 3/8 * t877 * t1268 * t3091 * t3090) * t3077 - 3/4 * t1282 * t3104 * t117 * IMz * t3077
    t3108 = sin(t1285)
    t3109 = t2495 * t2024
    t3110 = t427 * IMx
    t3111 = t674 * t3110
    t3118 = t2504 * t2024
    t3119 = t474 * IMx
    t3120 = t674 * t3119
    t3121 = t3118 + t3120
    t3122 = t3121 * t5
    t3127 = t1131 * t908
    t3132 = t2504 * t2826
    t3133 = t998 * t3119
    t3137 = t1320 * (t3132 + t3133) * t5 * t1362
    contr[92] = (3/4 * t972 * (t3109 + t3111) * t5 * t894 * t1983 - 3/8 * t982 * t977 * t3122 * t1362 - 3/4 * t988 * t1310 * t3122 * t3127 + 3/8 * t1011 * t3137 + 3/8 * t1014 * t3137) * t3108 - 3/4 * t1335 * t3121 * t919 * muM * t175 * t3108
    t3150 = sin(t1338)
    t3151 = t2495 * t1928
    t3152 = t764 * t3110
    t3159 = t2504 * t1928
    t3160 = t764 * t3119
    t3161 = t3159 - t3160
    t3162 = t5 * t3161
    t3171 = t2504 * t1947
    t3172 = t940 * t3119
    t3176 = t1321 * t292 * (t3171 - t3172) * t908
    contr[93] = (3/4 * t905 * t5 * (t3151 - t3152) * t894 * t1983 + 3/8 * t916 * t911 * t3162 * t1362 - 3/4 * t925 * t1310 * t3162 * t3127 + 3/8 * t951 * t3176 - 3/8 * t954 * t3176) * t3150 - 3/4 * t1382 * t5 * t3161 * pi * muM * t175 * t3150
    t3190 = sin(t1385)
    t3193 = t175 * IMz
    t3195 = t292 * t2428
    t3207 = t2428 * q
    t3217 = t357 * t698
    t3221 = t1415 * t1174 * muM * t2428
    contr[94] = (-3/4 * t1161 * t3080 - 3/4 * t1171 * t1164 * t3195 * t838 * t3193 + 3/4 * t1176 * t3080 - 3/4 * t1192 * muM * t3195 * t1182 * t1603 + 3/8 * t1201 * t292 * t3207 * t1182 * t1603) * t3190 + 3/4 * t3221 * t3217 * t117 * IMz * t3190
    t3224 = sin(t1419)
    t3225 = IMy * t1444
    t3226 = t429 * t3225
    t3227 = t1429 * t616
    t3229 = sdelta * (t3226 - t3227)
    t3238 = t501 * t3225
    t3239 = t1429 * t637
    contr[95] = (3/4 * t452 * t443 * t3229 * t407 + 3/8 * t496 * t492 * t3229 * t108 + 3/8 * t517 * t1462 * (t3238 - t3239) * t107 * t635) * t3224
    t3247 = sin(t1467)
    t3248 = t3226 + t3227
    t3252 = t443 * pi * sdelta
    contr[96] = (3/4 * t452 * t3252 * t1469 * t13 * t3248 + 3/8 * t496 * t492 * t372 * muM * t3248 + 3/8 * t517 * t1462 * t138 * (t3238 + t3239) * muM) * t3247
    t3268 = sin(t1490)
    t3269 = t2457 * t819
    t3272 = muM * t3207 * t1246 * t3269
    t3275 = t858 * t2920
    t3282 = t175 * t329
    contr[97] = (3/4 * t834 * t3272 - 3/4 * t846 * t839 * t3207 * t3275 - 3/4 * t851 * t3272 + 3/4 * t868 * muM * t2428 * t107 * t3282 * t1261 + 3/8 * t877 * t2428 * t838 * t3282 * t1261) * t3268 - 3/4 * t1282 * t3104 * t117 * IMz * t3268
    t3301 = sin(t1520)
    t3308 = t3118 - t3120
    t3310 = t329 * t3308 * t908
    t3320 = t1320 * (t3132 - t3133) * t5 * t1564
    contr[98] = (-3/4 * t972 * t1526 * (t3109 - t3111) * muM * t698 + 3/8 * t982 * t1306 * t3310 + 3/4 * t988 * t1311 * t3310 - 3/8 * t1011 * t3320 - 3/8 * t1014 * t3320) * t3301 + 3/4 * t1335 * t5 * pi * t3308 * muM * t175 * t3301
    t3334 = sin(t1555)
    t3341 = t3159 + t3160
    t3343 = t3341 * t329 * t908
    t3353 = t1321 * t329 * (t3171 + t3172) * t908
    contr[99] = (-3/4 * t905 * t919 * t13 * (t3151 + t3152) * t2208 - 3/8 * t916 * t1355 * t3343 + 3/4 * t925 * t1311 * t3343 - 3/8 * t951 * t3353 + 3/8 * t954 * t3353) * t3334 + 3/4 * t1382 * t5 * pi * t3341 * muM * t175 * t3334
    t3367 = sin(t1592)
    t3377 = t329 * t72 * t819
    contr[100] = (-3/4 * t1161 * t3272 - 3/4 * t1171 * t1164 * t3207 * t3275 + 3/4 * t1176 * t3272 - 3/4 * t1192 * muM * t2428 * t1181 * t858 * t3377 + 3/8 * t1201 * t2428 * t2412 * t858 * t3377) * t3367 + 3/4 * t3221 * t3217 * t117 * IMz * t3367
    t3396 = sin(t1622)
    t3397 = IMy * t1643
    t3398 = t429 * t3397
    t3399 = t1633 * IMx
    t3400 = t81 * t3399
    t3401 = t3398 - t3400
    t3412 = t501 * t3397
    t3413 = t503 * t3399
    contr[101] = (-3/4 * t452 * t3252 * t1469 * t13 * t3401 - 3/8 * t496 * t492 * t372 * muM * t3401 - 3/8 * t517 * t1462 * t138 * (t3412 - t3413) * muM) * t3396
    t3421 = sin(t1664)
    t3422 = t3398 + t3400
    contr[102] = (-3/4 * t452 * t3252 * t73 * t3422 * t406 - 3/8 * t496 * t492 * t372 * t3422 * muM - 3/8 * t517 * t1462 * t138 * (t3412 + t3413) * muM) * t3421
    t3440 = sin(t1683)
    t3441 = t2894 * q
    t3447 = muM * t2911
    t3453 = t72 * t3447
    t3458 = 3/8 * t368 * t3441 * t894 * t2371 + 3/16 * t382 * t375 * t3447 * t838 * t2377 + 3/8 * t400 * t3453 * t389 * t388 * t2377
    contr[103] = t3458 * t3440
    t3459 = sin(t1701)
    t3469 = t2977 * t118
    t3475 = 3/8 * t368 * t357 * t2960 * t13 * t2371 + 3/16 * t382 * t376 * t2984 * t2377 + 3/8 * t400 * t139 * t2315 * t3469 * t2377
    contr[104] = t3475 * t3459
    t3476 = sin(t1719)
    contr[105] = -t3458 * t3476
    t3478 = sin(t1722)
    contr[106] = -t3475 * t3478
    t3480 = sin(t1725)
    t3481 = muM * t3441
    t3483 = t3481 * t1246 * t3269
    t3486 = t2911 * q
    t3487 = t1164 * t3486
    t3491 = t73 * t3447
    t3493 = t3491 * t357 * t3060
    t3500 = muM * t3486
    t3509 = -t55 * t2890 + t1425 + t415
    t3510 = t3509 * t2927
    t3512 = q * t117
    t3515 = t1310 * t300
    t3519 = t98 * t1158 * t164 * t1154 * t3515
    contr[107] = (3/8 * t1161 * t3483 + 3/8 * t1171 * t3487 * t3275 - 3/8 * t1176 * t3493 + 3/8 * t1192 * t3453 * t1182 * t3060 - 3/16 * t3028 * t3500 * t1182 * t3060) * t3480 + 3/8 * t3519 * t3512 * t3480 * IMz * t3510
    t3522 = sin(t1755)
    t3524 = t3481 * t1131 * t299
    t3527 = t1267 * t3193
    t3533 = t3491 * t1247 * t1246 * t819
    t3536 = t858 * t819
    t3549 = t3512 * IMz * t3509
    contr[108] = (-3/8 * t1161 * t3524 - 3/8 * t1171 * t3487 * t3527 + 3/8 * t1176 * t3533 - 3/8 * t1192 * t3453 * t1397 * t3536 + 3/16 * t3028 * t3500 * t1397 * t3536) * t3522 - 3/8 * t3519 * t3549 * t3522 * t2927
    t3553 = sin(t1778)
    t3556 = t839 * t3486
    t3562 = t854 * IMz
    t3563 = t2462 * t3562
    t3571 = t261 * t875 * t1320
    t3581 = t98 * t831 * t164 * t826
    t3582 = t3581 * t3515
    contr[109] = (-3/8 * t834 * t3483 + 3/8 * t846 * t3556 * t3275 + 3/8 * t851 * t3493 - 3/8 * t868 * t3453 * t858 * t3563 - 3/16 * t3571 * t3500 * t858 * t3563) * t3553 - 3/8 * t3582 * t3512 * t3553 * IMz * t3510
    t3585 = sin(t1804)
    t3593 = t298 * t3562
    contr[110] = (3/8 * t834 * t3524 - 3/8 * t846 * t3556 * t3527 - 3/8 * t851 * t3533 + 3/8 * t868 * t3453 * t1267 * t3593 + 3/16 * t3571 * t3500 * t1267 * t3593) * t3585 + 3/8 * t3582 * t3549 * cdelta * t175 * t3585
    t3609 = sin(t1828)
    t3612 = t1249 * t2960 * t73 * t819
    t3616 = t858 * t2977 * IMz
    t3620 = t175 * t2977
    t3621 = t3620 * t819
    t3622 = t73 * t374
    t3624 = t3622 * t1131 * t3621
    t3628 = t72 * muM * t1181
    t3633 = muM * t2412
    contr[111] = (3/8 * t1161 * t3612 + 3/8 * t1171 * t1389 * t3616 - 3/8 * t1176 * t3624 + 3/8 * t1192 * t3628 * t1267 * t3621 - 3/16 * t3028 * t3633 * t1267 * t3621) * t3609 - 3/8 * t3519 * t3512 * t2960 * IMz * cdelta * t3609 * t175
    t3647 = sin(t1857)
    t3655 = t3469 * t3562
    t3665 = IMz * t2927
    t3666 = t117 * t2960
    contr[112] = (-3/8 * t834 * t3612 + 3/8 * t846 * t1254 * t3616 + 3/8 * t851 * t3624 - 3/8 * t868 * t1813 * t3655 - 3/16 * t3571 * t1248 * t858 * t3655) * t3647 + 3/8 * t3581 * t1310 * pi * t3647 * t374 * t3666 * t3665
    t3674 = sin(t1881)
    t3677 = t821 * t175 * t2960 * t3269
    t3680 = t3620 * t2920
    t3685 = t2977 * t329 * t819
    t3687 = t3622 * t1246 * t3685
    contr[113] = (3/8 * t834 * t3677 - 3/8 * t846 * t840 * t3680 - 3/8 * t851 * t3687 + 3/8 * t868 * t139 * t3620 * t3563 + 3/16 * t3571 * muM * t838 * t3620 * t3563) * t3674 - 3/8 * t3582 * q * t3674 * t3666 * t3665
    t3706 = sin(t1904)
    contr[114] = (-3/8 * t1161 * t3677 - 3/8 * t1171 * t1165 * t3680 + 3/8 * t1176 * t3687 - 3/8 * t1192 * t3628 * t858 * t3685 + 3/16 * t3028 * t3633 * t858 * t3685) * t3706 + 3/8 * t3519 * q * t3706 * t3666 * t3665
    t3729 = sin(t1926)
    t3730 = t3 * t790
    t3731 = t3730 * t3225
    t3732 = t1429 * t888
    t3733 = t3731 - t3732
    t3735 = t3733 * muM * t698
    t3748 = t4 * t1444 * t936
    t3749 = t1429 * t1949
    t3753 = t1321 * t1532 * (t3748 - t3749) * t175
    t3760 = t1966 * t888
    contr[115] = (3/8 * t905 * t1526 * t3735 + 3/16 * t916 * t1355 * t329 * t3733 * t908 - 3/8 * t925 * t1943 * t3735 + 3/16 * t951 * t3753 - 3/16 * t954 * t3753) * t3729 - 3/8 * t1978 * t1972 * cdelta * t3729 * (t3731 + t3760)
    t3767 = sin(t1981)
    t3768 = t3730 * t3397
    t3769 = t1633 * t888
    t3770 = t3768 - t3769
    t3772 = t3770 * t292 * t698
    t3777 = muM * t3770
    t3787 = t4 * t1643 * t936
    t3788 = t1633 * t1949
    t3792 = t1321 * (t3787 - t3788) * muM * t2951
    contr[116] = (-3/8 * t905 * t919 * t406 * t3772 - 3/16 * t916 * t1355 * t3777 * t2951 + 3/8 * t925 * t1942 * t300 * t3772 - 3/16 * t951 * t3792 + 3/16 * t954 * t3792) * t3767 + 3/8 * t2019 * pi * t3777 * t175 * t73 * t3767
    t3805 = sin(t2022)
    t3806 = t2058 * t3225
    t3808 = t674 * t1429 * IMx
    t3809 = t3806 - t3808
    t3826 = t4 * t1444 * t995
    t3827 = t1429 * t999
    t3831 = t1321 * (t3826 - t3827) * muM * t2951
    t3841 = t674 * t1966 * IMx
    contr[117] = (3/8 * t972 * t919 * t13 * t3809 * t1983 - 3/16 * t982 * t1306 * t3809 * muM * t2951 - 3/8 * t988 * t1942 * pi * t3809 * t1983 + 3/16 * t1011 * t3831 + 3/16 * t1014 * t3831) * t3805 - 3/8 * t2067 * t5 * t73 * (t3806 + t3841) * muM * cdelta * t3805
    t3848 = sin(t2070)
    t3849 = t2058 * t3397
    t3850 = t674 * t3399
    t3851 = t3849 - t3850
    t3852 = t5 * t3851
    t3867 = t4 * t995 * t1643
    t3868 = t1633 * t999
    t3872 = t1321 * t1532 * (t3867 - t3868) * t175
    contr[118] = (-3/8 * t972 * t3852 * t894 * t2208 + 3/16 * t982 * t977 * t3852 * t1564 + 3/8 * t988 * t1942 * t3851 * pi * t2208 - 3/16 * t1011 * t3872 - 3/16 * t1014 * t3872) * t3848 + 3/8 * t2104 * t3851 * t300 * t175 * t73 * t3848
    t3885 = sin(t2107)
    t3886 = t3806 + t3808
    t3887 = t5 * t3886
    t3904 = t1320 * t5 * (t3826 + t3827) * t1564
    contr[119] = (3/8 * t972 * t3887 * t894 * t2208 - 3/16 * t982 * t977 * t3887 * t1564 - 3/8 * t988 * t1942 * t3886 * pi * t2208 + 3/16 * t1011 * t3904 + 3/16 * t1014 * t3904) * t3885 - 3/8 * t2067 * t1972 * cdelta * t3885 * (t3806 - t3841)
    t3917 = sin(t2139)
    t3918 = t3849 + t3850
    t3924 = t3918 * muM
    t3937 = t1321 * (t3867 + t3868) * muM * t2951
    contr[120] = (-3/8 * t972 * t919 * t13 * t3918 * t1983 + 3/16 * t982 * t1306 * t3924 * t2951 + 3/8 * t988 * t1942 * pi * t3918 * t1983 - 3/16 * t1011 * t3937 - 3/16 * t1014 * t3937) * t3917 + 3/8 * t2104 * pi * t3924 * t175 * t73 * t3917
    t3950 = sin(t2172)
    t3951 = t3731 + t3732
    t3970 = t1321 * (t3748 + t3749) * muM * t2951
    contr[121] = (3/8 * t905 * t919 * t13 * t3951 * t1983 + 3/16 * t916 * t1355 * t3951 * muM * t2951 - 3/8 * t925 * t1942 * pi * t3951 * t1983 + 3/16 * t951 * t3970 - 3/16 * t954 * t3970) * t3950 - 3/8 * t1978 * t1972 * (t3731 - t3760) * cdelta * t3950
    t3983 = sin(t2206)
    t3984 = t3768 + t3769
    t3985 = muM * t3984
    t3986 = t3985 * t698
    t4001 = t1320 * (t3787 + t3788) * t5 * t1564
    contr[122] = (-3/8 * t905 * t1526 * t3986 - 3/16 * t916 * t1355 * t1532 * t3984 * t175 + 3/8 * t925 * t1943 * t3986 - 3/16 * t951 * t4001 + 3/16 * t954 * t4001) * t3983 + 3/8 * t2019 * pi * t3985 * t175 * t73 * t3983

    der_Jg = sum(contr);
    return der_Jg;
end

function derivativechiM2_JgP2(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)

    contr = zeros(51);
    t1 = 2 * TL
    t2 = -psig + t1
    t3 = cos(t2)
    t6 = sqrt(k)
    t9 = sqrt(k + m)
    t10 = 0.1e1 / t9
    t11 = exp(sigma)
    t13 = t11 * t10 * pi * t6
    t17 = Q1 * cpa2EQ - Q2 * cpa1EQ
    t18 = Q1 ^ 2
    t19 = Q2 ^ 2
    t21 = 1 / (t18 + t19 + 1)
    t22 = t21 * t17
    t23 = cdelta ^ 2
    t24 = rc ^ 2
    t26 = 0.1e1 / t24 / rc
    t27 = t26 * t23
    t30 = exp(2 * sigma)
    t33 = 0.1e1 / KK
    t36 = 0.1e1 / Jg
    t38 = t36 / npsig * t33 / (t30 - 1)
    t39 = t38 * t27 * t22
    contr[1] = 3/2 * t39 * t13 * muM * IMz * t3
    t41 = psig + t1
    t42 = cos(t41)
    contr[2] = -3/2 * t39 * t13 * muM * IMz * t42
    t48 = 2 * psil
    t49 = psih - t48
    t50 = cos(t49)
    t53 = cpa1EQ * t18
    t54 = Q1 * Q2
    t56 = 2 * cpa2EQ * t54
    t57 = cpa1EQ * t19
    t62 = muM * q
    t63 = t62 * t21 * (4 * Q1 * cpa3EQ - cpa1EQ + t53 - t56 - t57)
    t65 = pi * t10
    t67 = q ^ 2
    t71 = 0.1e1 / npsil
    t73 = t36 * t71 / (t67 + 1) * t33
    t74 = t73 * t27 * t65
    contr[3] = -t74 * t63 * t6 * IMz * t50 / 4
    t77 = sqrt(q)
    t78 = t77 * pi
    t79 = cpa1EQ * t54
    t80 = cpa2EQ * t18
    t81 = t80 / 2
    t82 = cpa2EQ * t19
    t83 = t82 / 2
    t84 = Q2 * cpa3EQ
    t87 = t79 + t81 - t83 + 2 * t84 + cpa2EQ / 2
    t89 = 1 + q
    t91 = sqrt(1 + k)
    t92 = t91 * t89
    t93 = t92 * t87 * IMy
    t94 = q - 1
    t95 = t94 * IMx
    t96 = Q2 * cpa2EQ
    t101 = t53 + Q1 * (-2 * t96 + 4 * cpa3EQ) - t57 - cpa1EQ
    t103 = t101 * t95 / 2
    t107 = muM * t23 * t10
    t109 = psih - psil
    t110 = cos(t109)
    t117 = t36 / (t67 - 1) * t71 * t26
    contr[4] = t117 * t33 * t21 * t110 * t107 * (t93 - t103) * t78
    t122 = psih + psil
    t123 = cos(t122)
    contr[5] = t117 * t33 * t21 * t123 * t107 * (t93 + t103) * t78
    t127 = psih + t48
    t128 = cos(t127)
    contr[6] = t74 * t63 * t6 * IMz * t128 / 4
    t133 = -psil + psig
    t134 = cos(t133)
    t136 = t11 * muM
    t141 = Q1 * cpa1EQ
    t144 = t21 * (cpa3EQ * t18 + cpa3EQ * t19 - cpa3EQ - t141 + t96) * t10 * t77
    t147 = t27 * pi * t91
    t148 = t30 + q
    t152 = 0.1e1 / (-npsil + npsig)
    t153 = t36 * t152
    contr[7] = t153 * t33 / t148 * t147 * t144 * t136 * IMy * t134
    t156 = psil + psig
    t157 = cos(t156)
    t161 = q * t30
    t162 = 1 + t161
    t166 = 0.1e1 / (npsil + npsig)
    t167 = t36 * t166
    contr[8] = t167 * t33 / t162 * t147 * t144 * t136 * IMy * t157
    t170 = t11 * t23
    t171 = t1 - psig + t48
    t172 = cos(t171)
    t176 = t62 * pi * t17
    t179 = t26 * t10
    t181 = -t67 + t30
    t184 = 2 * npsil
    t187 = t36 / (-t184 + npsig)
    t188 = t187 * t33 / t181
    t189 = t188 * t179 * t21 * t6
    contr[9] = 3/2 * t189 * t176 * IMz * t172 * t170
    t191 = t1 + psig - t48
    t192 = cos(t191)
    contr[10] = -3/2 * t189 * t176 * IMz * t192 * t170
    t198 = t161 - 1
    t199 = t198 * IMy
    t200 = t141 + t96
    t201 = t91 * t200
    t202 = t201 * t199
    t203 = t162 * IMx
    t204 = -t17
    t205 = t204 * t203
    t208 = t1 - psil - psig
    t209 = cos(t208)
    t214 = t26 * t21 * muM
    t217 = exp(4 * sigma)
    t222 = t36 / (t67 * t217 - 1) * t166 * t33
    t223 = t222 * t214
    contr[11] = -3/2 * t223 * t209 * t77 * t170 * (t202 + t205) * t65
    t226 = q - t30
    t227 = t226 * IMy
    t228 = t201 * t227
    t229 = t148 * IMx
    t230 = t204 * t229
    t234 = t1 - psil + psig
    t235 = cos(t234)
    t244 = t36 / (t67 - t217) * t152 * t33 * t214
    contr[12] = -3/2 * t244 * t235 * t77 * t170 * pi * (t228 + t230) * t10
    t250 = t1 + psil - psig
    t251 = cos(t250)
    contr[13] = 3/2 * t244 * t251 * t77 * t170 * pi * (-t228 + t230) * t10
    t259 = t1 + psil + psig
    t260 = cos(t259)
    contr[14] = 3/2 * t223 * t260 * t77 * t170 * pi * (-t202 + t205) * t10
    t265 = -psig - t48 + t1
    t266 = cos(t265)
    t269 = pi * q
    t270 = t269 * t22
    t282 = t36 / (t184 + npsig) * t33 / (t67 * t30 - 1)
    t283 = t282 * t26 * t6 * muM * t10
    contr[15] = 3/2 * t283 * t270 * IMz * t266 * t170
    t285 = psig + t48 + t1
    t286 = cos(t285)
    contr[16] = -3/2 * t283 * t270 * IMz * t286 * t170
    t292 = t10 * t78
    t293 = muM * t23
    t294 = -psih - psil + t1
    t295 = cos(t294)
    t299 = t92 * IMy * cpa2EQ
    t300 = cpa1EQ * t95
    contr[17] = -3/2 * t117 * t33 * t21 * (t299 + t300) * t295 * t293 * t292
    t310 = -psih + psil + t1
    t311 = cos(t310)
    contr[18] = 3/2 * t117 * t33 * t21 * t311 * (-t299 + t300) * t293 * t292
    t316 = t89 * IMy
    t317 = t79 - t81 + t83
    t320 = 2 * t91 * t317 * t316
    t321 = t53 + t56 - t57
    t323 = t94 * t321 * IMx
    t328 = psih - psil + t1
    t329 = cos(t328)
    contr[19] = -3/2 * t117 * t33 * t21 * t329 * t107 * t77 * pi * (-t320 + t323)
    t339 = psih + psil + t1
    t340 = cos(t339)
    contr[20] = 3/2 * t117 * t33 * t21 * t340 * t107 * t77 * pi * (t320 + t323)
    t345 = -t48 - psih + t1
    t346 = cos(t345)
    t350 = cpa1EQ * t10 * t62
    t353 = t27 * pi * t21
    t354 = t73 * t353
    contr[21] = -3/4 * t354 * t350 * t6 * IMz * t346
    t357 = -t48 + psih + t1
    t358 = cos(t357)
    t362 = t62 * t6 * IMz
    contr[22] = -3/4 * t74 * t362 * t21 * t321 * t358
    t366 = t48 - psih + t1
    t367 = cos(t366)
    contr[23] = 3/4 * t354 * t350 * t6 * IMz * t367
    t372 = t48 + psih + t1
    t373 = cos(t372)
    contr[24] = 3/4 * t74 * t362 * t21 * t321 * t373
    t379 = sin(psig)
    t383 = cpa3EQ * (-t18 - t19 + 1) + t141 - t96
    t385 = t11 * t6
    contr[25] = t38 * t353 * t385 * t383 * t10 * t379 * IMz * muM
    t389 = sin(t2)
    t393 = t200 * pi * t385
    t396 = t27 * t10 * t21
    t397 = t38 * t396
    contr[26] = -3/2 * t397 * t393 * muM * IMz * t389
    t400 = sin(t41)
    contr[27] = 3/2 * t397 * t393 * muM * IMz * t400
    t410 = t6 * t23 * t62 * t11 * pi * t383 * IMz
    t412 = sin(psig - t48)
    t414 = t26 * t21
    contr[28] = t187 * t33 / t181 * t414 * t412 * t10 * t410
    t423 = sin(psig + t48)
    contr[29] = t282 * t414 * t423 * t10 * t410
    t427 = sin(t49)
    t428 = 2 * t79
    t430 = t80 + t428 - t82 + 4 * t84 + cpa2EQ
    contr[30] = t74 * t362 * t21 * t430 * t427 / 4
    t436 = t91 * t101 * t316
    t439 = 2 * t94 * t87 * IMx
    t444 = sin(t109)
    contr[31] = t117 * t33 * t21 * t444 * muM * (t436 + t439) * t23 * t292 / 2
    t452 = sin(t122)
    contr[32] = t117 * t33 * t21 * t452 * t107 * (t436 - t439) * t78 / 2
    t457 = sin(t127)
    contr[33] = -t74 * t362 * t21 * t430 * t457 / 4
    t467 = t77 * t23 * t136 * pi * t383 * IMx
    t468 = sin(t133)
    contr[34] = -t153 * t33 / t226 * t414 * t468 * t10 * t467
    t476 = sin(t156)
    contr[35] = t167 * t33 / t198 * t414 * t476 * t10 * t467
    t483 = sin(t171)
    t487 = t188 * t396
    contr[36] = -3/2 * t487 * t393 * t62 * IMz * t483
    t490 = sin(t191)
    contr[37] = 3/2 * t487 * t393 * t62 * IMz * t490
    t495 = t91 * t204
    t496 = t495 * t199
    t497 = t200 * t203
    t500 = sin(t208)
    contr[38] = -3/2 * t223 * t500 * t77 * t170 * (-t496 + t497) * t65
    t506 = t495 * t227
    t507 = t200 * t229
    t510 = sin(t234)
    contr[39] = -3/2 * t244 * t510 * t77 * t170 * (-t506 + t507) * t65
    t516 = t23 * t65
    t517 = t77 * t11
    t518 = sin(t250)
    contr[40] = 3/2 * t244 * (t506 + t507) * t518 * t517 * t516
    t524 = sin(t259)
    contr[41] = 3/2 * t222 * t26 * t21 * (t496 + t497) * muM * t524 * t517 * t516
    t533 = sin(t265)
    t537 = t282 * t396
    contr[42] = -3/2 * t537 * t393 * t62 * IMz * t533
    t540 = sin(t285)
    contr[43] = 3/2 * t537 * t393 * t62 * IMz * t540
    t546 = t92 * IMy * cpa1EQ
    t547 = cpa2EQ * t95
    t551 = sin(t294)
    contr[44] = -3/2 * t117 * t33 * t21 * t551 * t107 * (-t546 + t547) * t78
    t560 = sin(t310)
    contr[45] = 3/2 * t117 * t33 * t21 * t560 * t107 * (t546 + t547) * t78
    t567 = t91 * t321 * t316 / 2
    t568 = t317 * t95
    t573 = sin(t328)
    contr[46] = 3 * t117 * t33 * t21 * t573 * muM * (t567 + t568) * t23 * t292
    t581 = sin(t339)
    contr[47] = -3 * t117 * t33 * t21 * t581 * (-t567 + t568) * t293 * t292
    t588 = IMz * t21 * cpa2EQ
    t589 = sin(t345)
    t594 = t73 * t179 * t293
    contr[48] = -3/4 * t594 * t6 * t589 * t269 * t588
    t597 = sin(t357)
    t600 = t6 * q
    t603 = (t80 - t428 - t82) * muM * t600
    t605 = t73 * t396
    contr[49] = -3/4 * t605 * t603 * pi * t597 * IMz
    t608 = sin(t366)
    contr[50] = 3/4 * t594 * t600 * pi * t608 * t588
    t614 = sin(t372)
    contr[51] = 3/4 * t605 * t603 * t614 * pi * IMz

    
    der_Jg = sum(contr);
    return der_Jg;
end

function derivativechiM2_JhP1(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)

    contr = zeros(71);
    t1 = sqrt(q)
    t2 = cos(psil)
    t6 = sqrt(1 + k)
    t9 = sqrt(k + m)
    t10 = 0.1e1 / t9
    t14 = Q1 ^ 2
    t15 = Q2 ^ 2
    t18 = Q1 * cpa1EQ
    t19 = Q2 * cpa2EQ
    t22 = 1 / (t14 + t15 + 1)
    t24 = 0.1e1 / KK
    t25 = t24 * t22 * (cpa3EQ * (-t14 - t15 + 1) + t18 - t19)
    t26 = q - 1
    t28 = rc ^ 2
    t30 = 0.1e1 / t28 / rc
    t32 = 0.1e1 / npsil
    t33 = 0.1e1 / Jg
    t34 = t33 * t32
    contr[1] = 2 * t34 * t30 / t26 * t25 * t10 * muM * t6 * pi * IMy * t2 * t1
    t38 = muM * IMz
    t39 = sqrt(k)
    t40 = t39 * t38
    t41 = pi * t10
    t42 = exp(sigma)
    t43 = cpa1EQ * t14
    t44 = Q1 * Q2
    t46 = 2 * cpa2EQ * t44
    t47 = cpa1EQ * t15
    t50 = 4 * Q1 * cpa3EQ - cpa1EQ + t43 - t46 - t47
    t53 = t50 * t42 * t41 * t40
    t54 = -psih + psig
    t55 = cos(t54)
    t59 = exp(2 * sigma)
    t65 = t33 / npsig * t24 / (t59 - 1)
    contr[2] = -t65 * t30 * t55 * t22 * t53 / 4
    t69 = psih + psig
    t70 = cos(t69)
    contr[3] = t65 * t30 * t70 * t22 * t53 / 4
    t75 = pi * IMz
    t78 = Q1 * cpa2EQ - Q2 * cpa1EQ
    t80 = q * t22
    t83 = t39 * t10 * t80 * t78 * t75
    t85 = -2 * psil + 2 * TL
    t86 = cos(t85)
    t89 = q ^ 2
    t93 = t34 / (t89 + 1) * t24
    contr[4] = -3/2 * t93 * t30 * t86 * muM * t83
    t97 = t1 * pi
    t98 = 2 * TL
    t99 = -psil + t98
    t100 = cos(t99)
    t102 = 1 + q
    t103 = t102 * IMy
    t104 = t18 + t19
    t106 = t6 * t104 * t103
    t107 = t26 * IMx
    t108 = -t78
    t109 = t108 * t107
    t120 = t33 / (t89 - 1) * t32 * t30 * t24 * t22
    contr[5] = 3 * t120 * t10 * muM * (t106 + t109) * t100 * t97
    t125 = psil + t98
    t126 = cos(t125)
    contr[6] = -3 * t120 * t10 * muM * t126 * t1 * pi * (-t106 + t109)
    t133 = 2 * psil + 2 * TL
    t134 = cos(t133)
    contr[7] = 3/2 * t93 * t30 * t134 * muM * t83
    t139 = t22 * cpa1EQ
    t141 = t41 * t139 * t40
    t142 = -psig - psih + t98
    t143 = cos(t142)
    contr[8] = -3/4 * t65 * t30 * t143 * t42 * t141
    t149 = t43 + t46 - t47
    t150 = t22 * t149
    t152 = t41 * t150 * t40
    t153 = -psig + psih + t98
    t154 = cos(t153)
    contr[9] = -3/4 * t65 * t30 * t154 * t42 * t152
    t160 = psig - psih + t98
    t161 = cos(t160)
    contr[10] = 3/4 * t65 * t30 * t161 * t42 * t141
    t166 = psig + psih + t98
    t167 = cos(t166)
    contr[11] = 3/4 * t65 * t30 * t167 * t42 * t152
    t172 = q * t38
    t173 = t39 * t42
    t176 = pi * t50 * t173 * t172
    t177 = 2 * psil
    t178 = -psih + psig - t177
    t179 = cos(t178)
    t181 = t30 * t10
    t186 = 2 * npsil
    t190 = t33 / (-t186 + npsig) * t24 / (-t89 + t59)
    contr[12] = -t190 * t181 * t22 * t179 * t176 / 4
    t194 = q - t59
    t195 = t194 * IMy
    t196 = cpa1EQ * t44
    t197 = cpa2EQ * t14
    t198 = t197 / 2
    t199 = cpa2EQ * t15
    t200 = t199 / 2
    t201 = Q2 * cpa3EQ
    t204 = t196 + t198 - t200 + 2 * t201 + cpa2EQ / 2
    t205 = t6 * t204
    t206 = t205 * t195
    t207 = t59 + q
    t208 = t207 * IMx
    t213 = t43 + Q1 * (-2 * t19 + 4 * cpa3EQ) - t47 - cpa1EQ
    t215 = t213 * t208 / 2
    t220 = t1 * t42 * muM
    t222 = -psih + psig - psil
    t223 = cos(t222)
    t230 = exp(4 * sigma)
    t234 = t33 / (t89 - t230) / (-npsil + npsig) * t24
    contr[13] = t234 * t30 * t22 * t223 * t220 * pi * t10 * (t206 + t215) / 2
    t237 = q * t59
    t238 = t237 - 1
    t239 = IMy * t238
    t240 = t205 * t239
    t241 = 1 + t237
    t242 = t241 * IMx
    t244 = t213 * t242 / 2
    t249 = -psih + psig + psil
    t250 = cos(t249)
    t260 = t33 / (t89 * t230 - 1) / (npsil + npsig) * t24
    contr[14] = t260 * t30 * t22 * t250 * t220 * pi * (t240 - t244) * t10 / 2
    t265 = t22 * t50 * t173 * t172
    t266 = -psih + psig + t177
    t267 = cos(t266)
    t277 = t33 / (t186 + npsig) * t24 / (t89 * t59 - 1)
    contr[15] = -t277 * t30 * t267 * t41 * t265 / 4
    t281 = psih + psig - t177
    t282 = cos(t281)
    contr[16] = t190 * t181 * t22 * t282 * t176 / 4
    t290 = psih + psig - psil
    t291 = cos(t290)
    contr[17] = t234 * t30 * t22 * t291 * t220 * (t206 - t215) * t41 / 2
    t296 = muM * t41
    t297 = t1 * t42
    t298 = psih + psig + psil
    t299 = cos(t298)
    contr[18] = t260 * t30 * t22 * (t240 + t244) * t299 * t297 * t296 / 2
    t307 = psih + psig + t177
    t308 = cos(t307)
    contr[19] = t277 * t30 * t308 * t41 * t265 / 4
    t314 = t139 * t173 * t172
    t315 = -psig - t177 - psih + t98
    t316 = cos(t315)
    contr[20] = -3/4 * t277 * t30 * t316 * t41 * t314
    t322 = psig + t177 - psih + t98
    t323 = cos(t322)
    contr[21] = 3/4 * t277 * t30 * t323 * t41 * t314
    t330 = cpa1EQ * pi * t173 * t172
    t331 = -psih + t98 - psig + t177
    t332 = cos(t331)
    contr[22] = -3/4 * t190 * t181 * t22 * t332 * t330
    t338 = -psih + t98 + psig - t177
    t339 = cos(t338)
    contr[23] = 3/4 * t190 * t181 * t22 * t339 * t330
    t345 = muM * q
    t347 = t173 * t345 * IMz * t150
    t348 = psih + t98 - psig - t177
    t349 = cos(t348)
    contr[24] = -3/4 * t277 * t30 * t349 * t41 * t347
    t359 = pi * t39 * t42 * q
    t360 = t359 * muM * IMz * t149
    t361 = psih + t98 - psig + t177
    t362 = cos(t361)
    contr[25] = -3/4 * t190 * t181 * t22 * t362 * t360
    t368 = psih + t98 + psig - t177
    t369 = cos(t368)
    contr[26] = 3/4 * t190 * t181 * t22 * t369 * t360
    t374 = psih + t98 + psig + t177
    t375 = cos(t374)
    contr[27] = 3/4 * t277 * t30 * t375 * t41 * t347
    t380 = t42 * t41
    t381 = IMy * cpa2EQ
    t382 = t6 * t238
    t383 = t382 * t381
    t384 = IMx * cpa1EQ
    t385 = t241 * t384
    t388 = -psil - psig - psih + t98
    t389 = cos(t388)
    t393 = t30 * t22 * muM
    t394 = t260 * t393
    contr[28] = -3/4 * t394 * t389 * (t383 + t385) * t1 * t380
    t397 = t196 - t198 + t200
    t399 = t6 * IMy
    t401 = 2 * t399 * t238 * t397
    t402 = t149 * t242
    t405 = -psil - psig + psih + t98
    t406 = cos(t405)
    contr[29] = -3/4 * t394 * t406 * t297 * (-t401 + t402) * t41
    t411 = t6 * t194
    t412 = t411 * t381
    t413 = t207 * t384
    t416 = -psil + psig - psih + t98
    t417 = cos(t416)
    t420 = t234 * t393
    contr[30] = -3/4 * t420 * t417 * t297 * (t412 + t413) * t41
    t423 = -psil + psig + psih + t98
    t424 = cos(t423)
    t430 = 2 * t399 * t194 * t397
    t431 = t149 * t208
    contr[31] = -3/4 * t234 * t30 * t22 * (-t430 + t431) * muM * t424 * t1 * t380
    t438 = psil - psig - psih + t98
    t439 = cos(t438)
    contr[32] = 3/4 * t234 * t30 * t22 * (-t412 + t413) * muM * t439 * t1 * t380
    t450 = psil - psig + psih + t98
    t451 = cos(t450)
    contr[33] = 3/4 * t420 * t451 * t297 * (t430 + t431) * t41
    t458 = psil + psig - psih + t98
    t459 = cos(t458)
    contr[34] = 3/4 * t394 * t459 * t297 * pi * (-t383 + t385) * t10
    t466 = psil + psig + psih + t98
    t467 = cos(t466)
    contr[35] = 3/4 * t394 * t467 * t297 * pi * (t401 + t402) * t10
    t471 = sin(psil)
    contr[36] = -2 * t34 * t30 / t102 * t25 * t296 * IMx * t471 * t1
    t486 = muM * t39
    t490 = sin(t177)
    contr[37] = t93 * t30 * t490 * pi * t10 * q * t486 * t22 * (cpa3EQ * t14 + cpa3EQ * t15 - cpa3EQ - t18 + t19) * IMz
    t494 = 2 * t196
    t496 = t197 + t494 - t199 + 4 * t201 + cpa2EQ
    t500 = t10 * t22 * t496 * pi * t40
    t501 = sin(t54)
    contr[38] = -t65 * t30 * t501 * t42 * t500 / 4
    t507 = sin(t69)
    contr[39] = -t65 * t30 * t507 * t42 * t500 / 4
    t516 = t22 * t104 * pi * q * t40
    t517 = sin(t85)
    contr[40] = 3/2 * t93 * t30 * t517 * t10 * t516
    t523 = t6 * t108 * t103
    t524 = t104 * t107
    t527 = sin(t99)
    contr[41] = 3 * t120 * t10 * muM * t527 * (-t523 + t524) * t97
    t535 = sin(t125)
    contr[42] = -3 * t120 * t10 * muM * t535 * t1 * pi * (t523 + t524)
    t541 = sin(t133)
    contr[43] = -3/2 * t93 * t30 * t541 * t10 * t516
    t548 = t39 * t22 * cpa2EQ
    t549 = sin(t142)
    t554 = t65 * t30 * t41
    contr[44] = -3/4 * t554 * t42 * t549 * t38 * t548
    t557 = t197 - t494 - t199
    t559 = t39 * t22
    t562 = t42 * pi * t559 * t557 * t38
    t563 = sin(t153)
    contr[45] = -3/4 * t65 * t30 * t563 * t10 * t562
    t569 = sin(t160)
    t571 = t42 * IMz
    contr[46] = 3/4 * t554 * t571 * muM * t569 * t548
    t575 = sin(t166)
    contr[47] = 3/4 * t65 * t30 * t575 * t10 * t562
    t580 = t496 * t38
    t581 = t359 * t580
    t582 = sin(t178)
    contr[48] = -t190 * t181 * t22 * t582 * t581 / 4
    t588 = sin(t222)
    t591 = t6 * t213
    t592 = t591 * t195
    t595 = 2 * t207 * t204 * IMx
    contr[49] = -t234 * t30 * t22 * (t592 - t595) * t588 * t297 * t296 / 4
    t602 = t591 * t239
    t604 = 2 * t204 * t242
    t608 = sin(t249)
    contr[50] = -t260 * t30 * t22 * t608 * t220 * (t602 + t604) * t41 / 4
    t615 = t173 * t80 * t580
    t616 = sin(t266)
    contr[51] = -t277 * t30 * t616 * t41 * t615 / 4
    t622 = sin(t281)
    contr[52] = -t190 * t181 * t22 * t622 * t581 / 4
    t628 = sin(t290)
    contr[53] = t234 * t30 * t22 * (t592 + t595) * t628 * t297 * t296 / 4
    t639 = sin(t298)
    contr[54] = t260 * t30 * t22 * t639 * t220 * (t602 - t604) * t41 / 4
    t644 = sin(t307)
    contr[55] = -t277 * t30 * t644 * t41 * t615 / 4
    t650 = cpa2EQ * t42
    t651 = t22 * t650
    t652 = sin(t315)
    t657 = t277 * t181 * t486
    contr[56] = -3/4 * t657 * q * t652 * t75 * t651
    t660 = sin(t322)
    contr[57] = 3/4 * t657 * t660 * q * t75 * t651
    t665 = IMz * t650
    t666 = sin(t331)
    t670 = t181 * t559
    t671 = t190 * t670
    contr[58] = -3/4 * t671 * t345 * t666 * pi * t665
    t674 = sin(t338)
    contr[59] = 3/4 * t671 * t345 * t674 * pi * t665
    t679 = pi * t571
    t680 = sin(t348)
    t682 = t557 * muM
    t685 = t277 * t670
    contr[60] = -3/4 * t685 * t682 * q * t680 * t679
    t688 = sin(t361)
    contr[61] = -3/4 * t671 * t682 * t688 * q * t679
    t694 = sin(t368)
    contr[62] = 3/4 * t671 * t682 * q * t694 * t679
    t699 = sin(t374)
    contr[63] = 3/4 * t685 * t557 * t699 * t345 * t679
    t704 = IMy * cpa1EQ
    t705 = t382 * t704
    t706 = IMx * cpa2EQ
    t707 = t241 * t706
    t711 = sin(t388)
    contr[64] = -3/4 * t394 * t711 * t297 * pi * (-t705 + t707) * t10
    t716 = t6 * t149
    t718 = t716 * t239 / 2
    t719 = IMx * t397
    t720 = t241 * t719
    t723 = sin(t405)
    contr[65] = 3/2 * t394 * t723 * t297 * (t718 + t720) * t41
    t727 = t411 * t704
    t728 = t207 * t706
    t731 = sin(t416)
    contr[66] = -3/4 * t420 * t731 * t297 * (-t727 + t728) * t41
    t737 = t716 * t195 / 2
    t738 = t207 * t719
    t741 = sin(t423)
    contr[67] = 3/2 * t420 * t741 * t297 * (t737 + t738) * t41
    t747 = sin(t438)
    contr[68] = 3/4 * t420 * t747 * (t727 + t728) * t1 * t380
    t754 = sin(t450)
    contr[69] = -3/2 * t420 * t754 * t297 * pi * (-t737 + t738) * t10
    t759 = sin(t458)
    contr[70] = 3/4 * t260 * t30 * t22 * (t705 + t707) * muM * t759 * t1 * t380
    t771 = sin(t466)
    contr[71] = -3/2 * t394 * t771 * t297 * pi * (-t718 + t720) * t10

    der_Jh = sum(contr);
    return der_Jh;
end

function derivativechiM2_JhP2(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)
    contr = zeros(51);
    t1 = muM * IMz
    t2 = sqrt(k)
    t3 = t2 * t1
    t5 = sqrt(k + m)
    t6 = 0.1e1 / t5
    t7 = t6 * pi
    t8 = exp(sigma)
    t11 = Q1 * cpa2EQ - Q2 * cpa1EQ
    t14 = t11 * t8 * t7 * t3
    t15 = Q1 ^ 2
    t16 = Q2 ^ 2
    t18 = 1 / (t15 + t16 + 1)
    t19 = cdelta * t18
    t20 = 2 * TL
    t21 = -psig + t20
    t22 = cos(t21)
    t23 = rc ^ 2
    t25 = 0.1e1 / t23 / rc
    t29 = exp(2 * sigma)
    t32 = 0.1e1 / KK
    t35 = 0.1e1 / Jg
    t37 = t35 / npsig * t32 / (t29 - 1)
    contr[1] = -3/2 * t37 * t25 * t22 * t19 * t14
    t41 = psig + t20
    t42 = cos(t41)
    contr[2] = 3/2 * t37 * t25 * t42 * t19 * t14
    t48 = cpa1EQ * t15
    t49 = Q1 * Q2
    t51 = 2 * cpa2EQ * t49
    t52 = cpa1EQ * t16
    t57 = muM * t18
    t58 = t6 * q
    t60 = t58 * t57 * (4 * Q1 * cpa3EQ - cpa1EQ + t48 - t51 - t52) * t2 * IMz
    t61 = pi * cdelta
    t62 = 2 * psil
    t63 = psih - t62
    t64 = cos(t63)
    t67 = q ^ 2
    t71 = 0.1e1 / npsil
    t73 = t35 * t71 / (t67 + 1) * t32
    contr[3] = t73 * t25 * t64 * t61 * t60 / 4
    t76 = sqrt(q)
    t77 = t76 * pi
    t78 = t6 * t77
    t79 = muM * cdelta
    t80 = psih - psil
    t81 = cos(t80)
    t84 = cpa1EQ * t49
    t85 = cpa2EQ * t15
    t86 = t85 / 2
    t87 = cpa2EQ * t16
    t88 = t87 / 2
    t89 = Q2 * cpa3EQ
    t92 = t84 + t86 - t88 + 2 * t89 + cpa2EQ / 2
    t94 = 1 + q
    t96 = sqrt(1 + k)
    t97 = t96 * t94
    t98 = t97 * t92 * IMy
    t99 = q - 1
    t100 = t99 * IMx
    t101 = Q2 * cpa2EQ
    t106 = t48 + Q1 * (-2 * t101 + 4 * cpa3EQ) - t52 - cpa1EQ
    t108 = t106 * t100 / 2
    t116 = t35 / (t67 - 1) * t71 * t25
    contr[4] = -t116 * t32 * t18 * (t98 - t108) * t81 * t79 * t78
    t122 = cdelta * t6
    t123 = muM * t122
    t125 = psih + psil
    t126 = cos(t125)
    contr[5] = -t116 * t32 * t18 * t126 * t123 * t76 * pi * (t98 + t108)
    t131 = psih + t62
    t132 = cos(t131)
    contr[6] = -t73 * t25 * t132 * t61 * t60 / 4
    t140 = Q1 * cpa1EQ
    t141 = cpa3EQ * (-t15 - t16 + 1) + t140 - t101
    t143 = t8 * pi
    t144 = t143 * t141 * IMy
    t145 = t96 * muM
    t146 = -psil + psig
    t147 = cos(t146)
    t151 = t6 * t76
    t152 = t25 * t18
    t153 = t152 * t151
    t154 = t29 + q
    t158 = 0.1e1 / (-npsil + npsig)
    t159 = t35 * t158
    contr[7] = t159 * t32 / t154 * t153 * t147 * cdelta * t145 * t144
    t162 = psil + psig
    t163 = cos(t162)
    t167 = q * t29
    t168 = 1 + t167
    t172 = 0.1e1 / (npsil + npsig)
    t173 = t35 * t172
    contr[8] = t173 * t32 / t168 * t153 * t163 * cdelta * t145 * t144
    t176 = t8 * cdelta
    t177 = t20 - psig + t62
    t178 = cos(t177)
    t182 = q * muM
    t183 = t182 * pi * t11
    t186 = t25 * t6
    t188 = -t67 + t29
    t191 = 2 * npsil
    t194 = t35 / (-t191 + npsig)
    t195 = t194 * t32 / t188
    t196 = t195 * t186 * t18 * t2
    contr[9] = -3/2 * t196 * t183 * IMz * t178 * t176
    t199 = t20 + psig - t62
    t200 = cos(t199)
    contr[10] = 3/2 * t196 * t183 * IMz * t200 * t176
    t205 = t167 - 1
    t206 = t205 * IMy
    t207 = t140 + t101
    t208 = t96 * t207
    t209 = t208 * t206
    t210 = t168 * IMx
    t211 = -t11
    t212 = t211 * t210
    t215 = t20 - psil - psig
    t216 = cos(t215)
    t220 = t25 * t57
    t223 = exp(4 * sigma)
    t228 = t35 / (t67 * t223 - 1) * t172 * t32
    t229 = t228 * t220
    contr[11] = 3/2 * t229 * t216 * t76 * t176 * (t209 + t212) * t7
    t231 = q - t29
    t232 = t231 * IMy
    t233 = t208 * t232
    t234 = t154 * IMx
    t235 = t211 * t234
    t239 = t20 - psil + psig
    t240 = cos(t239)
    t249 = t35 / (t67 - t223) * t158 * t32 * t220
    contr[12] = 3/2 * t249 * t240 * t76 * t176 * pi * (t233 + t235) * t6
    t254 = t20 + psil - psig
    t255 = cos(t254)
    contr[13] = -3/2 * t249 * t255 * t76 * t176 * pi * (-t233 + t235) * t6
    t264 = t20 + psil + psig
    t265 = cos(t264)
    contr[14] = -3/2 * t229 * t265 * t76 * t176 * pi * (-t209 + t212) * t6
    t271 = -psig - t62 + t20
    t272 = cos(t271)
    t276 = pi * q
    t277 = t276 * t18 * t11
    t289 = t35 / (t191 + npsig) * t32 / (t67 * t29 - 1)
    t290 = t289 * t25 * t2 * muM * t6
    contr[15] = -3/2 * t290 * t277 * IMz * t272 * t176
    t293 = psig + t62 + t20
    t294 = cos(t293)
    contr[16] = 3/2 * t290 * t277 * IMz * t294 * t176
    t300 = t97 * IMy * cpa2EQ
    t301 = cpa1EQ * t100
    t306 = -psih - psil + t20
    t307 = cos(t306)
    contr[17] = 3/2 * t116 * t32 * t18 * t307 * t123 * t76 * pi * (t300 + t301)
    t315 = -psih + psil + t20
    t316 = cos(t315)
    contr[18] = -3/2 * t116 * t32 * t18 * t316 * (-t300 + t301) * t79 * t78
    t322 = t94 * IMy
    t323 = t84 - t86 + t88
    t326 = 2 * t96 * t323 * t322
    t327 = t48 + t51 - t52
    t329 = t99 * t327 * IMx
    t334 = psih - psil + t20
    t335 = cos(t334)
    contr[19] = 3/2 * t116 * t32 * t18 * t335 * t123 * t76 * pi * (-t326 + t329)
    t344 = psih + psil + t20
    t345 = cos(t344)
    contr[20] = -3/2 * t116 * t32 * t18 * t345 * t123 * t76 * pi * (t326 + t329)
    t353 = t18 * cpa1EQ * t58 * t3
    t354 = -t62 - psih + t20
    t355 = cos(t354)
    contr[21] = 3/4 * t73 * t25 * t355 * t61 * t353
    t362 = muM * t2
    t363 = t58 * t362
    t364 = t363 * IMz * t18 * t327
    t365 = -t62 + psih + t20
    t366 = cos(t365)
    contr[22] = 3/4 * t73 * t25 * t366 * t61 * t364
    t371 = t62 - psih + t20
    t372 = cos(t371)
    contr[23] = -3/4 * t73 * t25 * t372 * t61 * t353
    t378 = t62 + psih + t20
    t379 = cos(t378)
    contr[24] = -3/4 * t73 * t25 * t379 * t61 * t364
    t387 = cpa3EQ * t15 + cpa3EQ * t16 - cpa3EQ + t101 - t140
    t391 = sin(psig)
    contr[25] = t37 * t25 * t391 * t19 * t387 * t8 * t7 * t3
    t396 = t18 * t207 * t143
    t397 = t396 * t3
    t398 = sin(t21)
    contr[26] = 3/2 * t37 * t25 * t398 * t122 * t397
    t403 = sin(t41)
    contr[27] = -3/2 * t37 * t25 * t403 * t122 * t397
    t415 = sin(psig - t62)
    contr[28] = -t194 * t32 / t188 * t152 * t415 * t6 * t2 * cdelta * t182 * t143 * t141 * IMz
    t430 = sin(psig + t62)
    contr[29] = t289 * t25 * t430 * t61 * t6 * t2 * t8 * q * t57 * t387 * IMz
    t434 = 2 * t84
    t439 = t363 * IMz * t18 * (t85 + t434 - t87 + 4 * t89 + cpa2EQ)
    t440 = sin(t63)
    contr[30] = -t73 * t25 * t440 * t61 * t439 / 4
    t447 = t96 * t106 * t322
    t450 = 2 * t99 * t92 * IMx
    t455 = sin(t80)
    contr[31] = -t116 * t32 * t18 * t455 * muM * (t447 + t450) * cdelta * t78 / 2
    t465 = sin(t125)
    contr[32] = -t116 * t32 * t18 * t465 * t123 * t76 * pi * (t447 - t450) / 2
    t471 = sin(t131)
    contr[33] = t73 * t25 * t471 * t61 * t439 / 4
    t478 = muM * t8
    t482 = sin(t146)
    contr[34] = t159 * t32 / t231 * t152 * t482 * t6 * t76 * cdelta * t478 * pi * t141 * IMx
    t493 = sin(t162)
    contr[35] = t173 * t32 / t205 * t25 * t493 * t61 * t151 * t478 * t18 * t387 * IMx
    t500 = t2 * q
    t502 = t396 * t500 * t1
    t503 = sin(t177)
    contr[36] = 3/2 * t195 * t25 * t503 * t122 * t502
    t508 = sin(t199)
    contr[37] = -3/2 * t195 * t25 * t508 * t122 * t502
    t514 = t96 * t211
    t515 = t514 * t206
    t516 = t207 * t210
    t519 = sin(t215)
    contr[38] = 3/2 * t229 * t519 * t76 * t176 * (-t515 + t516) * t7
    t524 = t514 * t232
    t525 = t207 * t234
    t528 = sin(t239)
    contr[39] = 3/2 * t249 * t528 * t76 * t176 * (-t524 + t525) * t7
    t533 = cdelta * t7
    t534 = t76 * t8
    t535 = sin(t254)
    contr[40] = -3/2 * t249 * (t524 + t525) * t535 * t534 * t533
    t542 = sin(t264)
    contr[41] = -3/2 * t228 * t25 * t18 * (t515 + t516) * muM * t542 * t534 * t533
    t552 = sin(t271)
    contr[42] = 3/2 * t289 * t25 * t552 * t122 * t502
    t557 = sin(t293)
    contr[43] = -3/2 * t289 * t25 * t557 * t122 * t502
    t564 = t97 * IMy * cpa1EQ
    t565 = cpa2EQ * t100
    t569 = sin(t306)
    contr[44] = 3/2 * t116 * t32 * t18 * t569 * t123 * (-t564 + t565) * t77
    t577 = sin(t315)
    contr[45] = -3/2 * t116 * t32 * t18 * t577 * t123 * (t564 + t565) * t77
    t585 = t96 * t327 * t322 / 2
    t586 = t323 * t100
    t591 = sin(t334)
    contr[46] = -3 * t116 * t32 * t18 * t591 * muM * cdelta * (t585 + t586) * t78
    t600 = sin(t344)
    contr[47] = 3 * t116 * t32 * t18 * t600 * (-t585 + t586) * t79 * t78
    t606 = IMz * t18 * cpa2EQ
    t609 = sin(t354)
    contr[48] = 3/4 * t73 * t186 * cdelta * t609 * t362 * t276 * t606
    t614 = pi * IMz
    t616 = sin(t365)
    t619 = (t85 - t434 - t87) * muM
    t623 = t73 * t186 * t19
    contr[49] = 3/4 * t623 * t619 * t616 * t2 * q * t614
    t625 = sin(t371)
    contr[50] = -3/4 * t73 * t186 * t79 * t500 * t625 * pi * t606
    t633 = sin(t378)
    contr[51] = -3/4 * t623 * t619 * t500 * t633 * t614

    
    der_Jh = sum(contr);
    return der_Jh;
end

function derivativechiM2_psil(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)

    contr = zeros(105)
    t1 = sqrt(q)
    t2 = sin(psil)
    t6 = sqrt(1 + k)
    t7 = t6 * IMy
    t8 = Q1 ^ 2
    t9 = Q2 ^ 2
    t12 = Q1 * cpa1EQ
    t13 = Q2 * cpa2EQ
    t14 = cpa3EQ * (-t8 - t9 + 1) + t12 - t13
    t19 = sqrt(k + m)
    t20 = 0.1e1 / t19
    t21 = pi * t20
    t23 = 1 / (t8 + t9 + 1)
    t25 = 0.1e1 / KK
    t26 = q - 1
    t29 = rc ^ 2
    t31 = 0.1e1 / t29 / rc
    t32 = 0.1e1 / npsil
    t33 = t32 * t31
    contr[1] = -2 * t33 / t26 * t25 * t23 * t21 * cdelta * t14 * t7 * muM * t2 * t1
    t38 = sqrt(k)
    t39 = t38 * IMz
    t40 = cpa1EQ * t8
    t41 = Q1 * Q2
    t43 = 2 * cpa2EQ * t41
    t44 = cpa1EQ * t9
    t47 = 4 * Q1 * cpa3EQ - cpa1EQ + t40 - t43 - t44
    t50 = q * sdelta
    t52 = t50 * muM * t23 * t47 * t39
    t53 = 2 * psil
    t54 = psih - t53
    t55 = sin(t54)
    t57 = t25 * t31
    t58 = q ^ 2
    t62 = t32 / (t58 + 1) * t57
    contr[2] = -t62 * t55 * t21 * t52 / 2
    t66 = t1 * sdelta
    t67 = cpa1EQ * t41
    t68 = cpa2EQ * t8
    t69 = t68 / 2
    t70 = cpa2EQ * t9
    t71 = t70 / 2
    t72 = Q2 * cpa3EQ
    t75 = t67 + t69 - t71 + 2 * t72 + cpa2EQ / 2
    t77 = 1 + q
    t78 = t6 * t77
    t79 = t78 * t75 * IMy
    t80 = t26 * IMx
    t85 = t40 + Q1 * (-2 * t13 + 4 * cpa3EQ) - t44 - cpa1EQ
    t87 = t85 * t80 / 2
    t90 = psih - psil
    t91 = sin(t90)
    t95 = t23 * pi
    t100 = 0.1e1 / (t58 - 1) * t33 * t25 * t95
    contr[3] = t100 * t20 * muM * t91 * (t79 - t87) * t66
    t101 = psih + psil
    t102 = sin(t101)
    contr[4] = -t100 * t20 * (t79 + t87) * muM * t102 * t66
    t109 = psih + t53
    t110 = sin(t109)
    contr[5] = -t62 * t110 * t21 * t52 / 2
    t115 = muM * t39
    t119 = Q1 * cpa2EQ - Q2 * cpa1EQ
    t122 = t119 * t20 * q * cdelta * t115
    t124 = -2 * psil + 2 * TL
    t125 = sin(t124)
    contr[6] = -3 * t62 * t125 * t95 * t122
    t130 = t77 * IMy
    t131 = t12 + t13
    t132 = t6 * t131
    t133 = t132 * t130
    t134 = -t119
    t135 = t134 * t80
    t139 = 2 * TL
    t140 = -psil + t139
    t141 = sin(t140)
    contr[7] = 3 * t100 * t20 * cdelta * t141 * muM * t1 * (t133 + t135)
    t148 = exp(sigma)
    t149 = t1 * t148
    t157 = -psil + psig
    t158 = sin(t157)
    t162 = exp(2 * sigma)
    t163 = t162 + q
    t167 = 0.1e1 / (-npsil + npsig)
    t168 = t167 * t25
    contr[8] = t168 / t163 * t31 * t158 * pi * t6 * t23 * (cpa3EQ * t8 + cpa3EQ * t9 - cpa3EQ - t12 + t13) * t20 * t149 * IMy * sdelta * muM
    t171 = muM * t1
    t172 = psil + t139
    t173 = sin(t172)
    t175 = t20 * cdelta
    contr[9] = -3 * t100 * (t133 - t135) * t175 * t173 * t171
    t184 = t14 * t148
    t187 = psil + psig
    t188 = sin(t187)
    t191 = q * t162
    t192 = 1 + t191
    t196 = 0.1e1 / (npsil + npsig)
    t197 = t196 * t25
    contr[10] = t197 / t192 * t31 * t95 * t188 * t20 * t184 * sdelta * t6 * t1 * IMy * muM
    t201 = 2 * psil + 2 * TL
    t202 = sin(t201)
    contr[11] = -3 * t62 * t202 * t95 * t122
    t208 = IMz * sdelta * muM
    t209 = t148 * q
    t212 = t119 * t38 * t209 * t208
    t213 = t139 - psig + t53
    t214 = sin(t213)
    t217 = -t58 + t162
    t220 = 2 * npsil
    t223 = 1 / (-t220 + npsig) * t25
    t224 = t223 / t217 * t31
    contr[12] = -3 * t224 * t20 * t214 * t95 * t212
    t228 = t139 + psig - t53
    t229 = sin(t228)
    contr[13] = -3 * t224 * t20 * t229 * t95 * t212
    t235 = t191 - 1
    t236 = t235 * IMy
    t237 = t132 * t236
    t238 = t192 * IMx
    t239 = t134 * t238
    t241 = t139 - psil - psig
    t242 = sin(t241)
    t245 = muM * t148
    t246 = t20 * t245
    t249 = t23 * pi * t1
    t251 = exp(4 * sigma)
    t256 = 0.1e1 / (t58 * t251 - 1) * t196 * t57
    t257 = t256 * t249
    contr[14] = -3/2 * t257 * t246 * sdelta * t242 * (t237 + t239)
    t260 = t139 - psil + psig
    t261 = sin(t260)
    t264 = t20 * muM
    t265 = q - t162
    t266 = t265 * IMy
    t267 = t132 * t266
    t268 = t163 * IMx
    t269 = t134 * t268
    t276 = 0.1e1 / (t58 - t251) * t167 * t57
    t277 = t276 * t249
    contr[15] = -3/2 * t277 * (t267 + t269) * t264 * t148 * sdelta * t261
    t281 = t139 + psil - psig
    t282 = sin(t281)
    contr[16] = 3/2 * t277 * t246 * sdelta * t282 * (t267 - t269)
    t287 = t139 + psil + psig
    t288 = sin(t287)
    contr[17] = 3/2 * t257 * t246 * sdelta * (t237 - t239) * t288
    t294 = t20 * t23
    t295 = -psig - t53 + t139
    t296 = sin(t295)
    t306 = 1 / (t220 + npsig) * t25 / (t58 * t162 - 1) * t31
    contr[18] = 3 * t306 * t296 * pi * t294 * t212
    t309 = psig + t53 + t139
    t310 = sin(t309)
    contr[19] = 3 * t306 * t310 * pi * t294 * t212
    t315 = cdelta - 1
    t317 = muM * t315 * IMz
    t320 = t47 * t38 * t209 * t317
    t321 = -psih + psig - t53
    t322 = sin(t321)
    contr[20] = -t224 * t294 * t322 * pi * t320 / 2
    t328 = t315 * t20
    t329 = t6 * t75
    t330 = t329 * t266
    t332 = t85 * t268 / 2
    t335 = t1 * t245
    t337 = -psih + psig - psil
    t338 = sin(t337)
    contr[21] = t276 * t23 * pi * t338 * t335 * (t330 + t332) * t328 / 2
    t343 = t329 * t236
    t345 = t85 * t238 / 2
    t350 = -psih + psig + psil
    t351 = sin(t350)
    contr[22] = -t256 * t23 * pi * t351 * t335 * t315 * (t343 - t345) * t20 / 2
    t357 = -psih + psig + t53
    t358 = sin(t357)
    contr[23] = t306 * t358 * pi * t294 * t320 / 2
    t363 = IMy * cpa2EQ
    t364 = t78 * t363
    t365 = cpa1EQ * t80
    t368 = -psih - psil + t139
    t369 = sin(t368)
    contr[24] = -3/2 * t100 * t20 * t369 * muM * (t364 + t365) * t66
    t375 = muM * t66
    t376 = -psih + psil + t139
    t377 = sin(t376)
    contr[25] = 3/2 * t100 * (t364 - t365) * t20 * t377 * t375
    t383 = muM * IMz
    t384 = q * t383
    t385 = t38 * t148
    t386 = cdelta + 1
    t390 = psih + psig - t53
    t391 = sin(t390)
    contr[26] = t224 * t294 * t391 * pi * t47 * t386 * t385 * t384 / 2
    t396 = t386 * t20
    t400 = psih + psig - psil
    t401 = sin(t400)
    contr[27] = t276 * t23 * pi * t401 * t335 * (t330 - t332) * t396 / 2
    t409 = psih + psig + psil
    t410 = sin(t409)
    contr[28] = -t256 * t23 * pi * t410 * t335 * (t343 + t345) * t396 / 2
    t418 = muM * q
    t419 = t385 * t418
    t421 = psih + psig + t53
    t422 = sin(t421)
    contr[29] = -t306 * t422 * pi * t396 * t419 * t23 * t47 * IMz / 2
    t428 = t67 - t69 + t71
    t430 = t6 * t428 * t130
    t431 = t40 + t43 - t44
    t434 = t26 * t431 * IMx / 2
    t437 = psih - psil + t139
    t438 = sin(t437)
    contr[30] = 3 * t100 * t20 * t438 * muM * (t430 - t434) * t66
    t445 = psih + psil + t139
    t446 = sin(t445)
    contr[31] = -3 * t100 * t20 * t446 * muM * (t430 + t434) * t66
    t454 = cpa1EQ * t20 * t50 * t115
    t455 = -t53 - psih + t139
    t456 = sin(t455)
    contr[32] = -3/2 * t62 * t456 * t95 * t454
    t462 = IMz * t23 * t431
    t464 = t50 * muM * t38
    t465 = t464 * t462
    t466 = -t53 + psih + t139
    t467 = sin(t466)
    contr[33] = -3/2 * t62 * t467 * t21 * t465
    t472 = t53 - psih + t139
    t473 = sin(t472)
    contr[34] = -3/2 * t62 * t473 * t95 * t454
    t478 = t53 + psih + t139
    t479 = sin(t478)
    contr[35] = -3/2 * t62 * t479 * t21 * t465
    t486 = cpa1EQ * t386 * t385 * t384
    t487 = -psig - t53 - psih + t139
    t488 = sin(t487)
    contr[36] = -3/2 * t306 * t488 * pi * t294 * t486
    t496 = cpa1EQ * t38 * t209 * t317
    t497 = psig + t53 - psih + t139
    t498 = sin(t497)
    contr[37] = -3/2 * t306 * t498 * pi * t294 * t496
    t504 = -psih + t139 - psig + t53
    t505 = sin(t504)
    contr[38] = 3/2 * t224 * t294 * t505 * pi * t486
    t510 = -psih + t139 + psig - t53
    t511 = sin(t510)
    contr[39] = 3/2 * t224 * t294 * t511 * pi * t496
    t519 = t20 * t38
    t520 = psih + t139 - psig - t53
    t521 = sin(t520)
    contr[40] = -3/2 * t306 * t521 * pi * t519 * t209 * muM * t315 * t462
    t527 = IMz * t431
    t530 = psih + t139 - psig + t53
    t531 = sin(t530)
    contr[41] = 3/2 * t224 * t294 * t531 * pi * t419 * t315 * t527
    t540 = psih + t139 + psig - t53
    t541 = sin(t540)
    contr[42] = 3/2 * t224 * t294 * t541 * pi * t386 * t38 * t209 * muM * t527
    t547 = psih + t139 + psig + t53
    t548 = sin(t547)
    contr[43] = -3/2 * t306 * t548 * pi * t396 * t419 * t462
    t554 = t6 * t235
    t555 = t554 * t363
    t556 = IMx * cpa1EQ
    t557 = t192 * t556
    t562 = -psil - psig - psih + t139
    t563 = sin(t562)
    contr[44] = -3/4 * t256 * t23 * pi * t563 * t335 * t386 * (t555 + t557) * t20
    t570 = t7 * t235 * t428
    t572 = t431 * t238 / 2
    t576 = -psil - psig + psih + t139
    t577 = sin(t576)
    contr[45] = 3/2 * t256 * t23 * pi * t577 * t335 * (t570 - t572) * t328
    t582 = t6 * t265
    t583 = t582 * t363
    t584 = t163 * t556
    t589 = -psil + psig - psih + t139
    t590 = sin(t589)
    contr[46] = -3/4 * t276 * t23 * pi * t590 * t335 * t315 * (t583 + t584) * t20
    t597 = t7 * t265 * t428
    t599 = t431 * t268 / 2
    t604 = -psil + psig + psih + t139
    t605 = sin(t604)
    contr[47] = 3/2 * t276 * t23 * pi * t605 * t335 * t386 * t20 * (t597 - t599)
    t614 = psil - psig - psih + t139
    t615 = sin(t614)
    contr[48] = 3/4 * t276 * t23 * pi * t615 * t335 * t386 * (t583 - t584) * t20
    t623 = psil - psig + psih + t139
    t624 = sin(t623)
    contr[49] = -3/2 * t276 * t23 * pi * t624 * t335 * (t597 + t599) * t328
    t630 = muM * t328
    t631 = psil + psig - psih + t139
    t632 = sin(t631)
    contr[50] = 3/4 * t256 * t23 * pi * (t555 - t557) * t632 * t149 * t630
    t643 = psil + psig + psih + t139
    t644 = sin(t643)
    contr[51] = -3/2 * t256 * t23 * pi * t644 * t335 * (t570 + t572) * t396
    t650 = cos(psil)
    t657 = t23 * pi * cdelta
    contr[52] = -2 * t33 / t77 * t25 * t657 * t14 * t20 * IMx * muM * t650 * t1
    t664 = cos(t53)
    contr[53] = -2 * t62 * t657 * q * t14 * t20 * IMz * muM * t664 * t38
    t676 = t148 * t20 * t50 * t115
    t678 = cos(psig - t53)
    contr[54] = -2 * t223 / t217 * t31 * t95 * t678 * t14 * t676
    t688 = cos(psig + t53)
    contr[55] = 2 * t306 * t95 * t688 * t14 * t676
    t693 = 2 * t67
    t695 = t68 + t693 - t70 + 4 * t72 + cpa2EQ
    t696 = t23 * t695
    t698 = t464 * IMz * t696
    t699 = cos(t54)
    contr[56] = -t62 * t699 * t21 * t698 / 2
    t704 = t6 * t85
    t705 = t704 * t130
    t706 = t75 * IMx
    t708 = 2 * t26 * t706
    t712 = cos(t90)
    contr[57] = -t100 * t20 * muM * t712 * t1 * (t705 + t708) * sdelta / 2
    t720 = cos(t101)
    contr[58] = t100 * t20 * muM * t720 * (t705 - t708) * t66 / 2
    t725 = cos(t109)
    contr[59] = -t62 * t725 * t21 * t698 / 2
    t731 = pi * t38
    t734 = t131 * q * t731 * cdelta * t383
    t735 = cos(t124)
    contr[60] = -3 * t62 * t735 * t294 * t734
    t740 = t6 * t134
    t741 = t740 * t130
    t742 = t131 * t80
    t746 = cos(t140)
    contr[61] = 3 * t100 * t20 * cdelta * t746 * muM * t1 * (t741 - t742)
    t755 = t184 * t20 * sdelta * t1 * IMx * muM
    t756 = cos(t157)
    contr[62] = t168 / t265 * t31 * t23 * pi * t756 * t755
    t763 = cos(t172)
    contr[63] = -3 * t100 * (t741 + t742) * t175 * t763 * t171
    t770 = cos(t187)
    contr[64] = t197 / t235 * t31 * t23 * pi * t770 * t755
    t777 = cos(t201)
    contr[65] = -3 * t62 * t777 * t294 * t734
    t782 = t38 * q
    t785 = pi * t148 * t782 * t208
    t786 = t23 * t131
    t787 = cos(t213)
    contr[66] = -3 * t224 * t787 * t20 * t786 * t785
    t793 = cos(t228)
    contr[67] = -3 * t224 * t793 * t20 * t786 * t785
    t799 = cos(t241)
    t802 = t740 * t236
    t803 = t131 * t238
    contr[68] = -3/2 * t257 * (t802 - t803) * t264 * t148 * sdelta * t799
    t809 = cos(t260)
    t814 = t740 * t266
    t815 = t131 * t268
    contr[69] = -3/2 * t276 * t23 * pi * (t814 - t815) * t1 * t264 * t148 * sdelta * t809
    t822 = cos(t281)
    contr[70] = 3/2 * t277 * t246 * (t814 + t815) * sdelta * t822
    t828 = cos(t287)
    contr[71] = 3/2 * t257 * t246 * (t802 + t803) * sdelta * t828
    t834 = cos(t295)
    contr[72] = 3 * t306 * t834 * t20 * t786 * t785
    t839 = cos(t309)
    contr[73] = 3 * t306 * t839 * t20 * t786 * t785
    t845 = t385 * q * t695
    t847 = cos(t321)
    contr[74] = t224 * t294 * t847 * pi * t845 * t317 / 2
    t852 = t704 * t266
    t854 = 2 * t163 * t706
    t859 = cos(t337)
    contr[75] = t276 * t23 * pi * t859 * t335 * t315 * t20 * (t852 - t854) / 4
    t864 = cos(t350)
    t867 = t704 * t236
    t869 = 2 * t75 * t238
    contr[76] = -t256 * t23 * pi * (t867 + t869) * t864 * t149 * t630 / 4
    t876 = t209 * t696
    t878 = cos(t357)
    contr[77] = -t306 * t878 * pi * t519 * t876 * t317 / 2
    t884 = cos(t368)
    t886 = IMy * cpa1EQ
    t887 = t78 * t886
    t888 = cpa2EQ * t80
    contr[78] = -3/2 * t100 * (t887 - t888) * t20 * t884 * t375
    t897 = cos(t376)
    contr[79] = 3/2 * t100 * t20 * t897 * muM * t1 * sdelta * (t887 + t888)
    t902 = t386 * IMz
    t903 = muM * t902
    t905 = cos(t390)
    contr[80] = t224 * t294 * t905 * pi * t845 * t903 / 2
    t913 = cos(t400)
    contr[81] = -t276 * t23 * pi * t913 * t335 * (t852 + t854) * t396 / 4
    t922 = cos(t409)
    contr[82] = t256 * t23 * pi * t922 * t335 * (t867 - t869) * t396 / 4
    t928 = cos(t421)
    contr[83] = -t306 * t928 * pi * t519 * t876 * t903 / 2
    t934 = t6 * t431
    t935 = t934 * t130
    t937 = 2 * t428 * t80
    t941 = cos(t437)
    contr[84] = -3/2 * t100 * t20 * t941 * muM * t1 * sdelta * (t935 + t937)
    t947 = cos(t445)
    contr[85] = 3/2 * t100 * (t935 - t937) * t20 * t947 * t375
    t955 = cos(t455)
    t961 = t62 * t20 * pi * sdelta
    contr[86] = 3/2 * t961 * t383 * t955 * q * t38 * t23 * cpa2EQ
    t963 = t68 - t693 - t70
    t966 = t23 * t963 * t50 * t115
    t967 = cos(t466)
    contr[87] = 3/2 * t62 * t967 * t21 * t966
    t971 = cos(t472)
    contr[88] = 3/2 * t961 * t383 * t782 * t23 * cpa2EQ * t971
    t977 = cos(t478)
    contr[89] = 3/2 * t62 * t977 * t21 * t966
    t983 = t902 * t418
    t985 = cos(t487)
    contr[90] = 3/2 * t306 * t21 * t38 * t985 * t983 * t23 * cpa2EQ * t148
    t991 = cpa2EQ * t315 * t148
    t993 = cos(t497)
    contr[91] = 3/2 * t306 * t21 * t39 * muM * t993 * q * t23 * t991
    t1000 = cos(t504)
    t1005 = t224 * t294 * t731
    contr[92] = -3/2 * t1005 * t983 * cpa2EQ * t148 * t1000
    t1008 = cos(t510)
    contr[93] = -3/2 * t1005 * t1008 * IMz * t418 * t991
    t1015 = t963 * t38 * t209
    t1016 = t1015 * t317
    t1017 = cos(t520)
    contr[94] = 3/2 * t306 * t1017 * t20 * t95 * t1016
    t1022 = cos(t530)
    contr[95] = -3/2 * t224 * t294 * t1022 * pi * t1016
    t1028 = t1015 * t903
    t1029 = cos(t540)
    contr[96] = -3/2 * t224 * t294 * t1029 * pi * t1028
    t1035 = cos(t547)
    contr[97] = 3/2 * t306 * t1035 * t20 * t95 * t1028
    t1040 = muM * t396
    t1041 = cos(t562)
    t1044 = t554 * t886
    t1045 = IMx * cpa2EQ
    t1046 = t192 * t1045
    contr[98] = -3/4 * t256 * t23 * pi * (t1044 - t1046) * t1041 * t149 * t1040
    t1053 = t934 * t236
    t1054 = IMx * t428
    t1056 = 2 * t192 * t1054
    t1061 = cos(t576)
    contr[99] = -3/4 * t256 * t23 * pi * t1061 * t335 * t315 * (t1053 + t1056) * t20
    t1067 = t582 * t886
    t1068 = t163 * t1045
    t1072 = cos(t589)
    contr[100] = -3/4 * t276 * t23 * pi * t1072 * t335 * (t1067 - t1068) * t328
    t1078 = t934 * t266
    t1080 = 2 * t163 * t1054
    t1085 = cos(t604)
    contr[101] = -3/4 * t276 * t23 * pi * t1085 * t335 * t386 * (t1078 + t1080) * t20
    t1095 = cos(t614)
    contr[102] = 3/4 * t276 * t23 * pi * t1095 * t335 * t386 * t20 * (t1067 + t1068)
    t1103 = cos(t623)
    contr[103] = 3/4 * t276 * t23 * pi * t1103 * t335 * (t1078 - t1080) * t328
    t1112 = cos(t631)
    contr[104] = 3/4 * t256 * t23 * pi * t1112 * t335 * t315 * (t1044 + t1046) * t20
    t1121 = cos(t643)
    contr[105] = 3/4 * t256 * t23 * pi * t1121 * t1 * t148 * (t1053 - t1056) * t1040

   
    der_psil = sum(contr);
    return der_psil;
end

function derivativechiM2_psig(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)

    
    contr = zeros(87)
    t1 = muM * IMz
    t2 = sqrt(k)
    t3 = t2 * t1
    t4 = pi * sdelta
    t6 = sqrt(k + m)
    t7 = 0.1e1 / t6
    t8 = exp(sigma)
    t9 = t8 * t7
    t11 = t9 * t4 * t3
    t14 = Q1 * cpa2EQ - Q2 * cpa1EQ
    t15 = Q1 ^ 2
    t16 = Q2 ^ 2
    t18 = 1 / (t15 + t16 + 1)
    t19 = t18 * t14
    t20 = 2 * TL
    t21 = -psig + t20
    t22 = sin(t21)
    t24 = rc ^ 2
    t26 = 0.1e1 / t24 / rc
    t28 = exp(2 * sigma)
    t32 = 0.1e1 / KK
    t35 = 0.1e1 / npsig * t32 / (t28 - 1) * t26
    contr[1] = 3/2 * t35 * t22 * t19 * t11
    t38 = psig + t20
    t39 = sin(t38)
    contr[2] = 3/2 * t35 * t39 * t19 * t11
    t43 = cdelta - 1
    t45 = muM * t43 * IMz
    t46 = pi * t2
    t47 = t9 * t46
    t49 = cpa1EQ * t15
    t50 = Q1 * Q2
    t52 = 2 * cpa2EQ * t50
    t53 = cpa1EQ * t16
    t56 = 4 * Q1 * cpa3EQ - cpa1EQ + t49 - t52 - t53
    t57 = t18 * t56
    t58 = -psih + psig
    t59 = sin(t58)
    contr[3] = t35 * t59 * t57 * t47 * t45 / 4
    t63 = cdelta + 1
    t64 = t63 * t1
    t66 = psih + psig
    t67 = sin(t66)
    contr[4] = -t35 * t67 * t57 * t47 * t64 / 4
    t73 = sqrt(q)
    t76 = sqrt(1 + k)
    t80 = Q1 * cpa1EQ
    t81 = Q2 * cpa2EQ
    t82 = cpa3EQ * (-t15 - t16 + 1) + t80 - t81
    t83 = t82 * t8
    t85 = t83 * sdelta * t76 * t73 * IMy * muM
    t86 = -psil + psig
    t87 = sin(t86)
    t89 = t18 * pi
    t91 = t28 + q
    t95 = 0.1e1 / (-npsil + npsig)
    t96 = t95 * t32
    contr[5] = t96 / t91 * t26 * t89 * t87 * t7 * t85
    t99 = psil + psig
    t100 = sin(t99)
    t103 = q * t28
    t104 = 1 + t103
    t108 = 0.1e1 / (npsil + npsig)
    t109 = t108 * t32
    contr[6] = t109 / t104 * t26 * t89 * t100 * t7 * t85
    t113 = IMz * sdelta * muM
    t114 = t8 * q
    t117 = t14 * t2 * t114 * t113
    t118 = 2 * psil
    t119 = t20 - psig + t118
    t120 = sin(t119)
    t123 = q ^ 2
    t124 = -t123 + t28
    t127 = 2 * npsil
    t130 = 0.1e1 / (-t127 + npsig) * t32
    t131 = t130 / t124 * t26
    contr[7] = 3/2 * t131 * t7 * t120 * t89 * t117
    t134 = t20 + psig - t118
    t135 = sin(t134)
    contr[8] = 3/2 * t131 * t7 * t135 * t89 * t117
    t140 = t103 - 1
    t141 = t140 * IMy
    t142 = t80 + t81
    t143 = t76 * t142
    t144 = t143 * t141
    t145 = t104 * IMx
    t146 = -t14
    t147 = t146 * t145
    t149 = t20 - psil - psig
    t150 = sin(t149)
    t153 = muM * t8
    t154 = t7 * t153
    t157 = t18 * pi * t73
    t158 = t32 * t26
    t160 = exp(4 * sigma)
    t165 = 0.1e1 / (t123 * t160 - 1) * t108 * t158
    t166 = t165 * t157
    contr[9] = -3/2 * t166 * t154 * sdelta * t150 * (t144 + t147)
    t169 = t20 - psil + psig
    t170 = sin(t169)
    t173 = t7 * muM
    t174 = q - t28
    t175 = t174 * IMy
    t176 = t143 * t175
    t177 = t91 * IMx
    t178 = t146 * t177
    t185 = 0.1e1 / (t123 - t160) * t95 * t158
    t186 = t185 * t157
    contr[10] = 3/2 * t186 * (t176 + t178) * t173 * t8 * sdelta * t170
    t189 = t20 + psil - psig
    t190 = sin(t189)
    contr[11] = -3/2 * t186 * t154 * sdelta * t190 * (t176 - t178)
    t196 = t20 + psil + psig
    t197 = sin(t196)
    contr[12] = 3/2 * t166 * t154 * sdelta * (t144 - t147) * t197
    t203 = cpa1EQ * t2
    t204 = t89 * t203
    t206 = -psig - psih + t20
    t207 = sin(t206)
    contr[13] = -3/4 * t35 * t207 * t9 * t204 * t64
    t212 = t49 + t52 - t53
    t214 = t89 * t212 * t2
    t216 = -psig + psih + t20
    t217 = sin(t216)
    contr[14] = -3/4 * t35 * t217 * t9 * t214 * t45
    t222 = t7 * t18
    t223 = -psig - t118 + t20
    t224 = sin(t223)
    t234 = 0.1e1 / (t127 + npsig) * t32 / (t123 * t28 - 1) * t26
    contr[15] = 3/2 * t234 * t224 * pi * t222 * t117
    t238 = psig - psih + t20
    t239 = sin(t238)
    contr[16] = -3/4 * t35 * t239 * t9 * t204 * t45
    t245 = psig + psih + t20
    t246 = sin(t245)
    contr[17] = -3/4 * t35 * t246 * t9 * t214 * t64
    t251 = psig + t118 + t20
    t252 = sin(t251)
    contr[18] = 3/2 * t234 * t252 * pi * t222 * t117
    t259 = t56 * t2 * t114 * t45
    t260 = -psih + psig - t118
    t261 = sin(t260)
    contr[19] = t131 * t222 * t261 * pi * t259 / 4
    t266 = t43 * t7
    t267 = cpa1EQ * t50
    t268 = cpa2EQ * t15
    t269 = t268 / 2
    t270 = cpa2EQ * t16
    t271 = t270 / 2
    t272 = Q2 * cpa3EQ
    t275 = t267 + t269 - t271 + 2 * t272 + cpa2EQ / 2
    t276 = t76 * t275
    t277 = t276 * t175
    t282 = t49 + Q1 * (-2 * t81 + 4 * cpa3EQ) - t53 - cpa1EQ
    t284 = t282 * t177 / 2
    t287 = t73 * t153
    t289 = -psih + psig - psil
    t290 = sin(t289)
    contr[20] = -t185 * t18 * pi * t290 * t287 * (t277 + t284) * t266 / 2
    t296 = t276 * t141
    t298 = t282 * t145 / 2
    t303 = -psih + psig + psil
    t304 = sin(t303)
    contr[21] = -t165 * t18 * pi * t304 * t287 * t43 * (t296 - t298) * t7 / 2
    t310 = -psih + psig + t118
    t311 = sin(t310)
    contr[22] = t234 * t311 * pi * t222 * t259 / 4
    t316 = q * t1
    t317 = t2 * t8
    t321 = psih + psig - t118
    t322 = sin(t321)
    contr[23] = -t131 * t222 * t322 * pi * t56 * t63 * t317 * t316 / 4
    t328 = t63 * t7
    t332 = psih + psig - psil
    t333 = sin(t332)
    contr[24] = -t185 * t18 * pi * t333 * t287 * (t277 - t284) * t328 / 2
    t342 = psih + psig + psil
    t343 = sin(t342)
    contr[25] = -t165 * t18 * pi * t343 * t287 * (t296 + t298) * t328 / 2
    t351 = muM * q
    t352 = t317 * t351
    t354 = psih + psig + t118
    t355 = sin(t354)
    contr[26] = -t234 * t355 * pi * t328 * t352 * t18 * t56 * IMz / 4
    t363 = cpa1EQ * t63 * t317 * t316
    t364 = -psig - t118 - psih + t20
    t365 = sin(t364)
    contr[27] = -3/4 * t234 * t365 * pi * t222 * t363
    t372 = t203 * t114 * t45
    t373 = psig + t118 - psih + t20
    t374 = sin(t373)
    contr[28] = -3/4 * t234 * t374 * pi * t222 * t372
    t380 = -psih + t20 - psig + t118
    t381 = sin(t380)
    contr[29] = -3/4 * t131 * t222 * t381 * pi * t363
    t387 = -psih + t20 + psig - t118
    t388 = sin(t387)
    contr[30] = -3/4 * t131 * t222 * t388 * pi * t372
    t395 = IMz * t18 * t212
    t399 = t7 * t2
    t400 = psih + t20 - psig - t118
    t401 = sin(t400)
    contr[31] = -3/4 * t234 * t401 * pi * t399 * t114 * muM * t43 * t395
    t407 = IMz * t212
    t410 = psih + t20 - psig + t118
    t411 = sin(t410)
    contr[32] = -3/4 * t131 * t222 * t411 * pi * t352 * t43 * t407
    t421 = psih + t20 + psig - t118
    t422 = sin(t421)
    contr[33] = -3/4 * t131 * t222 * t422 * pi * t63 * t2 * t114 * muM * t407
    t429 = psih + t20 + psig + t118
    t430 = sin(t429)
    contr[34] = -3/4 * t234 * t430 * pi * t328 * t352 * t395
    t436 = IMy * cpa2EQ
    t437 = t76 * t140
    t438 = t437 * t436
    t439 = IMx * cpa1EQ
    t440 = t104 * t439
    t445 = -psil - psig - psih + t20
    t446 = sin(t445)
    contr[35] = -3/4 * t165 * t18 * pi * t446 * t287 * t63 * (t438 + t440) * t7
    t452 = t267 - t269 + t271
    t454 = t76 * IMy
    t455 = t454 * t140 * t452
    t457 = t212 * t145 / 2
    t461 = -psil - psig + psih + t20
    t462 = sin(t461)
    contr[36] = 3/2 * t165 * t18 * pi * t462 * t287 * (t455 - t457) * t266
    t467 = t76 * t174
    t468 = t467 * t436
    t469 = t91 * t439
    t474 = -psil + psig - psih + t20
    t475 = sin(t474)
    contr[37] = 3/4 * t185 * t18 * pi * t475 * t287 * t43 * (t468 + t469) * t7
    t481 = t454 * t174 * t452
    t483 = t212 * t177 / 2
    t488 = -psil + psig + psih + t20
    t489 = sin(t488)
    contr[38] = -3/2 * t185 * t18 * pi * t489 * t287 * t63 * t7 * (t481 - t483)
    t499 = psil - psig - psih + t20
    t500 = sin(t499)
    contr[39] = -3/4 * t185 * t18 * pi * t500 * t287 * t63 * (t468 - t469) * t7
    t509 = psil - psig + psih + t20
    t510 = sin(t509)
    contr[40] = 3/2 * t185 * t18 * pi * t510 * t287 * (t481 + t483) * t266
    t515 = muM * t266
    t516 = t73 * t8
    t517 = psil + psig - psih + t20
    t518 = sin(t517)
    contr[41] = 3/4 * t165 * t18 * pi * (t438 - t440) * t518 * t516 * t515
    t529 = psil + psig + psih + t20
    t530 = sin(t529)
    contr[42] = -3/2 * t165 * t18 * pi * t530 * t287 * (t455 + t457) * t328
    t537 = cos(psig)
    contr[43] = t35 * t18 * IMz * t7 * t4 * t153 * t537 * t2 * t82
    t546 = t142 * pi * t317 * t113
    t547 = cos(t21)
    contr[44] = 3/2 * t35 * t547 * t222 * t546
    t551 = cos(t38)
    contr[45] = 3/2 * t35 * t551 * t222 * t546
    t557 = t9 * q * sdelta * t3
    t559 = cos(psig - t118)
    contr[46] = t130 / t124 * t26 * t89 * t559 * t82 * t557
    t569 = cos(psig + t118)
    contr[47] = t234 * t89 * t569 * t82 * t557
    t573 = pi * t43
    t574 = 2 * t267
    t576 = t268 + t574 - t270 + 4 * t272 + cpa2EQ
    t577 = t18 * t576
    t580 = cos(t58)
    contr[48] = -t35 * t580 * t9 * t577 * t573 * t3 / 4
    t589 = cos(t66)
    contr[49] = -t35 * t589 * t63 * t8 * t222 * t576 * pi * t3 / 4
    t598 = t83 * t7 * sdelta * t73 * IMx * muM
    t599 = cos(t86)
    contr[50] = -t96 / t174 * t26 * t18 * pi * t599 * t598
    t607 = cos(t99)
    contr[51] = t109 / t140 * t26 * t18 * pi * t607 * t598
    t615 = pi * t8
    t617 = t615 * t2 * q * t113
    t618 = t18 * t142
    t619 = cos(t119)
    contr[52] = 3/2 * t131 * t619 * t7 * t618 * t617
    t624 = cos(t134)
    contr[53] = 3/2 * t131 * t624 * t7 * t618 * t617
    t629 = cos(t149)
    t632 = t76 * t146
    t633 = t632 * t141
    t634 = t142 * t145
    contr[54] = -3/2 * t166 * (t633 - t634) * t173 * t8 * sdelta * t629
    t640 = cos(t169)
    t645 = t632 * t175
    t646 = t142 * t177
    contr[55] = 3/2 * t185 * t18 * pi * (t645 - t646) * t73 * t173 * t8 * sdelta * t640
    t652 = cos(t189)
    contr[56] = -3/2 * t186 * t154 * (t645 + t646) * sdelta * t652
    t659 = cos(t196)
    contr[57] = 3/2 * t166 * t154 * (t633 + t634) * sdelta * t659
    t668 = cos(t206)
    contr[58] = 3/4 * t35 * t668 * t222 * cpa2EQ * t63 * t615 * t3
    t672 = t268 - t574 - t270
    t673 = t672 * t1
    t674 = t2 * t18
    t677 = cos(t216)
    contr[59] = 3/4 * t35 * t677 * t9 * t573 * t674 * t673
    t681 = cos(t223)
    contr[60] = 3/2 * t234 * t681 * t7 * t618 * t617
    t686 = cpa2EQ * t8
    t689 = cos(t238)
    contr[61] = 3/4 * t35 * t689 * t222 * t686 * t573 * t3
    t695 = cos(t245)
    contr[62] = 3/4 * t35 * t695 * t328 * t615 * t674 * t673
    t699 = cos(t251)
    contr[63] = 3/2 * t234 * t699 * t7 * t618 * t617
    t705 = t317 * q * t576
    t707 = cos(t260)
    contr[64] = -t131 * t222 * t707 * pi * t705 * t45 / 4
    t713 = t76 * t282
    t714 = t713 * t175
    t717 = 2 * t91 * t275 * IMx
    t722 = cos(t289)
    contr[65] = -t185 * t18 * pi * t722 * t287 * t43 * t7 * (t714 - t717) / 4
    t728 = cos(t303)
    t731 = t713 * t141
    t733 = 2 * t275 * t145
    contr[66] = -t165 * t18 * pi * (t731 + t733) * t728 * t516 * t515 / 4
    t740 = t114 * t577
    t742 = cos(t310)
    contr[67] = -t234 * t742 * pi * t399 * t740 * t45 / 4
    t749 = cos(t321)
    contr[68] = -t131 * t222 * t749 * pi * t705 * t64 / 4
    t758 = cos(t332)
    contr[69] = t185 * t18 * pi * t758 * t287 * (t714 + t717) * t328 / 4
    t766 = cos(t342)
    contr[70] = t165 * t18 * pi * t766 * t287 * (t731 - t733) * t328 / 4
    t772 = cos(t354)
    contr[71] = -t234 * t772 * pi * t399 * t740 * t64 / 4
    t780 = t63 * IMz * t351
    t782 = cos(t364)
    t784 = t7 * pi
    contr[72] = 3/4 * t234 * t784 * t2 * t782 * t780 * t18 * t686
    t789 = cpa2EQ * t43 * t8
    t791 = cos(t373)
    contr[73] = 3/4 * t234 * t784 * t2 * IMz * muM * t791 * q * t18 * t789
    t799 = cos(t380)
    t804 = t131 * t222 * t46
    contr[74] = 3/4 * t804 * t780 * cpa2EQ * t8 * t799
    t806 = cos(t387)
    contr[75] = 3/4 * t804 * t806 * IMz * t351 * t789
    t812 = t672 * t2 * t114
    t813 = t812 * t45
    t814 = cos(t400)
    contr[76] = 3/4 * t234 * t814 * t7 * t89 * t813
    t819 = cos(t410)
    contr[77] = 3/4 * t131 * t222 * t819 * pi * t813
    t824 = t812 * t64
    t825 = cos(t421)
    contr[78] = 3/4 * t131 * t222 * t825 * pi * t824
    t830 = cos(t429)
    contr[79] = 3/4 * t234 * t830 * t7 * t89 * t824
    t835 = muM * t328
    t836 = cos(t445)
    t839 = IMy * cpa1EQ
    t840 = t437 * t839
    t841 = IMx * cpa2EQ
    t842 = t104 * t841
    contr[80] = -3/4 * t165 * t18 * pi * (t840 - t842) * t836 * t516 * t835
    t849 = t76 * t212
    t850 = t849 * t141
    t851 = IMx * t452
    t853 = 2 * t104 * t851
    t858 = cos(t461)
    contr[81] = -3/4 * t165 * t18 * pi * t858 * t287 * t43 * (t850 + t853) * t7
    t864 = t467 * t839
    t865 = t91 * t841
    t869 = cos(t474)
    contr[82] = 3/4 * t185 * t18 * pi * t869 * t287 * (t864 - t865) * t266
    t874 = t849 * t175
    t876 = 2 * t91 * t851
    t881 = cos(t488)
    contr[83] = 3/4 * t185 * t18 * pi * t881 * t287 * t63 * (t874 + t876) * t7
    t890 = cos(t499)
    contr[84] = -3/4 * t185 * t18 * pi * t890 * t287 * t63 * t7 * (t864 + t865)
    t899 = cos(t509)
    contr[85] = -3/4 * t185 * t18 * pi * t899 * t287 * (t874 - t876) * t266
    t909 = cos(t517)
    contr[86] = 3/4 * t165 * t18 * pi * t909 * t287 * t43 * (t840 + t842) * t7
    t918 = cos(t529)
    contr[87] = 3/4 * t165 * t18 * pi * t918 * t73 * t8 * (t850 - t853) * t835

   
    der_psig = sum(contr);
    return der_psig;

end

function derivativechiM2_psih(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)

    contr = zeros(84);
    t1 = cdelta - 1
    t3 = muM * t1 * IMz
    t4 = sqrt(k)
    t5 = pi * t4
    t7 = sqrt(k + m)
    t8 = 0.1e1 / t7
    t9 = exp(sigma)
    t10 = t9 * t8
    t11 = t10 * t5
    t13 = Q1 ^ 2
    t14 = cpa1EQ * t13
    t15 = Q1 * Q2
    t17 = 2 * cpa2EQ * t15
    t18 = Q2 ^ 2
    t19 = cpa1EQ * t18
    t22 = 4 * Q1 * cpa3EQ - cpa1EQ + t14 - t17 - t19
    t24 = 1 / (t13 + t18 + 1)
    t25 = t24 * t22
    t26 = -psih + psig
    t27 = sin(t26)
    t29 = rc ^ 2
    t31 = 0.1e1 / t29 / rc
    t33 = exp(2 * sigma)
    t37 = 0.1e1 / KK
    t40 = 0.1e1 / npsig * t37 / (t33 - 1) * t31
    contr[1] = -t40 * t27 * t25 * t11 * t3 / 4
    t44 = muM * IMz
    t45 = cdelta + 1
    t46 = t45 * t44
    t48 = psih + psig
    t49 = sin(t48)
    contr[2] = -t40 * t49 * t25 * t11 * t46 / 4
    t54 = t4 * IMz
    t57 = q * sdelta
    t59 = t57 * muM * t24 * t22 * t54
    t60 = pi * t8
    t61 = 2 * psil
    t62 = psih - t61
    t63 = sin(t62)
    t65 = t37 * t31
    t66 = q ^ 2
    t69 = 0.1e1 / npsil
    t71 = t69 / (t66 + 1) * t65
    contr[3] = t71 * t63 * t60 * t59 / 4
    t74 = sqrt(q)
    t75 = t74 * sdelta
    t76 = cpa1EQ * t15
    t77 = cpa2EQ * t13
    t78 = t77 / 2
    t79 = cpa2EQ * t18
    t80 = t79 / 2
    t81 = Q2 * cpa3EQ
    t84 = t76 + t78 - t80 + 2 * t81 + cpa2EQ / 2
    t86 = 1 + q
    t88 = sqrt(1 + k)
    t89 = t88 * t86
    t90 = t89 * t84 * IMy
    t91 = q - 1
    t92 = t91 * IMx
    t98 = t14 + (-2 * Q2 * cpa2EQ + 4 * cpa3EQ) * Q1 - t19 - cpa1EQ
    t100 = t98 * t92 / 2
    t103 = psih - psil
    t104 = sin(t103)
    t108 = t24 * pi
    t114 = 1 / (t66 - 1) * t69 * t31 * t37 * t108
    contr[4] = -t114 * t8 * muM * t104 * (t90 - t100) * t75
    t116 = psih + psil
    t117 = sin(t116)
    contr[5] = -t114 * t8 * (t90 + t100) * muM * t117 * t75
    t124 = psih + t61
    t125 = sin(t124)
    contr[6] = -t71 * t125 * t60 * t59 / 4
    t130 = cpa1EQ * t4
    t131 = t108 * t130
    t133 = 2 * TL
    t134 = -psig - psih + t133
    t135 = sin(t134)
    contr[7] = -3/4 * t40 * t135 * t10 * t131 * t46
    t140 = t14 + t17 - t19
    t142 = t108 * t140 * t4
    t144 = -psig + psih + t133
    t145 = sin(t144)
    contr[8] = 3/4 * t40 * t145 * t10 * t142 * t3
    t150 = psig - psih + t133
    t151 = sin(t150)
    contr[9] = 3/4 * t40 * t151 * t10 * t131 * t3
    t156 = psig + psih + t133
    t157 = sin(t156)
    contr[10] = -3/4 * t40 * t157 * t10 * t142 * t46
    t162 = t9 * q
    t165 = t22 * t4 * t162 * t3
    t166 = -psih + psig - t61
    t167 = sin(t166)
    t169 = t8 * t24
    t174 = 2 * npsil
    t178 = 0.1e1 / (-t174 + npsig) * t37 / (-t66 + t33) * t31
    contr[11] = -t178 * t169 * t167 * pi * t165 / 4
    t182 = t1 * t8
    t183 = q - t33
    t184 = t183 * IMy
    t185 = t88 * t84
    t186 = t185 * t184
    t187 = t33 + q
    t188 = t187 * IMx
    t190 = t98 * t188 / 2
    t194 = t74 * t9 * muM
    t196 = -psih + psig - psil
    t197 = sin(t196)
    t203 = exp(4 * sigma)
    t207 = 0.1e1 / (t66 - t203) / (-npsil + npsig) * t65
    contr[12] = t207 * t24 * pi * t197 * t194 * (t186 + t190) * t182 / 2
    t210 = q * t33
    t211 = t210 - 1
    t212 = IMy * t211
    t213 = t185 * t212
    t214 = 1 + t210
    t215 = t214 * IMx
    t217 = t98 * t215 / 2
    t222 = -psih + psig + psil
    t223 = sin(t222)
    t232 = 0.1e1 / (t66 * t203 - 1) / (npsil + npsig) * t65
    contr[13] = t232 * t24 * pi * t223 * t194 * t1 * (t213 - t217) * t8 / 2
    t235 = -psih + psig + t61
    t236 = sin(t235)
    t246 = 0.1e1 / (t174 + npsig) * t37 / (t66 * t33 - 1) * t31
    contr[14] = -t246 * t236 * pi * t169 * t165 / 4
    t250 = IMy * cpa2EQ
    t251 = t89 * t250
    t252 = cpa1EQ * t92
    t255 = -psih - psil + t133
    t256 = sin(t255)
    contr[15] = -3/2 * t114 * t8 * t256 * muM * (t251 + t252) * t75
    t262 = muM * t75
    t263 = -psih + psil + t133
    t264 = sin(t263)
    contr[16] = -3/2 * t114 * (t251 - t252) * t8 * t264 * t262
    t271 = q * t44
    t272 = t4 * t9
    t276 = psih + psig - t61
    t277 = sin(t276)
    contr[17] = -t178 * t169 * t277 * pi * t22 * t45 * t272 * t271 / 4
    t283 = t45 * t8
    t287 = psih + psig - psil
    t288 = sin(t287)
    contr[18] = -t207 * t24 * pi * t288 * t194 * (t186 - t190) * t283 / 2
    t297 = psih + psig + psil
    t298 = sin(t297)
    contr[19] = -t232 * t24 * pi * t298 * t194 * (t213 + t217) * t283 / 2
    t306 = muM * q
    t307 = t272 * t306
    t309 = psih + psig + t61
    t310 = sin(t309)
    contr[20] = -t246 * t310 * pi * t283 * t307 * t24 * t22 * IMz / 4
    t316 = t86 * IMy
    t317 = t76 - t78 + t80
    t319 = t88 * t317 * t316
    t322 = t91 * t140 * IMx / 2
    t325 = psih - psil + t133
    t326 = sin(t325)
    contr[21] = -3 * t114 * t8 * t326 * muM * (t319 - t322) * t75
    t334 = psih + psil + t133
    t335 = sin(t334)
    contr[22] = -3 * t114 * t8 * t335 * muM * (t319 + t322) * t75
    t341 = muM * t54
    t344 = cpa1EQ * t8 * t57 * t341
    t345 = -t61 - psih + t133
    t346 = sin(t345)
    contr[23] = -3/4 * t71 * t346 * t108 * t344
    t352 = IMz * t24 * t140
    t354 = t57 * muM * t4
    t355 = t354 * t352
    t356 = -t61 + psih + t133
    t357 = sin(t356)
    contr[24] = 3/4 * t71 * t357 * t60 * t355
    t361 = t61 - psih + t133
    t362 = sin(t361)
    contr[25] = 3/4 * t71 * t362 * t108 * t344
    t366 = t61 + psih + t133
    t367 = sin(t366)
    contr[26] = -3/4 * t71 * t367 * t60 * t355
    t374 = cpa1EQ * t45 * t272 * t271
    t375 = -psig - t61 - psih + t133
    t376 = sin(t375)
    contr[27] = -3/4 * t246 * t376 * pi * t169 * t374
    t383 = t130 * t162 * t3
    t384 = psig + t61 - psih + t133
    t385 = sin(t384)
    contr[28] = 3/4 * t246 * t385 * pi * t169 * t383
    t390 = -psih + t133 - psig + t61
    t391 = sin(t390)
    contr[29] = -3/4 * t178 * t169 * t391 * pi * t374
    t397 = -psih + t133 + psig - t61
    t398 = sin(t397)
    contr[30] = 3/4 * t178 * t169 * t398 * pi * t383
    t406 = t8 * t4
    t407 = psih + t133 - psig - t61
    t408 = sin(t407)
    contr[31] = 3/4 * t246 * t408 * pi * t406 * t162 * muM * t1 * t352
    t413 = IMz * t140
    t416 = psih + t133 - psig + t61
    t417 = sin(t416)
    contr[32] = 3/4 * t178 * t169 * t417 * pi * t307 * t1 * t413
    t426 = psih + t133 + psig - t61
    t427 = sin(t426)
    contr[33] = -3/4 * t178 * t169 * t427 * pi * t45 * t4 * t162 * muM * t413
    t434 = psih + t133 + psig + t61
    t435 = sin(t434)
    contr[34] = -3/4 * t246 * t435 * pi * t283 * t307 * t352
    t441 = t88 * t211
    t442 = t441 * t250
    t443 = IMx * cpa1EQ
    t444 = t214 * t443
    t449 = -psil - psig - psih + t133
    t450 = sin(t449)
    contr[35] = -3/4 * t232 * t24 * pi * t450 * t194 * t45 * (t442 + t444) * t8
    t457 = t88 * IMy
    t458 = t457 * t211 * t317
    t460 = t140 * t215 / 2
    t464 = -psil - psig + psih + t133
    t465 = sin(t464)
    contr[36] = -3/2 * t232 * t24 * pi * t465 * t194 * (t458 - t460) * t182
    t471 = t88 * t183
    t472 = t471 * t250
    t473 = t187 * t443
    t478 = -psil + psig - psih + t133
    t479 = sin(t478)
    contr[37] = -3/4 * t207 * t24 * pi * t479 * t194 * t1 * (t472 + t473) * t8
    t486 = t457 * t183 * t317
    t488 = t140 * t188 / 2
    t493 = -psil + psig + psih + t133
    t494 = sin(t493)
    contr[38] = -3/2 * t207 * t24 * pi * t494 * t194 * t45 * t8 * (t486 - t488)
    t504 = psil - psig - psih + t133
    t505 = sin(t504)
    contr[39] = -3/4 * t207 * t24 * pi * t505 * t194 * t45 * (t472 - t473) * t8
    t514 = psil - psig + psih + t133
    t515 = sin(t514)
    contr[40] = -3/2 * t207 * t24 * pi * t515 * t194 * (t486 + t488) * t182
    t521 = muM * t182
    t522 = t74 * t9
    t523 = psil + psig - psih + t133
    t524 = sin(t523)
    contr[41] = -3/4 * t232 * t24 * pi * (t442 - t444) * t524 * t522 * t521
    t536 = psil + psig + psih + t133
    t537 = sin(t536)
    contr[42] = -3/2 * t232 * t24 * pi * t537 * t194 * (t458 + t460) * t283
    t543 = pi * t1
    t544 = 2 * t76
    t546 = t77 + t544 - t79 + 4 * t81 + cpa2EQ
    t547 = t24 * t546
    t550 = cos(t26)
    contr[43] = t40 * t550 * t10 * t547 * t543 * t341 / 4
    t558 = cos(t48)
    contr[44] = -t40 * t558 * t45 * t9 * t169 * t546 * pi * t341 / 4
    t564 = t354 * IMz * t547
    t565 = cos(t62)
    contr[45] = t71 * t565 * t60 * t564 / 4
    t569 = t88 * t98
    t570 = t569 * t316
    t571 = t84 * IMx
    t573 = 2 * t91 * t571
    t577 = cos(t103)
    contr[46] = t114 * t8 * muM * t577 * t74 * (t570 + t573) * sdelta / 2
    t584 = cos(t116)
    contr[47] = t114 * t8 * muM * t584 * (t570 - t573) * t75 / 2
    t589 = cos(t124)
    contr[48] = -t71 * t589 * t60 * t564 / 4
    t594 = t9 * pi
    t598 = cos(t134)
    contr[49] = 3/4 * t40 * t598 * t169 * cpa2EQ * t45 * t594 * t341
    t602 = t77 - t544 - t79
    t603 = t602 * t44
    t604 = t4 * t24
    t607 = cos(t144)
    contr[50] = -3/4 * t40 * t607 * t10 * t543 * t604 * t603
    t612 = cpa2EQ * t9
    t615 = cos(t150)
    contr[51] = -3/4 * t40 * t615 * t169 * t612 * t543 * t341
    t622 = cos(t156)
    contr[52] = 3/4 * t40 * t622 * t283 * t594 * t604 * t603
    t627 = t272 * q * t546
    t629 = cos(t166)
    contr[53] = t178 * t169 * t629 * pi * t627 * t3 / 4
    t634 = t569 * t184
    t636 = 2 * t187 * t571
    t641 = cos(t196)
    contr[54] = t207 * t24 * pi * t641 * t194 * t1 * t8 * (t634 - t636) / 4
    t646 = cos(t222)
    t649 = t569 * t212
    t651 = 2 * t84 * t215
    contr[55] = t232 * t24 * pi * (t649 + t651) * t646 * t522 * t521 / 4
    t657 = t162 * t547
    t659 = cos(t235)
    contr[56] = t246 * t659 * pi * t406 * t657 * t3 / 4
    t664 = cos(t255)
    t666 = IMy * cpa1EQ
    t667 = t89 * t666
    t668 = cpa2EQ * t92
    contr[57] = -3/2 * t114 * (t667 - t668) * t8 * t664 * t262
    t677 = cos(t263)
    contr[58] = -3/2 * t114 * t8 * t677 * muM * t74 * sdelta * (t667 + t668)
    t684 = cos(t276)
    contr[59] = -t178 * t169 * t684 * pi * t627 * t46 / 4
    t693 = cos(t287)
    contr[60] = t207 * t24 * pi * t693 * t194 * (t634 + t636) * t283 / 4
    t701 = cos(t297)
    contr[61] = t232 * t24 * pi * t701 * t194 * (t649 - t651) * t283 / 4
    t707 = cos(t309)
    contr[62] = -t246 * t707 * pi * t406 * t657 * t46 / 4
    t713 = t88 * t140
    t714 = t713 * t316
    t716 = 2 * t317 * t92
    t720 = cos(t325)
    contr[63] = 3/2 * t114 * t8 * t720 * muM * t74 * sdelta * (t714 + t716)
    t725 = cos(t334)
    contr[64] = 3/2 * t114 * (t714 - t716) * t8 * t725 * t262
    t733 = cos(t345)
    t739 = t71 * t8 * pi * sdelta
    contr[65] = 3/4 * t739 * t44 * t733 * q * t4 * t24 * cpa2EQ
    t743 = t24 * t602 * t57 * t341
    t744 = cos(t356)
    contr[66] = -3/4 * t71 * t744 * t60 * t743
    t749 = cos(t361)
    contr[67] = -3/4 * t739 * t44 * q * t4 * t24 * cpa2EQ * t749
    t757 = cos(t366)
    contr[68] = 3/4 * t71 * t757 * t60 * t743
    t763 = t45 * IMz * t306
    t765 = cos(t375)
    contr[69] = 3/4 * t246 * t60 * t4 * t765 * t763 * t24 * t612
    t771 = cpa2EQ * t1 * t9
    t773 = cos(t384)
    contr[70] = -3/4 * t246 * t60 * t54 * muM * t773 * q * t24 * t771
    t781 = cos(t390)
    t786 = t178 * t169 * t5
    contr[71] = 3/4 * t786 * t763 * cpa2EQ * t9 * t781
    t788 = cos(t397)
    contr[72] = -3/4 * t786 * t788 * IMz * t306 * t771
    t795 = t602 * t4 * t162
    t796 = t795 * t3
    t797 = cos(t407)
    contr[73] = -3/4 * t246 * t797 * t8 * t108 * t796
    t803 = cos(t416)
    contr[74] = -3/4 * t178 * t169 * t803 * pi * t796
    t809 = t795 * t46
    t810 = cos(t426)
    contr[75] = 3/4 * t178 * t169 * t810 * pi * t809
    t815 = cos(t434)
    contr[76] = 3/4 * t246 * t815 * t8 * t108 * t809
    t820 = muM * t283
    t821 = cos(t449)
    t824 = t441 * t666
    t825 = IMx * cpa2EQ
    t826 = t214 * t825
    contr[77] = -3/4 * t232 * t24 * pi * (t824 - t826) * t821 * t522 * t820
    t833 = t713 * t212
    t834 = IMx * t317
    t836 = 2 * t214 * t834
    t841 = cos(t464)
    contr[78] = 3/4 * t232 * t24 * pi * t841 * t194 * t1 * (t833 + t836) * t8
    t846 = t471 * t666
    t847 = t187 * t825
    t851 = cos(t478)
    contr[79] = -3/4 * t207 * t24 * pi * t851 * t194 * (t846 - t847) * t182
    t857 = t713 * t184
    t859 = 2 * t187 * t834
    t864 = cos(t493)
    contr[80] = 3/4 * t207 * t24 * pi * t864 * t194 * t45 * (t857 + t859) * t8
    t873 = cos(t504)
    contr[81] = -3/4 * t207 * t24 * pi * t873 * t194 * t45 * t8 * (t846 + t847)
    t882 = cos(t514)
    contr[82] = 3/4 * t207 * t24 * pi * t882 * t194 * (t857 - t859) * t182
    t891 = cos(t523)
    contr[83] = -3/4 * t232 * t24 * pi * t891 * t194 * t1 * (t824 + t826) * t8
    t901 = cos(t536)
    contr[84] = 3/4 * t232 * t24 * pi * t901 * t74 * t9 * (t833 - t836) * t820


    der_psih = sum(contr);
    return der_psih;
end

function derivativechiM2_cdeltapsigMpsihOsdelta(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)
    
    contr = zeros(111);

    t2 = sqrt(k)
    t5 = sqrt(k + m)
    t6 = 0.1e1 / t5
    t7 = exp(sigma)
    t8 = t7 * t6
    t11 = Q1 * cpa2EQ - Q2 * cpa1EQ
    t14 = t11 * IMz * t8 * t2 * pi * cdelta
    t15 = Q1 ^ 2
    t16 = Q2 ^ 2
    t18 = 1 / (t15 + t16 + 1)
    t19 = muM * t18
    t20 = 2 * TL
    t21 = -psig + t20
    t22 = sin(t21)
    t24 = rc ^ 2
    t26 = 0.1e1 / rc / t24
    t28 = exp(2 * sigma)
    t32 = 0.1e1 / KK
    t35 = 0.1e1 / npsig * t32 / (-1 + t28) * t26
    contr[1] = 3/2 * t35 * t22 * t19 * t14
    t38 = psig + t20
    t39 = sin(t38)
    contr[2] = 3/2 * t35 * t39 * t19 * t14
    t43 = cpa1EQ * t15
    t44 = Q1 * Q2
    t46 = 2 * cpa2EQ * t44
    t47 = cpa1EQ * t16
    t50 = 4 * Q1 * cpa3EQ - cpa1EQ + t43 - t46 - t47
    t53 = IMz * t2
    t55 = t53 * t8 * t18 * t50 * pi
    t56 = sdelta * muM
    t57 = -psih + psig
    t58 = sin(t57)
    contr[3] = -t35 * t58 * t56 * t55 / 4
    t63 = psih + psig
    t64 = sin(t63)
    contr[4] = t35 * t64 * t56 * t55 / 4
    t68 = t2 * q
    t69 = t6 * t68
    t70 = pi * muM
    t71 = IMz * t70
    t72 = t71 * t69
    t73 = t18 * t50
    t74 = 2 * psil
    t75 = psih - t74
    t76 = sin(t75)
    t78 = t32 * t26
    t79 = q ^ 2
    t82 = 0.1e1 / npsil
    t84 = t82 / (t79 + 1) * t78
    contr[5] = -t84 * t76 * t73 * t72 / 4
    t88 = psih - psil
    t89 = sin(t88)
    t91 = sqrt(q)
    t92 = pi * t91
    t95 = q + 1
    t96 = t95 * IMy
    t97 = cpa1EQ * t44
    t98 = cpa2EQ * t15
    t99 = t98 / 2
    t100 = cpa2EQ * t16
    t101 = t100 / 2
    t102 = Q2 * cpa3EQ
    t105 = t97 + t99 - t101 + 2 * t102 + cpa2EQ / 2
    t107 = sqrt(1 + k)
    t108 = t107 * t105
    t109 = t108 * t96
    t110 = Q2 * cpa2EQ
    t115 = t43 + Q1 * (-2 * t110 + 4 * cpa3EQ) - t47 - cpa1EQ
    t116 = t115 * IMx
    t117 = q - 1
    t119 = t117 * t116 / 2
    t126 = 0.1e1 / (t79 - 1) * t82 * t26
    contr[6] = t126 * t32 * t18 * (t109 - t119) * t6 * t92 * muM * t89
    t129 = psih + psil
    t130 = sin(t129)
    t132 = t91 * muM
    t133 = pi * t132
    t135 = t18 * t6
    t137 = t126 * t32 * t135
    contr[7] = t137 * t133 * t130 * (t109 + t119)
    t138 = psih + t74
    t139 = sin(t138)
    contr[8] = t84 * t139 * t73 * t72 / 4
    t145 = Q1 * cpa1EQ
    t146 = cpa3EQ * (-t15 - t16 + 1) + t145 - t110
    t148 = t91 * IMy * t146
    t149 = -psil + psig
    t150 = sin(t149)
    t156 = t18 * t107 * cdelta * t6
    t157 = t28 + q
    t161 = 0.1e1 / (-npsil + npsig)
    t162 = t161 * t32
    contr[9] = t162 / t157 * t26 * t156 * t70 * t150 * t7 * t148
    t165 = psil + psig
    t166 = sin(t165)
    t170 = q * t28
    t171 = 1 + t170
    t175 = 0.1e1 / (npsil + npsig)
    t176 = t175 * t32
    contr[10] = t176 / t171 * t26 * t156 * t70 * t166 * t7 * t148
    t180 = t7 * q * cdelta
    t181 = t11 * t2
    t183 = t19 * t181 * t180
    t184 = pi * IMz
    t185 = t20 - psig + t74
    t186 = sin(t185)
    t189 = -t79 + t28
    t192 = 2 * npsil
    t195 = 0.1e1 / (-t192 + npsig) * t32
    t196 = t195 / t189 * t26
    contr[11] = 3/2 * t196 * t6 * t186 * t184 * t183
    t199 = t20 + psig - t74
    t200 = sin(t199)
    contr[12] = 3/2 * t196 * t6 * t200 * t184 * t183
    t205 = t20 - psil - psig
    t206 = sin(t205)
    t209 = t170 - 1
    t210 = t209 * IMy
    t211 = t145 + t110
    t212 = t107 * t211
    t213 = t212 * t210
    t214 = t171 * IMx
    t215 = -t11
    t216 = t215 * t214
    t222 = t18 * t91 * t7
    t224 = exp(4 * sigma)
    t229 = 0.1e1 / (t79 * t224 - 1) * t175 * t78
    t230 = t229 * t222
    contr[13] = -3/2 * t230 * muM * pi * (t213 + t216) * t6 * t206 * cdelta
    t233 = t20 - psil + psig
    t234 = sin(t233)
    t237 = t7 * t70
    t239 = q - t28
    t240 = t239 * IMy
    t241 = t212 * t240
    t242 = t157 * IMx
    t243 = t215 * t242
    t250 = 0.1e1 / (-t224 + t79) * t161 * t78
    contr[14] = 3/2 * t250 * t18 * t91 * (t241 + t243) * t237 * t6 * t234 * cdelta
    t253 = t20 + psil - psig
    t254 = sin(t253)
    t261 = t250 * t222
    contr[15] = -3/2 * t261 * muM * (t241 - t243) * pi * t6 * t254 * cdelta
    t264 = t20 + psil + psig
    t265 = sin(t264)
    contr[16] = 3/2 * t230 * muM * (t213 - t216) * pi * t6 * t265 * cdelta
    t274 = pi * t18 * cpa1EQ
    t275 = -psig - psih + t20
    t276 = sin(t275)
    t278 = t7 * muM
    t282 = t35 * t6 * t53
    contr[17] = 3/4 * t282 * t278 * sdelta * t276 * t274
    t284 = -psig + psih + t20
    t285 = sin(t284)
    t288 = t43 + t46 - t47
    t289 = t18 * t288
    t290 = t289 * t278
    contr[18] = 3/4 * t282 * t290 * sdelta * t285 * pi
    t294 = t135 * t181 * t180
    t295 = -psig - t74 + t20
    t296 = sin(t295)
    t306 = 0.1e1 / (t192 + npsig) * t32 / (t79 * t28 - 1) * t26
    contr[19] = 3/2 * t306 * t296 * IMz * t70 * t294
    t309 = psig - psih + t20
    t310 = sin(t309)
    contr[20] = 3/4 * t282 * t278 * sdelta * t310 * t274
    t315 = psig + psih + t20
    t316 = sin(t315)
    contr[21] = 3/4 * t282 * t290 * sdelta * t316 * pi
    t321 = psig + t74 + t20
    t322 = sin(t321)
    contr[22] = 3/2 * t306 * t322 * IMz * t70 * t294
    t327 = t7 * q
    t328 = -psih + psig - t74
    t329 = sin(t328)
    t331 = t53 * t70
    t335 = t196 * t135 * t50 * sdelta
    contr[23] = -t335 * t331 * t329 * t327 / 4
    t338 = t7 * sdelta
    t339 = -psih + psig - psil
    t340 = sin(t339)
    t343 = t108 * t240
    t345 = t157 * t116 / 2
    contr[24] = t250 * t18 * t6 * (t343 + t345) * t133 * t340 * t338 / 2
    t351 = -psih + psig + psil
    t352 = sin(t351)
    t354 = t108 * t210
    t356 = t171 * t116 / 2
    t361 = t6 * pi
    t362 = t18 * t361
    t363 = t229 * t362
    contr[25] = t363 * muM * (t354 - t356) * t91 * t352 * t338 / 2
    t365 = -psih + psig + t74
    t366 = sin(t365)
    t368 = muM * t6
    t369 = t2 * pi
    t370 = t369 * t368
    t372 = IMz * sdelta
    t374 = t306 * t73 * t372
    contr[26] = -t374 * t370 * t366 * t327 / 4
    t377 = IMy * cpa2EQ
    t378 = t107 * t95
    t379 = t378 * t377
    t381 = cpa1EQ * t117 * IMx
    t384 = -psih - psil + t20
    t385 = sin(t384)
    contr[27] = 3/2 * t137 * t385 * t70 * (t379 + t381) * t91
    t391 = -psih + psil + t20
    t392 = sin(t391)
    contr[28] = 3/2 * t137 * t392 * t70 * (t379 - t381) * t91
    t396 = psih + psig - t74
    t397 = sin(t396)
    contr[29] = t335 * t331 * t397 * t327 / 4
    t401 = psih + psig - psil
    t402 = sin(t401)
    t407 = t250 * t362
    contr[30] = t407 * (t343 - t345) * t132 * t402 * t338 / 2
    t409 = psih + psig + psil
    t410 = sin(t409)
    contr[31] = t229 * t18 * t6 * (t354 + t356) * t133 * t410 * t338 / 2
    t418 = psih + psig + t74
    t419 = sin(t418)
    contr[32] = t374 * t370 * t419 * t327 / 4
    t423 = t97 - t99 + t101
    t425 = t378 * IMy * t423
    t428 = t117 * IMx * t288 / 2
    t431 = psih - psil + t20
    t432 = sin(t431)
    contr[33] = 3 * t137 * t432 * t70 * t91 * (t425 - t428)
    t436 = psih + psil + t20
    t437 = sin(t436)
    contr[34] = 3 * t137 * (t425 + t428) * t437 * muM * t92
    t444 = cpa1EQ * t70 * t69
    t445 = IMz * t18
    t446 = -t74 - psih + t20
    t447 = sin(t446)
    contr[35] = 3/4 * t84 * t447 * t445 * t444
    t451 = -t74 + psih + t20
    t452 = sin(t451)
    contr[36] = -3/4 * t84 * t452 * t289 * t72
    t457 = t74 - psih + t20
    t458 = sin(t457)
    contr[37] = -3/4 * t84 * t458 * t445 * t444
    t463 = t74 + psih + t20
    t464 = sin(t463)
    contr[38] = 3/4 * t84 * t464 * t289 * t72
    t468 = q * sdelta
    t469 = t6 * t468
    t470 = -psig - t74 - psih + t20
    t471 = sin(t470)
    t476 = t7 * t18
    t478 = t306 * t476 * muM * cpa1EQ
    contr[39] = 3/4 * t478 * t184 * t471 * t2 * t469
    t480 = psig + t74 - psih + t20
    t481 = sin(t480)
    contr[40] = 3/4 * t478 * t184 * t481 * t2 * t469
    t486 = t2 * t468
    t487 = -psih + t20 - psig + t74
    t488 = sin(t487)
    t494 = t196 * t135 * t7 * cpa1EQ
    contr[41] = 3/4 * t494 * t70 * IMz * t488 * t486
    t496 = -psih + t20 + psig - t74
    t497 = sin(t496)
    contr[42] = 3/4 * t494 * t70 * IMz * t497 * t486
    t502 = psih + t20 - psig - t74
    t503 = sin(t502)
    t507 = t306 * t290
    contr[43] = 3/4 * t507 * t184 * t503 * t2 * t469
    t509 = psih + t20 - psig + t74
    t510 = sin(t509)
    t516 = t196 * t135 * t7 * t288
    contr[44] = 3/4 * t516 * t70 * IMz * t510 * t486
    t518 = psih + t20 + psig - t74
    t519 = sin(t518)
    contr[45] = 3/4 * t516 * t70 * IMz * t519 * t486
    t524 = psih + t20 + psig + t74
    t525 = sin(t524)
    contr[46] = 3/4 * t507 * t184 * t525 * t2 * t469
    t530 = -psil - psig - psih + t20
    t531 = sin(t530)
    t533 = t107 * t209
    t534 = t533 * t377
    t535 = IMx * cpa1EQ
    t536 = t171 * t535
    t540 = t18 * t368
    t541 = t229 * t540
    contr[47] = 3/4 * t541 * (t534 + t536) * t92 * t531 * t338
    t543 = -psil - psig + psih + t20
    t544 = sin(t543)
    t547 = t107 * t423
    t548 = t547 * t210
    t550 = t288 * t214 / 2
    contr[48] = -3/2 * t229 * t18 * t6 * (t548 - t550) * t133 * t544 * t338
    t557 = t107 * t239
    t558 = t557 * t377
    t559 = t157 * t535
    t563 = -psil + psig - psih + t20
    t564 = sin(t563)
    t568 = t250 * t540
    contr[49] = -3/4 * t568 * pi * t91 * t564 * t7 * sdelta * (t558 + t559)
    t571 = -psil + psig + psih + t20
    t572 = sin(t571)
    t574 = t547 * t240
    t576 = t288 * t242 / 2
    contr[50] = 3/2 * t568 * (t574 - t576) * t92 * t572 * t338
    t581 = psil - psig - psih + t20
    t582 = sin(t581)
    contr[51] = 3/4 * t568 * pi * (t558 - t559) * t91 * t582 * t338
    t589 = psil - psig + psih + t20
    t590 = sin(t589)
    contr[52] = -3/2 * t568 * pi * (t574 + t576) * t91 * t590 * t338
    t598 = psil + psig - psih + t20
    t599 = sin(t598)
    contr[53] = -3/4 * t229 * t18 * (t534 - t536) * t6 * t133 * t599 * t338
    t611 = psil + psig + psih + t20
    t612 = sin(t611)
    contr[54] = 3/2 * t541 * pi * t91 * t612 * t7 * sdelta * (t548 + t550)
    t618 = cdelta * IMz
    t621 = cos(psig)
    contr[55] = t35 * t18 * t146 * t621 * t618 * t8 * muM * t369
    t625 = muM * t618
    t629 = t211 * pi * t7 * t2 * t625
    t630 = cos(t21)
    contr[56] = 3/2 * t35 * t630 * t135 * t629
    t634 = cos(t38)
    contr[57] = 3/2 * t35 * t634 * t135 * t629
    t642 = t278 * t6 * t2 * IMz * t146 * q
    t644 = cos(psig - t74)
    t646 = t18 * cdelta
    contr[58] = t195 / t189 * t26 * t646 * t644 * pi * t642
    t655 = cos(psig + t74)
    contr[59] = t306 * t646 * t655 * pi * t642
    t660 = 2 * t97
    t662 = t98 + t660 - t100 + 4 * t102 + cpa2EQ
    t663 = t662 * muM
    t665 = t663 * t53 * t7 * t361
    t666 = sdelta * t18
    t667 = cos(t57)
    contr[60] = t35 * t667 * t666 * t665 / 4
    t671 = cos(t63)
    contr[61] = t35 * t671 * t666 * t665 / 4
    t675 = t18 * t662
    t676 = cos(t75)
    contr[62] = -t84 * t676 * t675 * t72 / 4
    t682 = t107 * t115 * t96
    t685 = 2 * t117 * t105 * IMx
    t687 = cos(t88)
    contr[63] = -t137 * t133 * t687 * (t682 + t685) / 2
    t692 = cos(t129)
    contr[64] = -t137 * pi * (t682 - t685) * t91 * muM * t692 / 2
    t700 = cos(t138)
    contr[65] = t84 * t700 * t675 * t72 / 4
    t706 = t70 * t8
    t707 = t706 * t91 * IMx * t146
    t708 = cos(t149)
    contr[66] = -t162 / t239 * t26 * t18 * cdelta * t708 * t707
    t716 = cos(t165)
    contr[67] = t176 / t209 * t26 * t18 * cdelta * t716 * t707
    t725 = pi * t7 * t68 * t625
    t726 = t18 * t211
    t727 = cos(t185)
    contr[68] = 3/2 * t196 * t727 * t6 * t726 * t725
    t732 = cos(t199)
    contr[69] = 3/2 * t196 * t732 * t6 * t726 * t725
    t737 = cos(t205)
    t741 = t107 * t215
    t742 = t741 * t210
    t743 = t211 * t214
    contr[70] = -3/2 * t229 * t18 * (t742 - t743) * t91 * t237 * t6 * t737 * cdelta
    t750 = t741 * t240
    t751 = t211 * t242
    t754 = cos(t233)
    contr[71] = 3/2 * t261 * muM * t361 * t754 * cdelta * (t750 - t751)
    t759 = cos(t253)
    contr[72] = -3/2 * t261 * muM * pi * (t750 + t751) * t6 * t759 * cdelta
    t768 = cos(t264)
    contr[73] = 3/2 * t230 * muM * pi * (t742 + t743) * t6 * t768 * cdelta
    t776 = cos(t275)
    t780 = t476 * muM * cpa2EQ
    contr[74] = -3/4 * t282 * t780 * sdelta * pi * t776
    t784 = t98 - t660 - t100
    t786 = t18 * t784 * pi
    t787 = cos(t284)
    contr[75] = -3/4 * t282 * t787 * t7 * t56 * t786
    t793 = cos(t295)
    contr[76] = 3/2 * t306 * t793 * t6 * t726 * t725
    t798 = cos(t309)
    contr[77] = -3/4 * t282 * t780 * sdelta * pi * t798
    t807 = cos(t315)
    contr[78] = -3/4 * t35 * t6 * t2 * t807 * IMz * t7 * t56 * t786
    t813 = cos(t321)
    contr[79] = 3/2 * t306 * t813 * t6 * t726 * t725
    t818 = cos(t328)
    t820 = t369 * t663
    t823 = t196 * t135 * t372
    contr[80] = t823 * t820 * t818 * t327 / 4
    t825 = cos(t339)
    t828 = t107 * IMy
    t829 = t828 * t115 * t239
    t831 = 2 * t105 * t242
    contr[81] = t407 * muM * (t829 - t831) * t91 * t825 * t338 / 4
    t837 = cos(t351)
    t840 = t828 * t115 * t209
    t842 = 2 * t105 * t214
    contr[82] = t363 * (t840 + t842) * t132 * t837 * t338 / 4
    t847 = cos(t365)
    t850 = t19 * t662 * t6
    t853 = t306 * t372 * t369
    contr[83] = t853 * t850 * t847 * t327 / 4
    t855 = IMy * cpa1EQ
    t856 = t378 * t855
    t858 = IMx * cpa2EQ * t117
    t861 = cos(t384)
    contr[84] = 3/2 * t137 * t861 * t70 * t91 * (t856 - t858)
    t865 = cos(t391)
    contr[85] = 3/2 * t126 * t32 * t18 * (t856 + t858) * t6 * t865 * muM * t92
    t874 = cos(t396)
    contr[86] = t823 * t820 * t874 * t327 / 4
    t881 = cos(t401)
    contr[87] = -t407 * muM * t91 * t881 * t7 * sdelta * (t829 + t831) / 4
    t890 = cos(t409)
    contr[88] = -t363 * muM * t91 * t890 * t7 * sdelta * (t840 - t842) / 4
    t896 = cos(t418)
    contr[89] = t853 * t850 * t896 * t327 / 4
    t900 = t107 * t288
    t901 = t900 * t96
    t902 = t423 * IMx
    t904 = 2 * t117 * t902
    t907 = cos(t431)
    contr[90] = -3/2 * t137 * t907 * (t901 + t904) * muM * t92
    t914 = cos(t436)
    contr[91] = -3/2 * t137 * t914 * t70 * (t901 - t904) * t91
    t919 = cos(t446)
    contr[92] = -3/4 * t84 * t6 * t2 * muM * pi * t445 * cpa2EQ * t919 * q
    t930 = t786 * muM * t68
    t931 = t6 * IMz
    t932 = cos(t451)
    contr[93] = 3/4 * t84 * t932 * t931 * t930
    t939 = cos(t457)
    contr[94] = 3/4 * t84 * t6 * t2 * t939 * t71 * t18 * cpa2EQ * q
    t944 = cos(t463)
    contr[95] = -3/4 * t84 * t944 * t931 * t930
    t949 = t18 * cpa2EQ
    t952 = cos(t470)
    contr[96] = -3/4 * t306 * t8 * muM * t952 * t184 * t949 * t486
    t958 = cos(t480)
    t962 = t306 * t706
    contr[97] = -3/4 * t962 * t958 * IMz * t949 * t486
    t965 = cos(t487)
    t972 = t196 * t135 * t278
    contr[98] = -3/4 * t972 * t184 * cpa2EQ * t2 * q * sdelta * t965
    t978 = cos(t496)
    contr[99] = -3/4 * t196 * t135 * t7 * t978 * t70 * cpa2EQ * IMz * t486
    t984 = t784 * t468
    t985 = t2 * t18
    t986 = cos(t502)
    contr[100] = -3/4 * t962 * t986 * IMz * t985 * t984
    t992 = cos(t509)
    contr[101] = -3/4 * t972 * pi * t992 * t53 * t984
    t999 = cos(t518)
    contr[102] = -3/4 * t196 * t135 * t999 * t7 * t331 * t984
    t1007 = cos(t524)
    contr[103] = -3/4 * t306 * t6 * t1007 * t278 * t184 * t985 * t984
    t1013 = cos(t530)
    t1015 = t533 * t855
    t1016 = IMx * cpa2EQ
    t1017 = t171 * t1016
    contr[104] = 3/4 * t541 * pi * (t1015 - t1017) * t91 * t1013 * t338
    t1023 = cos(t543)
    t1026 = t900 * t210
    t1028 = 2 * t171 * t902
    contr[105] = 3/4 * t229 * t18 * t6 * (t1026 + t1028) * t133 * t1023 * t338
    t1034 = cos(t563)
    t1036 = t557 * t855
    t1037 = t157 * t1016
    contr[106] = -3/4 * t568 * pi * (t1036 - t1037) * t91 * t1034 * t338
    t1044 = t900 * t240
    t1046 = 2 * t157 * t902
    t1050 = cos(t571)
    contr[107] = -3/4 * t568 * pi * t91 * t1050 * t7 * sdelta * (t1044 + t1046)
    t1059 = cos(t581)
    contr[108] = 3/4 * t568 * pi * t91 * t1059 * t7 * sdelta * (t1036 + t1037)
    t1064 = cos(t589)
    contr[109] = 3/4 * t250 * t18 * t6 * (t1044 - t1046) * t133 * t1064 * t338
    t1072 = cos(t598)
    contr[110] = -3/4 * t229 * t18 * (t1015 + t1017) * t6 * t133 * t1072 * t338
    t1081 = cos(t611)
    contr[111] = -3/4 * t229 * t18 * t6 * (t1026 - t1028) * t133 * t1081 * t338


    der = sum(contr);
    return der;
end

function derivativechiM3_Jl(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)

    contr = zeros(21)
    t1 = cos(TL)
    t4 = -1 + m
    t9 = KK * t4 * k + (k + m) * EE
    t10 = Q1 ^ 2
    t11 = Q2 ^ 2
    t12 = t10 + t11 + 1
    t13 = 1 / t12
    t14 = Q1 * t13
    t15 = cpa1EQ * t14
    t17 = Q2 * t13
    t18 = cpa2EQ * t17
    t22 = cpa3EQ * (-t10 - t11 + 1) * t13
    t23 = -2 * t15 + 2 * t18 + t22
    t24 = t12 ^ 2
    t25 = 1 / t24
    t26 = t25 * t23
    t28 = 4 * t10 * t26
    t29 = -t10 + t11 + 1
    t30 = t29 * t13
    t37 = 2 * Q2 * cpa2EQ * t14 + cpa1EQ * t30 + 2 * cpa3EQ * t14
    t38 = t13 * t37
    t43 = t10 - t11 + 1
    t44 = t43 * t13
    t48 = 2 * Q2 * cpa1EQ * t14 + cpa2EQ * t44 - 2 * cpa3EQ * t17
    t49 = t13 * t48
    t50 = Q1 * Q2
    t52 = 2 * t50 * t49
    t53 = t29 * t38 + t52
    t56 = 2 * Q1 * t13 * t53
    t57 = t11 * t26
    t59 = t50 * t38
    t60 = 6 * t59
    t61 = t43 * t49
    t72 = 2 * t59
    t74 = Q2 * t13 * t23
    t81 = -2 * Q1 * t13 * (t72 + t61 + 4 * t74) + 2 * t53 * t17
    t85 = pi ^ 2
    t86 = cdelta * t85
    t89 = KK ^ 2
    t91 = 1 / KK / t89
    t92 = sma ^ 2
    t94 = 0.1e1 / sma / t92
    t95 = t94 * t91
    t96 = eta ^ 2
    t98 = 0.1e1 / eta / t96
    t99 = 0.1e1 / n
    t100 = t99 * t98
    t102 = 1 / m
    t103 = 1 / t4
    t106 = sqrt(1 + k)
    t109 = 0.1e1 / Jg / t106
    t111 = t109 * t103 * t102 * t100 * t95
    contr[1] = 3/16 * t111 * t86 * (P1 * (t28 - t56 + 12 * t57 + 2 * Q2 * t13 * (t60 + 3 * t61) + 8/3 * t15 - 8/3 * t18 - 4/3 * t22) + t81 * P2) * t9 * muM * IMz * t1
    t113 = cos(psih)
    t115 = muM * sdelta
    t119 = (P1 + P2) * (P1 - P2)
    t120 = eta + 1/3
    t121 = P1 ^ 2
    t123 = P2 ^ 2
    t124 = t123 * t120
    t125 = 1 + eta
    t126 = t125 * t96
    t127 = t121 * t120 + t124 + t126
    t128 = t13 * t127
    t134 = P1 * t121 * t120 * P2
    t137 = P1 * P2 * (t124 + t126)
    t138 = t125 ^ 2
    t139 = t125 * t138
    t140 = t139 * phiTA
    t141 = -t134 - t137 + t140
    t142 = t13 * t141
    t146 = t13 * (t29 * t128 * t119 / 2 + 2 * t50 * t142)
    t148 = t134 + t137 + t140
    t149 = t13 * t148
    t151 = t127 * t119
    t153 = Q2 * t14 * t151
    t154 = t29 * t149 + t153
    t165 = t13 * (-Q1 * t128 * t119 + 2 * Q2 * t142)
    t171 = t127 * t17 * t119 - 2 * Q1 * t149
    t177 = t25 * t141
    t178 = t43 ^ 2
    t185 = t25 * t148
    t186 = t11 * t10
    t189 = 2/3 * t140
    t199 = (KK * k + EE) * m + (EE - KK) * k
    t204 = 0.1e1 / t139
    t209 = t109 * t98 * t102 * t91 * t204 * t103 * t99
    contr[2] = 3/8 * t209 * t94 * t199 * (t37 * (2 * t154 * Q2 * t14 + t43 * t146) + t23 * (2 * t50 * t13 * t171 + t43 * t165) + (2 * t43 * t127 * t50 * t25 * t119 + t178 * t177 + 4 * t186 * t185 - t189) * t48) * t85 * t115 * IMz * t113
    t211 = 2 * TL
    t212 = cos(t211)
    t216 = muM * IMz
    contr[3] = 3/16 * t111 * t216 * t81 * cdelta * t85 * t9 * t212
    t220 = 3 * TL
    t221 = cos(t220)
    t224 = t23 * P1
    t225 = t10 * t25
    t228 = P2 * t23
    t229 = t17 * t228
    t231 = P1 * t53
    t232 = t72 + t61
    t233 = t232 * P2
    t238 = t17 * t224
    t240 = -t232
    t242 = t53 * P2
    contr[4] = t111 * t86 * t9 * (4 * t225 * t224 - 2 * Q1 * t13 * (4 * t229 + t231 + t233) + 2 * (P1 * t240 - 2 * t238 + t242) * t17) * muM * IMz * t221 / 16
    t251 = t211 - psih
    t252 = cos(t251)
    t255 = t29 ^ 2
    t256 = t255 * t25
    t257 = t29 * t25
    t258 = t43 * t257
    t261 = Q1 * t257
    t262 = t43 * t25
    t263 = Q1 * t262
    t266 = t23 * (-2 * t261 - 2 * t263)
    t267 = t50 * t257
    t268 = Q1 * t25
    t270 = t43 * Q2 * t268
    t272 = 2 * t267 + 2 * t270
    t273 = t272 * t48
    contr[5] = -3/32 * t111 * (t37 * (t256 + t258) + t266 + t273) * IMz * t115 * t85 * t9 * t252
    t280 = t211 + psih
    t281 = cos(t280)
    t284 = t11 * t225
    t285 = 8 * t284
    t288 = 2 * t261
    t290 = Q1 * t11 * t25
    t291 = 8 * t290
    t292 = 2 * t263
    t294 = t23 * (-t288 - t291 + t292)
    t295 = 2 * t267
    contr[6] = 3/32 * t111 * (t37 * (t256 - t258 - t285) + t294 + (t295 - 6 * t270) * t48) * IMz * t115 * t85 * t9 * t281
    t304 = t220 - psih
    t305 = cos(t304)
    t308 = t29 * Q2 * t25
    t309 = Q2 * t262
    t311 = -2 * t308 - 2 * t309
    t312 = t23 * t311
    t315 = t25 * t48
    t316 = t178 * t315
    t317 = t25 * t37
    t318 = t43 * t50
    t320 = 2 * t318 * t317
    t323 = t255 * t317
    t324 = t43 * t38
    t329 = 2 * t59 + 2 * t61
    t334 = 2 * t318 * t315
    t336 = 4 * t186 * t317
    t337 = t266 + t323 + t29 * t13 * (t324 + t52) + 2 * t50 * t13 * t329 - t334 - t336
    t341 = t9 * muM
    t342 = sdelta * t85
    t343 = t342 * t341
    contr[7] = -t111 * t343 * (P1 * (t29 * t13 * t240 + t312 - t316 - t320) + t337 * P2) * IMz * t305 / 32
    t347 = t220 + psih
    t348 = cos(t347)
    t351 = 2 * t308
    t352 = Q2 * t225
    t353 = 8 * t352
    t354 = 2 * t309
    t355 = -t351 + t353 + t354
    t357 = -t60 - t61
    t361 = 8 * t186 * t315
    t362 = t232 * t44
    t372 = t294 + t323 + t29 * t13 * (-t324 + t52) - 2 * t50 * t13 * t329 - t334 - t336
    contr[8] = t111 * t342 * (P1 * (t29 * t13 * t357 + t23 * t355 - t361 + t362) + P2 * t372) * t9 * muM * IMz * t348 / 32
    t379 = -psih + TL
    t380 = cos(t379)
    t383 = t85 * t9
    t385 = t258 / 3
    t386 = 8/3 * t284
    t387 = t178 * t25
    t390 = 6 * t309
    t399 = 2/3 * t263
    contr[9] = -9/32 * t111 * sdelta * (P1 * (t37 * t272 + t48 * (t385 + t386 + t387 - 4/9) + (t351 - t353 + t390) * t23 / 3) + (t37 * (t256 + t385 + t386 - 4/9) + t273 + (-t288 + 8/3 * t290 - t399) * t23) * P2) * t383 * muM * IMz * t380
    t410 = psih + TL
    t411 = cos(t410)
    t415 = 2 * t270
    contr[10] = 9/32 * t111 * t342 * (P1 * (t37 * (2/3 * t267 - t415) + t48 * (t385 - t387 + 4/9) + (t351 - t390) * t23 / 3) + (t37 * (t256 - t385 - 4/9) + t48 * (t295 - 2/3 * t270) + (-t288 + t399) * t23) * P2) * t9 * muM * IMz * t411
    t439 = sin(TL)
    contr[11] = -9/16 * t111 * (P2 * (t28 - t56 + 4/3 * t57 + 2 * Q2 * t13 * (t61 / 3 + 2/3 * t59) + 8/9 * t15 - 8/9 * t18 - 4/9 * t22) + t81 * P1 / 3) * cdelta * t383 * muM * IMz * t439
    t462 = sin(psih)
    t468 = t13 * (t43 * t142 + t153)
    t476 = 2 * t50 * t149 + t43 * t128 * t119 / 2
    contr[12] = -3/8 * t209 * t94 * (t48 * (t476 * t30 + 2 * t50 * t468) + t23 * (2 * t50 * t165 + t171 * t30) + (2 * t267 * t151 + 4 * t186 * t177 + t255 * t185 - t189) * t37) * t85 * t199 * t115 * IMz * t462
    t498 = sin(t211)
    contr[13] = -3/16 * t111 * t216 * t86 * (t28 - t56 - 2 * (t72 + t61 + 2 * t74) * t17) * t9 * t498
    t510 = sin(t220)
    contr[14] = -t111 * t86 * t341 * (4 * t225 * t228 - 2 * Q1 * t13 * (-t232 * P1 - 4 * t238 + t242) - 2 * (2 * t229 + t233 + t231) * t17) * IMz * t510 / 16
    t530 = sin(t251)
    t536 = -t37 * t272
    contr[15] = 3/32 * t111 * IMz * (t48 * (-t258 - t387) + t312 + t536) * t115 * t85 * t9 * t530
    t542 = sin(t280)
    t546 = -t23 * t355
    contr[16] = 3/32 * t111 * t216 * t342 * t9 * (t48 * (t258 + t285 - t387) + t546 + (6 * t267 - t415) * t37) * t542
    t556 = sin(t304)
    contr[17] = -t111 * t342 * t9 * (P1 * t337 + P2 * (t29 * t13 * t232 - t23 * t311 + t362)) * muM * IMz * t556 / 32
    t572 = sin(t347)
    contr[18] = t111 * t342 * t9 * (P1 * t372 + P2 * (-t29 * t13 * t357 - t316 - t320 + t361 + t546)) * muM * IMz * t572 / 32
    t586 = sin(t379)
    contr[19] = -3/32 * t111 * (P1 * (t37 * (t256 - t258 + t285 - 4/3) + t273 + (-t288 + t291 + t292) * t23) + P2 * (t536 + t48 * (t258 - t285 - t387 + 4/3) + (t351 + t353 - t354) * t23)) * sdelta * t383 * muM * IMz * t586
    t607 = sin(t410)
    t609 = 16 * t284
    contr[20] = 3/32 * t111 * t343 * (P1 * (t37 * (t256 + t258 + t609 - 4/3) + t48 * (t295 + 10 * t270) + (-t288 + 16 * t290 - t292) * t23) + P2 * (t37 * (10 * t267 + t415) + t48 * (t258 + t609 + t387 - 4/3) + (t351 - 16 * t352 + t354) * t23)) * IMz * t607
    contr[21] = -3/8 * t109 * t95 * t100 * t204 * t102 * t103 * (t37 * (-2 * Q1 * t13 * t154 + 2 * Q2 * t146) + t48 * (-2 * Q1 * t13 * t476 + 2 * Q2 * t468) + t23 * (-4 * Q2 * t268 * t151 + 4 * t10 * t185 + 4 * t11 * t177 - t189)) * t86 * t199 * t216
       
    contr = sum(contr);
end

function derivativechiM3_JgP1(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)

    contr = zeros(21)
    t1 = cos(TL)
    t2 = IMz * t1
    t3 = k + m
    t4 = sqrt(t3)
    t5 = 0.1e1 / t4
    t6 = sqrt(k)
    t7 = 0.1e1 / t6
    t8 = t7 * t5
    t10 = -1 + m
    t14 = KK * t10 * k + EE * t3
    t15 = t14 * muM
    t16 = Q1 ^ 2
    t17 = Q2 ^ 2
    t18 = t16 + t17 + 1
    t19 = 1 / t18
    t20 = Q1 * t19
    t21 = cpa1EQ * t20
    t23 = Q2 * t19
    t24 = cpa2EQ * t23
    t28 = cpa3EQ * (-t16 - t17 + 1) * t19
    t29 = -2 * t21 + 2 * t24 + t28
    t30 = t18 ^ 2
    t31 = 1 / t30
    t32 = t31 * t29
    t34 = 4 * t16 * t32
    t35 = -t16 + t17 + 1
    t36 = t35 * t19
    t43 = 2 * Q2 * cpa2EQ * t20 + cpa1EQ * t36 + 2 * cpa3EQ * t20
    t44 = t19 * t43
    t49 = t16 - t17 + 1
    t50 = t49 * t19
    t54 = 2 * Q2 * cpa1EQ * t20 + cpa2EQ * t50 - 2 * cpa3EQ * t23
    t55 = t19 * t54
    t56 = Q1 * Q2
    t58 = 2 * t56 * t55
    t59 = t35 * t44 + t58
    t62 = 2 * Q1 * t19 * t59
    t63 = t17 * t32
    t65 = t56 * t44
    t66 = 6 * t65
    t67 = t49 * t55
    t78 = 2 * t65
    t80 = Q2 * t19 * t29
    t87 = -2 * Q1 * t19 * (t78 + t67 + 4 * t80) + 2 * t59 * t23
    t89 = P1 * (t34 - t62 + 12 * t63 + 2 * Q2 * t19 * (t66 + 3 * t67) + 8/3 * t21 - 8/3 * t24 - 4/3 * t28) + t87 * P2
    t93 = KK ^ 2
    t95 = 0.1e1 / KK / t93
    t97 = sma ^ 2
    t99 = 0.1e1 / sma / t97
    t100 = eta ^ 2
    t102 = 0.1e1 / eta / t100
    t103 = t102 * t99
    t105 = 0.1e1 / n
    t106 = 1 / m
    t108 = 1 / t10
    t111 = -m * KK + PP * t3
    t113 = 0.1e1 / Jg
    t115 = t113 * t111 * t108 * t106 * t105
    t116 = t115 * t103 * t95 * cdelta
    t119 = muM * t6
    t124 = 0.1e1 / KK
    t126 = t113 * cdelta
    t127 = t126 * t124 * t99
    t128 = t127 * t102 * t105 * pi
    contr[1] = -3/8 * t116 * pi * t89 * t15 * t8 * t2 + 3/8 * t128 * t89 * t119 * t5 * t2
    t131 = cos(psih)
    t133 = muM * sdelta
    t135 = pi * t7
    t138 = (P1 + P2) * (P1 - P2)
    t139 = eta + 1/3
    t140 = P1 ^ 2
    t142 = P2 ^ 2
    t143 = t142 * t139
    t144 = 1 + eta
    t145 = t144 * t100
    t146 = t140 * t139 + t143 + t145
    t147 = t19 * t146
    t153 = P1 * t140 * t139 * P2
    t156 = P1 * P2 * (t143 + t145)
    t157 = t144 ^ 2
    t158 = t144 * t157
    t159 = t158 * phiTA
    t160 = -t153 - t156 + t159
    t161 = t19 * t160
    t165 = t19 * (t35 * t147 * t138 / 2 + 2 * t56 * t161)
    t167 = t153 + t156 + t159
    t168 = t19 * t167
    t170 = t146 * t138
    t172 = Q2 * t20 * t170
    t173 = t35 * t168 + t172
    t184 = t19 * (-Q1 * t147 * t138 + 2 * Q2 * t161)
    t190 = t146 * t23 * t138 - 2 * Q1 * t168
    t196 = t31 * t160
    t197 = t49 ^ 2
    t204 = t31 * t167
    t205 = t17 * t16
    t208 = 2/3 * t159
    t217 = (KK * k + EE) * m + (EE - KK) * k
    t223 = 0.1e1 / t158
    t230 = t113 * t111 * t102 * t106 * t95 * t223 * t108 * t105 * t99
    contr[2] = -3/4 * t230 * t5 * t217 * (t43 * (2 * t173 * Q2 * t20 + t49 * t165) + t29 * (2 * t56 * t19 * t190 + t49 * t184) + (2 * t49 * t146 * t56 * t31 * t138 + t197 * t196 + 4 * t205 * t204 - t208) * t54) * t135 * t133 * IMz * t131
    t233 = 2 * TL
    t234 = cos(t233)
    t236 = pi * t5
    t238 = t87 * cdelta
    t239 = muM * IMz
    t244 = t115 * t103 * t95 * t7
    contr[3] = 3/8 * t113 * t124 * t103 * t105 * t238 * pi * t5 * muM * t6 * t234 * IMz - 3/8 * t244 * t239 * t238 * t236 * t14 * t234
    t257 = 3 * TL
    t258 = cos(t257)
    t259 = IMz * t258
    t261 = t29 * P1
    t262 = t16 * t31
    t265 = P2 * t29
    t266 = t23 * t265
    t268 = P1 * t59
    t269 = t78 + t67
    t270 = t269 * P2
    t275 = t23 * t261
    t277 = -t269
    t279 = t59 * P2
    t283 = 4 * t262 * t261 - 2 * Q1 * t19 * (4 * t266 + t268 + t270) + 2 * (P1 * t277 - 2 * t275 + t279) * t23
    t285 = pi * t14
    contr[4] = -t116 * t285 * t283 * muM * t8 * t259 / 8 + t128 * t283 * t119 * t5 * t259 / 8
    t294 = t233 - psih
    t295 = cos(t294)
    t299 = t7 * IMz * t133
    t301 = t35 ^ 2
    t302 = t301 * t31
    t303 = t35 * t31
    t304 = t49 * t303
    t307 = Q1 * t303
    t308 = t49 * t31
    t309 = Q1 * t308
    t312 = t29 * (-2 * t307 - 2 * t309)
    t313 = t56 * t303
    t314 = Q1 * t31
    t316 = t49 * Q2 * t314
    t318 = 2 * t313 + 2 * t316
    t319 = t318 * t54
    contr[5] = 3/16 * t115 * t103 * t95 * (t43 * (t302 + t304) + t312 + t319) * t299 * t236 * t14 * t295
    t325 = t233 + psih
    t326 = cos(t325)
    t330 = t17 * t262
    t331 = 8 * t330
    t334 = 2 * t307
    t335 = t17 * t31
    t336 = Q1 * t335
    t337 = 8 * t336
    t338 = 2 * t309
    t340 = t29 * (-t334 - t337 + t338)
    t341 = 2 * t313
    contr[6] = -3/16 * t115 * t103 * t95 * (t43 * (t302 - t304 - t331) + t340 + (t341 - 6 * t316) * t54) * t299 * t236 * t14 * t326
    t351 = t257 - psih
    t352 = cos(t351)
    t354 = Q2 * t31
    t355 = t35 * t354
    t356 = Q2 * t308
    t358 = -2 * t355 - 2 * t356
    t359 = t29 * t358
    t362 = t31 * t54
    t363 = t197 * t362
    t364 = t31 * t43
    t365 = t49 * t56
    t367 = 2 * t365 * t364
    t370 = t301 * t364
    t371 = t49 * t44
    t376 = 2 * t65 + 2 * t67
    t381 = 2 * t365 * t362
    t383 = 4 * t205 * t364
    t384 = t312 + t370 + t35 * t19 * (t371 + t58) + 2 * t56 * t19 * t376 - t381 - t383
    t390 = t285 * muM * t7
    t394 = t115 * t103 * t95 * sdelta
    contr[7] = t394 * t390 * (P1 * (t35 * t19 * t277 + t359 - t363 - t367) + t384 * P2) * t5 * IMz * t352 / 16
    t396 = t257 + psih
    t397 = cos(t396)
    t400 = 2 * t355
    t401 = Q2 * t262
    t402 = 8 * t401
    t403 = 2 * t356
    t404 = -t400 + t402 + t403
    t406 = -t66 - t67
    t410 = 8 * t205 * t362
    t411 = t269 * t50
    t421 = t340 + t370 + t35 * t19 * (-t371 + t58) - 2 * t56 * t19 * t376 - t381 - t383
    contr[8] = -t394 * pi * (P1 * (t35 * t19 * t406 + t29 * t404 - t410 + t411) + P2 * t421) * t15 * t8 * IMz * t397 / 16
    t429 = -psih + TL
    t430 = cos(t429)
    t434 = t304 / 3
    t435 = 8/3 * t330
    t436 = t197 * t31
    t439 = 6 * t356
    t448 = 2/3 * t309
    contr[9] = 9/16 * t394 * (P1 * (t43 * t318 + t54 * (t434 + t435 + t436 - 4/9) + (t400 - t402 + t439) * t29 / 3) + (t43 * (t302 + t434 + t435 - 4/9) + t319 + (-t334 + 8/3 * t336 - t448) * t29) * P2) * pi * t15 * t8 * IMz * t430
    t458 = psih + TL
    t459 = cos(t458)
    t463 = 2 * t316
    contr[10] = -9/16 * t394 * pi * (P1 * (t43 * (2/3 * t313 - t463) + t54 * (t434 - t436 + 4/9) + (t400 - t439) * t29 / 3) + (t43 * (t302 - t434 - 4/9) + t54 * (t341 - 2/3 * t316) + (-t334 + t448) * t29) * P2) * t15 * t8 * IMz * t459
    t488 = sin(TL)
    t489 = IMz * t488
    t491 = pi * cdelta
    t508 = P2 * (t34 - t62 + 4/3 * t63 + 2 * Q2 * t19 * (t67 / 3 + 2/3 * t65) + 8/9 * t21 - 8/9 * t24 - 4/9 * t28) + t87 * P1 / 3
    contr[11] = -9/8 * t127 * t102 * t105 * t508 * pi * t119 * t5 * t489 + 9/8 * t115 * t103 * t95 * t508 * t491 * t15 * t8 * t489
    t521 = sin(psih)
    t527 = t19 * (t49 * t161 + t172)
    t535 = 2 * t56 * t168 + t49 * t147 * t138 / 2
    contr[12] = 3/4 * t230 * t5 * (t54 * (t535 * t36 + 2 * t56 * t527) + t29 * (2 * t56 * t184 + t190 * t36) + (2 * t313 * t170 + 4 * t205 * t196 + t301 * t204 - t208) * t43) * pi * t217 * t7 * t133 * IMz * t521
    t557 = sin(t233)
    contr[13] = 3/8 * t244 * t239 * t491 * t5 * (t34 - t62 - 2 * (t78 + t67 + 2 * t80) * t23) * t14 * t557 - 3/8 * t126 * t5 * t124 * t99 * t102 * t105 * IMz * t6 * pi * muM * (-4 * Q1 * t43 * t335 - 2 * Q1 * t35 * t364 - 4 * Q2 * t16 * t362 - 2 * t49 * t54 * t354 + t34 - 4 * t63) * t557
    t595 = sin(t257)
    t596 = IMz * t595
    t609 = 4 * t262 * t265 - 2 * Q1 * t19 * (-t269 * P1 - 4 * t275 + t279) - 2 * (2 * t266 + t270 + t268) * t23
    contr[14] = -t128 * muM * t6 * t609 * t5 * t596 / 8 + t116 * t390 * t609 * t5 * t596 / 8
    t620 = sin(t294)
    t626 = -t43 * t318
    contr[15] = -3/16 * t244 * IMz * (t54 * (-t304 - t436) + t359 + t626) * t133 * t236 * t14 * t620
    t633 = sin(t325)
    t637 = -t29 * t404
    t645 = pi * sdelta
    contr[16] = -3/16 * t244 * t239 * t645 * t5 * t14 * (t54 * (t304 + t331 - t436) + t637 + (6 * t313 - t463) * t43) * t633
    t650 = sin(t351)
    contr[17] = t394 * t285 * (P1 * t384 + P2 * (t35 * t19 * t269 - t29 * t358 + t411)) * muM * t8 * IMz * t650 / 16
    t665 = sin(t396)
    contr[18] = -t394 * t285 * (P1 * t421 + P2 * (-t35 * t19 * t406 - t363 - t367 + t410 + t637)) * muM * t8 * IMz * t665 / 16
    t680 = sin(t429)
    contr[19] = 3/16 * t115 * t103 * t95 * (P1 * (t43 * (t302 - t304 + t331 - 4/3) + t319 + (-t334 + t337 + t338) * t29) + P2 * (t626 + t54 * (t304 - t331 - t436 + 4/3) + (t400 + t402 - t403) * t29)) * t645 * t15 * t8 * IMz * t680
    t702 = sin(t458)
    t703 = IMz * t702
    t704 = 16 * t330
    contr[20] = -3/16 * t394 * t390 * (P1 * (t43 * (t302 + t304 + t704 - 4/3) + t54 * (t341 + 10 * t316) + (-t334 + 16 * t336 - t338) * t29) + P2 * (t43 * (10 * t313 + t463) + t54 * (t304 + t704 + t436 - 4/3) + (t400 - 16 * t401 + t403) * t29)) * t5 * t703
    t755 = t5 * (t43 * (-2 * Q1 * t19 * t173 + 2 * Q2 * t165) + t54 * (-2 * Q1 * t19 * t535 + 2 * Q2 * t527) + t29 * (-4 * Q2 * t314 * t170 + 4 * t16 * t204 + 4 * t17 * t196 - t208))
    contr[21] = -3/4 * t127 * t102 * t105 * t223 * t755 * muM * pi * t6 * t703 + 3/4 * t230 * t755 * t135 * cdelta * t217 * t239
      

    contr = sum(contr);
    return contr;
end

function derivativechiM3_JgP2(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)

    contr = zeros(14)
    t2 = muM * pi * IMz
    t3 = sqrt(k)
    t4 = eta + 1/3
    t5 = Q2 * Q1
    t7 = 2 * cpa2EQ * t5
    t8 = Q1 ^ 2
    t9 = Q2 ^ 2
    t10 = t8 - t9 + 1
    t12 = t10 * cpa1EQ + t7
    t13 = t12 * t4
    t14 = P1 ^ 2
    t15 = t14 ^ 2
    t19 = -t10 / 2
    t21 = cpa1EQ * t5
    t22 = cpa2EQ * t19 + t21
    t24 = P1 * t14
    t28 = eta ^ 2
    t29 = 1 + eta
    t30 = t29 * t28
    t34 = P2 ^ 2
    t36 = t34 * t4 + t30
    t41 = t34 ^ 2
    t50 = 2 * cpa3EQ
    t55 = t29 ^ 2
    t56 = t29 * t55
    t60 = cos(psih)
    t61 = cdelta ^ 2
    t66 = sqrt(k + m)
    t67 = 0.1e1 / t66
    t69 = 1 / (t8 + t9 + 1)
    t72 = 0.1e1 / n
    t77 = sma ^ 2
    t84 = 0.1e1 / KK / Jg / sma / t77 / eta / t28
    t85 = t84 * t72 / t56 * t69 * t67
    contr[1] = -t85 * t61 * t60 * (3/4 * t15 * t13 + 3 * t24 * P2 * t22 * t4 + 3/4 * t14 * t12 * t30 + 3 * P2 * P1 * t36 * t22 - 3/4 * t41 * t13 - 3/4 * t34 * t12 * t30 + t56 * phiTA * (-cpa2EQ * t19 + (Q1 * cpa1EQ + t50) * Q2)) * t3 * t2 / 2
    t88 = 2 * TL
    t89 = t88 - psih
    t90 = cos(t89)
    t93 = muM * IMz
    t99 = t84 * t72 * t61 * t69
    contr[2] = 3/8 * t99 * cpa1EQ * t3 * t93 * pi * t67 * t90
    t101 = t88 + psih
    t102 = cos(t101)
    t105 = cpa1EQ * t8
    t106 = cpa1EQ * t9
    contr[3] = 3/8 * t99 * (t105 + t7 - t106) * t3 * t93 * pi * t67 * t102
    t112 = 3 * TL
    t113 = t112 - psih
    t114 = cos(t113)
    t121 = muM * t3
    t126 = t84 * t72 * t61 * pi
    contr[4] = -t126 * t121 * t69 * (cpa2EQ * P1 - P2 * cpa1EQ) * t67 * IMz * t114 / 8
    t129 = t112 + psih
    t130 = cos(t129)
    t133 = t8 * P1
    t135 = P1 * Q1
    t136 = Q2 * cpa1EQ
    t139 = t9 * P1
    t141 = t8 * P2
    t143 = P2 * Q1
    t144 = Q2 * cpa2EQ
    t147 = t9 * P2
    contr[5] = -t126 * t69 * (-cpa1EQ * t141 + cpa1EQ * t147 + cpa2EQ * t133 - cpa2EQ * t139 - 2 * t136 * t135 - 2 * t144 * t143) * t121 * t67 * IMz * t130 / 8
    t155 = -psih + TL
    t156 = cos(t155)
    t157 = cpa2EQ * t8
    t158 = t157 / 2
    t159 = cpa2EQ * t9
    t160 = t159 / 2
    t161 = Q2 * cpa3EQ
    t162 = 2 * t161
    t169 = Q1 * (-2 * t144 + 4 * cpa3EQ)
    t178 = t67 * t3
    t179 = t178 * pi * IMz
    contr[6] = t99 * t179 * muM * (P1 * (t21 + t158 - t160 + t162 + 2 * cpa2EQ) - P2 * (t105 + t169 - t106 - 4 * cpa1EQ) / 2) * t156 / 4
    t182 = psih + TL
    t183 = cos(t182)
    contr[7] = -t99 * t179 * muM * (P1 * (t21 - t157 + t159 - t161 - cpa2EQ / 4) - P2 * (t105 + Q1 * (t144 + cpa3EQ) - t106 - cpa1EQ / 4)) * t183 / 2
    t198 = sin(psih)
    t200 = t8 - t9 - 1
    t203 = t21 - t200 * cpa2EQ / 2
    t204 = t203 * t4
    t208 = cpa1EQ * t200
    t209 = t208 + t7
    t213 = t28 * t203
    contr[8] = -t85 * t61 * (-3 * t15 * t204 + 3 * t24 * t209 * P2 * t4 - 3 * t14 * t29 * t213 + 3 * P1 * t209 * P2 * t36 + 3 * t41 * t204 + 3 * t34 * t29 * t213 + t56 * phiTA * (t208 - 2 * (t144 - t50) * Q1)) * t198 * t3 * t2 / 4
    t244 = sin(t89)
    contr[9] = 3/8 * t84 * t72 * t67 * t244 * t3 * pi * t61 * muM * t69 * cpa2EQ * IMz
    t250 = sin(t101)
    contr[10] = 3/8 * t84 * t72 * t178 * pi * t69 * (t157 - 2 * t21 - t159) * t250 * t61 * t93
    t260 = sin(t113)
    contr[11] = t84 * t72 * IMz * t69 * (cpa1EQ * P1 + cpa2EQ * P2) * t3 * t67 * pi * muM * t61 * t260 / 8
    t274 = sin(t129)
    contr[12] = t126 * t69 * (cpa1EQ * t133 - cpa1EQ * t139 + cpa2EQ * t141 - cpa2EQ * t147 + 2 * t144 * t135 - 2 * t136 * t143) * t121 * t67 * IMz * t274 / 8
    t290 = sin(t155)
    contr[13] = -t99 * (P1 * (t105 + t169 - t106 + 2 * cpa1EQ) + 2 * (t21 + t158 - t160 + t162 - cpa2EQ) * P2) * t67 * t3 * IMz * pi * muM * t290 / 8
    t306 = sin(t182)
    contr[14] = -t99 * t179 * muM * (P1 * (t105 + Q1 * (4 * t144 - t50) - t106 + cpa1EQ / 2) + 4 * P2 * (t21 - t157 / 4 + t159 / 4 + t161 / 2 + cpa2EQ / 8)) * t306 / 4
       
    contr = sum(contr);
    return contr;
end

function derivativechiM3_JhP1(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)
    contr = zeros(7)
    t1 = Q1 ^ 2
    t4 = Q2 ^ 2
    t7 = Q1 * cpa1EQ
    t8 = Q2 * cpa2EQ
    t15 = -Q1 * cpa2EQ + Q2 * cpa1EQ
    t20 = sqrt(k + m)
    t21 = 0.1e1 / t20
    t25 = sqrt(k)
    t26 = t25 * IMz * pi
    t28 = cos(TL)
    t30 = 1 / (t1 + t4 + 1)
    t32 = 0.1e1 / n
    t34 = eta ^ 2
    t37 = sma ^ 2
    t44 = 0.1e1 / KK / Jg / sma / t37 / eta / t34
    contr[1] = -t44 * t32 * t30 * t28 * t26 * muM * t21 * (P1 * (2 * cpa3EQ * t1 + 2 * cpa3EQ * t4 - 2 * cpa3EQ + t7 + 5 * t8) + 3 * t15 * P2) / 4
    t48 = t21 * IMz
    t51 = 2 * TL
    t52 = cos(t51)
    contr[2] = -3/4 * t44 * t32 * t30 * t15 * t52 * pi * t25 * muM * t48
    t60 = t25 * t48
    t61 = Q1 * P1
    t63 = Q2 * P1
    t65 = Q1 * P2
    t67 = Q2 * P2
    t73 = 3 * TL
    t74 = cos(t73)
    contr[3] = t44 * t32 * t74 * pi * t30 * (cpa1EQ * t61 - cpa1EQ * t67 + cpa2EQ * t63 + cpa2EQ * t65) * muM * t60 / 4
    t86 = cpa2EQ * t61
    t88 = cpa1EQ * t63
    t90 = cpa1EQ * t65
    t92 = cpa2EQ * t67
    t98 = sin(TL)
    contr[4] = -t44 * t32 * t98 * t30 * (-2 * cpa3EQ * t1 * P2 - 2 * cpa3EQ * t4 * P2 + 2 * P2 * cpa3EQ + 3 * t86 - 3 * t88 + 5 * t90 + t92) * pi * muM * t60 / 4
    t104 = t7 + t8
    t108 = sin(t51)
    contr[5] = -3/4 * t44 * t32 * t108 * t21 * t26 * muM * t30 * t104
    t119 = sin(t73)
    contr[6] = t44 * t32 * t119 * pi * muM * t25 * t30 * (t86 - t88 - t90 - t92) * t48 / 4
    t124 = 1 + eta
    t125 = t124 ^ 2
    t126 = t124 * t125
    t132 = eta + 1/3
    t133 = P1 ^ 2
    t135 = P2 ^ 2
    contr[7] = -t44 * t32 / t126 * t30 * t60 * pi * muM * (phiTA * (t7 - t8 - cpa3EQ * (t1 + t4 - 1)) * t126 - 3/2 * (-2 * P1 * t104 * P2 + t133 * t15 - t15 * t135) * (t124 * t34 + t133 * t132 + t135 * t132)) / 2
       
    contr = sum(contr);
    return contr;
end

function derivativechiM3_JhP2(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)
    
    contr = zeros(14)
    t1 = pi * muM
    t2 = IMz * t1
    t3 = sqrt(k)
    t4 = eta + 1/3
    t5 = Q2 * Q1
    t7 = 2 * cpa2EQ * t5
    t8 = Q1 ^ 2
    t9 = Q2 ^ 2
    t10 = t8 - t9 + 1
    t12 = t10 * cpa1EQ + t7
    t13 = t12 * t4
    t14 = P1 ^ 2
    t15 = t14 ^ 2
    t19 = -t10 / 2
    t21 = cpa1EQ * t5
    t22 = cpa2EQ * t19 + t21
    t24 = P1 * t14
    t28 = eta ^ 2
    t29 = 1 + eta
    t30 = t29 * t28
    t34 = P2 ^ 2
    t36 = t34 * t4 + t30
    t41 = t34 ^ 2
    t50 = 2 * cpa3EQ
    t55 = t29 ^ 2
    t56 = t29 * t55
    t60 = cos(psih)
    t65 = sqrt(k + m)
    t66 = 0.1e1 / t65
    t68 = 1 / (t8 + t9 + 1)
    t71 = 0.1e1 / n
    t76 = sma ^ 2
    t83 = 0.1e1 / KK / Jg / sma / t76 / eta / t28
    t84 = t83 * t71 / t56 * t68 * t66
    contr[1] = t84 * cdelta * t60 * (3/4 * t15 * t13 + 3 * t24 * P2 * t22 * t4 + 3/4 * t14 * t12 * t30 + 3 * P2 * P1 * t36 * t22 - 3/4 * t41 * t13 - 3/4 * t34 * t12 * t30 + t56 * phiTA * (-cpa2EQ * t19 + (Q1 * cpa1EQ + t50) * Q2)) * t3 * t2 / 2
    t87 = muM * pi * t66
    t88 = t3 * IMz
    t92 = 2 * TL
    t93 = t92 - psih
    t94 = cos(t93)
    contr[2] = -3/8 * t83 * t71 * t94 * cdelta * t68 * cpa1EQ * t88 * t87
    t100 = cpa1EQ * t8
    t101 = cpa1EQ * t9
    t106 = t92 + psih
    t107 = cos(t106)
    contr[3] = -3/8 * t83 * t71 * t107 * cdelta * t68 * (t100 + t7 - t101) * t88 * t87
    t113 = t66 * IMz
    t121 = 3 * TL
    t122 = t121 - psih
    t123 = cos(t122)
    contr[4] = t83 * t71 * t123 * cdelta * t1 * t3 * t68 * (cpa2EQ * P1 - P2 * cpa1EQ) * t113 / 8
    t128 = t3 * t113
    t129 = t8 * P1
    t131 = P1 * Q1
    t132 = Q2 * cpa1EQ
    t135 = t9 * P1
    t137 = t8 * P2
    t139 = P2 * Q1
    t140 = Q2 * cpa2EQ
    t143 = t9 * P2
    t147 = pi * t68
    t150 = t121 + psih
    t151 = cos(t150)
    contr[5] = t83 * t71 * t151 * cdelta * t147 * (-cpa1EQ * t137 + cpa1EQ * t143 + cpa2EQ * t129 - cpa2EQ * t135 - 2 * t132 * t131 - 2 * t140 * t139) * muM * t128 / 8
    t156 = -psih + TL
    t157 = cos(t156)
    t158 = cpa2EQ * t8
    t159 = t158 / 2
    t160 = cpa2EQ * t9
    t161 = t160 / 2
    t162 = Q2 * cpa3EQ
    t163 = 2 * t162
    t170 = Q1 * (-2 * t140 + 4 * cpa3EQ)
    t179 = t66 * t3
    t180 = t179 * pi * IMz
    t184 = t83 * t71 * t68 * cdelta
    contr[6] = -t184 * t180 * muM * (P1 * (t21 + t159 - t161 + t163 + 2 * cpa2EQ) - P2 * (t100 + t170 - t101 - 4 * cpa1EQ) / 2) * t157 / 4
    t187 = psih + TL
    t188 = cos(t187)
    contr[7] = t184 * t180 * muM * (P1 * (t21 - t158 + t160 - t162 - cpa2EQ / 4) - P2 * (t100 + Q1 * (t140 + cpa3EQ) - t101 - cpa1EQ / 4)) * t188 / 2
    t202 = sin(psih)
    t204 = t8 - t9 - 1
    t207 = t21 - t204 * cpa2EQ / 2
    t208 = t207 * t4
    t212 = cpa1EQ * t204
    t213 = t212 + t7
    t217 = t28 * t207
    contr[8] = t84 * cdelta * (-3 * t15 * t208 + 3 * t24 * t213 * P2 * t4 - 3 * t14 * t29 * t217 + 3 * P1 * t213 * P2 * t36 + 3 * t41 * t208 + 3 * t34 * t29 * t217 + t56 * phiTA * (t212 - 2 * (t140 - t50) * Q1)) * t202 * t3 * t2 / 4
    t243 = muM * cdelta
    t247 = sin(t93)
    contr[9] = -3/8 * t83 * t71 * t66 * t247 * t3 * pi * t243 * t68 * cpa2EQ * IMz
    t255 = sin(t106)
    contr[10] = -3/8 * t83 * t71 * t179 * t147 * (t158 - 2 * t21 - t160) * t255 * IMz * muM * cdelta
    t272 = sin(t122)
    contr[11] = -t83 * t71 * t272 * IMz * t68 * (cpa1EQ * P1 + cpa2EQ * P2) * t179 * pi * t243 / 8
    t290 = sin(t150)
    contr[12] = -t83 * t71 * t290 * cdelta * t147 * (cpa1EQ * t129 - cpa1EQ * t135 + cpa2EQ * t137 - cpa2EQ * t143 + 2 * t140 * t131 - 2 * t132 * t139) * muM * t128 / 8
    t296 = sin(t156)
    contr[13] = t184 * (P1 * (t100 + t170 - t101 + 2 * cpa1EQ) + 2 * (t21 + t159 - t161 + t163 - cpa2EQ) * P2) * t66 * t88 * pi * muM * t296 / 8
    t310 = sin(t187)
    contr[14] = t184 * t180 * muM * (P1 * (t100 + Q1 * (4 * t140 - t50) - t101 + cpa1EQ / 2) + 4 * P2 * (t21 - t158 / 4 + t160 / 4 + t162 / 2 + cpa2EQ / 8)) * t310 / 4
      
    contr = sum(contr)
    return contr
end

function derivativechiM3_psil(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)

   return 0.0;
end

function derivativechiM3_psig(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)
    return 0.0;
end

function derivativechiM3_psih(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)
    contr = zeros(14)
    t1 = sin(psih)
    t4 = sdelta * pi
    t5 = sqrt(k)
    t6 = eta + 1/3
    t7 = Q2 * Q1
    t9 = 2 * cpa2EQ * t7
    t10 = Q1 ^ 2
    t11 = Q2 ^ 2
    t12 = t10 - t11 + 1
    t14 = t12 * cpa1EQ + t9
    t15 = t14 * t6
    t16 = P1 ^ 2
    t17 = t16 ^ 2
    t21 = -t12 / 2
    t23 = cpa1EQ * t7
    t24 = cpa2EQ * t21 + t23
    t26 = P1 * t16
    t30 = eta ^ 2
    t31 = 1 + eta
    t32 = t31 * t30
    t36 = P2 ^ 2
    t38 = t36 * t6 + t32
    t43 = t36 ^ 2
    t52 = 2 * cpa3EQ
    t57 = t31 ^ 2
    t58 = t31 * t57
    t65 = sqrt(k + m)
    t66 = 0.1e1 / t65
    t68 = 1 / (t10 + t11 + 1)
    t76 = sma ^ 2
    t81 = 0.1e1 / KK / sma / t76 / eta / t30 / n
    t82 = t81 / t58 * t68 * t66
    contr[1] = t82 * (3/4 * t17 * t15 + 3 * t26 * P2 * t24 * t6 + 3/4 * t16 * t14 * t32 + 3 * P2 * P1 * t38 * t24 - 3/4 * t43 * t15 - 3/4 * t36 * t14 * t32 + t58 * phiTA * (-cpa2EQ * t21 + (Q1 * cpa1EQ + t52) * Q2)) * t5 * t4 * IMz * muM * t1 / 2
    t88 = t5 * IMz * muM * sdelta * pi * t66
    t90 = 2 * TL
    t91 = t90 - psih
    t92 = sin(t91)
    contr[2] = 3/8 * t81 * t92 * t68 * cpa1EQ * t88
    t96 = cpa1EQ * t10
    t97 = cpa1EQ * t11
    t100 = t90 + psih
    t101 = sin(t100)
    contr[3] = -3/8 * t81 * t101 * t68 * (t96 + t9 - t97) * t88
    t106 = t66 * IMz
    t114 = 3 * TL
    t115 = t114 - psih
    t116 = sin(t115)
    contr[4] = -t81 * t116 * t4 * muM * t5 * t68 * (cpa2EQ * P1 - P2 * cpa1EQ) * t106 / 8
    t121 = t5 * t106
    t122 = t10 * P1
    t124 = P1 * Q1
    t125 = Q2 * cpa1EQ
    t128 = t11 * P1
    t130 = t10 * P2
    t132 = P2 * Q1
    t133 = Q2 * cpa2EQ
    t136 = t11 * P2
    t142 = t114 + psih
    t143 = sin(t142)
    contr[5] = t81 * t143 * t4 * t68 * (-cpa1EQ * t130 + cpa1EQ * t136 + cpa2EQ * t122 - cpa2EQ * t128 - 2 * t125 * t124 - 2 * t133 * t132) * muM * t121 / 8
    t149 = cpa2EQ * t10
    t150 = t149 / 2
    t151 = cpa2EQ * t11
    t152 = t151 / 2
    t153 = Q2 * cpa3EQ
    t154 = 2 * t153
    t161 = Q1 * (-2 * t133 + 4 * cpa3EQ)
    t168 = -psih + TL
    t169 = sin(t168)
    t172 = t5 * pi
    t174 = t81 * t68 * t172
    contr[6] = t174 * t169 * (P1 * (t23 + t150 - t152 + t154 + 2 * cpa2EQ) - P2 * (t96 + t161 - t97 - 4 * cpa1EQ) / 2) * IMz * sdelta * muM * t66 / 4
    t187 = IMz * sdelta
    t188 = psih + TL
    t189 = sin(t188)
    contr[7] = t174 * t189 * t187 * muM * t66 * (P1 * (t23 - t149 + t151 - t153 - cpa2EQ / 4) - P2 * (t96 + Q1 * (t133 + cpa3EQ) - t97 - cpa1EQ / 4)) / 2
    t193 = cos(psih)
    t194 = t10 - t11 - 1
    t197 = t23 - t194 * cpa2EQ / 2
    t198 = t197 * t6
    t202 = cpa1EQ * t194
    t203 = t202 + t9
    t207 = t30 * t197
    contr[8] = -t82 * t172 * t187 * muM * (-3 * t17 * t198 + 3 * t26 * t203 * P2 * t6 - 3 * t16 * t31 * t207 + 3 * P1 * t203 * P2 * t38 + 3 * t43 * t198 + 3 * t36 * t31 * t207 + t58 * phiTA * (t202 - 2 * (t133 - t52) * Q1)) * t193 / 4
    t235 = cos(t91)
    contr[9] = -3/8 * t81 * t66 * t68 * cpa2EQ * muM * IMz * t235 * pi * t5 * sdelta
    t252 = cos(t100)
    contr[10] = 3/8 * t81 * t252 * t66 * t5 * sdelta * muM * IMz * pi * t68 * (t149 - 2 * t23 - t151)
    t258 = cos(t115)
    contr[11] = -t81 * IMz * t68 * (cpa1EQ * P1 + cpa2EQ * P2) * pi * sdelta * t258 * t66 * muM * t5 / 8
    t282 = cos(t142)
    contr[12] = t81 * t282 * t4 * t68 * (cpa1EQ * t122 - cpa1EQ * t128 + cpa2EQ * t130 - cpa2EQ * t136 + 2 * t133 * t124 - 2 * t125 * t132) * muM * t121 / 8
    t295 = cos(t168)
    contr[13] = t174 * t295 * t187 * muM * (P1 * (t96 + t161 - t97 + 2 * cpa1EQ) + 2 * (t23 + t150 - t152 + t154 - cpa2EQ) * P2) * t66 / 8
    t315 = cos(t188)
    contr[14] = -t174 * t315 * t187 * muM * t66 * (P1 * (t96 + Q1 * (4 * t133 - t52) - t97 + cpa1EQ / 2) + 4 * P2 * (t23 - t149 / 4 + t151 / 4 + t153 / 2 + cpa2EQ / 8)) / 4
       
    contr = sum(contr)
    return contr
end

function derivativechiM3_cdeltapsigMpsihOsdelta(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)
    
    contr = zeros(14);
    t2 = sqrt(k)
    t3 = t2 * IMz * muM
    t4 = sin(psih)
    t5 = eta + 1/3
    t6 = Q2 * Q1
    t8 = 2 * cpa2EQ * t6
    t9 = Q1 ^ 2
    t10 = Q2 ^ 2
    t11 = t9 - t10 + 1
    t13 = t11 * cpa1EQ + t8
    t14 = t13 * t5
    t15 = P1 ^ 2
    t16 = t15 ^ 2
    t20 = -t11 / 2
    t22 = cpa1EQ * t6
    t23 = cpa2EQ * t20 + t22
    t25 = P1 * t15
    t29 = eta ^ 2
    t30 = 1 + eta
    t31 = t30 * t29
    t35 = P2 ^ 2
    t37 = t35 * t5 + t31
    t42 = t35 ^ 2
    t51 = 2 * cpa3EQ
    t56 = t30 ^ 2
    t57 = t30 * t56
    t64 = sqrt(k + m)
    t65 = 0.1e1 / t64
    t67 = 1 / (t9 + t10 + 1)
    t71 = 0.1e1 / n
    t73 = 0.1e1 / eta / t29
    t75 = sma ^ 2
    t77 = 0.1e1 / sma / t75
    t78 = 0.1e1 / KK
    t81 = t78 * t77 * t73 * t71 / t57 * t67 * t65
    contr[1] = -t81 * pi * (3/4 * t16 * t14 + 3 * t25 * P2 * t23 * t5 + 3/4 * t15 * t13 * t31 + 3 * P2 * P1 * t37 * t23 - 3/4 * t42 * t14 - 3/4 * t35 * t13 * t31 + t57 * phiTA * (-cpa2EQ * t20 + (Q1 * cpa1EQ + t51) * Q2)) * t4 * t3 / 2
    t85 = muM * pi * t65
    t86 = t2 * IMz
    t89 = 2 * TL
    t90 = t89 - psih
    t91 = sin(t90)
    t95 = t78 * t77 * t73
    contr[2] = -3/8 * t95 * t71 * t91 * t67 * cpa1EQ * t86 * t85
    t99 = cpa1EQ * t9
    t100 = cpa1EQ * t10
    t104 = t89 + psih
    t105 = sin(t104)
    contr[3] = 3/8 * t95 * t71 * t105 * t67 * (t99 + t8 - t100) * t86 * t85
    t110 = t65 * IMz
    t118 = 3 * TL
    t119 = t118 - psih
    t120 = sin(t119)
    contr[4] = t95 * t71 * t120 * pi * muM * t2 * t67 * (cpa2EQ * P1 - P2 * cpa1EQ) * t110 / 8
    t125 = t2 * t110
    t126 = t9 * P1
    t128 = P1 * Q1
    t129 = Q2 * cpa1EQ
    t132 = t10 * P1
    t134 = t9 * P2
    t136 = P2 * Q1
    t137 = Q2 * cpa2EQ
    t140 = t10 * P2
    t146 = t118 + psih
    t147 = sin(t146)
    contr[5] = -t95 * t71 * t147 * pi * t67 * (-cpa1EQ * t134 + cpa1EQ * t140 + cpa2EQ * t126 - cpa2EQ * t132 - 2 * t129 * t128 - 2 * t137 * t136) * muM * t125 / 8
    t153 = -psih + TL
    t154 = sin(t153)
    t156 = cpa2EQ * t9
    t157 = t156 / 2
    t158 = cpa2EQ * t10
    t159 = t158 / 2
    t160 = Q2 * cpa3EQ
    t161 = 2 * t160
    t168 = Q1 * (-2 * t137 + 4 * cpa3EQ)
    t178 = t95 * t71 * t67 * pi
    contr[6] = -t178 * t125 * (P1 * (t22 + t157 - t159 + t161 + 2 * cpa2EQ) - P2 * (t99 + t168 - t100 - 4 * cpa1EQ) / 2) * muM * t154 / 4
    t181 = psih + TL
    t182 = sin(t181)
    contr[7] = -t178 * (P1 * (t22 - t156 + t158 - t160 - cpa2EQ / 4) - P2 * (t99 + Q1 * (t137 + cpa3EQ) - t100 - cpa1EQ / 4)) * t110 * t2 * muM * t182 / 2
    t198 = t9 - t10 - 1
    t201 = t22 - t198 * cpa2EQ / 2
    t202 = t201 * t5
    t206 = cpa1EQ * t198
    t207 = t206 + t8
    t211 = t29 * t201
    t233 = cos(psih)
    contr[8] = t81 * pi * t233 * t2 * IMz * muM * (-3 * t16 * t202 + 3 * t25 * t207 * P2 * t5 - 3 * t15 * t30 * t211 + 3 * P1 * t207 * P2 * t37 + 3 * t42 * t202 + 3 * t35 * t30 * t211 + t57 * phiTA * (t206 - 2 * (t137 - t51) * Q1)) / 4
    t243 = cos(t90)
    contr[9] = 3/8 * t95 * t71 * t65 * t243 * t67 * cpa2EQ * muM * IMz * pi * t2
    t253 = cos(t104)
    contr[10] = -3/8 * t95 * t71 * t253 * t65 * t3 * pi * t67 * (t156 - 2 * t22 - t158)
    t260 = cos(t119)
    contr[11] = t95 * t71 * IMz * pi * t65 * t67 * (cpa1EQ * P1 + cpa2EQ * P2) * t260 * muM * t2 / 8
    t284 = cos(t146)
    contr[12] = -t95 * t71 * t284 * pi * t67 * (cpa1EQ * t126 - cpa1EQ * t132 + cpa2EQ * t134 - cpa2EQ * t140 + 2 * t137 * t128 - 2 * t129 * t136) * muM * t125 / 8
    t290 = cos(t153)
    contr[13] = -t95 * t71 * t67 * (P1 * (t99 + t168 - t100 + 2 * cpa1EQ) + 2 * (t22 + t157 - t159 + t161 - cpa2EQ) * P2) * pi * t110 * t2 * muM * t290 / 8
    t307 = cos(t181)
    contr[14] = t178 * t125 * (P1 * (t99 + Q1 * (4 * t137 - t51) - t100 + cpa1EQ / 2) + 4 * P2 * (t22 - t156 / 4 + t158 / 4 + t160 / 2 + cpa2EQ / 8)) * muM * t307 / 4
     

    contr = sum(contr);
    return contr;
end

###############################################################################################################################################################################################
# case k=0 smk!=0

function derivativechiM2_psil_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    contr = zeros(54)
    t1 = sqrt(smk)
    t3 = cos(psil)
    t6 = Q1 ^ 2
    t7 = Q2 ^ 2
    t11 = Q2 * cpa2EQ
    t13 = muM * (cpa3EQ * (t6 + t7 - 1) - Q1 * cpa1EQ + t11)
    t15 = 1 / (t6 + t7 + 1)
    t16 = rc ^ 2
    t18 = 0.1e1 / t16 / rc
    t19 = t18 * t15
    t20 = 0.1e1 / npsil
    t22 = t20 * t19 * t13
    contr[1] = t22 * cdelta * t3 * IMx * t1
    t23 = psig - psil
    t24 = cos(t23)
    t26 = sqrt(skm)
    t27 = t26 - 1
    t28 = t27 * sdelta
    t30 = npsil - npsig
    t33 = 1 / t30 * t19 * t13
    contr[2] = t33 * t28 * IMx * t24 / 2
    t35 = t26 + 1
    t36 = psig + psil
    t37 = cos(t36)
    t42 = 0.1e1 / (npsil + npsig)
    t44 = t42 * t19 * t13
    contr[3] = t44 * IMx * sdelta * t37 * t35 / 2
    t46 = t1 * cdelta
    t47 = Q1 * IMx
    t48 = cpa1EQ * t47
    t49 = Q2 * IMx
    t50 = cpa2EQ * t49
    t51 = Q1 * IMy
    t52 = cpa2EQ * t51
    t53 = Q2 * IMy
    t54 = cpa1EQ * t53
    t55 = t48 + t50 - t52 + t54
    t56 = t55 * muM
    t58 = 2 * TL
    t59 = -psil + t58
    t60 = cos(t59)
    t62 = t20 * t18
    contr[4] = -3/2 * t62 * t60 * t15 * t56 * t46
    t66 = -psil + psih
    t67 = cos(t66)
    t76 = -2 * Q1 * Q2 * cpa1EQ - 4 * Q2 * cpa3EQ - cpa2EQ * t6 + cpa2EQ * t7 - cpa2EQ
    t84 = cpa1EQ * t6 + Q1 * (-2 * t11 + 4 * cpa3EQ) - cpa1EQ * t7 - cpa1EQ
    t85 = t84 * IMy
    t87 = (IMx * t76 + t85) * muM
    t89 = t15 * sdelta
    t90 = t62 * t89
    contr[5] = t90 * t87 * t67 * t1 / 4
    t92 = t48 + t50 + t52 - t54
    t93 = t92 * muM
    t95 = psil + t58
    t96 = cos(t95)
    contr[6] = -3/2 * t62 * t96 * t15 * t93 * t46
    t101 = psil + psih
    t102 = cos(t101)
    t104 = muM * sdelta
    t106 = -t76
    t108 = IMx * t106 + t85
    contr[7] = -t62 * t15 * t108 * t104 * t102 * t1 / 4
    t115 = t58 - psig - psil
    t116 = cos(t115)
    t118 = t42 * t18
    contr[8] = -3/4 * t118 * t116 * t15 * t55 * t35 * t104
    t123 = t58 - psig + psil
    t124 = cos(t123)
    t128 = -1 / t30 * t18
    contr[9] = 3/4 * t128 * t124 * t15 * t93 * t28
    t132 = t58 + psig - psil
    t133 = cos(t132)
    contr[10] = 3/4 * t128 * t133 * t15 * t56 * t28
    t139 = t58 + psig + psil
    t140 = cos(t139)
    contr[11] = -3/4 * t118 * t140 * t15 * t92 * t35 * t104
    t146 = -psih + psig - psil
    t147 = cos(t146)
    t150 = cdelta - 1
    t151 = t15 * t150
    t152 = t128 * t151
    contr[12] = -t152 * t147 * muM * t27 * t108 / 8
    t155 = -psih + psig + psil
    t156 = cos(t155)
    t159 = t118 * t151
    contr[13] = -t159 * t35 * t156 * t87 / 8
    t162 = t1 * sdelta
    t163 = IMx * cpa2EQ
    t164 = IMy * cpa1EQ
    t165 = t163 + t164
    t166 = t165 * muM
    t168 = -psih - psil + t58
    t169 = cos(t168)
    contr[14] = 3/4 * t62 * t169 * t15 * t166 * t162
    t174 = t15 * (t163 - t164)
    t176 = -psih + psil + t58
    t177 = cos(t176)
    contr[15] = 3/4 * t62 * t177 * muM * t174 * t162
    t181 = cdelta + 1
    t182 = t27 * t181
    t184 = psih + psig - psil
    t185 = cos(t184)
    contr[16] = t128 * t15 * t185 * t87 * t182 / 8
    t190 = psih + psig + psil
    t191 = cos(t190)
    t194 = t15 * t35
    t195 = t118 * t194
    contr[17] = t195 * t191 * muM * t108 * t181 / 8
    t197 = t6 * IMx
    t198 = cpa2EQ * t197
    t199 = Q2 * cpa1EQ
    t201 = 2 * t199 * t47
    t202 = t7 * IMx
    t203 = cpa2EQ * t202
    t204 = t6 * IMy
    t205 = cpa1EQ * t204
    t207 = 2 * t11 * t51
    t208 = t7 * IMy
    t209 = cpa1EQ * t208
    t210 = t198 - t201 - t203 + t205 + t207 - t209
    t213 = psih - psil + t58
    t214 = cos(t213)
    contr[18] = 3/4 * t62 * t214 * t15 * t210 * muM * t162
    t219 = t15 * (t198 - t201 - t203 - t205 - t207 + t209)
    t221 = psih + psil + t58
    t222 = cos(t221)
    contr[19] = 3/4 * t62 * t222 * muM * t162 * t219
    t226 = muM * t35
    t229 = -psig - psil + t58 - psih
    t230 = cos(t229)
    contr[20] = -3/8 * t118 * t230 * t15 * t165 * t181 * t226
    t235 = -psig - psil + t58 + psih
    t236 = cos(t235)
    t238 = t150 * t35
    t240 = t15 * t210
    contr[21] = -3/8 * t118 * t240 * t238 * muM * t236
    t244 = -psig + psil + t58 - psih
    t245 = cos(t244)
    contr[22] = 3/8 * t128 * t174 * t182 * muM * t245
    t250 = -psig + psil + t58 + psih
    t251 = cos(t250)
    t254 = t150 * t27
    t255 = t128 * t254
    contr[23] = 3/8 * t255 * t219 * muM * t251
    t258 = psig - psil + t58 - psih
    t259 = cos(t258)
    contr[24] = 3/8 * t128 * t259 * t15 * t166 * t254
    t263 = psig - psil + t58 + psih
    t264 = cos(t263)
    contr[25] = 3/8 * t128 * t240 * t182 * muM * t264
    t269 = psig + psil + t58 - psih
    t270 = cos(t269)
    contr[26] = -3/8 * t118 * t174 * t238 * muM * t270
    t276 = psig + psil + t58 + psih
    t277 = cos(t276)
    contr[27] = -3/8 * t118 * t181 * t35 * t219 * muM * t277
    t285 = sin(psil)
    contr[28] = -t22 * cdelta * t285 * IMy * t1
    t289 = sin(t23)
    t291 = IMy * sdelta
    contr[29] = t33 * t291 * t289 * t27 / 2
    t294 = sin(t36)
    contr[30] = -t44 * t291 * t294 * t35 / 2
    t299 = cpa2EQ * t47
    t300 = cpa1EQ * t49
    t301 = cpa1EQ * t51
    t302 = cpa2EQ * t53
    t303 = t299 - t300 + t301 + t302
    t304 = t303 * muM
    t306 = sin(t59)
    contr[31] = -3/2 * t62 * t306 * t15 * t304 * t46
    t311 = sin(t66)
    t314 = IMx * t84
    t315 = t106 * IMy
    t316 = t314 + t315
    contr[32] = -t62 * t15 * t316 * t104 * t311 * t1 / 4
    t321 = t299 - t300 - t301 - t302
    t322 = t15 * t321
    t324 = sin(t95)
    contr[33] = -3/2 * t62 * t324 * muM * t322 * t46
    t329 = t314 - t315
    t331 = sin(t101)
    contr[34] = -t90 * muM * t331 * t329 * t1 / 4
    t338 = sin(t115)
    contr[35] = -3/4 * t118 * t338 * t15 * t303 * t35 * t104
    t344 = sin(t123)
    contr[36] = 3/4 * t128 * t344 * muM * t322 * t28
    t349 = sin(t132)
    contr[37] = 3/4 * t128 * t349 * t15 * t304 * t28
    t354 = muM * t15
    t356 = sin(t139)
    contr[38] = -3/4 * t118 * t356 * t35 * t354 * t321 * sdelta
    t362 = sin(t146)
    contr[39] = t152 * t362 * muM * t329 * t27 / 8
    t366 = muM * t316
    t367 = sin(t155)
    contr[40] = -t159 * t35 * t367 * t366 / 8
    t372 = IMx * cpa1EQ
    t373 = IMy * cpa2EQ
    t374 = t372 - t373
    t377 = sin(t168)
    contr[41] = -3/4 * t62 * t377 * t15 * t374 * muM * t162
    t382 = t372 + t373
    t385 = sin(t176)
    contr[42] = -3/4 * t62 * t385 * muM * t89 * t382 * t1
    t391 = sin(t184)
    contr[43] = -t128 * t15 * t391 * t366 * t182 / 8
    t397 = sin(t190)
    contr[44] = t195 * t397 * muM * t329 * t181 / 8
    t401 = cpa1EQ * t197
    t403 = 2 * t11 * t47
    t404 = cpa1EQ * t202
    t405 = cpa2EQ * t204
    t407 = 2 * t199 * t51
    t408 = cpa2EQ * t208
    t409 = t401 + t403 - t404 - t405 + t407 + t408
    t412 = sin(t213)
    contr[45] = -3/4 * t62 * t412 * t15 * t409 * muM * t162
    t418 = t15 * (t401 + t403 - t404 + t405 - t407 - t408)
    t420 = sin(t221)
    contr[46] = -3/4 * t62 * t420 * muM * t418 * t162
    t425 = sin(t229)
    t429 = t181 * t15
    contr[47] = 3/8 * t118 * t429 * t374 * t35 * muM * t425
    t432 = sin(t235)
    contr[48] = 3/8 * t118 * t15 * t409 * t238 * muM * t432
    t440 = sin(t244)
    contr[49] = -3/8 * t128 * t440 * t181 * t354 * t382 * t27
    t446 = sin(t250)
    contr[50] = -3/8 * t128 * t446 * muM * t418 * t254
    t451 = sin(t258)
    contr[51] = -3/8 * t255 * t15 * t374 * muM * t451
    t457 = sin(t263)
    contr[52] = -3/8 * t128 * t429 * t409 * t27 * muM * t457
    t466 = sin(t269)
    contr[53] = 3/8 * t118 * t466 * muM * t194 * t382 * t150
    t471 = sin(t276)
    contr[54] = 3/8 * t118 * t471 * t181 * t226 * t418
    contr = sum(contr)
    return contr;
end

function derivativechiM2_psig_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    contr = zeros(53)
    t1 = sqrt(smk)
    t2 = IMz * t1
    t4 = Q2 * cpa1EQ
    t6 = Q1 ^ 2
    t7 = Q2 ^ 2
    t9 = 1 / (t6 + t7 + 1)
    t11 = t9 * (Q1 * cpa2EQ - t4) * t2
    t12 = muM * sdelta
    t13 = 2 * TL
    t14 = -psig + t13
    t15 = sin(t14)
    t16 = rc ^ 2
    t18 = 0.1e1 / t16 / rc
    t20 = 0.1e1 / npsig
    contr[1] = 3/2 * t20 * t18 * t15 * t12 * t11
    t24 = psig + t13
    t25 = sin(t24)
    contr[2] = 3/2 * t20 * t18 * t25 * t12 * t11
    t30 = cpa1EQ * t6
    t31 = Q1 * Q2
    t33 = 2 * cpa2EQ * t31
    t34 = cpa1EQ * t7
    t37 = 4 * Q1 * cpa3EQ - cpa1EQ + t30 - t33 - t34
    t40 = cdelta - 1
    t41 = t40 * t9
    t42 = psig - psih
    t43 = sin(t42)
    contr[3] = t20 * t18 * t43 * t41 * t37 * muM * t2 / 4
    t48 = cdelta + 1
    t49 = t48 * t1
    t50 = IMz * muM
    t53 = psig + psih
    t54 = sin(t53)
    contr[4] = -t20 * t18 * t54 * t9 * t37 * t50 * t49 / 4
    t60 = psig - psil
    t61 = cos(t60)
    t63 = sqrt(skm)
    t64 = t63 - 1
    t65 = t64 * sdelta
    t69 = Q1 * cpa1EQ
    t70 = Q2 * cpa2EQ
    t71 = cpa3EQ * (t6 + t7 - 1) - t69 + t70
    t72 = muM * t71
    t73 = t18 * t9
    t74 = npsil - npsig
    t77 = 0.1e1 / t74 * t73 * t72
    contr[5] = -t77 * t65 * IMx * t61 / 2
    t80 = t63 + 1
    t81 = psig + psil
    t82 = cos(t81)
    t87 = 0.1e1 / (npsil + npsig)
    t89 = t87 * t73 * t72
    contr[6] = t89 * IMx * sdelta * t82 * t80 / 2
    t91 = Q1 * IMx
    t92 = cpa1EQ * t91
    t93 = Q2 * IMx
    t94 = cpa2EQ * t93
    t95 = Q1 * IMy
    t96 = cpa2EQ * t95
    t97 = Q2 * IMy
    t98 = cpa1EQ * t97
    t99 = t92 + t94 - t96 + t98
    t102 = t13 - psig - psil
    t103 = cos(t102)
    t105 = t87 * t18
    contr[7] = -3/4 * t105 * t103 * t9 * t99 * t80 * t12
    t109 = t92 + t94 + t96 - t98
    t112 = t13 - psig + psil
    t113 = cos(t112)
    t117 = -0.1e1 / t74 * t18
    contr[8] = -3/4 * t117 * t113 * t9 * t109 * muM * t65
    t123 = t13 + psig - psil
    t124 = cos(t123)
    contr[9] = -3/4 * t117 * t124 * t9 * t99 * muM * t65
    t131 = t13 + psig + psil
    t132 = cos(t131)
    contr[10] = -3/4 * t105 * t132 * t9 * t109 * t80 * t12
    t140 = -psih - psig + t13
    t141 = sin(t140)
    t144 = t20 * t18 * IMz
    contr[11] = -3/4 * t144 * muM * t141 * t1 * t9 * cpa1EQ * t48
    t149 = -psih + psig + t13
    t150 = sin(t149)
    t153 = t40 * muM
    t154 = t144 * t153
    contr[12] = -3/4 * t154 * t150 * t1 * t9 * cpa1EQ
    t157 = cpa2EQ * t6
    t159 = 2 * cpa1EQ * t31
    t160 = cpa2EQ * t7
    t163 = 4 * Q2 * cpa3EQ + cpa2EQ + t157 + t159 - t160
    t169 = t30 + Q1 * (-2 * t70 + 4 * cpa3EQ) - t34 - cpa1EQ
    t170 = t169 * IMy
    t171 = IMx * t163 + t170
    t173 = -psih + psig - psil
    t174 = cos(t173)
    t177 = t117 * t41
    contr[13] = t177 * t174 * muM * t64 * t171 / 8
    t182 = muM * (-IMx * t163 + t170)
    t183 = -psih + psig + psil
    t184 = cos(t183)
    t187 = t105 * t41
    contr[14] = -t187 * t80 * t184 * t182 / 8
    t191 = t9 * (t30 + t33 - t34)
    t192 = psih - psig + t13
    t193 = sin(t192)
    contr[15] = -3/4 * t154 * t193 * t1 * t191
    t199 = psih + psig + t13
    t200 = sin(t199)
    contr[16] = -3/4 * t144 * muM * t200 * t49 * t191
    t205 = t64 * t48
    t207 = psih + psig - psil
    t208 = cos(t207)
    contr[17] = -t117 * t9 * t208 * t182 * t205 / 8
    t214 = psih + psig + psil
    t215 = cos(t214)
    t218 = t9 * t80
    t219 = t105 * t218
    contr[18] = t219 * t215 * muM * t171 * t48 / 8
    t221 = muM * t80
    t222 = IMx * cpa2EQ
    t223 = IMy * cpa1EQ
    t224 = t222 + t223
    t227 = -psig - psil + t13 - psih
    t228 = cos(t227)
    contr[19] = -3/8 * t105 * t228 * t9 * t224 * t48 * t221
    t233 = -psig - psil + t13 + psih
    t234 = cos(t233)
    t236 = t40 * t80
    t238 = t6 * IMx
    t239 = cpa2EQ * t238
    t241 = 2 * t4 * t91
    t242 = t7 * IMx
    t243 = cpa2EQ * t242
    t244 = t6 * IMy
    t245 = cpa1EQ * t244
    t247 = 2 * t70 * t95
    t248 = t7 * IMy
    t249 = cpa1EQ * t248
    t251 = t9 * (t239 - t241 - t243 + t245 + t247 - t249)
    contr[20] = -3/8 * t105 * t251 * t236 * muM * t234
    t255 = -psig + psil + t13 - psih
    t256 = cos(t255)
    t260 = t9 * (t222 - t223)
    contr[21] = -3/8 * t117 * t260 * t205 * muM * t256
    t264 = -psig + psil + t13 + psih
    t265 = cos(t264)
    t268 = t9 * (t239 - t241 - t243 - t245 - t247 + t249)
    t270 = t40 * t64
    t271 = t117 * t270
    contr[22] = -3/8 * t271 * t268 * muM * t265
    t276 = psig - psil + t13 - psih
    t277 = cos(t276)
    contr[23] = -3/8 * t117 * t277 * t9 * t224 * muM * t270
    t282 = psig - psil + t13 + psih
    t283 = cos(t282)
    contr[24] = -3/8 * t117 * t251 * t205 * muM * t283
    t289 = psig + psil + t13 - psih
    t290 = cos(t289)
    contr[25] = -3/8 * t105 * t260 * t236 * muM * t290
    t296 = psig + psil + t13 + psih
    t297 = cos(t296)
    contr[26] = -3/8 * t105 * t48 * t80 * t268 * muM * t297
    t305 = cos(psig)
    contr[27] = -t20 * t73 * t2 * t305 * muM * sdelta * t71
    t311 = t12 * t2
    t313 = t9 * (t69 + t70)
    t314 = cos(t14)
    contr[28] = 3/2 * t20 * t18 * t314 * t313 * t311
    t319 = cos(t24)
    contr[29] = 3/2 * t20 * t18 * t319 * t313 * t311
    t327 = cos(t42)
    contr[30] = -t20 * t18 * t327 * t153 * IMz * t9 * t163 * t1 / 4
    t335 = cos(t53)
    contr[31] = -t20 * t18 * t335 * t50 * t9 * t163 * t49 / 4
    t341 = sin(t60)
    t343 = IMy * sdelta
    contr[32] = -t77 * t343 * t341 * t64 / 2
    t347 = sin(t81)
    contr[33] = -t89 * t343 * t347 * t80 / 2
    t352 = cpa2EQ * t91
    t353 = cpa1EQ * t93
    t354 = cpa1EQ * t95
    t355 = cpa2EQ * t97
    t356 = t352 - t353 + t354 + t355
    t359 = sin(t102)
    contr[34] = -3/4 * t105 * t359 * t9 * t356 * t80 * t12
    t364 = t352 - t353 - t354 - t355
    t367 = sin(t112)
    contr[35] = -3/4 * t117 * t367 * muM * t9 * t364 * t65
    t374 = sin(t123)
    contr[36] = -3/4 * t117 * t374 * t9 * t356 * muM * t65
    t380 = muM * t9
    t382 = sin(t131)
    contr[37] = -3/4 * t105 * t382 * t80 * t380 * t364 * sdelta
    t387 = t9 * cpa2EQ
    t389 = cos(t140)
    contr[38] = 3/4 * t144 * muM * t389 * t49 * t387
    t393 = cos(t149)
    contr[39] = 3/4 * t154 * t393 * t1 * t387
    t397 = IMx * t169
    t398 = t163 * IMy
    t399 = t397 - t398
    t401 = sin(t173)
    contr[40] = -t177 * t401 * muM * t399 * t64 / 8
    t407 = muM * (t397 + t398)
    t408 = sin(t183)
    contr[41] = -t187 * t80 * t408 * t407 / 8
    t413 = cos(t192)
    t415 = t157 - t159 - t160
    contr[42] = 3/4 * t154 * t9 * t415 * t413 * t1
    t419 = cos(t199)
    contr[43] = 3/4 * t144 * t380 * t415 * t419 * t49
    t425 = sin(t207)
    contr[44] = t117 * t9 * t425 * t407 * t205 / 8
    t430 = sin(t214)
    contr[45] = t219 * t430 * muM * t399 * t48 / 8
    t434 = sin(t227)
    t436 = IMx * cpa1EQ
    t437 = IMy * cpa2EQ
    t438 = t436 - t437
    t441 = t48 * t9
    contr[46] = 3/8 * t105 * t441 * t438 * t80 * muM * t434
    t444 = sin(t233)
    t447 = cpa1EQ * t238
    t449 = 2 * t70 * t91
    t450 = cpa1EQ * t242
    t451 = cpa2EQ * t244
    t453 = 2 * t4 * t95
    t454 = cpa2EQ * t248
    t455 = t447 + t449 - t450 - t451 + t453 + t454
    contr[47] = 3/8 * t105 * t9 * t455 * t236 * muM * t444
    t459 = t436 + t437
    t462 = sin(t255)
    contr[48] = 3/8 * t117 * t462 * t48 * t380 * t459 * t64
    t467 = t9 * (t447 + t449 - t450 + t451 - t453 - t454)
    t469 = sin(t264)
    contr[49] = 3/8 * t117 * t469 * muM * t467 * t270
    t473 = sin(t276)
    contr[50] = 3/8 * t271 * t9 * t438 * muM * t473
    t478 = sin(t282)
    contr[51] = 3/8 * t117 * t441 * t455 * t64 * muM * t478
    t486 = sin(t289)
    contr[52] = 3/8 * t105 * t486 * muM * t218 * t459 * t40
    t491 = sin(t296)
    contr[53] = 3/8 * t105 * t491 * t48 * t221 * t467
    contr = sum(contr)
    return contr
end

function derivativechiM2_psih_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    contr = zeros(48)
    t1 = sqrt(smk)
    t3 = Q1 ^ 2
    t4 = cpa1EQ * t3
    t5 = Q1 * Q2
    t7 = 2 * cpa2EQ * t5
    t8 = Q2 ^ 2
    t9 = cpa1EQ * t8
    t12 = 4 * Q1 * cpa3EQ - cpa1EQ + t4 - t7 - t9
    t16 = 1 / (t3 + t8 + 1)
    t17 = cdelta - 1
    t18 = t17 * t16
    t19 = psig - psih
    t20 = sin(t19)
    t21 = rc ^ 2
    t23 = 0.1e1 / t21 / rc
    t25 = 0.1e1 / npsig
    contr[1] = -t25 * t23 * t20 * t18 * t12 * muM * IMz * t1 / 4
    t30 = cdelta + 1
    t31 = t30 * t1
    t32 = IMz * muM
    t35 = psig + psih
    t36 = sin(t35)
    contr[2] = -t25 * t23 * t36 * t16 * t12 * t32 * t31 / 4
    t42 = -psil + psih
    t43 = cos(t42)
    t45 = cpa2EQ * t3
    t47 = 2 * cpa1EQ * t5
    t48 = cpa2EQ * t8
    t51 = -4 * Q2 * cpa3EQ - cpa2EQ - t45 - t47 + t48
    t53 = Q2 * cpa2EQ
    t58 = t4 + Q1 * (-2 * t53 + 4 * cpa3EQ) - t9 - cpa1EQ
    t59 = t58 * IMy
    t61 = (IMx * t51 + t59) * muM
    t63 = t16 * sdelta
    t65 = 0.1e1 / npsil * t23
    t66 = t65 * t63
    contr[3] = -t66 * t61 * t43 * t1 / 4
    t69 = psil + psih
    t70 = cos(t69)
    t72 = muM * sdelta
    t74 = -t51
    t76 = IMx * t74 + t59
    contr[4] = -t65 * t16 * t76 * t72 * t70 * t1 / 4
    t84 = 2 * TL
    t85 = -psih - psig + t84
    t86 = sin(t85)
    t89 = t25 * t23 * IMz
    contr[5] = -3/4 * t89 * muM * t86 * t1 * t16 * cpa1EQ * t30
    t94 = -psih + psig + t84
    t95 = sin(t94)
    t98 = t17 * muM
    t99 = t89 * t98
    contr[6] = 3/4 * t99 * t95 * t1 * t16 * cpa1EQ
    t101 = sqrt(skm)
    t102 = t101 - 1
    t104 = -psih + psig - psil
    t105 = cos(t104)
    t110 = 0.1e1 / (-npsil + npsig) * t23
    t111 = t110 * t18
    contr[7] = -t111 * t105 * muM * t102 * t76 / 8
    t114 = -psih + psig + psil
    t115 = cos(t114)
    t116 = t101 + 1
    t121 = 0.1e1 / (npsil + npsig) * t23
    t122 = t121 * t18
    contr[8] = t122 * t116 * t115 * t61 / 8
    t124 = t1 * sdelta
    t125 = IMx * cpa2EQ
    t126 = IMy * cpa1EQ
    t127 = t125 + t126
    t128 = t127 * muM
    t130 = -psih - psil + t84
    t131 = cos(t130)
    contr[9] = 3/4 * t65 * t131 * t16 * t128 * t124
    t136 = t16 * (t125 - t126)
    t138 = -psih + psil + t84
    t139 = cos(t138)
    contr[10] = -3/4 * t65 * t139 * muM * t136 * t124
    t145 = t16 * (t4 + t7 - t9)
    t146 = psih - psig + t84
    t147 = sin(t146)
    contr[11] = 3/4 * t99 * t147 * t1 * t145
    t152 = psih + psig + t84
    t153 = sin(t152)
    contr[12] = -3/4 * t89 * muM * t153 * t31 * t145
    t158 = t102 * t30
    t160 = psih + psig - psil
    t161 = cos(t160)
    contr[13] = -t110 * t16 * t161 * t61 * t158 / 8
    t167 = psih + psig + psil
    t168 = cos(t167)
    t171 = t16 * t116
    t172 = t121 * t171
    contr[14] = t172 * t168 * muM * t76 * t30 / 8
    t174 = t3 * IMx
    t175 = cpa2EQ * t174
    t176 = Q1 * IMx
    t177 = Q2 * cpa1EQ
    t179 = 2 * t177 * t176
    t180 = t8 * IMx
    t181 = cpa2EQ * t180
    t182 = t3 * IMy
    t183 = cpa1EQ * t182
    t184 = Q1 * IMy
    t186 = 2 * t53 * t184
    t187 = t8 * IMy
    t188 = cpa1EQ * t187
    t189 = t175 - t179 - t181 + t183 + t186 - t188
    t192 = psih - psil + t84
    t193 = cos(t192)
    contr[15] = -3/4 * t65 * t193 * t16 * t189 * muM * t124
    t199 = t16 * (t175 - t179 - t181 - t183 - t186 + t188)
    t201 = psih + psil + t84
    t202 = cos(t201)
    contr[16] = 3/4 * t65 * t202 * muM * t124 * t199
    t206 = muM * t116
    t209 = -psig - psil + t84 - psih
    t210 = cos(t209)
    contr[17] = -3/8 * t121 * t210 * t16 * t127 * t30 * t206
    t215 = -psig - psil + t84 + psih
    t216 = cos(t215)
    t218 = t17 * t116
    t220 = t16 * t189
    contr[18] = 3/8 * t121 * t220 * t218 * muM * t216
    t223 = -psig + psil + t84 - psih
    t224 = cos(t223)
    contr[19] = -3/8 * t110 * t136 * t158 * muM * t224
    t230 = -psig + psil + t84 + psih
    t231 = cos(t230)
    t234 = t17 * t102
    t235 = t110 * t234
    contr[20] = 3/8 * t235 * t199 * muM * t231
    t238 = psig - psil + t84 - psih
    t239 = cos(t238)
    contr[21] = 3/8 * t110 * t239 * t16 * t128 * t234
    t243 = psig - psil + t84 + psih
    t244 = cos(t243)
    contr[22] = -3/8 * t110 * t220 * t158 * muM * t244
    t250 = psig + psil + t84 - psih
    t251 = cos(t250)
    contr[23] = 3/8 * t121 * t136 * t218 * muM * t251
    t256 = psig + psil + t84 + psih
    t257 = cos(t256)
    contr[24] = -3/8 * t121 * t30 * t116 * t199 * muM * t257
    t267 = cos(t19)
    contr[25] = t25 * t23 * t267 * t98 * IMz * t16 * t74 * t1 / 4
    t274 = cos(t35)
    contr[26] = -t25 * t23 * t274 * t32 * t16 * t74 * t31 / 4
    t280 = sin(t42)
    t283 = IMx * t58
    t284 = t74 * IMy
    t285 = t283 + t284
    contr[27] = t65 * t16 * t285 * t72 * t280 * t1 / 4
    t289 = t283 - t284
    t291 = sin(t69)
    contr[28] = -t66 * muM * t291 * t289 * t1 / 4
    t296 = t16 * cpa2EQ
    t298 = cos(t85)
    contr[29] = 3/4 * t89 * muM * t298 * t31 * t296
    t302 = cos(t94)
    contr[30] = -3/4 * t99 * t302 * t1 * t296
    t308 = sin(t104)
    contr[31] = t111 * t308 * muM * t289 * t102 / 8
    t312 = muM * t285
    t313 = sin(t114)
    contr[32] = t122 * t116 * t313 * t312 / 8
    t317 = IMx * cpa1EQ
    t318 = IMy * cpa2EQ
    t319 = t317 - t318
    t322 = sin(t130)
    contr[33] = -3/4 * t65 * t322 * t16 * t319 * muM * t124
    t327 = t317 + t318
    t330 = sin(t138)
    contr[34] = 3/4 * t65 * t330 * muM * t63 * t327 * t1
    t334 = cos(t146)
    t336 = t45 - t47 - t48
    contr[35] = -3/4 * t99 * t16 * t336 * t334 * t1
    t341 = cos(t152)
    t344 = muM * t16
    contr[36] = 3/4 * t89 * t344 * t336 * t341 * t31
    t348 = sin(t160)
    contr[37] = t110 * t16 * t348 * t312 * t158 / 8
    t353 = sin(t167)
    contr[38] = t172 * t353 * muM * t289 * t30 / 8
    t357 = cpa1EQ * t174
    t359 = 2 * t53 * t176
    t360 = cpa1EQ * t180
    t361 = cpa2EQ * t182
    t363 = 2 * t177 * t184
    t364 = cpa2EQ * t187
    t365 = t357 + t359 - t360 - t361 + t363 + t364
    t368 = sin(t192)
    contr[39] = 3/4 * t65 * t368 * t16 * t365 * muM * t124
    t373 = t16 * (t357 + t359 - t360 + t361 - t363 - t364)
    t375 = sin(t201)
    contr[40] = -3/4 * t65 * t375 * muM * t373 * t124
    t380 = sin(t209)
    t384 = t30 * t16
    contr[41] = 3/8 * t121 * t384 * t319 * t116 * muM * t380
    t387 = sin(t215)
    contr[42] = -3/8 * t121 * t16 * t365 * t218 * muM * t387
    t396 = sin(t223)
    contr[43] = 3/8 * t110 * t396 * t30 * t344 * t327 * t102
    t401 = sin(t230)
    contr[44] = -3/8 * t110 * t401 * muM * t373 * t234
    t406 = sin(t238)
    contr[45] = -3/8 * t235 * t16 * t319 * muM * t406
    t412 = sin(t243)
    contr[46] = 3/8 * t110 * t384 * t365 * t102 * muM * t412
    t420 = sin(t250)
    contr[47] = -3/8 * t121 * t420 * muM * t171 * t327 * t17
    t426 = sin(t256)
    contr[48] = 3/8 * t121 * t426 * t30 * t206 * t373
    contr = sum(contr)
    return contr
end

function derivativechiM2_Jl1_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    contr = zeros(54)
    t1 = sqrt(smk)
    t2 = Q1 ^ 2
    t3 = Q2 ^ 2
    t7 = Q2 * cpa2EQ
    t8 = cpa3EQ * (-t2 - t3 + 1) + Q1 * cpa1EQ - t7
    t10 = muM * t8 * t1
    t11 = A - C
    t12 = t11 * IMx
    t15 = sin(psil)
    t17 = 1 / (t2 + t3 + 1)
    t19 = 0.1e1 / C
    t22 = rc ^ 2
    t25 = 0.1e1 / t22 / rc / A
    t26 = npsil ^ 2
    t28 = 0.1e1 / t26 * t25
    contr[1] = t28 * t19 * t17 * t15 * cdelta * t12 * t10
    t30 = psig - psil
    t31 = sin(t30)
    t33 = sqrt(skm)
    t34 = t33 - 1
    t36 = t8 * t12
    t39 = t19 * t17 * sdelta
    t41 = (-npsil + npsig) ^ 2
    t43 = 0.1e1 / t41 * t25
    t44 = t43 * t39
    contr[2] = -t44 * t36 * t34 * t31 * muM / 2
    t47 = psig + psil
    t48 = sin(t47)
    t50 = t33 + 1
    t54 = (npsil + npsig) ^ 2
    t56 = 0.1e1 / t54 * t25
    t57 = t56 * t39
    contr[3] = t57 * t36 * t50 * t48 * muM / 2
    t59 = 2 * TL
    t60 = -psil + t59
    t61 = sin(t60)
    t63 = muM * t11
    t64 = IMx * Q1
    t65 = cpa1EQ * t64
    t66 = Q2 * IMx
    t67 = cpa2EQ * t66
    t68 = IMy * Q1
    t69 = cpa2EQ * t68
    t70 = Q2 * IMy
    t71 = cpa1EQ * t70
    t72 = t65 + t67 - t69 + t71
    contr[4] = -3/2 * t28 * t19 * cdelta * t17 * t72 * t63 * t61 * t1
    t80 = -psil + psih
    t81 = sin(t80)
    t83 = cpa2EQ * t2
    t85 = Q1 * Q2 * cpa1EQ
    t87 = cpa2EQ * t3
    t88 = Q2 * cpa3EQ
    t90 = -t83 - 2 * t85 + t87 - 4 * t88 - cpa2EQ
    t98 = cpa1EQ * t2 + Q1 * (-2 * t7 + 4 * cpa3EQ) - cpa1EQ * t3 - cpa1EQ
    t99 = t98 * IMy
    t102 = t11 * muM * (IMx * t90 + t99)
    t104 = t28 * t39
    contr[5] = t104 * t102 * t1 * t81 / 4
    t106 = t65 + t67 + t69 - t71
    t108 = psil + t59
    t109 = sin(t108)
    t115 = t28 * t19 * cdelta * muM
    contr[6] = 3/2 * t115 * t11 * t109 * t1 * t17 * t106
    t117 = psil + psih
    t118 = sin(t117)
    t121 = -IMx * t90 + t99
    t124 = t11 * muM * t1
    contr[7] = t104 * t124 * t121 * t118 / 4
    t127 = t50 * muM
    t128 = t11 * sdelta
    t129 = t59 - psig - psil
    t130 = sin(t129)
    t134 = t19 * t17 * t72
    contr[8] = -3/4 * t56 * t134 * t130 * t128 * t127
    t138 = t34 * muM
    t139 = t106 * t128
    t141 = t59 - psig + psil
    t142 = sin(t141)
    contr[9] = 3/4 * t43 * t19 * t142 * t17 * t139 * t138
    t147 = t59 + psig - psil
    t148 = sin(t147)
    contr[10] = -3/4 * t43 * t134 * t148 * t128 * t138
    t155 = t59 + psig + psil
    t156 = sin(t155)
    contr[11] = 3/4 * t56 * t19 * t156 * t17 * t139 * t127
    t161 = t59 - psil - psih
    t162 = sin(t161)
    t164 = sdelta * muM
    t165 = IMx * cpa2EQ
    t166 = IMy * cpa1EQ
    t167 = t165 + t166
    t171 = t19 * t11 * t17
    t172 = t28 * t171
    contr[12] = 3/4 * t172 * t167 * t164 * t162 * t1
    t174 = t59 - psil + psih
    t175 = sin(t174)
    t177 = t2 * IMx
    t178 = cpa2EQ * t177
    t179 = Q2 * cpa1EQ
    t181 = 2 * t179 * t64
    t182 = t3 * IMx
    t183 = cpa2EQ * t182
    t184 = t2 * IMy
    t185 = cpa1EQ * t184
    t187 = 2 * t7 * t68
    t188 = t3 * IMy
    t189 = cpa1EQ * t188
    t190 = t178 - t181 - t183 + t185 + t187 - t189
    t192 = muM * t17 * t190
    t195 = t28 * t19 * t128
    contr[13] = 3/4 * t195 * t192 * t175 * t1
    t197 = t59 + psil - psih
    t198 = sin(t197)
    t200 = t165 - t166
    contr[14] = -3/4 * t172 * t200 * t164 * t198 * t1
    t205 = t59 + psil + psih
    t206 = sin(t205)
    t208 = t178 - t181 - t183 - t185 - t187 + t189
    t209 = t17 * t208
    contr[15] = -3/4 * t195 * muM * t209 * t206 * t1
    t214 = -psih + psig - psil
    t215 = sin(t214)
    t217 = cdelta - 1
    t222 = t19 * t17 * t121
    contr[16] = t43 * t222 * t34 * t217 * t11 * muM * t215 / 8
    t225 = -psih + psig + psil
    t226 = sin(t225)
    t229 = t17 * t217
    t231 = t56 * t19 * t229
    contr[17] = t231 * t102 * t226 * t50 / 8
    t233 = cdelta + 1
    t234 = psih + psig - psil
    t235 = sin(t234)
    t240 = t43 * t19 * t17 * t34
    contr[18] = -t240 * t102 * t235 * t233 / 8
    t243 = t50 * t233
    t244 = psih + psig + psil
    t245 = sin(t244)
    contr[19] = -t56 * t222 * t11 * muM * t245 * t243 / 8
    t254 = t11 * muM * t17
    t256 = -psig - psil - psih + t59
    t257 = sin(t256)
    contr[20] = -3/8 * t56 * t19 * t233 * t257 * t254 * t167 * t50
    t263 = t50 * t217
    t265 = -psig - psil + psih + t59
    t266 = sin(t265)
    contr[21] = -3/8 * t56 * t19 * t266 * t11 * t192 * t263
    t272 = -psig + psil - psih + t59
    t273 = sin(t272)
    t278 = t19 * t233 * t17
    contr[22] = 3/8 * t43 * t278 * t200 * t273 * t11 * t138
    t284 = -psig + psil + psih + t59
    t285 = sin(t284)
    contr[23] = 3/8 * t43 * t19 * t285 * t11 * muM * t229 * t208 * t34
    t290 = t217 * t34
    t294 = psig - psil - psih + t59
    t295 = sin(t294)
    contr[24] = -3/8 * t43 * t19 * t295 * t11 * muM * t17 * t167 * t290
    t303 = psig - psil + psih + t59
    t304 = sin(t303)
    contr[25] = -3/8 * t43 * t19 * t233 * t304 * t254 * t190 * t34
    t310 = psig + psil - psih + t59
    t311 = sin(t310)
    contr[26] = 3/8 * t56 * t19 * t17 * t200 * t311 * t63 * t263
    t318 = t11 * t127
    t320 = psig + psil + psih + t59
    t321 = sin(t320)
    contr[27] = 3/8 * t56 * t19 * t233 * t321 * t318 * t209
    t326 = t11 * IMy
    t329 = cos(psil)
    contr[28] = t28 * t19 * t17 * t329 * cdelta * t326 * t10
    t333 = cos(t30)
    t336 = t8 * t326
    contr[29] = t44 * t336 * t34 * t333 * muM / 2
    t339 = cos(t47)
    contr[30] = t57 * t336 * t50 * t339 * muM / 2
    t344 = cpa2EQ * t64
    t345 = cpa1EQ * t66
    t346 = cpa1EQ * t68
    t347 = cpa2EQ * t70
    t348 = t344 - t345 + t346 + t347
    t350 = cos(t60)
    contr[31] = 3/2 * t115 * t11 * t350 * t1 * t17 * t348
    t355 = IMx * t98
    t362 = 2 * IMy * (t85 + t83 / 2 - t87 / 2 + 2 * t88 + cpa2EQ / 2)
    t363 = t355 + t362
    t364 = cos(t80)
    contr[32] = t104 * t124 * t364 * t363 / 4
    t368 = t344 - t345 - t346 - t347
    t370 = cos(t108)
    contr[33] = -3/2 * t115 * t11 * t370 * t17 * t368 * t1
    t376 = cos(t117)
    t378 = t355 - t362
    contr[34] = -t104 * t378 * t63 * t1 * t376 / 4
    t383 = t348 * t128
    t385 = cos(t129)
    contr[35] = 3/4 * t56 * t19 * t385 * t17 * t383 * t127
    t390 = t17 * t368
    t393 = cos(t141)
    contr[36] = -3/4 * t43 * t19 * t393 * t11 * sdelta * t138 * t390
    t400 = cos(t147)
    contr[37] = 3/4 * t43 * t19 * t400 * t17 * t383 * t138
    t407 = cos(t155)
    contr[38] = -3/4 * t56 * t19 * t407 * t11 * sdelta * t127 * t390
    t413 = cos(t161)
    t415 = IMx * cpa1EQ
    t416 = IMy * cpa2EQ
    t417 = t415 - t416
    contr[39] = 3/4 * t172 * t417 * t164 * t413 * t1
    t421 = cpa1EQ * t177
    t423 = 2 * t7 * t64
    t424 = cpa1EQ * t182
    t425 = cpa2EQ * t184
    t427 = 2 * t179 * t68
    t428 = cpa2EQ * t188
    t429 = t421 + t423 - t424 - t425 + t427 + t428
    t431 = cos(t174)
    contr[40] = 3/4 * t195 * muM * t431 * t17 * t429 * t1
    t436 = cos(t197)
    t438 = t415 + t416
    contr[41] = -3/4 * t172 * t438 * t164 * t436 * t1
    t443 = cos(t205)
    t445 = t421 + t423 - t424 + t425 - t427 - t428
    contr[42] = -3/4 * t172 * t445 * t164 * t443 * t1
    t450 = cos(t214)
    contr[43] = t240 * t217 * t63 * t378 * t450 / 8
    t456 = cos(t225)
    contr[44] = -t231 * t11 * muM * t456 * t363 * t50 / 8
    t463 = cos(t234)
    contr[45] = -t240 * t11 * muM * t463 * t363 * t233 / 8
    t469 = cos(t244)
    contr[46] = t56 * t171 * muM * t378 * t469 * t243 / 8
    t475 = t17 * t417
    t477 = cos(t256)
    contr[47] = -3/8 * t56 * t19 * t233 * t477 * t318 * t475
    t483 = t17 * t429
    t486 = cos(t265)
    contr[48] = -3/8 * t56 * t19 * t486 * t11 * muM * t263 * t483
    t494 = cos(t272)
    contr[49] = 3/8 * t43 * t19 * t233 * t494 * t254 * t438 * t34
    t499 = cos(t284)
    contr[50] = 3/8 * t43 * t19 * t17 * t445 * t499 * t63 * t290
    t508 = cos(t294)
    contr[51] = -3/8 * t43 * t19 * t508 * t11 * muM * t475 * t290
    t516 = cos(t303)
    contr[52] = -3/8 * t43 * t19 * t233 * t516 * t11 * t138 * t483
    t526 = cos(t310)
    contr[53] = 3/8 * t56 * t19 * t526 * t11 * muM * t50 * t17 * t438 * t217
    t531 = cos(t320)
    contr[54] = 3/8 * t56 * t278 * t445 * t531 * t11 * t127

    contr = sum(contr)
    return contr;    

end

function derivativechiM2_csigma1_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    contr = zeros(36)
    t1 = Q1 ^ 2
    t2 = Q2 ^ 2
    t6 = Q2 * cpa2EQ
    t8 = (cpa3EQ * (t1 + t2 - 1) - Q1 * cpa1EQ + t6) * sdelta
    t9 = psig - psil
    t10 = sin(t9)
    t14 = 1 / (t1 + t2 + 1)
    t15 = t14 * muM
    t16 = rc ^ 2
    t18 = 0.1e1 / t16 / rc
    t21 = 0.1e1 / (-npsil + npsig) * t18
    t22 = t21 * t15
    contr[1] = t22 * t10 * IMx * t8 / 2
    t24 = psig + psil
    t25 = sin(t24)
    t30 = 0.1e1 / (npsil + npsig) * t18
    t31 = t30 * t15
    contr[2] = t31 * t25 * IMx * t8 / 2
    t33 = 2 * TL
    t34 = t33 - psig - psil
    t35 = sin(t34)
    t38 = Q1 * IMx
    t39 = cpa1EQ * t38
    t40 = Q2 * IMx
    t41 = cpa2EQ * t40
    t42 = Q1 * IMy
    t43 = cpa2EQ * t42
    t44 = Q2 * IMy
    t45 = cpa1EQ * t44
    t47 = t14 * (t39 + t41 - t43 + t45)
    contr[3] = 3/4 * t30 * t47 * muM * sdelta * t35
    t50 = t33 - psig + psil
    t51 = sin(t50)
    t55 = t14 * (t39 + t41 + t43 - t45)
    contr[4] = 3/4 * t21 * t55 * muM * sdelta * t51
    t58 = t33 + psig - psil
    t59 = sin(t58)
    contr[5] = -3/4 * t21 * t47 * muM * sdelta * t59
    t65 = t33 + psig + psil
    t66 = sin(t65)
    contr[6] = -3/4 * t30 * t55 * muM * sdelta * t66
    t72 = cdelta - 1
    t73 = -psih + psig - psil
    t74 = sin(t73)
    t84 = 2 * Q1 * Q2 * cpa1EQ + 4 * Q2 * cpa3EQ + cpa2EQ * t1 - cpa2EQ * t2 + cpa2EQ
    t92 = cpa1EQ * t1 + Q1 * (-2 * t6 + 4 * cpa3EQ) - cpa1EQ * t2 - cpa1EQ
    t93 = t92 * IMy
    t95 = t14 * (IMx * t84 + t93)
    contr[7] = t21 * t95 * muM * t74 * t72 / 8
    t98 = -psih + psig + psil
    t99 = sin(t98)
    t105 = t14 * (-IMx * t84 + t93)
    contr[8] = -t30 * t105 * muM * t99 * t72 / 8
    t109 = psih + psig - psil
    t110 = sin(t109)
    t112 = cdelta + 1
    contr[9] = -t21 * t105 * t112 * muM * t110 / 8
    t117 = psih + psig + psil
    t118 = sin(t117)
    contr[10] = t30 * t95 * t112 * muM * t118 / 8
    t123 = -psig - psil + t33 - psih
    t124 = sin(t123)
    t127 = IMx * cpa2EQ
    t128 = IMy * cpa1EQ
    t130 = t14 * (t127 + t128)
    contr[11] = 3/8 * t30 * t130 * t112 * muM * t124
    t133 = t1 * IMx
    t134 = cpa2EQ * t133
    t135 = Q2 * cpa1EQ
    t137 = 2 * t135 * t38
    t138 = t2 * IMx
    t139 = cpa2EQ * t138
    t140 = t1 * IMy
    t141 = cpa1EQ * t140
    t143 = 2 * t6 * t42
    t144 = t2 * IMy
    t145 = cpa1EQ * t144
    t146 = t134 - t137 - t139 + t141 + t143 - t145
    t149 = -psig - psil + t33 + psih
    t150 = sin(t149)
    contr[12] = 3/8 * t30 * t72 * t150 * t14 * t146 * muM
    t154 = muM * t112
    t155 = -psig + psil + t33 - psih
    t156 = sin(t155)
    t159 = t14 * (t127 - t128)
    contr[13] = 3/8 * t21 * t159 * t156 * t154
    t162 = t134 - t137 - t139 - t141 - t143 + t145
    t165 = -psig + psil + t33 + psih
    t166 = sin(t165)
    contr[14] = 3/8 * t21 * t72 * t166 * t14 * t162 * muM
    t170 = psig - psil + t33 - psih
    t171 = sin(t170)
    contr[15] = -3/8 * t21 * t130 * muM * t72 * t171
    t178 = psig - psil + t33 + psih
    t179 = sin(t178)
    contr[16] = -3/8 * t21 * t179 * t14 * t146 * t154
    t184 = psig + psil + t33 - psih
    t185 = sin(t184)
    contr[17] = -3/8 * t30 * t159 * t72 * t185 * muM
    t192 = psig + psil + t33 + psih
    t193 = sin(t192)
    contr[18] = -3/8 * t30 * t193 * t14 * t162 * t154
    t198 = cos(t9)
    contr[19] = -t22 * t198 * IMy * t8 / 2
    t203 = cos(t24)
    contr[20] = t31 * t203 * IMy * t8 / 2
    t207 = cos(t34)
    t210 = cpa2EQ * t38
    t211 = cpa1EQ * t40
    t212 = cpa1EQ * t42
    t213 = cpa2EQ * t44
    t215 = t14 * (t210 - t211 + t212 + t213)
    contr[21] = -3/4 * t30 * t215 * muM * sdelta * t207
    t219 = cos(t50)
    t221 = t210 - t211 - t212 - t213
    contr[22] = -3/4 * t22 * t221 * sdelta * t219
    t225 = cos(t58)
    contr[23] = 3/4 * t21 * t215 * muM * sdelta * t225
    t230 = cos(t65)
    contr[24] = 3/4 * t31 * t221 * sdelta * t230
    t234 = cos(t73)
    t237 = IMx * t92
    t238 = t84 * IMy
    t240 = t14 * (t237 - t238)
    contr[25] = t21 * t240 * muM * t234 * t72 / 8
    t243 = cos(t98)
    t246 = t237 + t238
    contr[26] = t30 * t14 * t246 * muM * t243 * t72 / 8
    t250 = cos(t109)
    contr[27] = -t21 * t14 * t112 * t246 * muM * t250 / 8
    t257 = cos(t117)
    contr[28] = -t30 * t240 * t112 * muM * t257 / 8
    t263 = IMx * cpa1EQ
    t264 = IMy * cpa2EQ
    t265 = t263 - t264
    t267 = cos(t123)
    contr[29] = 3/8 * t30 * t267 * t14 * t265 * t154
    t271 = cpa1EQ * t133
    t273 = 2 * t6 * t38
    t274 = cpa1EQ * t138
    t275 = cpa2EQ * t140
    t277 = 2 * t135 * t42
    t278 = cpa2EQ * t144
    t279 = t271 + t273 - t274 - t275 + t277 + t278
    t282 = cos(t149)
    contr[30] = 3/8 * t30 * t72 * t282 * t14 * t279 * muM
    t286 = cos(t155)
    t287 = t263 + t264
    contr[31] = 3/8 * t21 * t154 * t14 * t287 * t286
    t292 = cos(t165)
    t294 = t271 + t273 - t274 + t275 - t277 - t278
    contr[32] = 3/8 * t22 * t294 * t72 * t292
    t299 = cos(t170)
    contr[33] = -3/8 * t21 * t72 * t299 * t14 * t265 * muM
    t305 = cos(t178)
    contr[34] = -3/8 * t21 * t305 * t14 * t279 * t154
    t310 = cos(t184)
    contr[35] = -3/8 * t31 * t287 * t72 * t310
    t315 = cos(t192)
    contr[36] = -3/8 * t30 * t154 * t14 * t294 * t315
    contr = sum(contr)
    return contr
end

function derivativechiM2_csigma2_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    contr = zeros(35)
    t1 = sqrt(skm)
    t2 = Q1 ^ 2
    t3 = Q2 ^ 2
    t6 = Q1 * cpa1EQ
    t7 = Q2 * cpa2EQ
    t9 = (cpa3EQ * (t2 + t3 - 1) - t6 + t7) * t1
    t10 = sin(psil)
    t15 = 1 / (t2 + t3 + 1)
    t16 = rc ^ 2
    t18 = 0.1e1 / t16 / rc
    t19 = t18 * t15
    t20 = 0.1e1 / npsil
    t22 = t20 * t19 * cdelta * muM
    contr[1] = -t22 * t10 * IMx * t9
    t24 = 2 * TL
    t25 = -psig + t24
    t26 = cos(t25)
    t29 = Q2 * cpa1EQ
    t31 = t15 * (Q1 * cpa2EQ - t29)
    t33 = muM * sdelta
    t35 = 0.1e1 / npsig
    t36 = t35 * t18 * t1
    t37 = t36 * t33
    contr[2] = -3/2 * t37 * t31 * IMz * t26
    t40 = psig + t24
    t41 = cos(t40)
    contr[3] = 3/2 * t37 * t31 * IMz * t41
    t45 = psig - psih
    t46 = cos(t45)
    t48 = cpa1EQ * t2
    t49 = Q1 * Q2
    t51 = 2 * cpa2EQ * t49
    t52 = cpa1EQ * t3
    t55 = 4 * Q1 * cpa3EQ - cpa1EQ + t48 - t51 - t52
    t58 = cdelta - 1
    contr[4] = t36 * t58 * t15 * t55 * muM * IMz * t46 / 4
    t62 = psig + psih
    t63 = cos(t62)
    t64 = cdelta + 1
    t66 = IMz * muM
    contr[5] = -t36 * t15 * t55 * t66 * t64 * t63 / 4
    t72 = -psil + t24
    t73 = sin(t72)
    t75 = Q1 * IMx
    t76 = cpa1EQ * t75
    t77 = Q2 * IMx
    t78 = cpa2EQ * t77
    t79 = Q1 * IMy
    t80 = cpa2EQ * t79
    t81 = Q2 * IMy
    t82 = cpa1EQ * t81
    t86 = t1 * t15
    t87 = t20 * t18
    t88 = t87 * t86
    contr[6] = -3/2 * t88 * (t76 + t78 - t80 + t82) * muM * cdelta * t73
    t91 = -psil + psih
    t92 = sin(t91)
    t95 = cpa2EQ * t2
    t97 = 2 * cpa1EQ * t49
    t98 = cpa2EQ * t3
    t101 = -4 * Q2 * cpa3EQ - cpa2EQ - t95 - t97 + t98
    t107 = t48 + Q1 * (-2 * t7 + 4 * cpa3EQ) - t52 - cpa1EQ
    t108 = t107 * IMy
    contr[7] = t87 * t15 * (IMx * t101 + t108) * t33 * t92 * t1 / 4
    t113 = psil + t24
    t114 = sin(t113)
    contr[8] = 3/2 * t88 * (t76 + t78 + t80 - t82) * muM * cdelta * t114
    t120 = psil + psih
    t121 = sin(t120)
    t123 = -t101
    t129 = t87 * t15 * sdelta
    contr[9] = t129 * muM * (IMx * t123 + t108) * t121 * t1 / 4
    t133 = -psih - psig + t24
    t134 = cos(t133)
    t137 = t35 * t18 * IMz
    contr[10] = 3/4 * t137 * muM * t134 * t86 * cpa1EQ * t64
    t141 = -psih + psig + t24
    t142 = cos(t141)
    t145 = t58 * muM
    t146 = t137 * t145
    contr[11] = -3/4 * t146 * t142 * t1 * t15 * cpa1EQ
    t149 = -psih - psil + t24
    t150 = sin(t149)
    t152 = IMx * cpa2EQ
    t153 = IMy * cpa1EQ
    contr[12] = 3/4 * t88 * (t152 + t153) * muM * sdelta * t150
    t160 = t1 * sdelta
    t162 = -psih + psil + t24
    t163 = sin(t162)
    contr[13] = -3/4 * t87 * t163 * muM * t160 * t15 * (t152 - t153)
    t168 = psih - psig + t24
    t169 = cos(t168)
    t171 = t48 + t51 - t52
    contr[14] = 3/4 * t146 * t15 * t171 * t169 * t1
    t175 = t1 * t64
    t176 = psih + psig + t24
    t177 = cos(t176)
    contr[15] = -3/4 * t137 * muM * t15 * t171 * t177 * t175
    t184 = t2 * IMx
    t185 = cpa2EQ * t184
    t187 = 2 * t29 * t75
    t188 = t3 * IMx
    t189 = cpa2EQ * t188
    t190 = t2 * IMy
    t191 = cpa1EQ * t190
    t193 = 2 * t7 * t79
    t194 = t3 * IMy
    t195 = cpa1EQ * t194
    t199 = psih - psil + t24
    t200 = sin(t199)
    contr[16] = 3/4 * t87 * t200 * t15 * (t185 - t187 - t189 + t191 + t193 - t195) * muM * t160
    t207 = psih + psil + t24
    t208 = sin(t207)
    contr[17] = -3/4 * t87 * t208 * t15 * (t185 - t187 - t189 - t191 - t193 + t195) * muM * t160
    t213 = sin(psig)
    contr[18] = t35 * t19 * sdelta * IMz * t213 * muM * t9
    t219 = cos(psil)
    contr[19] = -t22 * t219 * IMy * t9
    t223 = sin(t25)
    t228 = t36 * t15 * (t6 + t7)
    contr[20] = 3/2 * t228 * t33 * IMz * t223
    t230 = sin(t40)
    contr[21] = -3/2 * t228 * t33 * IMz * t230
    t235 = sin(t45)
    contr[22] = t36 * t145 * IMz * t15 * t123 * t235 / 4
    t241 = sin(t62)
    contr[23] = t36 * t66 * t15 * t123 * t64 * t241 / 4
    t247 = cos(t72)
    t249 = cpa2EQ * t75
    t250 = cpa1EQ * t77
    t251 = cpa1EQ * t79
    t252 = cpa2EQ * t81
    contr[24] = 3/2 * t88 * (t249 - t250 + t251 + t252) * muM * cdelta * t247
    t257 = cos(t91)
    t260 = IMx * t107
    t261 = t123 * IMy
    contr[25] = t87 * t15 * (t260 + t261) * t33 * t257 * t1 / 4
    t266 = cos(t113)
    t272 = t87 * t1 * muM
    contr[26] = -3/2 * t272 * t15 * (t249 - t250 - t251 - t252) * cdelta * t266
    t277 = cos(t120)
    contr[27] = -t129 * muM * t277 * t1 * (t260 - t261) / 4
    t284 = sin(t133)
    contr[28] = 3/4 * t137 * muM * t284 * t86 * cpa2EQ * t64
    t289 = sin(t141)
    contr[29] = -3/4 * t146 * t289 * t1 * t15 * cpa2EQ
    t294 = IMx * cpa1EQ
    t295 = IMy * cpa2EQ
    t299 = cos(t149)
    contr[30] = 3/4 * t87 * t299 * muM * t160 * t15 * (t294 - t295)
    t306 = cos(t162)
    contr[31] = -3/4 * t87 * t306 * t15 * (t294 + t295) * muM * t160
    t312 = t15 * (t95 - t97 - t98)
    t313 = sin(t168)
    contr[32] = 3/4 * t146 * t313 * t1 * t312
    t318 = sin(t176)
    contr[33] = -3/4 * t137 * muM * t318 * t175 * t312
    t323 = cpa1EQ * t184
    t325 = 2 * t7 * t75
    t326 = cpa1EQ * t188
    t327 = cpa2EQ * t190
    t329 = 2 * t29 * t79
    t330 = cpa2EQ * t194
    t334 = cos(t199)
    contr[34] = 3/4 * t87 * t334 * t15 * (t323 + t325 - t326 - t327 + t329 + t330) * muM * t160
    t338 = cos(t207)
    contr[35] = -3/4 * t272 * t15 * (t323 + t325 - t326 + t327 - t329 - t330) * sdelta * t338
    contr = sum(contr)
    return contr
end

function derivativechiM2_Jg1_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    contr = zeros(53)
    t1 = 2 * TL
    t2 = -psig + t1
    t3 = cos(t2)
    t4 = sqrt(smk)
    t7 = Q2 * cpa1EQ
    t10 = Q1 ^ 2
    t11 = Q2 ^ 2
    t13 = 1 / (t10 + t11 + 1)
    t14 = t13 * (Q1 * cpa2EQ - t7) * IMz
    t17 = rc ^ 2
    t19 = 0.1e1 / t17 / rc
    t20 = npsig ^ 2
    t23 = 0.1e1 / A
    t24 = t23 / t20 * t19
    t25 = t24 * muM * sdelta
    contr[1] = -3/2 * t25 * t14 * t4 * t3
    t28 = psig + t1
    t29 = cos(t28)
    contr[2] = 3/2 * t25 * t14 * t4 * t29
    t33 = psig - psih
    t34 = cos(t33)
    t36 = IMz * muM
    t37 = cpa1EQ * t10
    t38 = Q1 * Q2
    t40 = 2 * cpa2EQ * t38
    t41 = cpa1EQ * t11
    t44 = 4 * Q1 * cpa3EQ - cpa1EQ + t37 - t40 - t41
    t47 = cdelta - 1
    t48 = t47 * t13
    contr[3] = t24 * t48 * t44 * t36 * t4 * t34 / 4
    t51 = psig + psih
    t52 = cos(t51)
    t54 = cdelta + 1
    contr[4] = -t24 * t13 * t44 * muM * IMz * t54 * t4 * t52 / 4
    t62 = psig - psil
    t63 = sin(t62)
    t65 = sqrt(skm)
    t66 = t65 - 1
    t69 = Q1 * cpa1EQ
    t70 = Q2 * cpa2EQ
    t71 = cpa3EQ * (-t10 - t11 + 1) + t69 - t70
    t73 = muM * t71 * t66
    t75 = t13 * IMx
    t77 = (-npsil + npsig) ^ 2
    t80 = t23 / t77 * t19
    contr[5] = t80 * t75 * t73 * sdelta * t63 / 2
    t83 = psig + psil
    t84 = sin(t83)
    t87 = t65 + 1
    t88 = t87 * muM * t71
    t91 = (npsil + npsig) ^ 2
    t94 = t23 / t91 * t19
    contr[6] = t94 * t75 * t88 * sdelta * t84 / 2
    t97 = t1 - psig - psil
    t98 = sin(t97)
    t100 = Q1 * IMx
    t101 = cpa1EQ * t100
    t102 = Q2 * IMx
    t103 = cpa2EQ * t102
    t104 = Q1 * IMy
    t105 = cpa2EQ * t104
    t106 = Q2 * IMy
    t107 = cpa1EQ * t106
    t108 = t101 + t103 - t105 + t107
    t111 = sdelta * t13
    t112 = t94 * t111
    contr[7] = -3/4 * t112 * t108 * t87 * muM * t98
    t115 = t1 - psig + psil
    t116 = sin(t115)
    t119 = t13 * (t101 + t103 + t105 - t107)
    t122 = t80 * sdelta * t66
    contr[8] = -3/4 * t122 * t119 * muM * t116
    t125 = t1 + psig - psil
    t126 = sin(t125)
    contr[9] = 3/4 * t80 * t111 * t108 * t66 * muM * t126
    t132 = t1 + psig + psil
    t133 = sin(t132)
    t137 = t94 * sdelta * t87
    contr[10] = 3/4 * t137 * t119 * muM * t133
    t139 = IMz * t4
    t140 = t13 * cpa1EQ
    t143 = -psih - psig + t1
    t144 = cos(t143)
    contr[11] = 3/4 * t24 * t144 * muM * t54 * t140 * t139
    t150 = -psih + psig + t1
    t151 = cos(t150)
    contr[12] = -3/4 * t24 * t151 * t47 * muM * t140 * t139
    t156 = -psih + psig - psil
    t157 = sin(t156)
    t159 = cpa2EQ * t10
    t160 = cpa1EQ * t38
    t161 = 2 * t160
    t162 = cpa2EQ * t11
    t163 = Q2 * cpa3EQ
    t165 = t159 + t161 - t162 + 4 * t163 + cpa2EQ
    t171 = t37 + Q1 * (-2 * t70 + 4 * cpa3EQ) - t41 - cpa1EQ
    t172 = t171 * IMy
    t173 = IMx * t165 + t172
    t176 = t80 * t48
    contr[13] = -t176 * muM * t173 * t66 * t157 / 8
    t179 = -psih + psig + psil
    t180 = sin(t179)
    t184 = -IMx * t165 + t172
    contr[14] = t94 * t48 * t184 * muM * t180 * t87 / 8
    t189 = t37 + t40 - t41
    t193 = psih - psig + t1
    t194 = cos(t193)
    contr[15] = 3/4 * t24 * t194 * t47 * t13 * t189 * muM * t139
    t198 = muM * t54
    t201 = psih + psig + t1
    t202 = cos(t201)
    contr[16] = -3/4 * t24 * t202 * t13 * t189 * t198 * t139
    t207 = psih + psig - psil
    t208 = sin(t207)
    t210 = muM * t66
    contr[17] = t80 * t13 * t184 * t210 * t208 * t54 / 8
    t215 = t87 * t54
    t216 = psih + psig + psil
    t217 = sin(t216)
    t220 = t13 * muM
    t221 = t94 * t220
    contr[18] = -t221 * t173 * t217 * t215 / 8
    t224 = -psig - psil + t1 - psih
    t225 = sin(t224)
    t228 = IMx * cpa2EQ
    t229 = IMy * cpa1EQ
    t231 = t13 * (t228 + t229)
    contr[19] = -3/8 * t94 * t231 * t198 * t87 * t225
    t235 = t10 * IMx
    t236 = cpa2EQ * t235
    t238 = 2 * t7 * t100
    t239 = t11 * IMx
    t240 = cpa2EQ * t239
    t241 = t10 * IMy
    t242 = cpa1EQ * t241
    t244 = 2 * t70 * t104
    t245 = t11 * IMy
    t246 = cpa1EQ * t245
    t247 = t236 - t238 - t240 + t242 + t244 - t246
    t249 = -psig - psil + t1 + psih
    t250 = sin(t249)
    t253 = t47 * muM
    t254 = t94 * t253
    contr[20] = -3/8 * t254 * t250 * t13 * t247 * t87
    t258 = -psig + psil + t1 - psih
    t259 = sin(t258)
    t263 = t13 * (t228 - t229)
    contr[21] = -3/8 * t80 * t263 * muM * t259 * t54 * t66
    t267 = t236 - t238 - t240 - t242 - t244 + t246
    t269 = -psig + psil + t1 + psih
    t270 = sin(t269)
    t273 = t80 * t253
    contr[22] = -3/8 * t273 * t270 * t13 * t267 * t66
    t276 = psig - psil + t1 - psih
    t277 = sin(t276)
    contr[23] = 3/8 * t80 * t231 * t210 * t47 * t277
    t283 = t54 * t13
    t285 = psig - psil + t1 + psih
    t286 = sin(t285)
    contr[24] = 3/8 * t80 * muM * t286 * t283 * t247 * t66
    t290 = psig + psil + t1 - psih
    t291 = sin(t290)
    contr[25] = 3/8 * t94 * t263 * t253 * t291 * t87
    t298 = psig + psil + t1 + psih
    t299 = sin(t298)
    contr[26] = 3/8 * t94 * muM * t299 * t283 * t267 * t87
    t303 = sin(psig)
    contr[27] = t24 * t111 * muM * (cpa3EQ * t10 + cpa3EQ * t11 - cpa3EQ - t69 + t70) * IMz * t4 * t303
    t312 = sin(t2)
    t314 = sdelta * t36
    t318 = t24 * t13 * (t69 + t70)
    contr[28] = 3/2 * t318 * t314 * t4 * t312
    t320 = sin(t28)
    contr[29] = -3/2 * t318 * t314 * t4 * t320
    t325 = sin(t33)
    contr[30] = t24 * t253 * IMz * t13 * t165 * t4 * t325 / 4
    t332 = sin(t51)
    contr[31] = t24 * t36 * t13 * t165 * t54 * t4 * t332 / 4
    t339 = cos(t62)
    t342 = t13 * IMy
    contr[32] = -t80 * t342 * t73 * sdelta * t339 / 2
    t346 = cos(t83)
    contr[33] = t94 * t342 * t88 * sdelta * t346 / 2
    t351 = cos(t97)
    t353 = cpa2EQ * t100
    t354 = cpa1EQ * t102
    t355 = cpa1EQ * t104
    t356 = cpa2EQ * t106
    t358 = t13 * (t353 - t354 + t355 + t356)
    contr[34] = 3/4 * t137 * t358 * muM * t351
    t361 = cos(t115)
    t363 = t353 - t354 - t355 - t356
    contr[35] = 3/4 * t122 * t13 * t363 * muM * t361
    t367 = cos(t125)
    contr[36] = -3/4 * t122 * t358 * muM * t367
    t372 = cos(t132)
    contr[37] = -3/4 * t112 * t363 * t87 * muM * t372
    t380 = sin(t143)
    contr[38] = 3/4 * t24 * t380 * t13 * cpa2EQ * t198 * t139
    t387 = sin(t150)
    contr[39] = -3/4 * t24 * t387 * t47 * t13 * cpa2EQ * muM * t139
    t392 = IMx * t171
    t399 = 2 * (t160 + t159 / 2 - t162 / 2 + 2 * t163 + cpa2EQ / 2) * IMy
    t400 = t392 - t399
    t401 = cos(t156)
    contr[40] = -t176 * t210 * t401 * t400 / 8
    t406 = cos(t179)
    t410 = t13 * (t392 + t399)
    contr[41] = -t94 * t410 * t253 * t406 * t87 / 8
    t415 = (t159 - t161 - t162) * t4
    t416 = IMz * t13
    t419 = sin(t193)
    contr[42] = 3/4 * t24 * t419 * t47 * muM * t416 * t415
    t425 = sin(t201)
    contr[43] = -3/4 * t24 * t425 * muM * t54 * t416 * t415
    t430 = cos(t207)
    contr[44] = t80 * t410 * t210 * t430 * t54 / 8
    t436 = cos(t216)
    contr[45] = t221 * t436 * t87 * t54 * t400 / 8
    t440 = IMx * cpa1EQ
    t441 = IMy * cpa2EQ
    t442 = t440 - t441
    t445 = cos(t224)
    contr[46] = -3/8 * t94 * muM * t445 * t13 * t442 * t215
    t450 = cpa1EQ * t235
    t452 = 2 * t70 * t100
    t453 = cpa1EQ * t239
    t454 = cpa2EQ * t241
    t456 = 2 * t7 * t104
    t457 = cpa2EQ * t245
    t458 = t450 + t452 - t453 - t454 + t456 + t457
    t460 = cos(t249)
    contr[47] = -3/8 * t254 * t460 * t13 * t458 * t87
    t465 = cos(t258)
    t468 = t13 * (t440 + t441)
    contr[48] = -3/8 * t80 * t198 * t468 * t66 * t465
    t473 = cos(t269)
    t475 = t450 + t452 - t453 + t454 - t456 - t457
    contr[49] = -3/8 * t80 * t220 * t475 * t66 * t47 * t473
    t482 = cos(t276)
    contr[50] = 3/8 * t273 * t482 * t13 * t442 * t66
    t488 = cos(t285)
    contr[51] = 3/8 * t80 * muM * t488 * t283 * t458 * t66
    t492 = cos(t290)
    contr[52] = 3/8 * t94 * muM * t87 * t468 * t47 * t492
    t498 = cos(t298)
    contr[53] = 3/8 * t94 * t198 * t87 * t13 * t475 * t498
    contr = sum(contr)
    return contr
end

function derivativechiM2_cdelta1_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    contr = zeros(42)
    t1 = sin(psil)
    t3 = Q1 ^ 2
    t4 = Q2 ^ 2
    t8 = Q2 * cpa2EQ
    t10 = sqrt(smk)
    t11 = t10 * (cpa3EQ * (t3 + t4 - 1) - Q1 * cpa1EQ + t8)
    t14 = 1 / (t3 + t4 + 1)
    t15 = t14 * muM
    t16 = rc ^ 2
    t18 = 0.1e1 / t16 / rc
    t20 = 0.1e1 / npsil * t18
    t21 = t20 * t15
    contr[1] = t21 * t11 * IMx * t1
    t22 = psig - psih
    t23 = cos(t22)
    t25 = IMz * muM
    t27 = cpa1EQ * t3
    t28 = Q1 * Q2
    t30 = 2 * cpa2EQ * t28
    t31 = cpa1EQ * t4
    t37 = 0.1e1 / npsig * t18
    t38 = t37 * t14 * (4 * Q1 * cpa3EQ - cpa1EQ + t27 - t30 - t31)
    contr[2] = -t38 * t25 * t10 * t23 / 4
    t41 = psig + psih
    t42 = cos(t41)
    contr[3] = t38 * t25 * t10 * t42 / 4
    t46 = 2 * TL
    t47 = -psil + t46
    t48 = sin(t47)
    t51 = Q1 * IMx
    t52 = cpa1EQ * t51
    t53 = Q2 * IMx
    t54 = cpa2EQ * t53
    t55 = Q1 * IMy
    t56 = cpa2EQ * t55
    t57 = Q2 * IMy
    t58 = cpa1EQ * t57
    contr[4] = 3/2 * t20 * t14 * (t52 + t54 - t56 + t58) * muM * t10 * t48
    t63 = psil + t46
    t64 = sin(t63)
    contr[5] = -3/2 * t20 * t14 * (t52 + t54 + t56 - t58) * muM * t10 * t64
    t72 = -psih - psig + t46
    t73 = cos(t72)
    t75 = muM * cpa1EQ
    t78 = t37 * IMz * t14
    contr[6] = -3/4 * t78 * t75 * t73 * t10
    t81 = -psih + psig + t46
    t82 = cos(t81)
    contr[7] = 3/4 * t78 * t75 * t82 * t10
    t86 = -psih + psig - psil
    t87 = sin(t86)
    t88 = sqrt(skm)
    t89 = t88 - 1
    t92 = cpa2EQ * t3
    t94 = 2 * cpa1EQ * t28
    t95 = cpa2EQ * t4
    t98 = 4 * Q2 * cpa3EQ + cpa2EQ + t92 + t94 - t95
    t104 = t27 + Q1 * (-2 * t8 + 4 * cpa3EQ) - t31 - cpa1EQ
    t105 = t104 * IMy
    t107 = t14 * (IMx * t98 + t105)
    t110 = 0.1e1 / (-npsil + npsig) * t18
    contr[8] = t110 * t107 * muM * t89 * t87 / 8
    t113 = -psih + psig + psil
    t114 = sin(t113)
    t118 = -IMx * t98 + t105
    t120 = t88 + 1
    t124 = 0.1e1 / (npsil + npsig) * t18
    t125 = t124 * t14 * t120
    contr[9] = -t125 * t118 * muM * t114 / 8
    t129 = (t27 + t30 - t31) * t10
    t130 = psih - psig + t46
    t131 = cos(t130)
    t134 = t37 * t25
    contr[10] = -3/4 * t134 * t131 * t14 * t129
    t137 = psih + psig + t46
    t138 = cos(t137)
    contr[11] = 3/4 * t134 * t138 * t14 * t129
    t142 = psih + psig - psil
    t143 = sin(t142)
    contr[12] = -t110 * t14 * t118 * muM * t89 * t143 / 8
    t150 = psih + psig + psil
    t151 = sin(t150)
    contr[13] = t124 * t107 * t120 * muM * t151 / 8
    t156 = -psig - psil + t46 - psih
    t157 = sin(t156)
    t160 = IMx * cpa2EQ
    t161 = IMy * cpa1EQ
    t163 = t14 * (t160 + t161)
    contr[14] = 3/8 * t124 * t163 * muM * t120 * t157
    t166 = muM * t120
    t167 = t3 * IMx
    t168 = cpa2EQ * t167
    t169 = Q2 * cpa1EQ
    t171 = 2 * t169 * t51
    t172 = t4 * IMx
    t173 = cpa2EQ * t172
    t174 = t3 * IMy
    t175 = cpa1EQ * t174
    t177 = 2 * t8 * t55
    t178 = t4 * IMy
    t179 = cpa1EQ * t178
    t180 = t168 - t171 - t173 + t175 + t177 - t179
    t182 = -psig - psil + t46 + psih
    t183 = sin(t182)
    contr[15] = 3/8 * t124 * t183 * t14 * t180 * t166
    t187 = -psig + psil + t46 - psih
    t188 = sin(t187)
    t192 = t14 * (t160 - t161)
    contr[16] = 3/8 * t110 * t192 * t89 * t188 * muM
    t195 = t168 - t171 - t173 - t175 - t177 + t179
    t198 = -psig + psil + t46 + psih
    t199 = sin(t198)
    contr[17] = 3/8 * t110 * t89 * t199 * t14 * t195 * muM
    t203 = psig - psil + t46 - psih
    t204 = sin(t203)
    contr[18] = -3/8 * t110 * t163 * muM * t89 * t204
    t212 = psig - psil + t46 + psih
    t213 = sin(t212)
    contr[19] = -3/8 * t110 * t89 * t213 * t14 * t180 * muM
    t218 = psig + psil + t46 - psih
    t219 = sin(t218)
    contr[20] = -3/8 * t124 * t192 * t219 * t166
    t225 = psig + psil + t46 + psih
    t226 = sin(t225)
    contr[21] = -3/8 * t124 * t226 * t14 * t195 * t166
    t231 = cos(psil)
    contr[22] = t21 * t11 * IMy * t231
    t234 = sin(t22)
    t236 = t14 * t98
    contr[23] = -t134 * t236 * t10 * t234 / 4
    t240 = sin(t41)
    contr[24] = -t134 * t236 * t10 * t240 / 4
    t245 = cos(t47)
    t248 = cpa2EQ * t51
    t249 = cpa1EQ * t53
    t250 = cpa1EQ * t55
    t251 = cpa2EQ * t57
    contr[25] = -3/2 * t20 * t14 * (t248 - t249 + t250 + t251) * muM * t10 * t245
    t257 = cos(t63)
    contr[26] = 3/2 * t21 * (t248 - t249 - t250 - t251) * t10 * t257
    t262 = cpa2EQ * t10
    t263 = sin(t72)
    contr[27] = -3/4 * t134 * t263 * t14 * t262
    t268 = sin(t81)
    contr[28] = 3/4 * t134 * t268 * t14 * t262
    t272 = cos(t86)
    t275 = IMx * t104
    t276 = t98 * IMy
    t278 = t14 * (t275 - t276)
    contr[29] = t110 * t278 * muM * t89 * t272 / 8
    t281 = cos(t113)
    t283 = t275 + t276
    contr[30] = t125 * t283 * muM * t281 / 8
    t286 = sin(t130)
    t289 = t14 * (t92 - t94 - t95)
    contr[31] = -3/4 * t134 * t289 * t286 * t10
    t293 = sin(t137)
    contr[32] = 3/4 * t134 * t289 * t293 * t10
    t297 = cos(t142)
    contr[33] = -t110 * t14 * t283 * muM * t89 * t297 / 8
    t304 = cos(t150)
    contr[34] = -t124 * t278 * t120 * muM * t304 / 8
    t310 = IMx * cpa1EQ
    t311 = IMy * cpa2EQ
    t312 = t310 - t311
    t314 = cos(t156)
    contr[35] = 3/8 * t124 * t314 * t14 * t312 * t166
    t318 = cpa1EQ * t167
    t320 = 2 * t8 * t51
    t321 = cpa1EQ * t172
    t322 = cpa2EQ * t174
    t324 = 2 * t169 * t55
    t325 = cpa2EQ * t178
    t326 = t318 + t320 - t321 - t322 + t324 + t325
    t328 = cos(t182)
    contr[36] = 3/8 * t124 * t328 * t14 * t326 * t166
    t332 = cos(t187)
    t334 = t310 + t311
    t336 = t110 * t15
    contr[37] = 3/8 * t336 * t334 * t89 * t332
    t338 = cos(t198)
    t340 = t318 + t320 - t321 + t322 - t324 - t325
    contr[38] = 3/8 * t336 * t340 * t89 * t338
    t345 = cos(t203)
    contr[39] = -3/8 * t110 * t89 * t345 * t14 * t312 * muM
    t352 = cos(t212)
    contr[40] = -3/8 * t110 * t89 * t352 * t14 * t326 * muM
    t357 = cos(t218)
    t360 = t124 * t166
    contr[41] = -3/8 * t360 * t14 * t334 * t357
    t363 = cos(t225)
    contr[42] = -3/8 * t360 * t14 * t340 * t363
    contr = sum(contr)
    return contr
end

function derivativechiM2_cdelta2_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    contr = zeros(29)
    t1 = 2 * TL
    t2 = -psig + t1
    t3 = cos(t2)
    t4 = sqrt(smk)
    t7 = Q2 * cpa1EQ
    t9 = (Q1 * cpa2EQ - t7) * IMz
    t11 = Q1 ^ 2
    t12 = Q2 ^ 2
    t14 = 1 / (t11 + t12 + 1)
    t15 = t14 * muM
    t16 = rc ^ 2
    t18 = 0.1e1 / t16 / rc
    t20 = 0.1e1 / npsig
    t21 = t20 * t18 * cdelta
    t22 = t21 * t15
    contr[1] = -3/2 * t22 * t9 * t4 * t3
    t25 = psig + t1
    t26 = cos(t25)
    contr[2] = 3/2 * t22 * t9 * t4 * t26
    t30 = sqrt(skm)
    t31 = t30 - 1
    t32 = cdelta * t31
    t33 = psig - psil
    t34 = sin(t33)
    t39 = Q1 * cpa1EQ
    t40 = Q2 * cpa2EQ
    t41 = cpa3EQ * (t11 + t12 - 1) - t39 + t40
    t43 = t18 * t14
    t44 = npsil - npsig
    t47 = 1 / t44 * t43 * muM * t41
    contr[3] = t47 * IMx * t34 * t32 / 2
    t49 = psig + psil
    t50 = sin(t49)
    t54 = t30 + 1
    t57 = 0.1e1 / (npsil + npsig)
    t59 = t57 * t43 * t54 * muM
    contr[4] = -t59 * t41 * IMx * t50 * cdelta / 2
    t69 = -2 * Q1 * Q2 * cpa1EQ - 4 * Q2 * cpa3EQ - cpa2EQ * t11 + cpa2EQ * t12 - cpa2EQ
    t77 = cpa1EQ * t11 + Q1 * (-2 * t40 + 4 * cpa3EQ) - cpa1EQ * t12 - cpa1EQ
    t78 = t77 * IMy
    t81 = -psil + psih
    t82 = sin(t81)
    t86 = 1 / npsil * t18
    t87 = t86 * t15
    contr[5] = t87 * t82 * cdelta * (IMx * t69 + t78) * t4 / 4
    t89 = cdelta * t4
    t90 = psil + psih
    t91 = sin(t90)
    t94 = -t69
    contr[6] = t86 * t14 * (IMx * t94 + t78) * muM * t91 * t89 / 4
    t100 = t1 - psig - psil
    t101 = sin(t100)
    t103 = Q1 * IMx
    t104 = cpa1EQ * t103
    t105 = Q2 * IMx
    t106 = cpa2EQ * t105
    t107 = Q1 * IMy
    t108 = cpa2EQ * t107
    t109 = Q2 * IMy
    t110 = cpa1EQ * t109
    t111 = t104 + t106 - t108 + t110
    t114 = cdelta * t14
    t115 = t57 * t18
    t116 = t115 * t114
    contr[7] = -3/4 * t116 * t111 * t54 * muM * t101
    t119 = t1 - psig + psil
    t120 = sin(t119)
    t122 = t104 + t106 + t108 - t110
    t127 = -1 / t44 * t18
    t128 = t127 * t114
    contr[8] = -3/4 * t128 * t122 * muM * t31 * t120
    t131 = t1 + psig - psil
    t132 = sin(t131)
    contr[9] = 3/4 * t128 * t111 * muM * t31 * t132
    t137 = t1 + psig + psil
    t138 = sin(t137)
    contr[10] = 3/4 * t116 * t122 * t54 * muM * t138
    t143 = -psih - psil + t1
    t144 = sin(t143)
    t146 = IMx * cpa2EQ
    t147 = IMy * cpa1EQ
    contr[11] = 3/4 * t86 * t114 * (t146 + t147) * muM * t4 * t144
    t156 = -psih + psil + t1
    t157 = sin(t156)
    contr[12] = -3/4 * t86 * t157 * muM * t89 * t14 * (t146 - t147)
    t162 = t11 * IMx
    t163 = cpa2EQ * t162
    t165 = 2 * t7 * t103
    t166 = t12 * IMx
    t167 = cpa2EQ * t166
    t168 = t11 * IMy
    t169 = cpa1EQ * t168
    t171 = 2 * t40 * t107
    t172 = t12 * IMy
    t173 = cpa1EQ * t172
    t177 = psih - psil + t1
    t178 = sin(t177)
    contr[13] = 3/4 * t86 * t178 * t14 * (t163 - t165 - t167 + t169 + t171 - t173) * muM * t89
    t185 = psih + psil + t1
    t186 = sin(t185)
    contr[14] = -3/4 * t86 * t186 * t14 * (t163 - t165 - t167 - t169 - t171 + t173) * muM * t89
    t191 = cdelta * muM
    t192 = sin(psig)
    contr[15] = t20 * t43 * IMz * t4 * t41 * t192 * t191
    t198 = sin(t2)
    t200 = IMz * muM
    t204 = t21 * t14 * (t39 + t40)
    contr[16] = 3/2 * t204 * t200 * t4 * t198
    t206 = sin(t25)
    contr[17] = -3/2 * t204 * t200 * t4 * t206
    t211 = cos(t33)
    contr[18] = -t47 * IMy * t211 * t32 / 2
    t216 = cos(t49)
    contr[19] = -t59 * t41 * IMy * t216 * cdelta / 2
    t222 = IMx * t77
    t223 = t94 * IMy
    t226 = cos(t81)
    contr[20] = t87 * t226 * cdelta * (t222 + t223) * t4 / 4
    t230 = cos(t90)
    contr[21] = -t87 * (t222 - t223) * t230 * t89 / 4
    t236 = cos(t100)
    t238 = cpa2EQ * t103
    t239 = cpa1EQ * t105
    t240 = cpa1EQ * t107
    t241 = cpa2EQ * t109
    t242 = t238 - t239 + t240 + t241
    contr[22] = 3/4 * t116 * t242 * t54 * muM * t236
    t246 = cos(t119)
    t248 = t238 - t239 - t240 - t241
    contr[23] = 3/4 * t127 * t191 * t14 * t248 * t31 * t246
    t253 = cos(t131)
    contr[24] = -3/4 * t128 * t242 * muM * t31 * t253
    t259 = cos(t137)
    contr[25] = -3/4 * t115 * cdelta * t54 * t15 * t248 * t259
    t266 = IMx * cpa1EQ
    t267 = IMy * cpa2EQ
    t271 = cos(t143)
    contr[26] = 3/4 * t86 * t271 * muM * t89 * t14 * (t266 - t267)
    t278 = cos(t156)
    contr[27] = -3/4 * t86 * t278 * t14 * (t266 + t267) * muM * t89
    t283 = cpa1EQ * t162
    t285 = 2 * t40 * t103
    t286 = cpa1EQ * t166
    t287 = cpa2EQ * t168
    t289 = 2 * t7 * t107
    t290 = cpa2EQ * t172
    t294 = cos(t177)
    contr[28] = 3/4 * t86 * t294 * t14 * (t283 + t285 - t286 - t287 + t289 + t290) * muM * t89
    t298 = cos(t185)
    contr[29] = -3/4 * t86 * t191 * t14 * (t283 + t285 - t286 + t287 - t289 - t290) * t4 * t298
    contr = sum(contr)
    return contr
end

function derivativechiM2_cdeltapsigMpsihOsdelta_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    contr = zeros(65)
    t1 = sqrt(smk)
    t2 = t1 * cdelta
    t4 = Q2 * cpa1EQ
    t7 = (Q1 * cpa2EQ - t4) * IMz * t2
    t8 = Q1 ^ 2
    t9 = Q2 ^ 2
    t11 = 0.1e1 / (t8 + t9 + 1)
    t12 = muM * t11
    t13 = 2 * TL
    t14 = -psig + t13
    t15 = sin(t14)
    t16 = rc ^ 2
    t18 = 0.1e1 / t16 / rc
    t20 = 0.1e1 / npsig
    contr[1] = 3/2 * t20 * t18 * t15 * t12 * t7
    t24 = psig + t13
    t25 = sin(t24)
    contr[2] = 3/2 * t20 * t18 * t25 * t12 * t7
    t30 = muM * t1
    t31 = sdelta * IMz
    t32 = t31 * t30
    t33 = cpa1EQ * t8
    t34 = Q1 * Q2
    t36 = 2 * cpa2EQ * t34
    t37 = cpa1EQ * t9
    t41 = t11 * (4 * Q1 * cpa3EQ - cpa1EQ + t33 - t36 - t37)
    t42 = psig - psih
    t43 = sin(t42)
    contr[3] = -t20 * t18 * t43 * t41 * t32 / 4
    t49 = psig + psih
    t50 = sin(t49)
    contr[4] = t20 * t18 * t50 * t41 * t32 / 4
    t55 = sqrt(skm)
    t56 = t55 - 1
    t57 = cdelta * t56
    t58 = psig - psil
    t59 = cos(t58)
    t64 = Q1 * cpa1EQ
    t65 = Q2 * cpa2EQ
    t66 = cpa3EQ * (t8 + t9 - 1) - t64 + t65
    t68 = t18 * t11
    t69 = npsil - npsig
    t72 = 0.1e1 / t69 * t68 * muM * t66
    contr[5] = -t72 * IMx * t59 * t57 / 2
    t75 = psig + psil
    t76 = cos(t75)
    t80 = t55 + 1
    t83 = 0.1e1 / (npsil + npsig)
    t85 = t83 * t68 * muM * t80
    contr[6] = t85 * t66 * IMx * t76 * cdelta / 2
    t87 = -psil + psih
    t88 = cos(t87)
    t91 = cpa2EQ * t8
    t93 = 2 * cpa1EQ * t34
    t94 = cpa2EQ * t9
    t97 = -4 * Q2 * cpa3EQ - cpa2EQ - t91 - t93 + t94
    t103 = t33 + Q1 * (-2 * t65 + 4 * cpa3EQ) - t37 - cpa1EQ
    t104 = t103 * IMy
    t106 = t11 * (IMx * t97 + t104)
    t108 = 0.1e1 / npsil * t18
    contr[7] = t108 * t106 * t1 * muM * t88 / 4
    t111 = psil + psih
    t112 = cos(t111)
    t113 = -t97
    t115 = IMx * t113 + t104
    t119 = t108 * t11 * t1
    contr[8] = t119 * muM * t115 * t112 / 4
    t121 = cdelta * muM
    t122 = Q1 * IMx
    t123 = cpa1EQ * t122
    t124 = Q2 * IMx
    t125 = cpa2EQ * t124
    t126 = Q1 * IMy
    t127 = cpa2EQ * t126
    t128 = Q2 * IMy
    t129 = cpa1EQ * t128
    t130 = t123 + t125 - t127 + t129
    t133 = t13 - psig - psil
    t134 = cos(t133)
    t136 = t83 * t18
    contr[9] = -3/4 * t136 * t134 * t11 * t130 * t80 * t121
    t140 = t123 + t125 + t127 - t129
    t143 = t13 - psig + psil
    t144 = cos(t143)
    t148 = -0.1e1 / t69 * t18
    contr[10] = -3/4 * t148 * t144 * t11 * t140 * muM * t57
    t154 = t13 + psig - psil
    t155 = cos(t154)
    contr[11] = -3/4 * t148 * t155 * t11 * t130 * muM * t57
    t162 = t13 + psig + psil
    t163 = cos(t162)
    contr[12] = -3/4 * t136 * t163 * t11 * t140 * t80 * t121
    t168 = t11 * cpa1EQ
    t169 = -psih - psig + t13
    t170 = sin(t169)
    t173 = muM * sdelta
    t176 = t20 * t18 * IMz * t173
    contr[13] = 3/4 * t176 * t170 * t1 * t168
    t178 = -psih + psig + t13
    t179 = sin(t178)
    contr[14] = 3/4 * t176 * t179 * t1 * t168
    t183 = -psih + psig - psil
    t184 = cos(t183)
    t188 = t148 * t11 * t56
    contr[15] = -t188 * t115 * t184 * t173 / 8
    t191 = sdelta * t80
    t192 = -psih + psig + psil
    t193 = cos(t192)
    contr[16] = t136 * t106 * t193 * muM * t191 / 8
    t198 = IMx * cpa2EQ
    t199 = IMy * cpa1EQ
    t200 = t198 + t199
    t202 = -psih - psil + t13
    t203 = cos(t202)
    contr[17] = -3/4 * t108 * t203 * t11 * t200 * t30
    t208 = t198 - t199
    t211 = -psih + psil + t13
    t212 = cos(t211)
    contr[18] = 3/4 * t108 * t212 * muM * t11 * t208 * t1
    t216 = psih - psig + t13
    t217 = sin(t216)
    t220 = t11 * (t33 + t36 - t37)
    contr[19] = 3/4 * t176 * t220 * t217 * t1
    t223 = psih + psig + t13
    t224 = sin(t223)
    contr[20] = 3/4 * t176 * t220 * t224 * t1
    t228 = psih + psig - psil
    t229 = cos(t228)
    contr[21] = t148 * t106 * t56 * t229 * t173 / 8
    t234 = psih + psig + psil
    t235 = cos(t234)
    contr[22] = -t136 * t11 * t115 * t235 * muM * t191 / 8
    t242 = psih - psil + t13
    t243 = cos(t242)
    t245 = t8 * IMx
    t246 = cpa2EQ * t245
    t248 = 2 * t4 * t122
    t249 = t9 * IMx
    t250 = cpa2EQ * t249
    t251 = t8 * IMy
    t252 = cpa1EQ * t251
    t254 = 2 * t65 * t126
    t255 = t9 * IMy
    t256 = cpa1EQ * t255
    t258 = t11 * (t246 - t248 - t250 + t252 + t254 - t256)
    contr[23] = 3/4 * t108 * t258 * t243 * t30
    t261 = t246 - t248 - t250 - t252 - t254 + t256
    t263 = psih + psil + t13
    t264 = cos(t263)
    contr[24] = -3/4 * t108 * t264 * t11 * t261 * t30
    t269 = t11 * t200
    t270 = -psig - psil + t13 - psih
    t271 = cos(t270)
    t274 = t136 * t191
    contr[25] = 3/8 * t274 * muM * t271 * t269
    t276 = -psig - psil + t13 + psih
    t277 = cos(t276)
    contr[26] = 3/8 * t274 * t258 * muM * t277
    t281 = -psig + psil + t13 - psih
    t282 = cos(t281)
    t284 = t11 * t208
    t287 = t148 * sdelta * t56
    contr[27] = 3/8 * t287 * t284 * muM * t282
    t289 = -psig + psil + t13 + psih
    t290 = cos(t289)
    t292 = t11 * t261
    contr[28] = 3/8 * t287 * t292 * muM * t290
    t295 = psig - psil + t13 - psih
    t296 = cos(t295)
    contr[29] = 3/8 * t287 * muM * t296 * t269
    t300 = psig - psil + t13 + psih
    t301 = cos(t300)
    contr[30] = 3/8 * t287 * t258 * muM * t301
    t305 = psig + psil + t13 - psih
    t306 = cos(t305)
    contr[31] = 3/8 * t274 * t284 * muM * t306
    t310 = psig + psil + t13 + psih
    t311 = cos(t310)
    contr[32] = 3/8 * t274 * t292 * muM * t311
    t315 = cos(psig)
    contr[33] = -t20 * t68 * IMz * t1 * t66 * t315 * t121
    t323 = IMz * muM * t2
    t325 = t11 * (t64 + t65)
    t326 = cos(t14)
    contr[34] = 3/2 * t20 * t18 * t326 * t325 * t323
    t331 = cos(t24)
    contr[35] = 3/2 * t20 * t18 * t331 * t325 * t323
    t337 = t11 * t113 * t30
    t338 = cos(t42)
    contr[36] = t20 * t18 * t338 * t31 * t337 / 4
    t343 = cos(t49)
    contr[37] = t20 * t18 * t343 * t31 * t337 / 4
    t348 = sin(t58)
    contr[38] = -t72 * IMy * t348 * t57 / 2
    t353 = sin(t75)
    contr[39] = -t85 * t66 * IMy * t353 * cdelta / 2
    t359 = sin(t87)
    t362 = IMx * t103
    t363 = t113 * IMy
    t364 = t362 + t363
    contr[40] = -t108 * t11 * t364 * t1 * muM * t359 / 4
    t369 = t362 - t363
    t370 = sin(t111)
    contr[41] = t119 * muM * t370 * t369 / 4
    t374 = cpa2EQ * t122
    t375 = cpa1EQ * t124
    t376 = cpa1EQ * t126
    t377 = cpa2EQ * t128
    t378 = t374 - t375 + t376 + t377
    t381 = sin(t133)
    contr[42] = -3/4 * t136 * t381 * t11 * t378 * t80 * t121
    t386 = t374 - t375 - t376 - t377
    t389 = sin(t143)
    contr[43] = -3/4 * t148 * t389 * muM * t11 * t386 * t57
    t396 = sin(t154)
    contr[44] = -3/4 * t148 * t396 * t11 * t378 * muM * t57
    t403 = sin(t162)
    contr[45] = -3/4 * t136 * t403 * t80 * t12 * t386 * cdelta
    t408 = t11 * cpa2EQ
    t409 = cos(t169)
    contr[46] = -3/4 * t176 * t409 * t1 * t408
    t414 = cos(t178)
    contr[47] = -3/4 * t176 * t414 * t1 * t408
    t419 = sin(t183)
    contr[48] = t188 * t369 * t419 * t173 / 8
    t425 = sin(t192)
    contr[49] = t136 * t11 * t425 * t173 * t80 * t364 / 8
    t429 = IMx * cpa1EQ
    t430 = IMy * cpa2EQ
    t432 = t11 * (t429 - t430)
    t434 = sin(t202)
    contr[50] = 3/4 * t108 * t434 * muM * t1 * t432
    t438 = t429 + t430
    t440 = sin(t211)
    contr[51] = -3/4 * t108 * t440 * t11 * t438 * t30
    t446 = t11 * (t91 - t93 - t94)
    t447 = cos(t216)
    contr[52] = -3/4 * t176 * t447 * t1 * t446
    t452 = cos(t223)
    contr[53] = -3/4 * t176 * t452 * t1 * t446
    t458 = sin(t228)
    contr[54] = -t188 * t458 * muM * sdelta * t364 / 8
    t463 = sin(t234)
    contr[55] = -t136 * t11 * t369 * t463 * muM * t191 / 8
    t470 = sin(t242)
    t472 = cpa1EQ * t245
    t474 = 2 * t65 * t122
    t475 = cpa1EQ * t249
    t476 = cpa2EQ * t251
    t478 = 2 * t4 * t126
    t479 = cpa2EQ * t255
    t481 = t11 * (t472 + t474 - t475 - t476 + t478 + t479)
    contr[56] = -3/4 * t108 * t481 * t470 * t30
    t485 = t472 + t474 - t475 + t476 - t478 - t479
    t488 = sin(t263)
    contr[57] = 3/4 * t108 * t488 * muM * t11 * t485 * t1
    t492 = sin(t270)
    contr[58] = -3/8 * t274 * muM * t492 * t432
    t497 = sin(t276)
    contr[59] = -3/8 * t274 * t481 * muM * t497
    t502 = sin(t281)
    t504 = t11 * t438
    contr[60] = -3/8 * t287 * t504 * muM * t502
    t508 = sin(t289)
    t510 = t11 * t485
    contr[61] = -3/8 * t287 * t510 * muM * t508
    t514 = sin(t295)
    contr[62] = -3/8 * t287 * muM * t514 * t432
    t519 = sin(t300)
    contr[63] = -3/8 * t287 * t481 * muM * t519
    t524 = sin(t305)
    contr[64] = -3/8 * t274 * t504 * muM * t524
    t529 = sin(t310)
    contr[65] = -3/8 * t274 * t510 * muM * t529
    contr = sum(contr)
    return contr
end

function derivativechiM3_psil_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    return 0.0;
end

function derivativechiM3_psig_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    return 0.0;
end

function derivativechiM3_psih_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    contr = zeros(14)
    t1 = sqrt(skm)
    t2 = t1 * IMz
    t3 = sdelta * muM
    t4 = P1 ^ 2
    t5 = cpa1EQ * t4
    t6 = 3/4 * t5
    t7 = P2 ^ 2
    t8 = cpa1EQ * t7
    t9 = 3/4 * t8
    t10 = cpa2EQ * phiTA
    t11 = t10 / 2
    t12 = P2 * P1
    t13 = cpa2EQ * t12
    t14 = 3/2 * t13
    t16 = Q2 ^ 2
    t18 = t4 * cpa2EQ
    t20 = 3/2 * Q1 * t18
    t21 = P1 * cpa1EQ
    t22 = P2 * Q1
    t24 = 3 * t22 * t21
    t25 = t7 * cpa2EQ
    t27 = 3/2 * Q1 * t25
    t29 = 2 * cpa3EQ
    t31 = (Q1 * cpa1EQ + t29) * phiTA
    t34 = Q1 ^ 2
    t35 = t34 + 1
    t43 = eta ^ 2
    t44 = t43 * eta
    t46 = 3/2 * t10
    t49 = 3 * t31
    t59 = t4 ^ 2
    t60 = cpa1EQ * t59
    t62 = t7 ^ 2
    t63 = cpa1EQ * t62
    t65 = t4 * P1
    t66 = P2 * t65
    t67 = cpa2EQ * t66
    t69 = t7 * P2
    t70 = t69 * P1
    t71 = cpa2EQ * t70
    t75 = t59 * cpa2EQ
    t76 = Q1 * t75
    t79 = t22 * t65 * cpa1EQ
    t82 = Q1 * t69 * t21
    t84 = t62 * cpa2EQ
    t85 = Q1 * t84
    t92 = (t60 / 2 - t63 / 2 + t10 - t67 - t71) * t35
    t110 = sin(psih)
    t112 = 0.1e1 / (t34 + t16 + 1)
    t114 = sma ^ 2
    t116 = 0.1e1 / t114 / sma
    t120 = 0.1e1 / n / t44
    t121 = 1 + eta
    t122 = t121 ^ 2
    t125 = 1 / t122 / t121 * t120
    contr[1] = t125 * t116 * t112 * t110 * (t44 * (t16 * (-t6 + t9 - t11 + t14) + Q2 * (t20 + t24 - t27 + t31) + (3/2 * t5 - 3/2 * t8 + t10 - 3 * t13) * t35 / 2) + t43 * (t16 * (-t6 + t9 - t46 + t14) + Q2 * (t20 + t24 - t27 + t49) + 3/2 * (t5 / 2 - t8 / 2 + t10 - t13) * t35) + eta * (t16 * (-3/4 * t60 + 3/4 * t63 - t46 + 3/2 * t67 + 3/2 * t71) + Q2 * (3/2 * t76 + 3 * t79 + 3 * t82 - 3/2 * t85 + t49) + 3/2 * t92) + t16 * (t67 / 2 + t71 / 2 - t60 / 4 + t63 / 4 - t11) + Q2 * (t76 / 2 + t79 + t82 - t85 / 2 + t31) + t92 / 2) * t3 * t2
    t127 = sdelta * t1
    t128 = Q2 * Q1
    t129 = cpa1EQ * t128
    t130 = cpa2EQ * t34
    t131 = t130 / 2
    t132 = cpa2EQ * t16
    t133 = t132 / 2
    t134 = Q2 * cpa3EQ
    t135 = 2 * t134
    t139 = cpa1EQ * t34
    t140 = Q2 * cpa2EQ
    t144 = Q1 * (-2 * t140 + 4 * cpa3EQ)
    t145 = cpa1EQ * t16
    t154 = TL - psih
    t155 = sin(t154)
    t157 = t116 * t120
    contr[2] = t157 * t112 * t155 * IMz * muM * (P1 * (t129 + t131 - t133 + t135 + 2 * cpa2EQ) - P2 * (t139 + t144 - t145 - 4 * cpa1EQ) / 2) * t127 / 2
    t172 = TL + psih
    t173 = sin(t172)
    contr[3] = t157 * t112 * t173 * IMz * muM * (P1 * (t129 - t130 + t132 - t134 - cpa2EQ / 4) - (t139 + Q1 * (t140 + cpa3EQ) - t145 - cpa1EQ / 4) * P2) * t127
    t176 = muM * IMz
    t179 = 2 * TL
    t180 = t179 - psih
    t181 = sin(t180)
    contr[4] = 3/4 * t157 * t181 * t112 * cpa1EQ * t127 * t176
    t189 = sdelta * t176
    t191 = t179 + psih
    t192 = sin(t191)
    contr[5] = -3/4 * t157 * t192 * t1 * t189 * t112 * (2 * cpa2EQ * t128 + t139 - t145)
    t197 = P1 * cpa2EQ
    t202 = 3 * TL
    t203 = t202 - psih
    t204 = sin(t203)
    contr[6] = -t157 * t204 * t1 * t189 * t112 * (-P2 * cpa1EQ + t197) / 4
    t209 = t34 * P1
    t211 = P1 * Q1
    t212 = Q2 * cpa1EQ
    t215 = t16 * P1
    t217 = t34 * P2
    t221 = t16 * P2
    t228 = t202 + psih
    t229 = sin(t228)
    contr[7] = t157 * t229 * t1 * sdelta * IMz * t112 * (-cpa1EQ * t217 + cpa1EQ * t221 + cpa2EQ * t209 - cpa2EQ * t215 - 2 * t140 * t22 - 2 * t212 * t211) * muM / 4
    t233 = cos(psih)
    t236 = 3/2 * t18
    t237 = cpa1EQ * t12
    t238 = 3 * t237
    t239 = 3/2 * t25
    t240 = cpa1EQ * phiTA
    t241 = t236 + t238 - t239 + t240
    t244 = 3 * Q2 * t5
    t245 = P2 * Q2
    t247 = 6 * t245 * t197
    t249 = 3 * Q2 * t8
    t251 = (t140 - t29) * phiTA
    t252 = 2 * t251
    t255 = t16 + 1
    t259 = 3 * t240
    t262 = 6 * t251
    t274 = cpa1EQ * t66
    t276 = cpa1EQ * t70
    t280 = Q2 * t60
    t283 = t245 * t65 * cpa2EQ
    t286 = Q2 * t69 * t197
    t288 = Q2 * t63
    t294 = t75 / 2 - t84 / 2 + t274 + t276 + t240
    t295 = t294 * t255
    contr[8] = -t125 * t116 * t112 * (t44 * (t34 * t241 + Q1 * (-t244 + t247 + t249 - t252) - t241 * t255) + t43 * (t34 * (t238 + t236 - t239 + t259) + Q1 * (-t244 + t247 + t249 - t262) - 3 * t255 * (t237 + t18 / 2 - t25 / 2 + t240)) + eta * (t34 * (3/2 * t75 - 3/2 * t84 + 3 * t274 + 3 * t276 + t259) + Q1 * (-3 * t280 + 6 * t283 + 6 * t286 + 3 * t288 - t262) - 3 * t295) + t34 * t294 + Q1 * (-t280 + 2 * t283 + 2 * t286 + t288 - t252) - t295) * t233 * t3 * t2 / 2
    t319 = cos(t154)
    contr[9] = t157 * t112 * t319 * (P1 * (t139 + t144 - t145 + 2 * cpa1EQ) + 2 * (t129 + t131 - t133 + t135 - cpa2EQ) * P2) * t176 * t127 / 4
    t339 = cos(t172)
    contr[10] = -t157 * t112 * t339 * t189 * t1 * (P1 * (t139 + Q1 * (4 * t140 - t29) - t145 + cpa1EQ / 2) + 4 * (t129 - t130 / 4 + t132 / 4 + t134 / 2 + cpa2EQ / 8) * P2) / 2
    t346 = cos(t180)
    contr[11] = -3/4 * t157 * t346 * t112 * cpa2EQ * t127 * t176
    t355 = cos(t191)
    contr[12] = 3/4 * t157 * t355 * t112 * (t130 - 2 * t129 - t132) * t127 * t176
    t364 = cos(t203)
    contr[13] = -t157 * t364 * IMz * t1 * t112 * (P2 * cpa2EQ + t21) * t3 / 4
    t381 = cos(t228)
    contr[14] = t157 * t381 * t1 * t112 * (cpa1EQ * t209 - cpa1EQ * t215 + cpa2EQ * t217 - cpa2EQ * t221 + 2 * t140 * t211 - 2 * t212 * t22) * sdelta * t176 / 4

    contr = sum(contr);
    return contr;

end

function derivativechiM3_csigma1_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    contr = zeros(21)
    t1 = Q1 ^ 2
    t2 = cpa3EQ * t1
    t4 = Q2 ^ 2
    t5 = cpa3EQ * t4
    t7 = Q1 * cpa1EQ
    t8 = Q2 * cpa2EQ
    t10 = 2 * cpa3EQ
    t14 = Q2 * cpa1EQ
    t15 = -Q1 * cpa2EQ + t14
    t20 = cos(TL)
    t24 = 1 / (t1 + t4 + 1)
    t27 = eta ^ 2
    t28 = t27 * eta
    t30 = 0.1e1 / t28 / n
    t31 = sma ^ 2
    t33 = 0.1e1 / t31 / sma
    t34 = t33 * t30
    t35 = t34 * t24 * cdelta
    contr[1] = -t35 * t20 * muM * IMz * (P1 * (2 * t2 + 2 * t5 + t7 + 5 * t8 - t10) + 3 * t15 * P2) / 2
    t38 = IMz * sdelta
    t39 = P1 ^ 2
    t40 = cpa1EQ * t39
    t41 = 3/4 * t40
    t42 = P2 ^ 2
    t43 = cpa1EQ * t42
    t44 = 3/4 * t43
    t45 = cpa2EQ * phiTA
    t46 = t45 / 2
    t47 = P2 * P1
    t48 = cpa2EQ * t47
    t49 = 3/2 * t48
    t52 = t39 * cpa2EQ
    t54 = 3/2 * Q1 * t52
    t55 = P1 * cpa1EQ
    t56 = P2 * Q1
    t58 = 3 * t56 * t55
    t59 = t42 * cpa2EQ
    t61 = 3/2 * Q1 * t59
    t63 = (t7 + t10) * phiTA
    t66 = t1 + 1
    t67 = 3/2 * t40
    t68 = 3/2 * t43
    t69 = 3 * t48
    t70 = t67 - t68 + t45 - t69
    t75 = 3/2 * t45
    t78 = 3 * t63
    t88 = t39 ^ 2
    t89 = cpa1EQ * t88
    t91 = t42 ^ 2
    t92 = cpa1EQ * t91
    t94 = t39 * P1
    t95 = P2 * t94
    t96 = cpa2EQ * t95
    t98 = t42 * P2
    t99 = t98 * P1
    t100 = cpa2EQ * t99
    t104 = t88 * cpa2EQ
    t105 = Q1 * t104
    t108 = t56 * t94 * cpa1EQ
    t111 = Q1 * t98 * t55
    t113 = t91 * cpa2EQ
    t114 = Q1 * t113
    t121 = (t89 / 2 - t92 / 2 + t45 - t96 - t100) * t66
    t138 = cos(psih)
    t142 = 1 + eta
    t143 = t142 ^ 2
    t147 = 1 / t143 / t142 * t30 * t33 * t24
    contr[2] = -t147 * t138 * (t28 * (t4 * (-t41 + t44 - t46 + t49) + Q2 * (t54 + t58 - t61 + t63) + t70 * t66 / 2) + t27 * (t4 * (-t41 + t44 - t75 + t49) + Q2 * (t54 + t58 - t61 + t78) + 3/2 * (t40 / 2 - t43 / 2 + t45 - t48) * t66) + eta * (t4 * (-3/4 * t89 + 3/4 * t92 - t75 + 3/2 * t96 + 3/2 * t100) + Q2 * (3/2 * t105 + 3 * t108 + 3 * t111 - 3/2 * t114 + t78) + 3/2 * t121) + t4 * (t96 / 2 + t100 / 2 - t89 / 4 + t92 / 4 - t46) + Q2 * (t105 / 2 + t108 + t111 - t114 / 2 + t63) + t121 / 2) * muM * t38
    t149 = 2 * TL
    t150 = cos(t149)
    t152 = muM * cdelta
    contr[3] = -3/2 * t34 * t24 * t15 * t152 * IMz * t150
    t158 = 3 * TL
    t159 = cos(t158)
    t160 = P1 * Q1
    t162 = Q2 * P1
    t165 = P2 * Q2
    t169 = muM * t24
    t172 = t34 * IMz * cdelta
    contr[4] = t172 * t169 * (cpa1EQ * t160 - cpa1EQ * t165 + cpa2EQ * t162 + cpa2EQ * t56) * t159 / 2
    t174 = Q2 * Q1
    t175 = cpa1EQ * t174
    t176 = t1 * cpa2EQ
    t177 = t176 / 2
    t178 = t4 * cpa2EQ
    t179 = t178 / 2
    t180 = Q2 * cpa3EQ
    t181 = 2 * t180
    t185 = cpa1EQ * t1
    t189 = Q1 * (-2 * t8 + 4 * cpa3EQ)
    t190 = cpa1EQ * t4
    t197 = muM * IMz
    t199 = TL - psih
    t200 = cos(t199)
    contr[5] = t34 * t24 * t200 * t197 * (P1 * (t175 + t177 - t179 + t181 + 2 * cpa2EQ) - P2 * (t185 + t189 - t190 - 4 * cpa1EQ) / 2) * sdelta / 2
    t215 = TL + psih
    t216 = cos(t215)
    contr[6] = -t34 * t24 * t216 * t197 * (P1 * (t175 - t176 + t178 - t180 - cpa2EQ / 4) - (t185 + Q1 * (t8 + cpa3EQ) - t190 - cpa1EQ / 4) * P2) * sdelta
    t220 = t149 - psih
    t221 = cos(t220)
    t224 = sdelta * t24
    contr[7] = 3/4 * t34 * t224 * cpa1EQ * t221 * t197
    t232 = t149 + psih
    t233 = cos(t232)
    contr[8] = 3/4 * t34 * sdelta * t233 * t197 * t24 * (2 * cpa2EQ * t174 + t185 - t190)
    t237 = t158 - psih
    t238 = cos(t237)
    t239 = P1 * cpa2EQ
    t244 = t34 * t38
    contr[9] = -t244 * t169 * (-P2 * cpa1EQ + t239) * t238 / 4
    t247 = t158 + psih
    t248 = cos(t247)
    t250 = t1 * P1
    t254 = t4 * P1
    t256 = t1 * P2
    t260 = t4 * P2
    contr[10] = -t244 * t24 * (-cpa1EQ * t256 + cpa1EQ * t260 + cpa2EQ * t250 - cpa2EQ * t254 - 2 * t14 * t160 - 2 * t8 * t56) * muM * t248 / 4
    t267 = sin(TL)
    t273 = cpa2EQ * t160
    t275 = cpa1EQ * t162
    t277 = cpa1EQ * t56
    t279 = cpa2EQ * t165
    contr[11] = -t35 * (2 * P2 * cpa3EQ - 2 * cpa3EQ * t256 - 2 * cpa3EQ * t260 + 3 * t273 - 3 * t275 + 5 * t277 + t279) * IMz * muM * t267 / 2
    t287 = 3/2 * t52
    t288 = cpa1EQ * t47
    t289 = 3 * t288
    t290 = 3/2 * t59
    t291 = cpa1EQ * phiTA
    t292 = t287 + t289 - t290 + t291
    t295 = 3 * Q2 * t40
    t297 = 6 * t165 * t239
    t299 = 3 * Q2 * t43
    t301 = (t8 - t10) * phiTA
    t302 = 2 * t301
    t305 = t4 + 1
    t309 = 3 * t291
    t310 = t289 + t287 - t290 + t309
    t312 = 6 * t301
    t315 = t52 / 2
    t316 = t59 / 2
    t324 = cpa1EQ * t95
    t326 = cpa1EQ * t99
    t328 = 3/2 * t104 - 3/2 * t113 + 3 * t324 + 3 * t326 + t309
    t330 = Q2 * t89
    t333 = t165 * t94 * cpa2EQ
    t336 = Q2 * t98 * t239
    t338 = Q2 * t92
    t344 = t104 / 2 - t113 / 2 + t324 + t326 + t291
    t345 = t344 * t305
    t356 = sin(psih)
    contr[12] = -t147 * t356 * (t28 * (t1 * t292 + Q1 * (-t295 + t297 + t299 - t302) - t292 * t305) + t27 * (t1 * t310 + Q1 * (-t295 + t297 + t299 - t312) - 3 * t305 * (t288 + t315 - t316 + t291)) + eta * (t1 * t328 + Q1 * (-3 * t330 + 6 * t333 + 6 * t336 + 3 * t338 - t312) - 3 * t345) + t1 * t344 + Q1 * (-t330 + 2 * t333 + 2 * t336 + t338 - t302) - t345) * muM * t38 / 2
    t361 = sin(t149)
    contr[13] = -3/2 * t34 * t24 * (t7 + t8) * t152 * IMz * t361
    t369 = sin(t158)
    contr[14] = t172 * t169 * (t273 - t275 - t277 - t279) * t369 / 2
    t383 = sin(t199)
    contr[15] = -t34 * t24 * t383 * t197 * sdelta * (P1 * (t185 + t189 - t190 + 2 * cpa1EQ) + 2 * (t175 + t177 - t179 + t181 - cpa2EQ) * P2) / 4
    t404 = sin(t215)
    contr[16] = -t34 * t24 * t404 * t197 * sdelta * (P1 * (t185 + Q1 * (4 * t8 - t10) - t190 + cpa1EQ / 2) + 4 * (t175 - t176 / 4 + t178 / 4 + t180 / 2 + cpa2EQ / 8) * P2) / 2
    t409 = sin(t220)
    t411 = sdelta * muM
    contr[17] = 3/4 * t34 * t24 * cpa2EQ * t411 * IMz * t409
    t416 = sin(t232)
    contr[18] = 3/4 * t34 * t24 * (t176 - 2 * t175 - t178) * t411 * IMz * t416
    t428 = sin(t237)
    contr[19] = t34 * t428 * IMz * t224 * (P2 * cpa2EQ + t55) * muM / 4
    t432 = sin(t247)
    contr[20] = t34 * t24 * (cpa1EQ * t250 - cpa1EQ * t254 + cpa2EQ * t256 - cpa2EQ * t260 - 2 * t14 * t56 + 2 * t8 * t160) * t38 * muM * t432 / 4
    t447 = phiTA * t2
    t449 = phiTA * t5
    t452 = cpa3EQ * phiTA
    t455 = 3 * t447
    t457 = 3 * t449
    t458 = 3 * t45
    t461 = 3 * t452
    t465 = t39 + t42
    t468 = (t40 - 2 * t48 - t43) * t465
    contr[21] = -t147 * t197 * cdelta * (t28 * (Q1 * t292 - Q2 * t70 - t447 - t449 + t452) + t27 * (-t455 + Q1 * t310 - t457 + Q2 * (-t67 + t68 - t458 + t69) + t461) + eta * (-t455 + Q1 * t328 - t457 + Q2 * (-t458 - 3/2 * t468) + t461) - t447 + Q1 * (t291 + (t315 - t316 + t288) * t465) - t449 + Q2 * (-t45 - t468 / 2) + t452)
    
    contr = sum(contr);
    return contr;
end

function derivativechiM3_csigma2_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    return 0.0;
end

function derivativechiM3_cdelta1_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    contr = zeros(7)
    t1 = sqrt(skm)
    t2 = t1 * IMz
    t3 = cos(TL)
    t6 = Q1 ^ 2
    t7 = cpa3EQ * t6
    t9 = Q2 ^ 2
    t10 = cpa3EQ * t9
    t12 = Q1 * cpa1EQ
    t13 = Q2 * cpa2EQ
    t20 = -Q1 * cpa2EQ + Q2 * cpa1EQ
    t25 = 1 / (t6 + t9 + 1)
    t28 = eta ^ 2
    t29 = t28 * eta
    t31 = 0.1e1 / t29 / n
    t32 = sma ^ 2
    t34 = 0.1e1 / t32 / sma
    t35 = t34 * t31
    contr[1] = -t35 * t25 * (P1 * (2 * t7 + 2 * t10 + t12 + 5 * t13 - 2 * cpa3EQ) + 3 * t20 * P2) * t3 * muM * t2 / 2
    t39 = 2 * TL
    t40 = cos(t39)
    t42 = t1 * muM
    contr[2] = -3/2 * t35 * t25 * t20 * t42 * IMz * t40
    t48 = 3 * TL
    t49 = cos(t48)
    t50 = P1 * Q1
    t52 = Q2 * P1
    t54 = P2 * Q1
    t56 = P2 * Q2
    t60 = muM * t25
    t62 = t35 * t2
    contr[3] = t62 * t60 * (cpa1EQ * t50 - cpa1EQ * t56 + cpa2EQ * t52 + cpa2EQ * t54) * t49 / 2
    t64 = sin(TL)
    t72 = cpa2EQ * t50
    t74 = cpa1EQ * t52
    t76 = cpa1EQ * t54
    t78 = cpa2EQ * t56
    contr[4] = -t35 * t1 * t25 * (-2 * cpa3EQ * t6 * P2 - 2 * cpa3EQ * t9 * P2 + 2 * P2 * cpa3EQ + 3 * t72 - 3 * t74 + 5 * t76 + t78) * IMz * muM * t64 / 2
    t88 = sin(t39)
    contr[5] = -3/2 * t35 * t25 * (t12 + t13) * t42 * IMz * t88
    t96 = sin(t48)
    contr[6] = t62 * t60 * (t72 - t74 - t76 - t78) * t96 / 2
    t101 = phiTA * t7
    t102 = P1 ^ 2
    t103 = cpa2EQ * t102
    t104 = 3/2 * t103
    t105 = P2 * P1
    t106 = cpa1EQ * t105
    t107 = 3 * t106
    t108 = P2 ^ 2
    t109 = cpa2EQ * t108
    t110 = 3/2 * t109
    t111 = cpa1EQ * phiTA
    t114 = phiTA * t10
    t115 = cpa1EQ * t102
    t116 = 3/2 * t115
    t117 = cpa1EQ * t108
    t118 = 3/2 * t117
    t119 = cpa2EQ * phiTA
    t120 = cpa2EQ * t105
    t121 = 3 * t120
    t124 = cpa3EQ * phiTA
    t127 = 3 * t101
    t128 = 3 * t111
    t131 = 3 * t114
    t132 = 3 * t119
    t135 = 3 * t124
    t138 = t102 ^ 2
    t141 = t108 ^ 2
    t154 = t102 + t108
    t157 = (t115 - 2 * t120 - t117) * t154
    t177 = 1 + eta
    t178 = t177 ^ 2
    contr[7] = -1 / t178 / t177 * t31 * t34 * t25 * muM * IMz * (t29 * (-t101 + Q1 * (t104 + t107 - t110 + t111) - t114 + Q2 * (-t116 + t118 - t119 + t121) + t124) + t28 * (-t127 + Q1 * (t107 + t104 - t110 + t128) - t131 + Q2 * (-t116 + t118 - t132 + t121) + t135) + eta * (-t127 + Q1 * (3/2 * cpa2EQ * t138 - 3/2 * cpa2EQ * t141 + 3 * cpa1EQ * P2 * t102 * P1 + 3 * cpa1EQ * t108 * P2 * P1 + t128) - t131 + Q2 * (-t132 - 3/2 * t157) + t135) - t101 + Q1 * (t111 + (t103 / 2 - t109 / 2 + t106) * t154) - t114 + Q2 * (-t119 - t157 / 2) + t124) * t1

    contr = sum(contr);
    return contr;
end

function derivativechiM3_cdelta2_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    contr = zeros(14)
    t1 = P1 ^ 2
    t2 = cpa1EQ * t1
    t3 = 3/4 * t2
    t4 = P2 ^ 2
    t5 = cpa1EQ * t4
    t6 = 3/4 * t5
    t7 = cpa2EQ * phiTA
    t8 = t7 / 2
    t9 = P2 * P1
    t10 = cpa2EQ * t9
    t11 = 3/2 * t10
    t13 = Q2 ^ 2
    t15 = t1 * cpa2EQ
    t17 = 3/2 * Q1 * t15
    t18 = P1 * cpa1EQ
    t19 = P2 * Q1
    t21 = 3 * t19 * t18
    t22 = t4 * cpa2EQ
    t24 = 3/2 * Q1 * t22
    t26 = 2 * cpa3EQ
    t28 = (Q1 * cpa1EQ + t26) * phiTA
    t31 = Q1 ^ 2
    t32 = t31 + 1
    t40 = eta ^ 2
    t41 = t40 * eta
    t43 = 3/2 * t7
    t46 = 3 * t28
    t56 = t1 ^ 2
    t57 = cpa1EQ * t56
    t59 = t4 ^ 2
    t60 = cpa1EQ * t59
    t62 = t1 * P1
    t63 = P2 * t62
    t64 = cpa2EQ * t63
    t66 = t4 * P2
    t67 = t66 * P1
    t68 = cpa2EQ * t67
    t72 = cpa2EQ * t56
    t73 = Q1 * t72
    t76 = t19 * t62 * cpa1EQ
    t79 = Q1 * t66 * t18
    t81 = t59 * cpa2EQ
    t82 = Q1 * t81
    t89 = (t57 / 2 - t60 / 2 + t7 - t64 - t68) * t32
    t106 = sqrt(skm)
    t107 = t106 * muM
    t108 = cdelta * t107
    t110 = cos(psih)
    t112 = 0.1e1 / (t31 + t13 + 1)
    t114 = sma ^ 2
    t116 = 0.1e1 / t114 / sma
    t120 = 0.1e1 / n / t41
    t121 = 1 + eta
    t122 = t121 ^ 2
    t125 = 1 / t122 / t121 * t120
    contr[1] = t125 * t116 * t112 * t110 * t108 * IMz * (t41 * (t13 * (-t3 + t6 - t8 + t11) + Q2 * (t17 + t21 - t24 + t28) + (3/2 * t2 - 3/2 * t5 + t7 - 3 * t10) * t32 / 2) + t40 * (t13 * (-t3 + t6 - t43 + t11) + Q2 * (t17 + t21 - t24 + t46) + 3/2 * (t2 / 2 - t5 / 2 + t7 - t10) * t32) + eta * (t13 * (-3/4 * t57 + 3/4 * t60 - t43 + 3/2 * t64 + 3/2 * t68) + Q2 * (3/2 * t73 + 3 * t76 + 3 * t79 - 3/2 * t82 + t46) + 3/2 * t89) + t13 * (t64 / 2 + t68 / 2 - t57 / 4 + t60 / 4 - t8) + Q2 * (t73 / 2 + t76 + t79 - t82 / 2 + t28) + t89 / 2)
    t127 = Q2 * Q1
    t128 = cpa1EQ * t127
    t129 = cpa2EQ * t31
    t130 = t129 / 2
    t131 = cpa2EQ * t13
    t132 = t131 / 2
    t133 = Q2 * cpa3EQ
    t134 = 2 * t133
    t138 = cpa1EQ * t31
    t139 = Q2 * cpa2EQ
    t143 = Q1 * (-2 * t139 + 4 * cpa3EQ)
    t144 = cpa1EQ * t13
    t151 = muM * cdelta
    t152 = IMz * t151
    t154 = TL - psih
    t155 = cos(t154)
    t157 = t116 * t120
    contr[2] = -t157 * t112 * t155 * t152 * t106 * (P1 * (t128 + t130 - t132 + t134 + 2 * cpa2EQ) - P2 * (t138 + t143 - t144 - 4 * cpa1EQ) / 2) / 2
    t172 = TL + psih
    t173 = cos(t172)
    contr[3] = t157 * t112 * t173 * t152 * t106 * (P1 * (t128 - t129 + t131 - t133 - cpa2EQ / 4) - (t138 + Q1 * (t139 + cpa3EQ) - t144 - cpa1EQ / 4) * P2)
    t177 = t106 * cdelta
    t180 = 2 * TL
    t181 = t180 - psih
    t182 = cos(t181)
    contr[4] = -3/4 * t157 * t182 * t112 * cpa1EQ * t177 * muM * IMz
    t192 = t180 + psih
    t193 = cos(t192)
    contr[5] = -3/4 * t157 * t193 * t106 * t152 * t112 * (2 * cpa2EQ * t127 + t138 - t144)
    t198 = 3 * TL
    t199 = t198 - psih
    t200 = cos(t199)
    t201 = P1 * cpa2EQ
    t208 = t157 * t177
    contr[6] = t208 * IMz * muM * t112 * (-P2 * cpa1EQ + t201) * t200 / 4
    t210 = t198 + psih
    t211 = cos(t210)
    t213 = t31 * P1
    t215 = P1 * Q1
    t216 = Q2 * cpa1EQ
    t219 = t13 * P1
    t221 = t31 * P2
    t225 = t13 * P2
    contr[7] = t208 * IMz * t112 * (-cpa1EQ * t221 + cpa1EQ * t225 + cpa2EQ * t213 - cpa2EQ * t219 - 2 * t139 * t19 - 2 * t216 * t215) * muM * t211 / 4
    t232 = 3/2 * t15
    t233 = cpa1EQ * t9
    t234 = 3 * t233
    t235 = 3/2 * t22
    t236 = cpa1EQ * phiTA
    t237 = t232 + t234 - t235 + t236
    t240 = 3 * Q2 * t2
    t241 = P2 * Q2
    t243 = 6 * t241 * t201
    t245 = 3 * Q2 * t5
    t247 = (t139 - t26) * phiTA
    t248 = 2 * t247
    t251 = t13 + 1
    t255 = 3 * t236
    t258 = 6 * t247
    t270 = cpa1EQ * t63
    t272 = cpa1EQ * t67
    t276 = Q2 * t57
    t279 = t241 * t62 * cpa2EQ
    t282 = Q2 * t66 * t201
    t284 = Q2 * t60
    t290 = t72 / 2 - t81 / 2 + t270 + t272 + t236
    t291 = t290 * t251
    t303 = sin(psih)
    contr[8] = t125 * t116 * t112 * t303 * t108 * IMz * (t41 * (t31 * t237 + Q1 * (-t240 + t243 + t245 - t248) - t237 * t251) + t40 * (t31 * (t234 + t232 - t235 + t255) + Q1 * (-t240 + t243 + t245 - t258) - 3 * t251 * (t233 + t15 / 2 - t22 / 2 + t236)) + eta * (t31 * (3/2 * t72 - 3/2 * t81 + 3 * t270 + 3 * t272 + t255) + Q1 * (-3 * t276 + 6 * t279 + 6 * t282 + 3 * t284 - t258) - 3 * t291) + t31 * t290 + Q1 * (-t276 + 2 * t279 + 2 * t282 + t284 - t248) - t291) / 2
    t318 = sin(t154)
    contr[9] = t157 * t112 * t318 * IMz * muM * (P1 * (t138 + t143 - t144 + 2 * cpa1EQ) + 2 * (t128 + t130 - t132 + t134 - cpa2EQ) * P2) * t177 / 4
    t338 = sin(t172)
    contr[10] = t157 * t112 * t338 * t152 * t106 * (P1 * (t138 + Q1 * (4 * t139 - t26) - t144 + cpa1EQ / 2) + 4 * (t128 - t129 / 4 + t131 / 4 + t133 / 2 + cpa2EQ / 8) * P2) / 2
    t342 = sin(t181)
    t347 = t157 * cdelta * t112
    contr[11] = -3/4 * t347 * cpa2EQ * t107 * IMz * t342
    t350 = sin(t192)
    contr[12] = -3/4 * t347 * (t129 - 2 * t128 - t131) * t107 * IMz * t350
    t363 = sin(t199)
    contr[13] = -t157 * t363 * IMz * t106 * t112 * (P2 * cpa2EQ + t18) * t151 / 4
    t368 = sin(t210)
    contr[14] = -t208 * t112 * (cpa1EQ * t213 - cpa1EQ * t219 + cpa2EQ * t221 - cpa2EQ * t225 + 2 * t139 * t215 - 2 * t216 * t19) * IMz * muM * t368 / 4
    
    contr = sum(contr);
    return contr;
end

function derivativechiM3_cdeltapsigMpsihOsdelta_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    contr = zeros(14)
    t1 = sqrt(skm)
    t2 = t1 * IMz
    t3 = P1 ^ 2
    t4 = cpa1EQ * t3
    t5 = 3/4 * t4
    t6 = P2 ^ 2
    t7 = cpa1EQ * t6
    t8 = 3/4 * t7
    t9 = cpa2EQ * phiTA
    t10 = t9 / 2
    t11 = P2 * P1
    t12 = cpa2EQ * t11
    t13 = 3/2 * t12
    t15 = Q2 ^ 2
    t17 = t3 * cpa2EQ
    t19 = 3/2 * Q1 * t17
    t20 = P1 * cpa1EQ
    t21 = P2 * Q1
    t23 = 3 * t21 * t20
    t24 = t6 * cpa2EQ
    t26 = 3/2 * Q1 * t24
    t28 = 2 * cpa3EQ
    t30 = (Q1 * cpa1EQ + t28) * phiTA
    t33 = Q1 ^ 2
    t34 = t33 + 1
    t42 = eta ^ 2
    t43 = t42 * eta
    t45 = 3/2 * t9
    t48 = 3 * t30
    t58 = t3 ^ 2
    t59 = cpa1EQ * t58
    t61 = t6 ^ 2
    t62 = cpa1EQ * t61
    t64 = t3 * P1
    t65 = P2 * t64
    t66 = cpa2EQ * t65
    t68 = t6 * P2
    t69 = t68 * P1
    t70 = cpa2EQ * t69
    t74 = t58 * cpa2EQ
    t75 = Q1 * t74
    t78 = t21 * t64 * cpa1EQ
    t81 = Q1 * t68 * t20
    t83 = t61 * cpa2EQ
    t84 = Q1 * t83
    t91 = (t59 / 2 - t62 / 2 + t9 - t66 - t70) * t34
    t108 = sin(psih)
    t112 = 0.1e1 / (t33 + t15 + 1)
    t113 = sma ^ 2
    t115 = 0.1e1 / t113 / sma
    t117 = 0.1e1 / t43
    t118 = 0.1e1 / n
    t120 = 1 + eta
    t121 = t120 ^ 2
    t125 = 1 / t121 / t120 * t118 * t117 * t115 * t112
    contr[1] = -t125 * t108 * (t43 * (t15 * (-t5 + t8 - t10 + t13) + Q2 * (t19 + t23 - t26 + t30) + (3/2 * t4 - 3/2 * t7 + t9 - 3 * t12) * t34 / 2) + t42 * (t15 * (-t5 + t8 - t45 + t13) + Q2 * (t19 + t23 - t26 + t48) + 3/2 * (t4 / 2 - t7 / 2 + t9 - t12) * t34) + eta * (t15 * (-3/4 * t59 + 3/4 * t62 - t45 + 3/2 * t66 + 3/2 * t70) + Q2 * (3/2 * t75 + 3 * t78 + 3 * t81 - 3/2 * t84 + t48) + 3/2 * t91) + t15 * (t66 / 2 + t70 / 2 - t59 / 4 + t62 / 4 - t10) + Q2 * (t75 / 2 + t78 + t81 - t84 / 2 + t30) + t91 / 2) * muM * t2
    t127 = Q2 * Q1
    t128 = cpa1EQ * t127
    t129 = cpa2EQ * t33
    t130 = t129 / 2
    t131 = cpa2EQ * t15
    t132 = t131 / 2
    t133 = Q2 * cpa3EQ
    t134 = 2 * t133
    t138 = cpa1EQ * t33
    t139 = Q2 * cpa2EQ
    t143 = Q1 * (-2 * t139 + 4 * cpa3EQ)
    t144 = cpa1EQ * t15
    t151 = muM * IMz
    t153 = TL - psih
    t154 = sin(t153)
    t157 = t118 * t117 * t115
    contr[2] = -t157 * t112 * t154 * t151 * (P1 * (t128 + t130 - t132 + t134 + 2 * cpa2EQ) - P2 * (t138 + t143 - t144 - 4 * cpa1EQ) / 2) * t1 / 2
    t172 = TL + psih
    t173 = sin(t172)
    contr[3] = -t157 * t112 * t173 * t151 * (P1 * (t128 - t129 + t131 - t133 - cpa2EQ / 4) - (t138 + Q1 * (t139 + cpa3EQ) - t144 - cpa1EQ / 4) * P2) * t1
    t177 = 2 * TL
    t178 = t177 - psih
    t179 = sin(t178)
    t182 = t1 * t112
    contr[4] = -3/4 * t157 * t182 * cpa1EQ * t179 * t151
    t191 = t177 + psih
    t192 = sin(t191)
    contr[5] = 3/4 * t157 * t1 * t192 * t151 * t112 * (2 * cpa2EQ * t127 + t138 - t144)
    t196 = P1 * cpa2EQ
    t201 = 3 * TL
    t202 = t201 - psih
    t203 = sin(t202)
    contr[6] = t157 * t203 * t1 * t151 * t112 * (-P2 * cpa1EQ + t196) / 4
    t207 = t33 * P1
    t209 = P1 * Q1
    t210 = Q2 * cpa1EQ
    t213 = t15 * P1
    t215 = t33 * P2
    t219 = t15 * P2
    t225 = t201 + psih
    t226 = sin(t225)
    contr[7] = -t157 * t226 * t1 * IMz * t112 * (-cpa1EQ * t215 + cpa1EQ * t219 + cpa2EQ * t207 - cpa2EQ * t213 - 2 * t139 * t21 - 2 * t210 * t209) * muM / 4
    t231 = 3/2 * t17
    t232 = cpa1EQ * t11
    t233 = 3 * t232
    t234 = 3/2 * t24
    t235 = cpa1EQ * phiTA
    t236 = t231 + t233 - t234 + t235
    t239 = 3 * Q2 * t4
    t240 = P2 * Q2
    t242 = 6 * t240 * t196
    t244 = 3 * Q2 * t7
    t246 = (t139 - t28) * phiTA
    t247 = 2 * t246
    t250 = t15 + 1
    t254 = 3 * t235
    t257 = 6 * t246
    t269 = cpa1EQ * t65
    t271 = cpa1EQ * t69
    t275 = Q2 * t59
    t278 = t240 * t64 * cpa2EQ
    t281 = Q2 * t68 * t196
    t283 = Q2 * t62
    t289 = t74 / 2 - t83 / 2 + t269 + t271 + t235
    t290 = t289 * t250
    t301 = cos(psih)
    contr[8] = t125 * t301 * (t43 * (t33 * t236 + Q1 * (-t239 + t242 + t244 - t247) - t236 * t250) + t42 * (t33 * (t233 + t231 - t234 + t254) + Q1 * (-t239 + t242 + t244 - t257) - 3 * t250 * (t232 + t17 / 2 - t24 / 2 + t235)) + eta * (t33 * (3/2 * t74 - 3/2 * t83 + 3 * t269 + 3 * t271 + t254) + Q1 * (-3 * t275 + 6 * t278 + 6 * t281 + 3 * t283 - t257) - 3 * t290) + t33 * t289 + Q1 * (-t275 + 2 * t278 + 2 * t281 + t283 - t247) - t290) * muM * t2 / 2
    t314 = cos(t153)
    contr[9] = -t157 * t112 * t314 * t151 * t1 * (P1 * (t138 + t143 - t144 + 2 * cpa1EQ) + 2 * (t128 + t130 - t132 + t134 - cpa2EQ) * P2) / 4
    t335 = cos(t172)
    contr[10] = t157 * t112 * t335 * t151 * t1 * (P1 * (t138 + Q1 * (4 * t139 - t28) - t144 + cpa1EQ / 2) + 4 * (t128 - t129 / 4 + t131 / 4 + t133 / 2 + cpa2EQ / 8) * P2) / 2
    t341 = cos(t178)
    contr[11] = 3/4 * t157 * t341 * t112 * cpa2EQ * t1 * t151
    t349 = cos(t191)
    contr[12] = -3/4 * t157 * t349 * t112 * (t129 - 2 * t128 - t131) * t1 * t151
    t358 = cos(t202)
    contr[13] = t157 * t358 * IMz * t182 * (P2 * cpa2EQ + t20) * muM / 4
    t373 = cos(t225)
    contr[14] = -t157 * t373 * t1 * t112 * (cpa1EQ * t207 - cpa1EQ * t213 + cpa2EQ * t215 - cpa2EQ * t219 + 2 * t139 * t209 - 2 * t210 * t21) * t151 / 4
    

    contr = sum(contr);
    return contr;
end

############################################
# case smk = 0.0
function CMterms_M2_smk0_magnetic(cdelta,sdelta,cpsih,spsih,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,A,B,C)

    CMXb11 = zeros(8)
    CMXb12 = zeros(8)
    CMXb13 = zeros(8)
    CMYb21 = zeros(8)
    CMYb22 = zeros(8)
    CMYb23 = zeros(8)
    CMZb31 = zeros(8)
    CMZb32 = zeros(8)
    CMZb33 = zeros(8)
    GG = 1+Q1^2+Q2^2
    t1 = cpa1 * spsih
    t2 = cpa2 * cpsih
    t3 = t1 + t2
    t4 = 3 * t3
    t5 = Q2 ^ 2
    t6 = t5 ^ 2
    t8 = cpa1 * cpsih
    t9 = cpa2 * spsih
    t10 = -t8 + t9
    t11 = 12 * t10
    t13 = cpsih * cpa3
    t14 = 6 * t13
    t16 = t5 * Q2
    t18 = -t3
    t19 = 18 * t18
    t20 = Q1 ^ 2
    t22 = cpa3 * spsih
    t23 = Q1 * t22
    t24 = 18 * t23
    t25 = 6 * t2
    t26 = 6 * t1
    t29 = -t11
    t30 = t20 * Q1
    t32 = t20 * t13
    t33 = 18 * t32
    t36 = t20 ^ 2
    t39 = 6 * t30 * t22
    t40 = -t1 + t2
    t41 = 6 * t40
    t43 = 6 * t23
    t44 = 3 * t2
    t45 = 3 * t1
    t48 = cpa2 * t16
    t50 = Q1 * cpa1
    t54 = cpa2 * t20
    t59 = cpa1 * t20
    t61 = Q1 * cpa3
    t65 = t48 / 2 + t5 * (-3/2 * t50 - cpa3) + Q2 * (-3/2 * t54 - cpa2 / 2) + (t59 / 2 + t61 - cpa1 / 2) * Q1
    t69 = cos(TL)
    t70 = t69 ^ 2
    t72 = -t10
    t73 = t72 / 2
    t75 = 2 * t3
    t79 = 3 * t10
    t81 = Q1 * t13
    t87 = t20 * t22
    t98 = t20 + 1
    t100 = t6 * t73 + t16 * (Q1 * t75 + t22) + t5 * (t20 * t79 - 3 * t81) + Q2 * (-2 * Q1 * t40 - t30 * t75 + t22 - 3 * t87) + t98 * (t20 * t73 + t81 - t8 / 2 + t9 / 2)
    t114 = -cpa1 * t16 / 4 - 3/4 * cpa2 * t5 * Q1 + Q2 * (3/4 * t59 + t61 - cpa1 / 4) + t98 * cpa2 * Q1 / 4
    t118 = sin(TL)
    t124 = 3 * cpa2 * t6 * cpsih
    t125 = 6 * t72
    t130 = 12 * t1 + t25
    t132 = 12 * t23
    t139 = 6 * Q2 * t98 * (Q1 * t72 + t13)
    t142 = 3 * cpa2 * t36 * cpsih
    t145 = 6 * cpa2 * t20 * cpsih
    t146 = GG ^ 2
    t147 = t146 - 3
    t148 = t147 * cpa2
    t149 = cpsih * t148
    t151 = cpa1 * spsih * t146
    t161 = t146 * cpa3
    t162 = 6 * t48 + t5 * (-12 * t50 - 12 * cpa3) + Q2 * (-6 * t54 - 6 * cpa2) + t161
    t166 = rc ^ 2
    t168 = 0.1e1 / t166 / rc
    t170 = 1 / t146
    CMXb11[2] = t170 * t168 * IMz * (t70 * (cdelta * (t6 * t4 + t16 * (Q1 * t11 - t14) + t5 * (t20 * t19 - t24 - t25 + t26) + Q2 * (t30 * t29 + t14 + t33) + t36 * t4 + t39 + t20 * t41 - t43 + t44 + t45) - 12 * t65 * sdelta) + 6 * t69 * t118 * (cdelta * t100 + 4 * t114 * sdelta) + cdelta * (-t124 + t16 * (Q1 * t125 + t14) + t5 * (t20 * t130 + t132 + t25) - t139 - t142 - t145 + t149 - t151) + t162 * sdelta) * muM / 2
    t173 = -t4
    t186 = -t41
    t216 = (t70 * (sdelta * (t6 * t173 + t16 * (Q1 * t29 + t14) + t5 * (-t20 * t19 + t24 + t25 - t26) + Q2 * (t30 * t11 - t14 - t33) + t36 * t173 - t39 + t20 * t186 + t43 - t44 - t45) - 12 * t65 * cdelta) - 6 * t69 * t118 * (-4 * t114 * cdelta + sdelta * t100) + sdelta * (t124 + t16 * (-Q1 * t125 - t14) + t5 * (-t20 * t130 - t132 - t25) + t139 + t142 + t145 - cpsih * t147 * cpa2 + t151) + t162 * cdelta) * muM
    t219 = t170 * t168 * IMy * t216
    CMXb11[5] = -t219
    t222 = 12 * t18
    t224 = 6 * t22
    t231 = 6 * t9
    t243 = t8 + t9
    t253 = 2/3 * t10
    t255 = t13 / 3
    t302 = spsih * t148
    t304 = cpsih * cpa1 * t146
    t309 = t170 * t168 * (t70 * (t6 * t79 + t16 * (Q1 * t222 - t224) + t5 * (18 * t20 * t72 - t231 - 6 * t8 + 18 * t81) + Q2 * (-t30 * t222 + t224 + 18 * t87) + t36 * t79 - 6 * cpsih * cpa3 * t30 + 6 * t20 * t243 + 6 * t81 - 3 * t8 + 3 * t9) + 18 * t69 * (t6 * t3 / 6 + t16 * (Q1 * t253 - t255) + t5 * (t20 * t18 - t23) + Q2 * (-t30 * t253 + t32 - 2/3 * Q1 * t243 - t255) + t98 * (t20 * t3 / 2 + t23 - t2 / 2 - t1 / 2) / 3) * t118 - 3 * spsih * cpa2 * t6 + t16 * (6 * Q1 * t3 + t224) + t5 * (t20 * (-12 * t8 + t231) - 12 * t81 + t231) - 6 * Q2 * t98 * (Q1 * t3 + t22) - 3 * spsih * cpa2 * t36 - 6 * spsih * t54 + t302 + t304) * muM * IMz / 2
    CMXb11[6] = -t309
    CMXb12[1] = t219
    CMXb12[2] = t309
    CMXb12[6] = CMXb11[2]
    CMYb21[1] = t170 * t168 * IMx * t216
    CMYb21[2] = -CMXb12[6]
    CMYb21[6] = CMXb12[2]
    CMYb22[2] = CMXb11[6]
    CMYb22[5] = CMYb21[1]
    CMYb22[6] = CMYb21[2]
    t312 = t3 * cdelta
    t313 = IMy * t312
    t314 = t10 * IMx
    t315 = t313 + t314
    t316 = 3 * t315
    t318 = t10 * cdelta
    t319 = IMy * t318
    t320 = t3 * IMx
    t321 = t319 - t320
    t322 = 12 * t321
    t327 = -cdelta * cpa3 * cpsih - cpa2 * sdelta
    t328 = 6 * t327
    t330 = IMx * t22
    t331 = 6 * t330
    t334 = -t315
    t339 = -cdelta * t22 + sdelta * cpa1
    t340 = 18 * t339
    t342 = IMx * t13
    t347 = cpa3 * sdelta
    t348 = 12 * t347
    t349 = cdelta * t186 + t348
    t351 = t243 * IMx
    t352 = 6 * t351
    t357 = -t327
    t358 = 18 * t357
    t363 = -t328
    t364 = IMy * t363
    t368 = -t339
    t369 = 6 * t368
    t371 = 6 * t342
    t375 = cdelta * t41 - t348
    t379 = -t369
    t390 = t339 / 2
    t391 = IMy * t390
    t392 = t342 / 2
    t395 = -t321
    t398 = IMy * t357 + Q1 * t395 + t330
    t403 = 3/2 * t368
    t410 = cdelta * t40 - 2 * t347
    t417 = 2 * t357
    t433 = (IMy * cdelta * cpsih + IMx * spsih) * cpa2
    t442 = (2 * t1 + t2) * cdelta
    t445 = -2 * t8 + t9
    t450 = 12 * t368
    t458 = 6 * cdelta * cpa2 * cpsih - t348
    t475 = cdelta * (t149 - t151) + sdelta * t161
    t477 = t304 + t302
    t481 = t170 * t168
    CMZb33[1] = -t481 * (t70 * (t6 * t316 + t16 * (IMy * t328 + Q1 * t322 - t331) + t5 * (18 * t20 * t334 + Q1 * (IMy * t340 + 18 * t342) + IMy * t349 - t352) + Q2 * (-t30 * t322 + t20 * (IMy * t358 + 18 * t330) + t364 + t331) + t36 * t316 + t30 * (IMy * t369 - t371) + t20 * (IMy * t375 + t352) + Q1 * (IMy * t379 + t371) + 3 * t313 + 3 * t314) - 12 * t69 * t118 * (t6 * t321 / 4 + t16 * (Q1 * t334 + t391 + t392) + 3/2 * t5 * t398 * Q1 + Q2 * (t30 * t315 + t20 * (IMy * t403 - 3/2 * t342) + Q1 * (IMy * t410 + t351) + t391 + t392) - t98 * (t20 * t395 + Q1 * (IMy * t417 + 2 * t330) + t319 - t320) / 4) - 3 * t6 * t433 + t16 * (6 * Q1 * t395 + t331 + t364) + t5 * (t20 * (6 * t445 * IMx + 6 * IMy * t442) + Q1 * (IMy * t450 - 12 * t342) + IMy * t458 + 6 * IMx * cpa2 * spsih) - 6 * Q2 * t98 * t398 - 3 * t36 * t433 - 6 * t20 * t433 + IMy * t475 + IMx * t477) * muM
    t483 = IMx * t312
    t484 = t10 * IMy
    t485 = t483 - t484
    t486 = 3 * t485
    t488 = IMx * t318
    t489 = t3 * IMy
    t490 = t488 + t489
    t491 = 12 * t490
    t494 = IMy * t22
    t495 = 6 * t494
    t498 = -t485
    t503 = IMy * cpa3 * cpsih
    t508 = t243 * IMy
    t509 = 6 * t508
    t518 = IMx * t363
    t523 = 6 * t503
    t539 = IMx * t390
    t540 = t503 / 2
    t545 = IMx * t327 + Q1 * t490 + t494
    t576 = (IMx * cdelta * cpsih - IMy * spsih) * cpa2
    CMZb33[5] = -t481 * muM * (t70 * (t6 * t486 + t16 * (IMx * t328 + Q1 * t491 + t495) + t5 * (18 * t20 * t498 + Q1 * (IMx * t340 - 18 * t503) + IMx * t349 + t509) + Q2 * (-t30 * t491 + t20 * (IMx * t358 - 18 * t494) + t518 - t495) + t36 * t486 + t30 * (IMx * t369 + t523) + t20 * (IMx * t375 - t509) + Q1 * (IMx * t379 - t523) + 3 * t483 - 3 * t484) - 12 * t69 * (t6 * t490 / 4 + t16 * (Q1 * t498 + t539 - t540) - 3/2 * t5 * Q1 * t545 + Q2 * (t30 * t485 + t20 * (IMx * t403 + 3/2 * t503) + Q1 * (IMx * t410 - t508) + t539 - t540) + (t20 * t490 + Q1 * (-IMx * t417 + 2 * t494) - t488 - t489) * t98 / 4) * t118 - 3 * t6 * t576 + t16 * (-6 * Q1 * t490 - t495 + t518) + t5 * (t20 * (6 * IMx * t442 - 6 * t445 * IMy) + Q1 * (IMx * t450 + 12 * t503) + IMx * t458 - 6 * IMy * cpa2 * spsih) + 6 * Q2 * t98 * t545 - 3 * t36 * t576 - 6 * t20 * t576 + IMx * t475 - t477 * IMy)
    
    return CMXb11,CMXb12,CMXb13,CMYb21,CMYb22,CMYb23,CMZb31,CMZb32,CMZb33;

end

function CMterms_M3_smk0_magnetic(cdelta,sdelta,cpsih,spsih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,A,B,C)
    GG = 1+Q1^2+Q2^2
    t1 = 1 + eta
    t2 = t1 ^ 2
    t3 = t2 * t1
    t4 = cpa1 * spsih
    t5 = cpa2 * cpsih
    t6 = t4 + t5
    t7 = t6 / 4
    t8 = P1 * t7
    t9 = cpsih * cpa1
    t10 = spsih * cpa2
    t11 = t9 - t10
    t12 = t11 * P2
    t13 = t12 / 4
    t14 = t8 + t13
    t15 = Q2 ^ 2
    t16 = t15 ^ 2
    t18 = -t11
    t19 = P1 * t18
    t20 = t6 * P2
    t23 = P1 * cpsih
    t24 = P2 * spsih
    t26 = (t23 - t24) * cpa3
    t27 = t26 / 2
    t29 = t15 * Q2
    t31 = -t6
    t32 = 3/2 * t31
    t36 = Q1 ^ 2
    t38 = spsih * P1
    t39 = cpsih * P2
    t41 = (t38 + t39) * cpa3
    t43 = 3/2 * Q1 * t41
    t44 = t4 - t5
    t45 = t44 * P1
    t49 = P1 * t11
    t50 = t49 - t20
    t51 = t36 * Q1
    t54 = 3/2 * t36 * t26
    t55 = t44 * P2
    t58 = (t23 + t24) * cpa3
    t59 = t58 / 2
    t62 = t36 ^ 2
    t65 = t51 * t41 / 2
    t69 = (-t38 + t39) * cpa3
    t71 = Q1 * t69 / 2
    t74 = cpa2 * P1
    t75 = cpa1 * P2
    t76 = t74 + t75
    t78 = cpa1 * P1
    t79 = cpa2 * P2
    t80 = -t78 + t79
    t83 = cpa3 * P1
    t87 = -t76
    t90 = cpa3 * P2
    t91 = Q1 * t90
    t95 = -t80
    t96 = t36 * t95
    t97 = Q1 * t83
    t106 = cos(TL)
    t107 = t106 ^ 2
    t108 = t107 * t106
    t112 = 4 * t6
    t113 = P1 * t112
    t114 = 4 * t12
    t117 = 2 * t41
    t120 = 6 * t18
    t121 = P1 * t120
    t126 = 6 * Q1 * t26
    t130 = -t112
    t131 = P1 * t130
    t135 = 6 * t36 * t41
    t138 = 2 * t69
    t143 = 2 * t51 * t26
    t147 = 2 * Q1 * t58
    t151 = t29 * t80 / 3
    t153 = 2/3 * t90
    t156 = 4/3 * t97
    t157 = t78 / 3
    t158 = t79 / 3
    t170 = sin(TL)
    t172 = 3/2 * t18
    t174 = 6 * t31
    t175 = Q1 * t174
    t176 = cpa3 * spsih
    t177 = 3 * t176
    t182 = cpa3 * cpsih
    t183 = Q1 * t182
    t187 = -t174
    t189 = t36 * t176
    t191 = -t44
    t196 = t36 + 1
    t198 = 2 * t183
    t208 = cpa1 * t36
    t209 = Q1 * cpa3
    t225 = Q1 * t18
    t226 = t182 / 2
    t230 = Q1 * t176
    t232 = t5 / 2
    t233 = t4 / 2
    t237 = t36 * t182
    t243 = t51 * t176 / 2
    t245 = t36 * t191 / 2
    t246 = t230 / 2
    t251 = cpa2 * t29
    t252 = Q1 * cpa1
    t254 = 2 * cpa3
    t257 = cpa2 * t36
    t274 = 2 * t4
    t277 = 2 * t230
    t280 = Q1 * t11
    t289 = GG ^ 2
    t291 = (t289 - 3) * cpa2
    t305 = t289 * cpa3
    t317 = t49 + (t274 - t5) * P2
    t319 = 2 * t12
    t332 = 4 * t4 + 2 * t5
    t348 = 2 * t24
    t363 = t289 - 2
    t372 = t78 + t79
    t376 = 2/3 * t75
    t377 = t74 / 3
    t393 = t11 / 8
    t394 = P1 ^ 2
    t396 = P1 * t20
    t397 = t396 / 4
    t398 = P2 ^ 2
    t399 = t398 + 1
    t400 = t11 * t399
    t401 = t400 / 8
    t402 = t394 * t393 + t397 - t401
    t404 = t6 / 2
    t406 = P1 * t12
    t408 = t6 * t399 / 2
    t411 = t394 * spsih
    t412 = t411 / 2
    t413 = P1 * P2
    t414 = cpsih * t413
    t416 = t399 * spsih / 2
    t418 = cpa3 * (-t412 + t414 + t416)
    t422 = 3/4 * t18
    t423 = t394 * t422
    t428 = t394 * cpsih
    t430 = 2 * spsih * t413
    t431 = t398 * cpsih
    t433 = (t428 + t430 - t431 - cpsih) * cpa3
    t436 = t44 * t413
    t440 = -t404
    t446 = t394 - t398 - 1
    t459 = t36 * t44 * t413
    t465 = -t393
    t467 = t16 * t402 + t29 * (Q1 * (t394 * t404 - t406 - t408) - t418 / 2) + t15 * (t36 * (t423 - 3/2 * t396 + 3/4 * t400) - 3/4 * Q1 * t433 + t436 / 2) + Q2 * (t51 * (t394 * t440 + t406 + t408) + 3/2 * t36 * t418 + Q1 * t44 * t446 / 2 + cpa3 * (t412 + t414 - t416) / 2) + t62 * t402 + t51 * t433 / 4 - t459 / 2 + Q1 * (t428 - t430 - t431 - cpsih) * cpa3 / 4 + t394 * t465 + t397 + t401
    t468 = eta ^ 2
    t469 = t468 * eta
    t471 = 5/8 * t11
    t473 = 5/4 * t396
    t474 = t398 + 3/5
    t475 = t474 * t11
    t476 = 5/8 * t475
    t477 = t394 * t471 + t473 - t476
    t479 = 5/2 * t6
    t481 = 5 * t406
    t483 = 5/2 * t6 * t474
    t487 = t398 * spsih / 2
    t488 = 3/10 * spsih
    t490 = cpa3 * (t414 - t412 + t487 + t488)
    t500 = 3/5 * cpsih
    t502 = (t428 - t431 + t430 - t500) * cpa3
    t514 = t394 - t398 - 3/5
    t533 = t16 * t477 + t29 * (Q1 * (t394 * t479 - t481 - t483) - 5/2 * t490) + t15 * (t36 * (15/4 * t394 * t18 - 15/2 * t396 + 15/4 * t475) - 15/4 * Q1 * t502 + 5/2 * t436) + Q2 * (t51 * (-t394 * t479 + t481 + t483) + 15/2 * t36 * t490 + 5/2 * Q1 * t44 * t514 + 5/2 * (t414 + t412 - t487 - t488) * cpa3) + t62 * t477 + 5/4 * t51 * t502 - 5/2 * t459 + 5/4 * Q1 * (t428 - t431 - t430 - t500) * cpa3 - t394 * t471 + t473 + t476
    t535 = t394 ^ 2
    t537 = t394 * P1
    t538 = t537 * t20
    t539 = t538 / 4
    t542 = t398 + 6
    t543 = t542 * P2
    t545 = P1 * t6 * t543
    t546 = t545 / 4
    t547 = t398 ^ 2
    t548 = 6 * t398
    t549 = t547 + t548 + 3
    t550 = t11 * t549
    t551 = t550 / 8
    t552 = t535 * t393 - t394 * t422 + t539 + t546 - t551
    t555 = t537 * t12
    t556 = 3 * t6
    t558 = t49 * t543
    t559 = t6 * t549
    t560 = t559 / 2
    t564 = t535 * spsih / 2
    t566 = P2 * t537 * cpsih
    t567 = 3 * t411
    t568 = P1 * t542
    t569 = t568 * t39
    t571 = t549 * spsih / 2
    t573 = (-t564 + t566 - t567 + t569 + t571) * cpa3
    t585 = t535 * cpsih
    t588 = 2 * P2 * spsih * t537
    t589 = 6 * t428
    t591 = 2 * t568 * t24
    t592 = t549 * cpsih
    t594 = cpa3 * (t585 + t588 + t589 + t591 - t592)
    t595 = Q1 * t594
    t597 = t394 + t398 + 6
    t598 = t44 * t597
    t599 = t598 * t413
    t608 = t36 * t573
    t611 = t535 - t547 + 6 * t394 - t548 - 3
    t613 = Q1 * t44 * t611
    t616 = cpa3 * (t564 + t566 + t567 + t569 - t571)
    t621 = t51 * t594
    t624 = t36 * t598 * t413
    t628 = Q1 * (t585 - t588 + t589 - t591 - t592) * cpa3
    t631 = t16 * t552 + t29 * (Q1 * (t394 * t556 + t535 * t404 - t555 - t558 - t560) - t573 / 2) + t15 * (t36 * (t535 * t422 - 3/2 * t538 + 9/2 * t394 * t18 - 3/2 * t545 + 3/4 * t550) - 3/4 * t595 + t599 / 2) + Q2 * (t51 * (-t394 * t556 + t535 * t440 + t555 + t558 + t560) + 3/2 * t608 + t613 / 2 + t616 / 2) + t62 * t552 + t621 / 4 - t624 / 2 + t628 / 4 + t535 * t465 + t539 + t423 + t546 + t551
    t633 = t11 / 24
    t635 = t538 / 12
    t636 = t11 / 4
    t638 = t545 / 12
    t639 = t550 / 24
    t640 = t394 * t636 + t535 * t633 + t635 + t638 - t639
    t642 = t6 / 6
    t644 = t555 / 3
    t646 = t558 / 3
    t647 = t559 / 6
    t653 = -t636
    t682 = t469 * t467 + t468 * t533 + eta * t631 + t16 * t640 + t29 * (Q1 * (t394 * t6 + t535 * t642 - t644 - t646 - t647) - t573 / 6) + t15 * (t36 * (t535 * t653 - t538 / 2 + t394 * t172 - t545 / 2 + t550 / 4) - t595 / 4 + t599 / 6) + Q2 * (t51 * (t394 * t31 - t535 * t642 + t644 + t646 + t647) + t608 / 2 + t613 / 6 + t616 / 6) + t62 * t640 + t621 / 12 - t624 / 6 + t628 / 12 - t535 * t633 + t635 + t394 * t653 + t638 + t639
    t684 = t394 * cpa1
    t685 = t684 / 3
    t686 = P2 * t74
    t687 = 2/3 * t686
    t688 = t399 * cpa1
    t689 = t688 / 3
    t692 = t394 * cpa2
    t693 = P1 * t75
    t695 = t399 * cpa2
    t698 = P2 * t83
    t702 = 2 * t686
    t703 = t398 * cpa1
    t704 = t684 + t702 - t703 - cpa1
    t711 = t692 / 2
    t712 = t695 / 2
    t713 = -t711 + t693 + t712
    t716 = 2 * t413 * t209
    t722 = 10/3 * t686
    t723 = 5/3 * t703
    t724 = 5/3 * t684
    t729 = t398 * cpa2
    t731 = 3 * cpa2
    t748 = t729 / 2
    t749 = 3/10 * cpa2
    t750 = t693 - t711 + t748 + t749
    t757 = cpa1 * t535
    t758 = t757 / 3
    t760 = P2 * cpa2 * t537
    t761 = 2/3 * t760
    t762 = 2 * t684
    t763 = t568 * t79
    t764 = 2/3 * t763
    t765 = t549 * cpa1
    t766 = t765 / 3
    t767 = -t758 - t761 - t762 - t764 + t766
    t769 = cpa2 * t535
    t771 = P2 * cpa1 * t537
    t774 = t568 * t75
    t776 = t549 * cpa2
    t777 = -t769 + 2 * t771 - 6 * t692 + 2 * t774 + t776
    t779 = t597 * P2
    t780 = t779 * t83
    t787 = t757 + 2 * t760 + 6 * t684 + 2 * t763 - t765
    t790 = Q1 * t611 * cpa3
    t794 = t769 / 2
    t795 = 3 * t692
    t796 = t776 / 2
    t797 = -t794 + t771 - t795 + t774 + t796
    t803 = Q1 * (2 * Q1 * t779 * t83 + t36 * t797 - t771 - t774 - t794 - t795 + t796)
    t807 = t757 / 9
    t808 = 2/9 * t760
    t809 = 2/3 * t684
    t810 = 2/9 * t763
    t811 = t765 / 9
    t833 = t191 / 4
    t835 = cpa3 * t29
    t845 = t289 - 3/2
    t866 = sma ^ 2
    t869 = 0.1e1 / t866 / sma * muM
    t877 = 1 / t3 / n / t289 / t469
    gfun3Mxb11 = 3 * t877 * t869 * IMz * (-2/3 * t108 * (cdelta * (t16 * t14 + t29 * (Q1 * (t19 + t20) - t27) + t15 * (t36 * (t32 * P1 - 3/2 * t12) - t43 + t45 / 2) + Q2 * (Q1 * t55 + t51 * t50 + t54 + t59) + t62 * t14 + t65 - t36 * t45 / 2 + t71 + t8 - t13) - (t29 * t76 + t15 * (3 * Q1 * t80 - 2 * t83) + Q2 * (3 * t36 * t87 - t74 + t75 - 4 * t91) + (t96 + 2 * t97 - t78 - t79) * Q1) * sdelta / 2) * t3 - t107 * (t170 * (cdelta * (t16 * t50 + t29 * (Q1 * (t113 + t114) + t117) + t15 * (t36 * (t121 + 6 * t20) - t126 - 2 * t55) + Q2 * (t51 * (t131 - t114) - t135 + 4 * Q1 * t45 - t138) + t62 * t50 + t143 + 2 * t36 * t55 + t147 + t19 - t20) + 6 * (t151 + t15 * (Q1 * t87 - t153) + Q2 * (t96 + t156 - t157 - t158) + (t36 * t76 + t74 - t75 + 2 * t91) * Q1 / 3) * sdelta) + cdelta * (t16 * t172 + t29 * (t175 - t177) + t15 * (9 * t36 * t11 + 9 * t183) + Q2 * (6 * Q1 * t191 + t51 * t187 - t177 + 9 * t189) - 3/2 * (t36 * t11 + t10 + t198 - t9) * t196) - 9 * (-cpa1 * t29 / 3 - cpa2 * t15 * Q1 + Q2 * (t208 + 4/3 * t209 - cpa1 / 3) + t196 * cpa2 * Q1 / 3) * sdelta) * t3 / 6 - t106 * (t170 * (cdelta * (t16 * t7 + t29 * (t225 - t226) + t15 * (t36 * t32 - 3/2 * t230 - t232 + t233) + Q2 * (t51 * t11 + 3/2 * t237 + t226) + t62 * t7 + t243 + t245 - t246 + t4 / 4 + t5 / 4) - (t251 + t15 * (-3 * t252 - t254) + Q2 * (-3 * t257 - cpa2) + (t208 + 2 * t209 - cpa1) * Q1) * sdelta / 2) - P1 * (cdelta * (cpa2 * t16 * cpsih / 2 + t29 * (t225 - t182) + t15 * (t36 * (-t274 - t5) - t277 - t5) + Q2 * (t280 + t182) * t196 + cpa2 * t62 * cpsih / 2 + cpa2 * t36 * cpsih - cpsih * t291 / 6 + cpa1 * spsih * t289 / 6) + 2 * sdelta * (-t251 / 2 + t15 * (t252 + cpa3) + Q2 * t196 * cpa2 / 2 - t305 / 12))) * t3 + t170 * (cdelta * (t16 * t317 + t29 * (Q1 * (t113 - t319) + t117) + t15 * (t36 * (-6 * cpsih * t79 + t121) - 6 * t23 * t209 + P2 * t332) + Q2 * (t51 * (t131 + t319) + 6 * t36 * t69 + Q1 * (4 * t44 * P1 - 6 * t12) - t138) + t62 * t317 + 2 * t51 * (t23 + t348) * cpa3 - t36 * P2 * t332 + 2 * Q1 * (t23 - t348) * cpa3 + t19 - P2 * (cpsih * cpa2 * (-t289 + 1) + t363 * t4)) + 6 * sdelta * (t151 + t15 * (-Q1 * t74 - t153) + Q2 * (t36 * t372 + t156 - t157 - t158) + t51 * (-t376 + t377) - 4/3 * t36 * t90 + Q1 * (t376 + t377) + P2 * t305 / 6)) * t3 / 6 + cdelta * t682 + 3/4 * sdelta * (t469 * (t29 * (-t685 - t687 + t689) + t15 * (Q1 * (-t692 + 2 * t693 + t695) + 4/3 * t698) + Q2 * (t36 * t704 + 4/3 * Q1 * t446 * cpa3 - t685 + t687 + t689) - 2/3 * Q1 * (t36 * t713 - t693 - t711 + t712 + t716)) + t468 * (t29 * (-t722 + t723 - t724 + cpa1) + t15 * (Q1 * (-5 * t692 + 10 * t693 + 5 * t729 + t731) + 20/3 * t698) + Q2 * (t36 * (5 * t684 + 10 * t686 - 5 * t703 - 3 * cpa1) + 20/3 * Q1 * t514 * cpa3 + cpa1 + t722 + t723 - t724) - 10/3 * (t36 * t750 - t693 - t711 + t716 + t748 + t749) * Q1) + eta * (t29 * t767 + t15 * (Q1 * t777 + 4/3 * t780) + Q2 * (t36 * t787 + 4/3 * t790 - t758 + t761 - t762 + t764 + t766) - 2/3 * t803) + t29 * (-t807 - t808 - t809 - t810 + t811) + t15 * (Q1 * (-t769 / 3 + 2/3 * t771 - 2 * t692 + 2/3 * t774 + t776 / 3) + 4/9 * t780) + Q2 * (-t36 * t767 + 4/9 * t790 - t807 + t808 - t809 + t810 + t811) - 2/9 * t803) + phiTA * (cdelta * (t16 * t833 - cpsih * t835 / 2 + t15 * (t245 - t246 - t232 - t233) + Q2 * (-t237 / 2 + t280 + t226) + t62 * t833 - t243 + t36 * t404 + t246 + t44 * t845 / 6) + (-t251 + t15 * (t252 + t254) + Q2 * (-t257 + cpa2) + cpa1 * t51 - t305 / 3 + 2 * cpa3 * t36 - t252) * sdelta / 2) * t3)
    t880 = t95 * cpsih
    t881 = spsih * t87 + t880
    t883 = 4 * t95
    t885 = t76 * cpsih
    t886 = 4 * t885
    t896 = t9 + t10
    t897 = t896 * P1
    t905 = t896 * P2
    t913 = -t74 + t75
    t922 = spsih * t95 / 4 + t885 / 4
    t944 = -t372
    t955 = 3/4 * t182
    t959 = Q1 * t6 + t176
    t965 = 3/2 * t896
    t979 = 2 * t176
    t994 = cpsih * cpa3 * t51
    t996 = -t896
    t1009 = 6 * t10
    t1035 = 2 * t75
    t1038 = spsih * t95 + cpsih * (t74 - t1035)
    t1040 = 4 * t74
    t1041 = t1040 - t1035
    t1043 = 4 * t78
    t1045 = -t1043 - 2 * t79
    t1062 = 4 * P2 * t9
    t1064 = 2 * P2 * t10
    t1088 = 2 * spsih * t83
    t1090 = 4 * cpsih * t90
    t1109 = 3/4 * t684
    t1110 = 3/2 * t686
    t1111 = 3/4 * t688
    t1114 = cpsih * t713
    t1116 = spsih * (-t1109 - t1110 + t1111) + 3/2 * t1114
    t1120 = -t795 + 6 * t693 + 3 * t729 + t731
    t1123 = 3 * t704 * cpsih
    t1126 = cpsih * t446
    t1128 = (t1126 + t430) * cpa3
    t1132 = 9/2 * t684
    t1141 = -t446 / 2
    t1144 = cpa3 * (spsih * t1141 + t414)
    t1147 = t896 * t413
    t1169 = t36 * t896 * t413
    t1184 = 15/2 * t686
    t1185 = 9/4 * cpa1
    t1186 = 15/4 * t684
    t1187 = 15/4 * t703
    t1190 = cpsih * t750
    t1192 = spsih * (-t1184 + t1185 - t1186 + t1187) + 15/2 * t1190
    t1198 = -15 * t692 + 30 * t693 + 15 * t729 + 9 * cpa2
    t1203 = 15 * (t702 - 3/5 * cpa1 + t684 - t703) * cpsih
    t1206 = cpsih * t514
    t1208 = cpa3 * (t1206 + t430)
    t1223 = -t394 / 2 + t398 / 2 + 3/10
    t1226 = (spsih * t1223 + t414) * cpa3
    t1263 = 3/4 * t757
    t1264 = 3/2 * t760
    t1265 = 3/2 * t763
    t1266 = 3/4 * t765
    t1269 = cpsih * t797
    t1271 = spsih * (-t1263 - t1264 - t1132 - t1265 + t1266) + 3/2 * t1269
    t1278 = -3 * t769 + 6 * t771 - 18 * t692 + 6 * t774 + 3 * t776
    t1280 = cpsih * t787
    t1281 = 3 * t1280
    t1284 = cpsih * t611
    t1287 = 2 * t597 * spsih * t413
    t1289 = cpa3 * (t1284 + t1287)
    t1307 = -t535 / 2 + t547 / 2 - 3 * t394 + 3 * t398 + 3/2
    t1310 = cpsih * t597 * t413
    t1312 = cpa3 * (spsih * t1307 + t1310)
    t1313 = Q1 * t1312
    t1315 = t896 * t597
    t1316 = t1315 * t413
    t1324 = t36 * t1289
    t1327 = Q1 * t896 * t611
    t1330 = (t1284 - t1287) * cpa3
    t1335 = t51 * t1312
    t1338 = t36 * t1315 * t413
    t1344 = Q1 * (-spsih * t1307 + t1310) * cpa3
    t1349 = cpsih * (t794 + t771 + t795 + t774 - t796)
    t1353 = t757 / 4
    t1354 = t760 / 2
    t1355 = 3/2 * t684
    t1356 = t763 / 2
    t1357 = t765 / 4
    t1361 = spsih * (-t1353 - t1354 - t1355 - t1356 + t1357) + t1269 / 2
    t1394 = -t965
    t1400 = 3 * t183
    t1416 = -t108 * (t16 * t881 + t29 * (Q1 * (spsih * t883 + t886) + t117) + t15 * (t36 * (6 * spsih * t76 - 6 * t880) - t126 + 2 * t897) + Q2 * (t51 * (-spsih * t883 - t886) - t135 + 4 * Q1 * t905 + t138) + t62 * t881 + t143 - 2 * t36 * t897 - t147 + spsih * t913 + t372 * cpsih) * t3 + 4 * t107 * (t170 * (t16 * t922 + t29 * (Q1 * (spsih * t76 - t880) - t27) + t15 * (t36 * (3/2 * spsih * t80 - 3/2 * t885) - t43 + t905 / 2) + Q2 * (-Q1 * t897 + t51 * t881 + t54 - t59) + t62 * t922 + t65 - t36 * t905 / 2 - t71 + spsih * t944 / 4 + t913 * cpsih / 4) + 3/8 * t16 * t31 + t29 * (-Q1 * t172 + t955) + 9/4 * t15 * Q1 * t959 + Q2 * (t51 * t172 - 9/4 * t237 + Q1 * t965 + t955) - 3/8 * (t36 * t6 + t277 - t4 - t5) * t196) * t3 - 3/2 * t106 * t3 * (t170 * (t16 * t11 + t29 * (Q1 * t112 + t979) + t15 * (t36 * t120 + 2 * t10 - 6 * t183 + 2 * t9) + Q2 * (t51 * t130 - 6 * t189 - t979) + t62 * t11 + 2 * t994 + 2 * t36 * t996 - t198 + t9 - t10) - 2/3 * P1 * (-3 * cpa2 * spsih * t16 + t29 * (Q1 * t187 + 6 * t176) + t15 * (t36 * (-12 * t9 + t1009) - 12 * t183 + t1009) - 6 * Q2 * t959 * t196 - 3 * spsih * cpa2 * t62 - 6 * cpa2 * spsih * t36 + spsih * t291 + cpsih * cpa1 * t289)) - t170 * (t16 * t1038 + t29 * (Q1 * (cpsih * t1045 + spsih * t1041) - 2 * t26) + t15 * (t36 * (-6 * P1 * t5 + 6 * spsih * t944) - 6 * Q1 * P1 * t176 - t1062 + t1064) + Q2 * (t51 * (-cpsih * t1045 - spsih * t1041) + 6 * t36 * t58 + Q1 * (spsih * (-t1040 - 6 * t75) + cpsih * (-t1043 - 6 * t79)) - 2 * t58) + t62 * t1038 + t51 * (t1088 - t1090) + t36 * (t1062 - t1064) + Q1 * (t1088 + t1090) + spsih * (-t78 + (GG - 1) * (GG + 1) * t79) + (t363 * t75 - t74) * cpsih) * t3 + t469 * (t16 * t1116 + t29 * (Q1 * (spsih * t1120 + t1123) + 3/2 * t1128) + t15 * (t36 * (spsih * (t1132 + 9 * t686 - 9/2 * t688) - 9 * t1114) - 9 * Q1 * t1144 + 3 * t1147) + Q2 * (t51 * (-spsih * t1120 - t1123) - 9/2 * t36 * t1128 + 3 * Q1 * t896 * t446 + 3/2 * cpa3 * (t1126 - t430)) + t62 * t1116 + 3 * t51 * t1144 - 3 * t1169 - 3 * Q1 * (-spsih * t1141 + t414) * cpa3 + spsih * (t1109 - t1110 - t1111) + 3/2 * cpsih * (t711 + t693 - t712)) + t468 * (t16 * t1192 + t29 * (Q1 * (spsih * t1198 + t1203) + 15/2 * t1208) + t15 * (t36 * (spsih * (45/2 * t684 + 45 * t686 - 45/2 * t703 - 27/2 * cpa1) - 45 * t1190) - 45 * Q1 * t1226 + 15 * t1147) + Q2 * (t51 * (-spsih * t1198 - t1203) - 45/2 * t36 * t1208 + 15 * Q1 * t514 * t896 + 15/2 * cpa3 * (t1206 - t430)) + t62 * t1192 + 15 * t51 * t1226 - 15 * t1169 - 15 * Q1 * (-spsih * t1223 + t414) * cpa3 + spsih * (-t1185 - t1187 + t1186 - t1184) + 15/2 * (t693 + t711 - t748 - t749) * cpsih) + eta * (t16 * t1271 + t29 * (Q1 * (spsih * t1278 + t1281) + 3/2 * t1289) + t15 * (t36 * (spsih * (9/2 * t757 + 9 * t760 + 27 * t684 + 9 * t763 - 9/2 * t765) - 9 * t1269) - 9 * t1313 + 3 * t1316) + Q2 * (t51 * (-spsih * t1278 - t1281) - 9/2 * t1324 + 3 * t1327 + 3/2 * t1330) + t62 * t1271 + 3 * t1335 - 3 * t1338 - 3 * t1344 + spsih * (t1263 - t1264 + t1132 - t1265 - t1266) + 3/2 * t1349) + t16 * t1361 + t29 * (Q1 * (spsih * t777 + t1280) + t1289 / 2) + t15 * (t36 * (spsih * (3/2 * t757 + 3 * t760 + 9 * t684 + 3 * t763 - 3/2 * t765) - 3 * t1269) - 3 * t1313 + t1316) + Q2 * (t51 * (-spsih * t777 - t1280) - 3/2 * t1324 + t1327 + t1330 / 2) + t62 * t1361 + t1335 - t1338 - t1344 + spsih * (t1353 - t1354 + t1355 - t1356 - t1357) + t1349 / 2 + phiTA * t3 * (t16 * t1394 + 3 * spsih * t835 + t15 * (3 * t36 * t996 + 3 * t10 - t1400 - 3 * t9) + Q2 * (3 * t189 + t175 - t177) + t62 * t1394 - 3 * t994 + 3 * t36 * t11 + t1400 + t896 * t845)
    gfun3Mxb12 = t877 * t869 * IMz * t1416 / 2
    gfun3Mxb13 = 0
    gfun3Myb21 = gfun3Mxb11
    gfun3Myb22 = gfun3Mxb12
    gfun3Myb23 = 0
    gfun3Mzb31 = 0
    gfun3Mzb32 = 0
    gfun3Mzb33 = 0
    
    return gfun3Mxb11, gfun3Mxb12, gfun3Mxb13, gfun3Myb21, gfun3Myb22, gfun3Myb23, gfun3Mzb31, gfun3Mzb32, gfun3Mzb33;

end
