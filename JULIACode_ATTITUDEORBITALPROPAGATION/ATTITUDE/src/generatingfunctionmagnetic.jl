"""
    getWM2(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ)
    Returns the generating function leading to the transformation 
    of variables allowing to average the attitude equations of motion 
    (expressed in Sadov variables) with respect to Sadov fast angles
    -- the perturbation here is the magnetic torque

    INPUT
    IV                = [A,B,C] principal moments of inertia [m^2]
    k                 = (B-A)/(C-A)*C/A
    sadovvar,skm      = sadov variables and sadov related variable **
    equi              = equinoctial elements ***
    muM               = Planet's magnetic dipole strenght [kg km^3/s^2/A]
    IMx,IMy,IMz       = components of the intrinsic magnetic moment in the body reference frame [A m^2]
    [cpa1,cpa2,cpa3]  = Planet's polar axis unit vector in the inertial frame 

    **
    Consider an inertial reference Frame XYZ.
    Consider a body reference frame xyz in principal axes of inertia. 
    The reference frame is such that m belongs to in[0,1] and k>0 where
    k = C/A*(B-A)/(C-B) 
    m = k*(C-delta)/(delta-A)
    with
    A,B,C the moments of inertia, A=int(y^2+z^2)dm, B=int(x^2+z^2)dm and C=int(x^2+y^2)dm.
    delta = G^2/2/Phi, with G the angular momentum of the body and Phi the kinetic energy
    Let GV=diag([A,B,C])omV be angular momentum of the body and G = norm(GV)
    (omV = [p,q,r]^T is the angular velocity) 
    Let N be the node between the inertial reference XY plane and the plane
    perpendicular to GV; let N'' be the node between the plane perpendicular 
    to GV and the xy plane. 
    sadovvar = [Jl,Jg,Jh,psil,psig,psih] or [Jg,Jh,psil,psig,psih]
            with
                Jl   = 2G/pi sqrt{k+m} sqrt{(1+k)/k} (ellP(-k,m)-m/(k+m)ellK(m)) [kg m^2 /s^2]
                Jg   = G [kg m^2 /s^2]
                Jh   = Gcos(delta), delta = inclination angle between [kg m^2 /s^2]
                       the XY plane and the plane perpendicular to GV.
                psil = pi/2 ellK(m)ellF(lambda,m) [rad], lambda = atan(cos(l),sqrt{1+k}sin(l)), l = angle between N'' and x axis
                psig = g - sqrt{(k+m)(1+k)/k}(ellP(-k,m)ellF(lambda,m)/ellK(m)-ellP(-k,lambda,m)) [rad], g = angle between N and N''
                psih = angle between X axis and N [rad]

    skm = k/(m+k)

    ***
    equi = [a,P1,P2,Q1,Q2,TL]  
    a   semi-major axis [km]       
    P1 = ec*sin(OM+om)                   
    P2 = ec*cos(OM+om)                         
    Q1 = tan(i/2)*sin(OM)  
    Q2 = tan(i/2)*cos(OM)  
    TL = nu+om+OM [rad]  
    with 
        e   orbital eccentricity                   
        i   inclination                            
        o   argumentum of pericentre               
        O   right ascension of the ascending node  
        nu  true anomaly                           
    

    OUTPUT
    WM2 = vector 6x1 of Float64 -
        generating function of the transformation 
        [skm,Jg,Jh,psil,psig,psih] -> [skm',Jg',Jh',psil',psig',psih'], 
        allowing to obtain averaged attitude equations of motion with respect to psil and psig
"""
function getWM2(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3)

    WM2 = getWM2procedure(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,1)
    return WM2;
end

"""
    getWM2(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ)
    Returns the generating function leading to the transformation 
    of variables allowing to average the attitude equations of motion 
    (expressed in Sadov-like variables) with respect to Sadov fast angles
    -- the perturbation here is the magnetic torque

    INPUT
    IV                = [A,B,C] principal moments of inertia [m^2]
    k                 = (B-A)/(C-A)*C/A
    sadovvar,skm      = sadov variables and sadov related variable **
    equi              = equinoctial elements ***
    muM               = Planet's magnetic dipole strenght [kg km^3/s^2/A]
    IMx,IMy,IMz       = components of the intrinsic magnetic moment in the body reference frame [A m^2]
    [cpa1,cpa2,cpa3]  = Planet's polar axis unit vector in the inertial frame 

    **
    Consider an inertial reference Frame XYZ.
    Consider a body reference frame xyz in principal axes of inertia. 
    The reference frame is such that m belongs to in[0,1] and k>0 where
    k = C/A*(B-A)/(C-B) 
    m = k*(C-delta)/(delta-A)
    with
    A,B,C the moments of inertia, A=int(y^2+z^2)dm, B=int(x^2+z^2)dm and C=int(x^2+y^2)dm.
    delta = G^2/2/Phi, with G the angular momentum of the body and Phi the kinetic energy
    Let GV=diag([A,B,C])omV be angular momentum of the body and G = norm(GV)
    (omV = [p,q,r]^T is the angular velocity) 
    Let N be the node between the inertial reference XY plane and the plane
    perpendicular to GV; let N'' be the node between the plane perpendicular 
    to GV and the xy plane. 
    sadovvar = [Jl,Jg,Jh,psil,psig,psih] or [Jg,Jh,psil,psig,psih]
            with
                Jl   = 2G/pi sqrt{k+m} sqrt{(1+k)/k} (ellP(-k,m)-m/(k+m)ellK(m)) [kg m^2 /s^2]
                Jg   = G [kg m^2 /s^2]
                Jh   = Gcos(delta), delta = inclination angle between [kg m^2 /s^2]
                       the XY plane and the plane perpendicular to GV.
                psil = pi/2 ellK(m)ellF(lambda,m) [rad], lambda = atan(cos(l),sqrt{1+k}sin(l)), l = angle between N'' and x axis
                psig = g - sqrt{(k+m)(1+k)/k}(ellP(-k,m)ellF(lambda,m)/ellK(m)-ellP(-k,lambda,m)) [rad], g = angle between N and N''
                psih = angle between X axis and N [rad]

    skm = k/(m+k)

    ***
    equi = [a,P1,P2,Q1,Q2,TL]  
    a   semi-major axis [km]       
    P1 = ec*sin(OM+om)                   
    P2 = ec*cos(OM+om)                         
    Q1 = tan(i/2)*sin(OM)  
    Q2 = tan(i/2)*cos(OM)  
    TL = nu+om+OM [rad]  
    with 
        e   orbital eccentricity                   
        i   inclination                            
        o   argumentum of pericentre               
        O   right ascension of the ascending node  
        nu  true anomaly                           
    

    OUTPUT
    WM2 = vector 7x1 of Float64 -
        generating function of the transformation 
        [skm,Jg,Jh,psil,J5,J6,J7] -> [skm',Jg',Jh',psil',J5',J6',J7'], 
        allowing to obtain averaged attitude equations of motion with respect to psil and psig
"""
function getWM2sadovlike(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3)

    WM2 = getWM2procedure(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,2)
    return WM2;
end

"""
    getWM3(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ)
    Returns the generating function leading to the transformation 
    of variables allowing to average the attitude equations of motion 
    (expressed in Sadov variables) with respect to the orbital mean anomaly
    -- the perturbation here is the magnetic torque

    INPUT
    IV                = [A,B,C] principal moments of inertia [m^2]
    k                 = (B-A)/(C-A)*C/A
    sadovvar,skm      = sadov variables and sadov related variable **
    equi              = equinoctial elements ***
    muM               = Planet's magnetic dipole strenght [kg km^3/s^2/A]
    IMx,IMy,IMz       = components of the intrinsic magnetic moment in the body reference frame [A m^2]
    [cpa1,cpa2,cpa3]  = Planet's polar axis unit vector in the inertial frame 

    **
    Consider an inertial reference Frame XYZ.
    Consider a body reference frame xyz in principal axes of inertia. 
    The reference frame is such that m belongs to in[0,1] and k>0 where
    k = C/A*(B-A)/(C-B) 
    m = k*(C-delta)/(delta-A)
    with
    A,B,C the moments of inertia, A=int(y^2+z^2)dm, B=int(x^2+z^2)dm and C=int(x^2+y^2)dm.
    delta = G^2/2/Phi, with G the angular momentum of the body and Phi the kinetic energy
    Let GV=diag([A,B,C])omV be angular momentum of the body and G = norm(GV)
    (omV = [p,q,r]^T is the angular velocity) 
    Let N be the node between the inertial reference XY plane and the plane
    perpendicular to GV; let N'' be the node between the plane perpendicular 
    to GV and the xy plane. 
    sadovvar = [Jl,Jg,Jh,psil,psig,psih] or [Jg,Jh,psil,psig,psih]
            with
                Jl   = 2G/pi sqrt{k+m} sqrt{(1+k)/k} (ellP(-k,m)-m/(k+m)ellK(m)) [kg m^2 /s^2]
                Jg   = G [kg m^2 /s^2]
                Jh   = Gcos(delta), delta = inclination angle between [kg m^2 /s^2]
                       the XY plane and the plane perpendicular to GV.
                psil = pi/2 ellK(m)ellF(lambda,m) [rad], lambda = atan(cos(l),sqrt{1+k}sin(l)), l = angle between N'' and x axis
                psig = g - sqrt{(k+m)(1+k)/k}(ellP(-k,m)ellF(lambda,m)/ellK(m)-ellP(-k,lambda,m)) [rad], g = angle between N and N''
                psih = angle between X axis and N [rad]

    skm = k/(m+k)

    OUTPUT
    WM3 = vector 6x1 of Float64 -
        generating function of the transformation 
        [skm,Jg,Jh,psil,psig,psih] -> [skm',Jg',Jh',psil',psig',psih'], 
        allowing to obtain averaged attitude equations of motion (already averaged with respect to psil and psig) with respect to the orbital mean anomaly 

"""
function getWM3(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,mu)
    WM3 = getWM3procedure(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,mu,1);
    return WM3;
end



"""
    getWM3sadovlike(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ)
    Returns the generating function leading to the transformation 
    of variables allowing to average the attitude equations of motion 
    (expressed in Sadov-like variables) with respect to the orbital mean anomaly
    -- the perturbation here is the magnetic torque

    INPUT
    IV                = [A,B,C] principal moments of inertia [m^2]
    k                 = (B-A)/(C-A)*C/A
    sadovvar,skm      = sadov variables and sadov related variable **
    equi              = equinoctial elements ***
    muM               = Planet's magnetic dipole strenght [kg km^3/s^2/A]
    IMx,IMy,IMz       = components of the intrinsic magnetic moment in the body reference frame [A m^2]
    [cpa1,cpa2,cpa3]  = Planet's polar axis unit vector in the inertial frame 

    **
    Consider an inertial reference Frame XYZ.
    Consider a body reference frame xyz in principal axes of inertia. 
    The reference frame is such that m belongs to in[0,1] and k>0 where
    k = C/A*(B-A)/(C-B) 
    m = k*(C-delta)/(delta-A)
    with
    A,B,C the moments of inertia, A=int(y^2+z^2)dm, B=int(x^2+z^2)dm and C=int(x^2+y^2)dm.
    delta = G^2/2/Phi, with G the angular momentum of the body and Phi the kinetic energy
    Let GV=diag([A,B,C])omV be angular momentum of the body and G = norm(GV)
    (omV = [p,q,r]^T is the angular velocity) 
    Let N be the node between the inertial reference XY plane and the plane
    perpendicular to GV; let N'' be the node between the plane perpendicular 
    to GV and the xy plane. 
    sadovvar = [Jl,Jg,Jh,psil,psig,psih] or [Jg,Jh,psil,psig,psih]
            with
                Jl   = 2G/pi sqrt{k+m} sqrt{(1+k)/k} (ellP(-k,m)-m/(k+m)ellK(m)) [kg m^2 /s^2]
                Jg   = G [kg m^2 /s^2]
                Jh   = Gcos(delta), delta = inclination angle between [kg m^2 /s^2]
                       the XY plane and the plane perpendicular to GV.
                psil = pi/2 ellK(m)ellF(lambda,m) [rad], lambda = atan(cos(l),sqrt{1+k}sin(l)), l = angle between N'' and x axis
                psig = g - sqrt{(k+m)(1+k)/k}(ellP(-k,m)ellF(lambda,m)/ellK(m)-ellP(-k,lambda,m)) [rad], g = angle between N and N''
                psih = angle between X axis and N [rad]

    skm = k/(m+k)

    OUTPUT
    WM3 =  vector 7x1 of Float64 -
        generating function of the transformation 
        [skm,Jg,Jh,psil,J5,J6,J7] -> [skm',Jg',Jh',psil',J5',J6',J7'], 
        allowing to obtain averaged attitude equations of motion (already averaged with respect to psil and psig) with respect to the orbital mean anomaly 

"""
function getWM3sadovlike(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,mu)
    WM3 = getWM3procedure(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,mu,2);
    return WM3;
end


#######################################
function getWM2procedure(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,typeofvariables)
    if skm == 1.0
        WM2 = getWM2procedure_smk0(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,typeofvariables)
        return WM2;
    end
    if size(sadovvar)[1] == 5
        Jg = sadovvar[1];
        Jh = sadovvar[2];
        psil = sadovvar[3];
        psig = sadovvar[4];
        psih = sadovvar[5];
    else
        Jg = sadovvar[2];
        Jh = sadovvar[3];
        psil = sadovvar[4];
        psig = sadovvar[5];
        psih = sadovvar[6];
    end

    cdelta = Jh/Jg;
    sdelta = sqrt(1-cdelta^2.0);
    smk    = 1-skm
    if smk == 0.0
        Base.error("this function is not suitable to convert variables if m=0")
    end

    sma = equi[1];
    P1  = equi[2];
    P2  = equi[3];
    Q1  = equi[4];
    Q2  = equi[5];
    TL  = equi[6];
    
    rc   = sma*(1-P1^2-P2^2)/(1+P1*sin(TL)+P2*cos(TL));
    GG   = 1.0+Q1^2+Q2^2;
    cpa1EQ = (-Q1^2*cpa1 + 2*Q1*Q2*cpa2 + Q2^2*cpa1 - 2*Q1*cpa3 + cpa1)/GG;
    cpa2EQ = (Q1^2*cpa2 + 2*Q1*Q2*cpa1 - Q2^2*cpa2 + 2*Q2*cpa3 + cpa2)/GG;
    cpa3EQ = (-Q1^2*cpa3 - Q2^2*cpa3 + 2*Q1*cpa1 - 2*Q2*cpa2 + cpa3)/GG;



    if k!=0.0

        m     = smk/skm*k;
        KK    = ellF(pi/2,m);
        EE    = ellE(pi/2,m);
        KP    = ellF(pi/2,1-m);
        EP    = ellE(pi/2,1-m);
        PP    = ellP(-k,pi/2,m);
        q     = exp(-pi*KP/KK);
        FA    = ellF(atan(sqrt(k/m)),1-m);
        EA    = ellE(atan(sqrt(k/m)),1-m);
        sigma = pi*FA/2/KK;
        M4    = (PP-KK)*sqrt(1+k)/sqrt(skm)/pi;

        npsig = Jg/IV[1]/IV[3]*((IV[3]-IV[1])PP+IV[1]*KK)/KK;
        npsil = -pi/2.0/sqrt(1+k)*sqrt(skm)*Jg/IV[1]/IV[3]*(IV[3]-IV[1])/KK;

        dskmdJl = sqrt(skm)*pi/(sqrt(1 + k)*KK*Jg);
        dskmdJg = -2*((m + k)*PP - m*KK)/((m + k)*KK*Jg);
        dchim2dJl    = derivativechiM2_Jl(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
        dchim2dJgP1  = derivativechiM2_JgP1(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
        dchim2dJhP1  = derivativechiM2_JhP1(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
        dchim2dJhP2  = derivativechiM2_JhP2(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
        dchim2dpsil  = derivativechiM2_psil(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
        dchim2dpsig  = derivativechiM2_psig(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
        dchim2dpsih  = derivativechiM2_psih(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
       
        if typeofvariables == 1
            dchim2dJgP2  = derivativechiM2_JgP2(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
            dchim2dJg    = dchim2dJgP1 + dchim2dJgP2/sdelta;
            dchim2dJh    = dchim2dJhP1 + dchim2dJhP2/sdelta;
            WM2  =  [-dchim2dpsil*dskmdJl-dchim2dpsig*dskmdJg,-dchim2dpsig,-dchim2dpsih,dchim2dJl ,dchim2dJg ,dchim2dJh ];
        else
            cdeltadchim2dpsigMdchim2dpsihOsdelta =  derivativechiM2_cdeltapsigMpsihOsdelta(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
            WM2 = [-dskmdJl*dchim2dpsil-dskmdJg*dchim2dpsig,
            -dchim2dpsig,
            -dchim2dpsih,
             dchim2dJl, 
             dchim2dJgP1 + cdelta*dchim2dJhP1 + psih/Jg*(cdelta*dchim2dpsig-dchim2dpsih),
            -Jg*sdelta*sin(psih)*dchim2dJhP1 - Jg*sin(psih)*dchim2dJhP2 - sdelta*cos(psih)*dchim2dpsig - cdelta*cos(psih)*cdeltadchim2dpsigMdchim2dpsihOsdelta,
             Jg*sdelta*cos(psih)*dchim2dJhP1 + Jg*cos(psih)*dchim2dJhP2 - sdelta*sin(psih)*dchim2dpsig - cdelta*sin(psih)*cdeltadchim2dpsigMdchim2dpsihOsdelta];


        end   
    else
        npsig = Jg/IV[1]
        npsil = Jg*skm*(1/IV[3]-1/IV[2]);

        dskmdJl = 2*sqrt(skm)/Jg
        dskmdJg = -2*skm/Jg
        dchim2dJlP1     = derivativechiM2_Jl1_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2]);
        dchim2dcsigmaP1 = derivativechiM2_csigma1_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
        dchim2dcsigmaP2 = derivativechiM2_csigma2_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
        dchim2dJl       = (dchim2dcsigmaP1 + dchim2dcsigmaP2/sqrt(smk))/Jg
        dchim2dJgP1     = derivativechiM2_Jg1_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
        dchim2dJgP1     = dchim2dJgP1 - sqrt(skm)*dchim2dJl 
        dchim2dJl       = dchim2dJl + dchim2dJlP1 
        dchim2dcdeltaP1 = derivativechiM2_cdelta1_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
        dchim2dcdeltaP2 = derivativechiM2_cdelta2_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
        dchim2dpsil     = derivativechiM2_psil_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
        dchim2dpsig     = derivativechiM2_psig_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
        dchim2dpsih     = derivativechiM2_psih_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
        
        if typeofvariables == 1
            dchim2dJh       = (dchim2dcdeltaP1 + dchim2dcdeltaP2/sdelta)/Jg;
            dchim2dJg       = -cdelta*dchim2dJh +  dchim2dJgP1;
            WM2  =  [-dchim2dpsil*dskmdJl-dchim2dpsig*dskmdJg,-dchim2dpsig,-dchim2dpsih,dchim2dJl ,dchim2dJg ,dchim2dJh ];
        else
            dchim2dJhP1 = dchim2dcdeltaP1/Jg;
            dchim2dJhP2 = dchim2dcdeltaP2/Jg;
            dchim2dJgP1 = dchim2dJgP1 - cdelta*dchiG2dJhP1;
            cdeltadchim2dpsigMdchim2dpsihOsdelta = derivativechiM2_cdeltapsigMpsihOsdelta_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3]);
            WM2 = [-dskmdJl*dchim2dpsil-dskmdJg*dchim2dpsig,
            -dchim2dpsig,
            -dchim2dpsih,
             dchim2dJl, 
             dchim2dJgP1 + cdelta*dchim2dJhP1 + psih/Jg*(cdelta*dchim2dpsig-dchim2dpsih),
            -Jg*sdelta*sin(psih)*dchim2dJhP1 - Jg*sin(psih)*dchim2dJhP2 - sdelta*cos(psih)*dchim2dpsig + cdelta*cos(psih)*cdeltadchim2dpsigMdchim2dpsihOsdelta,
             Jg*sdelta*cos(psih)*dchim2dJhP1 + Jg*cos(psih)*dchim2dJhP2 - sdelta*sin(psih)*dchim2dpsig + cdelta*sin(psih)*cdeltadchim2dpsigMdchim2dpsihOsdelta];
        end

    end

    return WM2;
end

function getWM3procedure(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,mu,typeofvariables)
    if skm == 1.0
        WM3 = getWM3procedure_smk0(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,mu,typeofvariables)
        return WM3;
    end
    if size(sadovvar)[1] == 5
        Jg = sadovvar[1];
        Jh = sadovvar[2];
        psil = sadovvar[3];
        psig = sadovvar[4];
        psih = sadovvar[5];
    else
        Jg = sadovvar[2];
        Jh = sadovvar[3];
        psil = sadovvar[4];
        psig = sadovvar[5];
        psih = sadovvar[6];
    end

    cdelta = Jh/Jg;
    sdelta = sqrt(1-cdelta^2.0);
    smk    = 1-skm
    if smk == 0.0
        Base.error("this function is not suitable to convert variables if m=0")
    end

    sma = equi[1];
    P1  = equi[2];
    P2  = equi[3];
    Q1  = equi[4];
    Q2  = equi[5];
    TL  = equi[6];
    
    eta  = sqrt(1-P1^2-P2^2);
    phiTA   = equi2equationofthecentre(TL,Q1,Q2,P1,P2)
    GG   = 1.0+Q1^2+Q2^2;
    cpa1EQ = (-Q1^2*cpa1 + 2*Q1*Q2*cpa2 + Q2^2*cpa1 - 2*Q1*cpa3 + cpa1)/GG;
    cpa2EQ = (Q1^2*cpa2 + 2*Q1*Q2*cpa1 - Q2^2*cpa2 + 2*Q2*cpa3 + cpa2)/GG;
    cpa3EQ = (-Q1^2*cpa3 - Q2^2*cpa3 + 2*Q1*cpa1 - 2*Q2*cpa2 + cpa3)/GG;
    n = sqrt(mu/sma^3.0);

    if k!=0.0
        m     = (1-skm)/skm*k;
        KK    = ellF(pi/2,m);
        EE    = ellE(pi/2,m);
        KP    = ellF(pi/2,1-m);
        EP    = ellE(pi/2,1-m);
        PP    = ellP(-k,pi/2,m);
        q     = exp(-pi*KP/KK);
        FA    = ellF(atan(sqrt(k/m)),1-m);
        EA    = ellE(atan(sqrt(k/m)),1-m);
        sigma = pi*FA/2/KK;
        M4    = (PP-KK)*sqrt(1+k)/sqrt(skm)/pi;
        dskmdJl = sqrt(skm)*pi/(sqrt(1 + k)*KK*Jg);
        dskmdJg = -2*((m + k)*PP - m*KK)/((m + k)*KK*Jg);

        dchim3dJl   = derivativechiM3_Jl(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
        dchim3dJgP1 = derivativechiM3_JgP1(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
        
        dchim3dJhP1 = derivativechiM3_JhP1(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
        dchim3dJhP2 = derivativechiM3_JhP2(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
        dchim3dpsil = derivativechiM3_psil(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
        dchim3dpsig = derivativechiM3_psig(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
        dchim3dpsih = derivativechiM3_psih(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
        
        if typeofvariables == 1
            dchim3dJgP2 = derivativechiM3_JgP2(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
            dchim3dJg   = dchim3dJgP1+dchim3dJgP2/sdelta;
            dchim3dJh   = dchim3dJhP1+dchim3dJhP2/sdelta;
            WM3  =  [-dchim3dpsil*dskmdJl-dchim3dpsig*dskmdJg,-dchim3dpsig,-dchim3dpsih,dchim3dJl,dchim3dJg,dchim3dJh];
        else
            cdeltadchim3dpsigMdchim3dpsihOsdelta =  derivativechiM3_cdeltapsigMpsihOsdelta(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[2],IV[3]);
            WM3 = [-dskmdJl*dchim3dpsil-dskmdJg*dchim3dpsig,
            -dchim3dpsig,
            -dchim3dpsih,
             dchim3dJl, 
             dchim3dJgP1 + cdelta*dchim3dJhP1 + psih/Jg*(cdelta*dchim3dpsig-dchim3dpsih),
            -Jg*sdelta*sin(psih)*dchim3dJhP1 - Jg*sin(psih)*dchim3dJhP2 - sdelta*cos(psih)*dchim3dpsig + cdelta*cos(psih)*cdeltadchim3dpsigMdchim3dpsihOsdelta,
             Jg*sdelta*cos(psih)*dchim3dJhP1 + Jg*cos(psih)*dchim3dJhP2 - sdelta*sin(psih)*dchim3dpsig + cdelta*sin(psih)*cdeltadchim3dpsigMdchim3dpsihOsdelta];
        end

    else

        dskmdJl = 2*sqrt(skm)/Jg
        dskmdJg = -2*skm/Jg

        dchim3dcsigmaP1 = derivativechiM3_csigma1_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
        dchim3dcsigmaP2 = derivativechiM3_csigma2_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
        dchim3dJl       = (dchim3dcsigmaP1 + dchim3dcsigmaP2/sqrt(smk))/Jg;
        dchim3dJgP1     = - sqrt(skm)*dchim3dJl;
        dchim3dcdeltaP1 = derivativechiM3_cdelta1_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
        dchim3dcdeltaP2 = derivativechiM3_cdelta2_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
        dchim3dpsil     = derivativechiM3_psil_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
        dchim3dpsig     = derivativechiM3_psig_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
        dchim3dpsih     = derivativechiM3_psih_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
        
        if typeofvariables == 1
            dchim3dJh       = (dchim3dcdeltaP1 + dchim3dcdeltaP2/sdelta)/Jg;
            dchim3dJg       = -cdelta*dchim3dJh +  dchim3dJgP1;
            WM3  =  [-dchim3dpsil*dskmdJl-dchim3dpsig*dskmdJg,-dchim3dpsig,-dchim3dpsih,dchim3dJl,dchim3dJg,dchim3dJh];
        else
            dchim3dJhP1 = dchim3dcdeltaP1/Jg;
            dchim3dJhP2 = dchim3dcdeltaP2/Jg;
            dchim3dJgP1 = dchim3dJgP1 - cdelta*dchim3dJhP1;
            cdeltadchim3dpsigMdchim3dpsihOsdelta = derivativechiM3_cdeltapsigMpsihOsdelta_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,IV[1],IV[3])
            WM3 = [-dskmdJl*dchim3dpsil-dskmdJg*dchim3dpsig,
            -dchim3dpsig,
            -dchim3dpsih,
             dchim3dJl, 
             dchim3dJgP1 + cdelta*dchim3dJhP1 + psih/Jg*(cdelta*dchim3dpsig-dchim3dpsih),
            -Jg*sdelta*sin(psih)*dchim3dJhP1 - Jg*sin(psih)*dchim3dJhP2 - sdelta*cos(psih)*dchim3dpsig + cdelta*cos(psih)*cdeltadchim3dpsigMdchim3dpsihOsdelta,
             Jg*sdelta*cos(psih)*dchim3dJhP1 + Jg*cos(psih)*dchim3dJhP2 - sdelta*sin(psih)*dchim3dpsig + cdelta*sin(psih)*cdeltadchim3dpsigMdchim3dpsihOsdelta];
        end
    end

    return WM3;

end

function getWM2procedure_smk0(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,typeofvariables)

    if size(sadovvar)[1] == 5
        Jg = sadovvar[1];
        Jh = sadovvar[2];
        psil = sadovvar[3];
        psig = sadovvar[4];
        psih = sadovvar[5];
    else
        Jg = sadovvar[2];
        Jh = sadovvar[3];
        psil = sadovvar[4];
        psig = sadovvar[5];
        psih = sadovvar[6];
    end
    cdelta = Jh/Jg;
    sdelta = sqrt(1-cdelta^2.0);
    cpsih  = cos(psih)
    spsih  = sin(psih)

    sma = equi[1];
    P1  = equi[2];
    P2  = equi[3];
    Q1  = equi[4];
    Q2  = equi[5];
    TL  = equi[6];
    rc   = sma*(1-P1^2-P2^2)/(1+P1*sin(TL)+P2*cos(TL));

    A = IV[1]
    C = IV[3]
    npsig = Jg/A/C*((C-A)/sqrt(1+k)+A);
    npsil = -1/sqrt(1+k)*sqrt(skm)*Jg/A/C*(C-A);
    dnpsildJg  = (A-C)/(A*C*sqrt(1+k));
    dnpsigdJg  = ((C-A)/sqrt(1+k)+A)/(A*C);
    dnpsigdskm = -Jg*(A-C)*(-k/sqrt(1+k)/2.0+1.0)/(2*A*C);
    dnpsildskm = 0.0

    VGT,VGGT =  getgeneratinfunctiontermsW2_allpert_psil_psig_smk0(psil,psig,npsil,npsig)
    CMXb11,CMXb12,CMXb13,CMYb21,CMYb22,CMYb23,CMZb31,CMZb32,CMZb33 = CMterms_M2_smk0_magnetic(cdelta,sdelta,cpsih,spsih,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,IV[1],IV[2],IV[3])
    W21Block  = transpose(-2*1.0/Jg*CMXb13 - 2*1.0/Jg*1.0/(1+k)*CMYb23);
    Tb3Block  = transpose(CMXb13+CMYb23+CMZb33);
    Tb2Block  = transpose(CMXb12+CMYb22+CMZb32);
    Tb1Block  = transpose(CMXb11+CMYb21+CMZb31);

    if typeofvariables==1
        W21 = W21Block*VGT;
        W22 = Tb3Block*VGT;
        W23 = (cdelta*Tb3Block + sdelta*Tb2Block)*VGT;
        W24 = 0.0;
        W25 = - cdelta/sdelta/Jg*Tb1Block*VGT + (dnpsigdskm+dnpsildskm)*W21Block*VGGT + (dnpsigdJg+dnpsildJg)*Tb3Block*VGGT;
        W26 = 1/sdelta/Jg*Tb1Block*VGT;  
        WM2  = [W21,W22,W23,W24,W25,W26];
    else
        W21 = W21Block*VGT;
        W22 = Tb3Block*VGT;
        W23 = (cdelta*Tb3Block + sdelta*Tb2Block)*VGT;
        W24 = 0.0;
        W25 = psih*sdelta/Jg*Tb2Block*VGT + (dnpsigdskm+dnpsildskm)*W21Block*VGGT + (dnpsigdJg+dnpsildJg)*Tb3Block*VGGT;
        W26 = (-spsih*Tb1Block+sdelta*cpsih*Tb3Block-cdelta*spsih*Tb2Block)*VGT  
        W27 = (cpsih*Tb1Block+sdelta*spsih*Tb3Block-cdelta*spsih*Tb2Block)*VGT  
        WM2  = [W21,W22,W23,W24,W25,W26,W27];
    end

    return WM2;

end

function getWM3procedure_smk0(IV,k,sadovvar,skm,equi,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,mu,typeofvariables)

    if size(sadovvar)[1] == 5
        Jg = sadovvar[1];
        Jh = sadovvar[2];
        psil = sadovvar[3];
        psig = sadovvar[4];
        psih = sadovvar[5];
    else
        Jg = sadovvar[2];
        Jh = sadovvar[3];
        psil = sadovvar[4];
        psig = sadovvar[5];
        psih = sadovvar[6];
    end

    cdelta = Jh/Jg;
    sdelta = sqrt(1-cdelta^2.0);
    cpsih = cos(psih)
    spsih = sin(psih)

    sma = equi[1];
    P1  = equi[2];
    P2  = equi[3];
    Q1  = equi[4];
    Q2  = equi[5];
    TL  = equi[6];
    eta  = sqrt(1-P1^2-P2^2);
    phiTA   = equi2equationofthecentre(TL,Q1,Q2,P1,P2)
    n = sqrt(mu/sma^3.0);

    mxb11,mxb12,mxb13,myb21,myb22,myb23,mzb31,mzb32,mzb33 = CMterms_M3_smk0_magnetic(cdelta,sdelta,cpsih,spsih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,IV[1],IV[2],IV[3])
    W21Block  = -2.0/Jg*mxb13 - 2.0/Jg*1.0/(1+k)*myb23;
    Tb3Block  = mxb13+myb23+mzb33;
    Tb2Block  = mxb12+myb22+mzb32;
    Tb1Block  = mxb11+myb21+mzb31;

    if typeofvariables==1
        W21 = W21Block;
        W22 = Tb3Block;
        W23 = (cdelta*Tb3Block + sdelta*Tb2Block);
        W24 = 0.0;
        W25 = - cdelta/sdelta/Jg*Tb1Block;
        W26 = 1/sdelta/Jg*Tb1Block;  
        WM3  = [W21,W22,W23,W24,W25,W26];
    else
        W21 = W21Block;
        W22 = Tb3Block;
        W23 = (cdelta*Tb3Block + sdelta*Tb2Block);
        W24 = 0.0;
        W25 = psih*sdelta/Jg*Tb2Block;
        W26 = -spsih*Tb1Block+sdelta*cpsih*Tb3Block-cdelta*spsih*Tb2Block  
        W27 = cpsih*Tb1Block+sdelta*spsih*Tb3Block-cdelta*spsih*Tb2Block  
        WM3  = [W21,W22,W23,W24,W25,W26,W27];
    end


    return WM3;

end



###############################################################################################################################################################################################
# generic case k!=0 m!=0

function derivativechiM2_Jl(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)
    contr = zeros(225);
    t1 = cos(psil)
    t2 = sqrt(q)
    t3 = t2 * cdelta
    t5 = -1 + m
    t8 = k + m
    t10 = KK * t5 * k + t8 * EE
    t11 = IMy * t10
    t12 = pi ^ 2
    t13 = Q1 ^ 2
    t14 = Q2 ^ 2
    t15 = t13 + t14 + 1
    t16 = t15 ^ 2
    t17 = 1 / t16
    t18 = t13 * t17
    t23 = 1 / t15
    t24 = Q1 * t23
    t25 = cpa1EQ * t24
    t27 = Q2 * t23
    t28 = cpa2EQ * t27
    t32 = cpa3EQ * (-t13 - t14 + 1) * t23
    t33 = -2 * t25 + 2 * t28 + t32
    t35 = -t13 + t14 + 1
    t36 = t35 * t23
    t37 = cpa1EQ * t36
    t39 = Q2 * cpa2EQ * t24
    t41 = cpa3EQ * t24
    t43 = t37 + 2 * t39 + 2 * t41
    t44 = t23 * t43
    t45 = t35 * t44
    t47 = Q2 * cpa1EQ * t24
    t49 = t13 - t14 + 1
    t50 = t49 * t23
    t51 = cpa2EQ * t50
    t52 = cpa3EQ * t27
    t54 = 2 * t47 + t51 - 2 * t52
    t55 = t23 * t54
    t56 = Q1 * Q2
    t57 = t56 * t55
    t58 = 2 * t57
    t59 = t45 + t58
    t62 = 2 * Q1 * t23 * t59
    t63 = t56 * t44
    t64 = 2 * t63
    t65 = t49 * t55
    t66 = t64 + t65
    t69 = t33 * (4 * t18 + 4 * t14 * t17 - 2/3) - t62 + 2 * t66 * t27
    t70 = t69 * t12
    t71 = t70 * t11
    t73 = rc ^ 2
    t75 = 0.1e1 / t73 / rc
    t76 = KK ^ 2
    t78 = 1 / t76 / KK
    t79 = t78 * t75
    t80 = q - 1
    t81 = 0.1e1 / t80
    t82 = 0.1e1 / npsil
    t85 = 1 / m
    t86 = 1 / t5
    t87 = t86 * t85
    t88 = sqrt(k)
    t89 = 0.1e1 / t88
    t90 = 0.1e1 / Jg
    t92 = t90 * t89 * t87
    t96 = muM * IMy
    t98 = t12 * pi
    t99 = 1 + k
    t100 = sqrt(t99)
    t101 = 0.1e1 / t100
    t103 = sqrt(t8)
    t104 = 0.1e1 / t103
    t109 = t76 ^ 2
    t110 = 1 / t109
    t112 = npsil ^ 2
    t113 = 0.1e1 / t112
    t114 = t10 * t113
    t116 = -C + A
    t117 = 0.1e1 / A
    t119 = 0.1e1 / C
    t120 = t85 * t119
    t122 = t86 * t120 * t117 * t116
    t126 = 1 + q
    t127 = t126 * muM
    t129 = t98 * IMy
    t133 = t110 * t75
    t134 = t80 ^ 2
    t141 = KK * (-KP + EP) + EE * KP
    t143 = t90 * t87
    t144 = t143 * t89 * t141
    contr[1] = (3/2 * t92 * t82 * t81 * t79 * t71 * muM * t3 - 3/4 * t122 * t114 * t81 * t110 * t75 * t69 * t104 * t101 * t98 * t96 * t3 + 3/4 * t144 * t82 / t134 * t133 * t69 * t8 * t129 * t127 * t3) * t1
    t149 = 3 * psil
    t150 = cos(t149)
    t151 = t2 * q
    t152 = t151 * cdelta
    t155 = q ^ 2
    t156 = t155 * q
    t157 = t156 - 1
    t158 = 0.1e1 / t157
    t164 = t98 * cdelta
    t167 = t17 * t43
    t168 = Q1 * t35
    t169 = t168 * t167
    t171 = t14 * Q1
    t172 = t171 * t167
    t174 = t17 * t54
    t175 = Q2 * t13
    t176 = t175 * t174
    t178 = Q2 * t49
    t179 = t178 * t174
    t181 = t17 * t33
    t182 = t13 * t181
    t184 = t14 * t181
    t189 = -6 * t169 + 12 * t172 - 12 * t176 + 6 * t179 + 12 * t182 + 12 * t184 + 4 * t25 - 4 * t28 - 2 * t32
    t201 = t156 + 1
    t205 = t110 * t8
    t206 = t157 ^ 2
    contr[2] = (t92 * t82 * t158 * t79 * t71 * muM * t152 / 2 - t122 * t114 * t158 * t110 * t104 * t75 * t189 * t151 * t101 * t164 * t96 / 12 + t144 * t82 / t206 * t205 * t75 * t201 * t189 * t98 * t96 * t152 / 4) * t150
    t214 = 2 * TL
    t215 = t214 - psig
    t216 = cos(t215)
    t217 = t12 * sdelta
    t218 = t23 * t33
    t219 = Q2 * t218
    t224 = t59 * t27
    t226 = -2 * Q1 * t23 * (t64 + t65 + 4 * t219) + 2 * t224
    t228 = muM * IMz
    t229 = exp(sigma)
    t230 = t10 * t229
    t231 = t230 * t228
    t234 = exp(2 * sigma)
    t235 = -1 + t234
    t237 = 0.1e1 / t235 * t75
    t238 = 0.1e1 / npsig
    t241 = t90 * t101
    t242 = t241 * t87
    t243 = t242 * t238 * t78 * t237
    t246 = muM * t226
    t248 = t229 * IMz
    t249 = t237 * t248
    t251 = npsig ^ 2
    t254 = t101 * t116
    t263 = t117 * t120 * t86 * (EE * KK * m - PP * t10)
    t264 = t263 * t254 / t251 * t110
    t267 = 1 + t234
    t269 = t8 * t98
    t273 = t235 ^ 2
    t281 = (EE - KK) * FA + KK * EA
    t283 = t143 * t281 * t101
    t284 = t283 * t238 * t110 / t273 * t75
    t287 = 3/8 * t243 * t231 * t226 * t217 - 3/8 * t264 * t249 * t246 * t217 - 3/16 * t284 * t248 * t246 * t269 * sdelta * t267
    contr[3] = t287 * t216
    t288 = t214 + psig
    t289 = cos(t288)
    contr[4] = -t287 * t289
    t291 = 4 * psil
    t292 = t214 - t291
    t293 = cos(t292)
    t294 = t155 * cdelta
    t295 = muM * t294
    t296 = t12 * IMz
    t298 = t226 * t10 * t296
    t300 = t155 ^ 2
    t301 = t300 + 1
    t302 = 0.1e1 / t301
    t305 = t242 * t82 * t302 * t79
    t308 = t88 * cdelta
    t309 = muM * t155
    t310 = t309 * t308
    t311 = t98 * IMz
    t314 = t75 * t226 * t104 * t311
    t317 = t116 * t114
    t323 = t86 * t85 / t99 * t119 * t117
    t324 = t323 * t317 * t302 * t110
    t335 = t49 * Q1
    t340 = 2 * Q2 * t35 * t167 - 4 * t175 * t167 + 4 * t171 * t174 - 2 * t335 * t174 - 8 * t56 * t181
    t342 = t300 - 1
    t343 = t8 * t342
    t346 = t301 ^ 2
    t347 = 0.1e1 / t346
    t348 = t82 * t347
    t350 = t101 * t141
    t351 = t143 * t350
    t352 = t351 * t348 * t133
    t355 = -3/16 * t305 * t298 * t295 + 3/32 * t324 * t314 * t310 - 3/8 * t352 * t343 * t340 * t98 * t228 * t294
    contr[5] = t355 * t293
    t356 = t214 - t149
    t357 = cos(t356)
    t358 = t151 * muM
    t359 = t155 - q + 1
    t360 = t359 * IMy
    t361 = 4 * t182
    t362 = 2 * t219
    t366 = t361 - t62 - 2 * (t64 + t65 + t362) * t27
    t369 = t100 * t366 * t126 * t360
    t370 = IMx * t80
    t371 = t155 + q + 1
    t377 = -2 * Q1 * t23 * (t362 + t63 + t65 / 2) + t224
    t380 = 2 * t377 * t371 * t370
    t381 = t369 - t380
    t383 = t10 * t12
    t385 = t85 * cdelta * t383
    t389 = t300 * t155 - 1
    t390 = 0.1e1 / t389
    t395 = t241 * t89 * t78 * t390 * t86 * t75 * t82
    t398 = t104 * muM
    t401 = t133 * t164
    t404 = t116 * t10
    t406 = t323 * t404 * t390 * t113
    t409 = t8 * muM
    t410 = t359 ^ 2
    t411 = t410 * t359
    t412 = t411 * IMy
    t413 = t126 ^ 2
    t414 = t413 * t126
    t417 = t100 * t366 * t414 * t412
    t418 = t134 * t80
    t419 = IMx * t418
    t420 = t371 ^ 2
    t421 = t420 * t371
    t424 = 2 * t377 * t421 * t419
    t429 = t389 ^ 2
    t433 = t92 * t350 / t429 * t82
    contr[6] = (t395 * t385 * t381 * t358 / 4 - t406 * t401 * t381 * t151 * t398 / 8 + 3/8 * t433 * t401 * (t417 - t424) * t151 * t409) * t357
    t438 = 2 * TL - 2 * psil
    t439 = cos(t438)
    t441 = cdelta * q * muM
    t443 = t155 + 1
    t444 = 0.1e1 / t443
    t447 = t242 * t82 * t444 * t79
    t450 = q * muM
    t451 = t450 * t308
    t455 = t323 * t317 * t444 * t110
    t458 = cdelta * muM
    t459 = t311 * t458
    t460 = t155 - 1
    t462 = t75 * t8
    t465 = t443 ^ 2
    t468 = t141 * t82
    t471 = t143 * t101 * q
    t472 = t471 * t468 / t465 * t110
    t475 = -3/8 * t447 * t298 * t441 + 3/16 * t455 * t314 * t451 - 3/8 * t472 * t462 * t460 * t340 * t459
    contr[7] = t475 * t439
    t476 = t214 - psil
    t477 = cos(t476)
    t478 = t2 * muM
    t479 = t12 * t478
    t481 = t126 * IMy
    t482 = t100 * t366
    t483 = t482 * t481
    t485 = 2 * t377 * t370
    t486 = t483 - t485
    t491 = 0.1e1 / t460
    t495 = t241 * t89 * t86
    t496 = t495 * t85 * t491 * t82 * t78
    t499 = t98 * t2
    t500 = t499 * t398
    t506 = t323 * t404 * t491 * t113
    t509 = t414 * IMy
    t510 = t482 * t509
    t512 = 2 * t377 * t419
    t517 = t460 ^ 2
    t521 = t92 * t350 / t517 * t82
    contr[8] = (3/4 * t496 * t75 * t486 * cdelta * t10 * t479 - 3/8 * t506 * t133 * t486 * cdelta * t500 + 3/8 * t521 * t401 * (t510 - t512) * t2 * t409) * t477
    t525 = t214 + psil
    t526 = cos(t525)
    t527 = t483 + t485
    contr[9] = (3/4 * t496 * t75 * cdelta * t10 * t527 * t479 - 3/8 * t506 * t133 * cdelta * t527 * t500 + 3/8 * t521 * t401 * (t510 + t512) * t2 * t409) * t526
    t547 = 2 * TL + 2 * psil
    t548 = cos(t547)
    contr[10] = -t475 * t548
    t550 = t214 + t149
    t551 = cos(t550)
    t553 = (t369 + t380) * muM
    t558 = t151 * t104
    t563 = t98 * t151
    contr[11] = (t395 * t385 * t151 * t553 / 4 - t406 * t401 * t558 * t553 / 8 + 3/8 * t433 * t133 * (t417 + t424) * cdelta * t563 * t409) * t551
    t572 = t214 + t291
    t573 = cos(t572)
    contr[12] = -t355 * t573
    t575 = -psih + psig
    t576 = cos(t575)
    t577 = t35 ^ 2
    t578 = t577 * t17
    t579 = t14 * t18
    t580 = 4 * t579
    t582 = t43 * (t578 + t580 - 2/3)
    t583 = Q1 * t218
    t587 = t35 * t23 * (2 * t57 - 2 * t583)
    t588 = t65 + t362
    t591 = 2 * t588 * Q2 * t24
    t592 = t582 + t587 + t591
    t593 = t12 * t592
    t595 = cdelta - 1
    t596 = t595 * t10
    t597 = t596 * t248
    t602 = t595 * t229
    t608 = t269 * t592 * t267
    t609 = t602 * t228
    contr[13] = (-3/8 * t243 * t597 * muM * t593 + 3/8 * t264 * t237 * t602 * t228 * t593 + 3/16 * t284 * t609 * t608) * t576
    t614 = psih + psig
    t615 = cos(t614)
    t616 = cdelta + 1
    t621 = muM * t616
    t626 = t248 * t621
    contr[14] = (3/8 * t243 * t231 * t616 * t593 - 3/8 * t264 * t249 * t621 * t593 - 3/16 * t284 * t626 * t608) * t615
    t631 = psih - t291
    t632 = cos(t631)
    t633 = t155 * sdelta
    t634 = muM * t633
    t635 = IMz * t592
    t636 = t383 * t635
    t640 = t88 * sdelta
    t641 = t309 * t640
    t642 = t104 * t98
    t643 = t75 * t642
    t644 = t643 * t635
    t648 = t577 * t167
    t650 = t14 * t13
    t651 = t650 * t167
    t653 = Q2 * t168
    t654 = t653 * t174
    t656 = t49 * t56
    t657 = t656 * t174
    t658 = 6 * t657
    t659 = t168 * t181
    t661 = t171 * t181
    t669 = t343 * t311
    t673 = -3/16 * t305 * t636 * t634 + 3/32 * t324 * t644 * t641 - t352 * t669 * (3 * t648 + 12 * t651 + 6 * t654 + t658 - 6 * t659 + 12 * t661 - 2 * t37 - 4 * t39 - 4 * t41) * muM * t633 / 8
    contr[15] = t673 * t632
    t674 = psih - t149
    t675 = cos(t674)
    t676 = t35 * t17
    t677 = t56 * t676
    t678 = Q1 * t17
    t679 = t178 * t678
    t681 = 2 * t677 + 2 * t679
    t683 = t49 ^ 2
    t684 = t683 * t17
    t686 = t54 * (t580 + t684 - 2/3)
    t687 = Q2 * t18
    t690 = Q2 * t49 * t17
    t691 = 2 * t690
    t694 = t43 * t681 + t686 + (-4 * t687 + t691) * t33
    t697 = t100 * t694 * t126 * t360
    t698 = t681 * t54
    t699 = Q1 * t676
    t700 = 2 * t699
    t701 = t14 * t678
    t705 = t582 + t698 + (-t700 + 4 * t701) * t33
    t707 = t705 * t371 * t370
    t712 = t85 * sdelta * t383
    t716 = t650 * t174
    t717 = 4 * t716
    t718 = t683 * t174
    t722 = t653 * t167
    t724 = t656 * t167
    t725 = 2 * t724
    t726 = t175 * t181
    t728 = t178 * t181
    t730 = t717 + t718 - 4/3 * t47 - 2/3 * t51 + 4/3 * t52 + 2 * t722 + t725 - 4 * t726 + 2 * t728
    t733 = t100 * t730 * t126 * t360
    t734 = 4 * t651
    t738 = t648 + t587 + t734 + t591 - 2/3 * t37 - 4/3 * t39 - 4/3 * t41
    t740 = t738 * t371 * t370
    t744 = t104 * sdelta
    t745 = t133 * t744
    t749 = sdelta * t98
    t750 = t749 * t358
    t753 = t100 * t730 * t414 * t412
    t755 = t738 * t421 * t419
    contr[16] = (-t395 * t712 * t151 * (t697 + t707) * muM / 4 + t406 * t745 * t563 * (t733 + t740) * muM / 8 - 3/8 * t433 * t133 * t8 * (t753 + t755) * t750) * t675
    t763 = 2 * psil
    t764 = psih - t763
    t765 = cos(t764)
    t766 = q * sdelta
    t767 = muM * t766
    t771 = t450 * t640
    t775 = sdelta * muM
    t779 = t75 * t269
    t780 = t779 * IMz * t126
    t784 = -3/8 * t447 * t636 * t767 + 3/16 * t455 * t644 * t771 - 3/8 * t472 * t780 * t80 * t592 * t775
    contr[17] = t784 * t765
    t785 = psih - psil
    t786 = cos(t785)
    t787 = t100 * t694
    t788 = t787 * t481
    t789 = t705 * t370
    t792 = t75 * sdelta
    t793 = t792 * t383
    t797 = t100 * t730
    t798 = t797 * t481
    t799 = t738 * t370
    t806 = t797 * t509
    t807 = t738 * t419
    t812 = t133 * t8 * sdelta
    contr[18] = (-3/4 * t496 * t793 * (t788 + t789) * t478 + 3/8 * t506 * t745 * t98 * (t798 + t799) * t478 - 3/8 * t521 * t812 * t98 * (t806 + t807) * t478) * t786
    t817 = psih + psil
    t818 = cos(t817)
    contr[19] = (3/4 * t496 * t792 * t10 * (-t788 + t789) * t479 - 3/8 * t506 * t745 * (-t798 + t799) * t98 * t478 + 3/8 * t521 * t812 * t499 * (-t806 + t807) * muM) * t818
    t838 = psih + t763
    t839 = cos(t838)
    contr[20] = -t784 * t839
    t841 = psih + t149
    t842 = cos(t841)
    t843 = t12 * t358
    t844 = sdelta * t10
    contr[21] = (t395 * t85 * (-t697 + t707) * t844 * t843 / 4 - t406 * t133 * t104 * (-t733 + t740) * t750 / 8 + 3/8 * t433 * t133 * t8 * (-t753 + t755) * t750) * t842
    t864 = psih + t291
    t865 = cos(t864)
    contr[22] = -t673 * t865
    t868 = cos(-t149 + psig)
    t869 = t230 * t775
    t870 = t69 * IMy
    t871 = t151 * t12
    t873 = t871 * t870 * t869
    t874 = t156 + t234
    t875 = 0.1e1 / t874
    t876 = 3 * npsil
    t877 = -t876 + npsig
    t878 = 1 / t877
    t881 = t92 * t878 * t875 * t79
    t884 = t229 * t101
    t885 = t884 * t775
    t886 = t104 * t563
    t888 = t886 * t870 * t885
    t889 = t877 ^ 2
    t891 = 1 / t889 * t875
    t892 = t10 * t891
    t894 = t122 * t892 * t133
    t897 = IMy * t229
    t898 = t897 * t775
    t900 = t110 * t75 * t151
    t902 = t900 * t70 * t898
    t903 = t89 * t116
    t905 = t263 * t903 * t891
    t908 = t156 - t234
    t909 = t229 * t908
    t911 = t8 * t563
    t912 = t911 * t870
    t913 = t912 * t909 * t775
    t914 = t874 ^ 2
    t916 = t878 / t914
    t917 = t916 * t133
    t918 = t144 * t917
    t922 = t143 * t89 * t281
    t923 = t922 * t917
    contr[23] = (-3/4 * t881 * t873 - 9/8 * t894 * t888 + 3/4 * t905 * t902 - 9/8 * t918 * t913 - 3/8 * t923 * t913) * t868
    t927 = -psil + psig
    t928 = cos(t927)
    t929 = t2 * t12
    t931 = t929 * t870 * t869
    t932 = q + t234
    t933 = 0.1e1 / t932
    t934 = -npsil + npsig
    t935 = 1 / t934
    t943 = t104 * t499 * t870 * t885
    t944 = t934 ^ 2
    t945 = 1 / t944
    t946 = t945 * t933
    t952 = t75 * t2
    t953 = t110 * t952
    t954 = t953 * t70
    t955 = t954 * t898
    t960 = q - t234
    t965 = t8 * t499 * t870 * t960 * t229 * t775
    t966 = t932 ^ 2
    t969 = t935 / t966 * t133
    contr[24] = (-3/4 * t92 * t935 * t933 * t79 * t931 - 3/8 * t122 * t10 * t946 * t133 * t943 + 3/4 * t263 * t903 * t946 * t955 - 3/8 * t144 * t969 * t965 - 3/8 * t922 * t969 * t965) * t928
    t977 = psil + psig
    t978 = cos(t977)
    t979 = q * t234
    t980 = 1 + t979
    t981 = 0.1e1 / t980
    t982 = npsil + npsig
    t983 = 1 / t982
    t989 = t982 ^ 2
    t990 = 1 / t989
    t991 = t990 * t981
    t1001 = t98 * t69
    t1002 = t8 * t2
    t1003 = t979 - 1
    t1006 = t1003 * t1002 * t1001 * t898
    t1007 = t980 ^ 2
    t1010 = t983 / t1007 * t133
    contr[25] = (-3/4 * t92 * t983 * t981 * t79 * t931 + 3/8 * t122 * t10 * t991 * t133 * t943 + 3/4 * t263 * t903 * t991 * t955 - 3/8 * t144 * t1010 * t1006 + 3/8 * t922 * t1010 * t1006) * t978
    t1019 = cos(t149 + psig)
    t1020 = t156 * t234
    t1021 = 1 + t1020
    t1022 = 0.1e1 / t1021
    t1023 = t876 + npsig
    t1024 = 1 / t1023
    t1027 = t92 * t1024 * t1022 * t79
    t1030 = t1023 ^ 2
    t1032 = 1 / t1030 * t1022
    t1033 = t10 * t1032
    t1035 = t122 * t1033 * t133
    t1039 = t263 * t903 * t1032
    t1042 = t1020 - 1
    t1045 = t912 * t1042 * t229 * t775
    t1046 = t1021 ^ 2
    t1048 = t1024 / t1046
    t1049 = t1048 * t133
    t1050 = t144 * t1049
    t1053 = t922 * t1049
    contr[26] = (-3/4 * t1027 * t873 + 9/8 * t1035 * t888 + 3/4 * t1039 * t902 - 9/8 * t1050 * t1045 + 3/8 * t1053 * t1045) * t1019
    t1057 = t214 - t291 - psig
    t1058 = cos(t1057)
    t1059 = t229 * muM
    t1060 = t1059 * t633
    t1061 = t298 * t1060
    t1062 = t300 * t234
    t1063 = t1062 - 1
    t1064 = 0.1e1 / t1063
    t1065 = 4 * npsil
    t1066 = t1065 + npsig
    t1067 = 1 / t1066
    t1070 = t242 * t1067 * t1064 * t79
    t1073 = IMz * t1059
    t1074 = t1073 * t633
    t1077 = t75 * t226 * t88 * t642
    t1078 = t1077 * t1074
    t1080 = t1066 ^ 2
    t1081 = 1 / t1080
    t1085 = t323 * t116 * t10 * t1081 * t1064 * t110
    t1090 = t110 * t75 * t226 * t296
    t1091 = t1090 * t1060
    t1094 = t263 * t254 * t1081 * t1064
    t1097 = t1062 + 1
    t1098 = IMz * t1097
    t1099 = t226 * t269
    t1101 = t1099 * t1098 * t1060
    t1102 = t1063 ^ 2
    t1105 = t1067 / t1102 * t133
    t1106 = t351 * t1105
    t1109 = t283 * t1105
    t1112 = 3/8 * t1070 * t1061 - 3/4 * t1085 * t1078 - 3/8 * t1094 * t1091 + 3/4 * t1106 * t1101 - 3/16 * t1109 * t1101
    contr[27] = t1112 * t1058
    t1113 = t214 - t149 - psig
    t1114 = cos(t1113)
    t1115 = IMy * t366
    t1117 = t871 * t1115 * t869
    t1120 = t749 * t96
    t1126 = -2 * t169 - 4 * t172 - 4 * t176 - 2 * t179 + t361 - 4 * t184
    t1130 = t75 * t1126 * t151 * t884 * t1120
    t1131 = t104 * t110
    t1137 = t151 * t229
    t1138 = t75 * t1126
    t1139 = t110 * t1138
    t1141 = t1139 * t1137 * t217 * t96
    t1147 = t75 * t1042 * t1126 * t1137 * t1120
    t1148 = t1048 * t205
    t1155 = -3/8 * t1027 * t1117 + 9/16 * t122 * t1033 * t1131 * t1130 + 3/8 * t1039 * t1141 - 9/16 * t144 * t1148 * t1147 + 3/16 * t922 * t1148 * t1147
    contr[28] = t1155 * t1114
    t1156 = t214 - t149 + psig
    t1157 = cos(t1156)
    t1170 = -t75 * t908 * t1126 * t1137 * t1120
    t1171 = t916 * t205
    t1178 = -3/8 * t881 * t1117 - 9/16 * t122 * t892 * t1131 * t1130 + 3/8 * t905 * t1141 + 9/16 * t144 * t1171 * t1170 + 3/16 * t922 * t1171 * t1170
    contr[29] = t1178 * t1157
    t1179 = t214 - psil - psig
    t1180 = cos(t1179)
    t1181 = t217 * t1059
    t1182 = t2 * t10
    t1183 = t100 * t1003
    t1184 = t1183 * t1115
    t1185 = IMx * t377
    t1187 = 2 * t980 * t1185
    t1188 = t1184 - t1187
    t1189 = t75 * t1188
    t1194 = exp(4 * sigma)
    t1195 = t155 * t1194
    t1196 = t1195 - 1
    t1197 = 0.1e1 / t1196
    t1200 = t495 * t85 * t1197 * t983 * t78
    t1203 = t744 * t1059
    t1209 = t323 * t404 * t1197 * t990
    t1213 = t990 * t133
    t1217 = t89 * t101
    t1219 = t263 * t1217 * t116 * t1197
    t1222 = t749 * t1059
    t1224 = exp(6 * sigma)
    t1225 = t156 * t1224
    t1226 = 3 * t1195
    t1227 = 3 * t979
    t1228 = t1225 - t1226 + t1227 - 1
    t1229 = IMy * t1228
    t1230 = t482 * t1229
    t1231 = t1225 + t1226 + t1227 + 1
    t1233 = 2 * t1231 * t1185
    t1237 = t462 * (t1230 - t1233) * t2 * t1222
    t1238 = t983 * t110
    t1239 = t1196 ^ 2
    t1240 = 0.1e1 / t1239
    t1243 = t143 * t1217
    t1244 = t1243 * t141 * t1240 * t1238
    t1249 = t922 * t101 * t1240 * t1238
    contr[30] = (-3/8 * t1200 * t1189 * t1182 * t1181 + 3/16 * t1209 * t110 * t1189 * t499 * t1203 + 3/8 * t1219 * t1213 * t1188 * t2 * t1181 - 3/16 * t1244 * t1237 + 3/16 * t1249 * t1237) * t1180
    t1253 = t214 - psil + psig
    t1254 = cos(t1253)
    t1255 = IMy * t960
    t1256 = t482 * t1255
    t1259 = 2 * IMx * t377 * t932
    t1260 = t1256 - t1259
    t1262 = sdelta * t1260 * t1059
    t1263 = t952 * t383
    t1266 = t155 - t1194
    t1267 = 0.1e1 / t1266
    t1270 = t495 * t85 * t1267 * t935 * t78
    t1275 = t953 * t749
    t1279 = t323 * t404 * t1267 * t945
    t1282 = t945 * t133
    t1283 = t1282 * t929
    t1287 = t263 * t1217 * t116 * t1267
    t1290 = t155 * t234
    t1291 = 3 * t1290
    t1293 = 3 * q * t1194
    t1294 = t156 - t1291 + t1293 - t1224
    t1295 = IMy * t1294
    t1296 = t482 * t1295
    t1297 = t156 + t1291 + t1293 + t1224
    t1300 = 2 * IMx * t1297 * t377
    t1304 = t462 * t2 * (t1296 - t1300) * t1222
    t1305 = t935 * t110
    t1306 = t1266 ^ 2
    t1307 = 0.1e1 / t1306
    t1310 = t1243 * t141 * t1307 * t1305
    t1315 = t922 * t101 * t1307 * t1305
    contr[31] = (-3/8 * t1270 * t1263 * t1262 - 3/16 * t1279 * t1275 * t1260 * t104 * t1059 + 3/8 * t1287 * t1283 * t1262 - 3/16 * t1310 * t1304 - 3/16 * t1315 * t1304) * t1254
    t1319 = t214 + psil - psig
    t1320 = cos(t1319)
    t1322 = (t1256 + t1259) * muM
    t1323 = sdelta * t229
    t1324 = t1323 * t1322
    t1328 = t104 * t229
    t1339 = t462 * t499
    t1340 = t1339 * t1323 * (t1296 + t1300) * muM
    contr[32] = (-3/8 * t1270 * t1263 * t1324 - 3/16 * t1279 * t1275 * t1328 * t1322 + 3/8 * t1287 * t1283 * t1324 - 3/16 * t1310 * t1340 - 3/16 * t1315 * t1340) * t1320
    t1346 = t214 + psil + psig
    t1347 = cos(t1346)
    t1348 = t1184 + t1187
    t1349 = t75 * t1348
    t1367 = t1339 * (t1230 + t1233) * sdelta * t1059
    contr[33] = (-3/8 * t1200 * t1349 * t1182 * t1181 + 3/16 * t1209 * t110 * t1349 * t499 * t1203 + 3/8 * t1219 * t1213 * t1348 * t2 * t1181 - 3/16 * t1244 * t1367 + 3/16 * t1249 * t1367) * t1347
    t1373 = t214 + t149 - psig
    t1374 = cos(t1373)
    contr[34] = t1178 * t1374
    t1375 = t214 + t149 + psig
    t1376 = cos(t1375)
    contr[35] = t1155 * t1376
    t1377 = t214 + t291 + psig
    t1378 = cos(t1377)
    contr[36] = -t1112 * t1378
    t1380 = -psig - t763 + t214
    t1381 = cos(t1380)
    t1382 = t1059 * t766
    t1383 = t298 * t1382
    t1384 = t1290 - 1
    t1385 = 0.1e1 / t1384
    t1386 = 2 * npsil
    t1387 = t1386 + npsig
    t1388 = 1 / t1387
    t1391 = t242 * t1388 * t1385 * t79
    t1394 = t1073 * t766
    t1395 = t1077 * t1394
    t1397 = t1387 ^ 2
    t1398 = 1 / t1397
    t1402 = t323 * t116 * t10 * t1398 * t1385 * t110
    t1405 = t1090 * t1382
    t1408 = t263 * t254 * t1398 * t1385
    t1411 = t1290 + 1
    t1413 = t1411 * t229 * t775
    t1418 = t1384 ^ 2
    t1419 = 0.1e1 / t1418
    t1423 = t471 * t141 * t1388 * t1419 * t110
    t1426 = IMz * t1411
    t1429 = t1388 * t1419
    t1431 = t283 * t1429 * t133
    t1434 = 3/8 * t1391 * t1383 - 3/8 * t1402 * t1395 - 3/8 * t1408 * t1405 + 3/8 * t1423 * t75 * t226 * t8 * t311 * t1413 - 3/16 * t1431 * t1099 * t1426 * t1382
    contr[37] = t1434 * t1381
    t1435 = -psig + t763 + t214
    t1436 = cos(t1435)
    t1437 = -t234 + t155
    t1438 = 0.1e1 / t1437
    t1439 = -t1386 + npsig
    t1440 = 1 / t1439
    t1443 = t242 * t1440 * t1438 * t79
    t1447 = t1439 ^ 2
    t1448 = 1 / t1447
    t1450 = t116 * t10 * t1448
    t1452 = t323 * t1450 * t1438 * t110
    t1457 = t263 * t254 * t1448 * t1438
    t1461 = t155 + t234
    t1466 = t1437 ^ 2
    t1467 = 0.1e1 / t1466
    t1469 = t141 * t1440
    t1471 = t471 * t1469 * t1467 * t110
    t1474 = t1461 * t8
    t1480 = t283 * t1440 * t1467 * t133
    t1483 = -3/8 * t1443 * t1383 - 3/8 * t1452 * t1395 + 3/8 * t1457 * t1405 - 3/8 * t1471 * t75 * t226 * t1461 * t269 * t248 * t775 - 3/16 * t1480 * t226 * t1474 * t311 * t1382
    contr[38] = t1483 * t1436
    t1484 = psig - t763 + t214
    t1485 = cos(t1484)
    contr[39] = -t1483 * t1485
    t1487 = psig - t763 - psih
    t1488 = cos(t1487)
    t1489 = t230 * t450
    t1490 = IMz * t595
    t1491 = t593 * t1490
    t1492 = t1491 * t1489
    t1495 = IMz * t602
    t1499 = t75 * t592 * t88 * t642
    t1500 = t1499 * t1495 * t450
    t1503 = t602 * t450
    t1506 = t110 * t75 * t592 * t296
    t1507 = t1506 * t1503
    t1512 = t75 * t592 * t1461 * t269
    t1517 = t592 * t1474 * t311
    contr[40] = (3/8 * t1443 * t1492 + 3/8 * t1452 * t1500 - 3/8 * t1457 * t1507 + 3/8 * t1471 * t1512 * t609 + 3/16 * t1480 * t1517 * t1503) * t1488
    t1522 = psig - t763 + psih
    t1523 = cos(t1522)
    t1524 = IMz * t616
    t1526 = t593 * t1524 * t1489
    t1529 = t616 * t229
    t1532 = t1499 * IMz * t1529 * t450
    t1535 = t1529 * t450
    t1536 = t1506 * t1535
    contr[41] = (-3/8 * t1443 * t1526 - 3/8 * t1452 * t1532 + 3/8 * t1457 * t1536 - 3/8 * t1471 * t1512 * t626 - 3/16 * t1480 * t1517 * t1535) * t1523
    t1546 = psig + t763 + t214
    t1547 = cos(t1546)
    contr[42] = -t1434 * t1547
    t1549 = -psih + t214 - psig
    t1550 = cos(t1549)
    t1551 = t49 * t676
    t1554 = t49 * t678
    t1557 = t33 * (-2 * t699 - 2 * t1554)
    t1558 = t43 * (t578 + t1551) + t1557 + t698
    t1559 = t1558 * t12
    t1560 = t10 * t1559
    t1568 = t1558 * t98
    t1571 = t267 * t229
    contr[43] = (3/16 * t243 * t626 * t1560 - 3/16 * t264 * t249 * t621 * t1559 - 3/32 * t284 * t1571 * t228 * t616 * t8 * t1568) * t1550
    t1577 = -psih + t214 + psig
    t1578 = cos(t1577)
    t1582 = t595 * muM
    t1588 = t1571 * t1490
    contr[44] = (-3/16 * t243 * t609 * t1560 + 3/16 * t264 * t249 * t1582 * t1559 + 3/32 * t284 * t1588 * t409 * t1568) * t1578
    t1593 = -psih + psig - psil
    t1594 = cos(t1593)
    t1595 = t787 * t1255
    t1597 = IMx * t705 * t932
    t1604 = t797 * t1255
    t1606 = IMx * t738 * t932
    t1609 = (-t1604 + t1606) * t229 * t1582
    t1611 = t110 * t75 * t104
    t1612 = t1611 * t499
    t1620 = t98 * t229 * t1582
    t1621 = t797 * t1295
    t1623 = IMx * t738 * t1297
    t1627 = t462 * t2 * (-t1621 + t1623) * t1620
    contr[45] = (3/8 * t1270 * t1263 * (-t1595 + t1597) * t229 * t1582 + 3/16 * t1279 * t1612 * t1609 - 3/8 * t1287 * t1283 * t1609 + 3/16 * t1310 * t1627 + 3/16 * t1315 * t1627) * t1594
    t1633 = -psih + psig + psil
    t1634 = cos(t1633)
    t1635 = t1003 * IMy
    t1636 = t787 * t1635
    t1638 = t980 * IMx * t705
    t1645 = t797 * t1635
    t1646 = IMx * t738
    t1647 = t980 * t1646
    t1650 = t229 * (t1645 + t1647) * t1582
    t1654 = t1213 * t929
    t1658 = t797 * t1229
    t1659 = t1231 * t1646
    t1663 = t462 * (t1658 + t1659) * t2 * t1620
    contr[46] = (-3/8 * t1200 * t1263 * t229 * (t1636 + t1638) * t1582 + 3/16 * t1209 * t1612 * t1650 + 3/8 * t1219 * t1654 * t1650 - 3/16 * t1244 * t1663 + 3/16 * t1249 * t1663) * t1634
    t1669 = -psih + psig + t763
    t1670 = cos(t1669)
    t1677 = t1411 * t595
    t1678 = t1677 * t1059
    t1685 = t592 * t269
    contr[47] = (-3/8 * t1391 * t1492 + 3/8 * t1402 * t1500 + 3/8 * t1408 * t1507 - 3/8 * t1423 * t75 * t592 * t8 * t311 * t1678 + 3/16 * t1431 * t1685 * t1426 * t1503) * t1670
    t1691 = -psih - t291 + psig
    t1692 = cos(t1691)
    t1694 = t1491 * t230 * t309
    t1695 = t300 - t234
    t1696 = 0.1e1 / t1695
    t1697 = -t1065 + npsig
    t1698 = 1 / t1697
    t1701 = t242 * t1698 * t1696 * t79
    t1705 = t1499 * t1495 * t309
    t1706 = t1696 * t110
    t1707 = t1697 ^ 2
    t1708 = 1 / t1707
    t1710 = t116 * t10 * t1708
    t1712 = t323 * t1710 * t1706
    t1715 = t602 * t309
    t1716 = t1506 * t1715
    t1719 = t263 * t254 * t1708 * t1696
    t1722 = t300 + t234
    t1723 = t155 * t1722
    t1726 = t1685 * t1490 * t1059 * t1723
    t1727 = t1695 ^ 2
    t1730 = t1698 / t1727 * t133
    t1731 = t351 * t1730
    t1734 = t283 * t1730
    contr[48] = (3/8 * t1701 * t1694 + 3/4 * t1712 * t1705 - 3/8 * t1719 * t1716 + 3/4 * t1731 * t1726 + 3/16 * t1734 * t1726) * t1692
    t1738 = -psih - t149 + psig
    t1739 = cos(t1738)
    t1740 = t596 * t1059
    t1741 = 2 * t583
    t1749 = t686 + 2 * t56 * t23 * (t45 - t1741) + (2 * t63 + 2 * t219) * t50
    t1750 = t1749 * IMy
    t1752 = t871 * t1750 * t1740
    t1755 = t101 * muM
    t1756 = t602 * t1755
    t1758 = t886 * t1750 * t1756
    t1762 = IMy * t595 * t1059
    t1765 = t900 * t12 * t1749 * t1762
    t1769 = t602 * t908 * muM
    t1770 = t911 * t1750
    t1771 = t1770 * t1769
    contr[49] = (-3/8 * t881 * t1752 - 9/16 * t894 * t1758 + 3/8 * t905 * t1765 - 9/16 * t918 * t1771 - 3/16 * t923 * t1771) * t1739
    t1777 = -psih + t149 + psig
    t1778 = cos(t1777)
    t1787 = t1770 * t1042 * t595 * t1059
    contr[50] = (-3/8 * t1027 * t1752 + 9/16 * t1035 * t1758 + 3/8 * t1039 * t1765 - 9/16 * t1050 * t1787 + 3/16 * t1053 * t1787) * t1778
    t1793 = -psih + t291 + psig
    t1794 = cos(t1793)
    t1801 = t229 * t592
    t1802 = t1801 * t309
    t1803 = t595 * t1097
    t1804 = t8 * t311
    t1806 = t1804 * t1803 * t1802
    contr[51] = (-3/8 * t1070 * t1694 + 3/4 * t1085 * t1705 + 3/8 * t1094 * t1716 - 3/4 * t1106 * t1806 + 3/16 * t1109 * t1806) * t1794
    t1812 = psih + t214 - psig
    t1813 = cos(t1812)
    t1815 = 8 * t579
    t1821 = t33 * (-t700 - 8 * t701 + 2 * t1554)
    t1826 = t43 * (t578 - t1551 - t1815) + t1821 + (2 * t677 - 6 * t679) * t54
    t1827 = t595 * t1826
    t1832 = muM * t12
    t1837 = t1826 * muM
    contr[52] = (-3/16 * t243 * t248 * t1827 * muM * t383 + 3/16 * t264 * t249 * t1827 * t1832 + 3/32 * t284 * t1588 * t1837 * t269) * t1813
    t1843 = psih + t214 + psig
    t1844 = cos(t1843)
    t1850 = t616 * t12
    t1856 = IMz * t1826
    contr[53] = (3/16 * t243 * t248 * t1837 * t616 * t383 - 3/16 * t264 * t249 * t1837 * t1850 - 3/32 * t284 * t1571 * t1856 * t621 * t269) * t1844
    t1862 = psih + psig - psil
    t1863 = cos(t1862)
    t1872 = t616 * (t1604 + t1606) * t1059
    t1882 = t1339 * t1529 * (t1621 + t1623) * muM
    contr[54] = (-3/8 * t1270 * t1263 * t616 * (t1595 + t1597) * t1059 - 3/16 * t1279 * t1612 * t1872 + 3/8 * t1287 * t1283 * t1872 - 3/16 * t1310 * t1882 - 3/16 * t1315 * t1882) * t1863
    t1888 = psih + psig + psil
    t1889 = cos(t1888)
    t1898 = t616 * (-t1645 + t1647) * t1059
    t1908 = t1339 * (-t1658 + t1659) * t616 * t1059
    contr[55] = (3/8 * t1200 * t1263 * t616 * (-t1636 + t1638) * t1059 - 3/16 * t1209 * t1612 * t1898 - 3/8 * t1219 * t1654 * t1898 + 3/16 * t1244 * t1908 - 3/16 * t1249 * t1908) * t1889
    t1914 = psih + psig + t763
    t1915 = cos(t1914)
    t1922 = t592 * muM
    t1924 = t779 * t1426
    t1929 = t1411 * t616
    t1930 = t1804 * t1929
    contr[56] = (3/8 * t1391 * t1526 - 3/8 * t1402 * t1532 - 3/8 * t1408 * t1536 + 3/8 * t1423 * t1924 * t1529 * t1922 - 3/16 * t1431 * t1930 * t1801 * t450) * t1915
    t1935 = psih - t291 + psig
    t1936 = cos(t1935)
    t1937 = t616 * t10
    t1938 = t296 * t1937
    t1939 = t1938 * t1802
    t1944 = t88 * t104
    t1945 = t75 * t1944
    t1946 = t1945 * t311
    t1947 = t1946 * t616 * t1801 * t309
    t1950 = t75 * t12
    t1951 = t110 * t1950
    t1952 = t1951 * t1524
    t1953 = t1952 * t1802
    t1957 = t1804 * t1529
    t1958 = t1957 * t1922 * t1723
    contr[57] = (-3/8 * t1701 * t1939 - 3/4 * t1712 * t1947 + 3/8 * t1719 * t1953 - 3/4 * t1731 * t1958 - 3/16 * t1734 * t1958) * t1936
    t1964 = psih - t149 + psig
    t1965 = cos(t1964)
    t1966 = muM * t1749
    t1968 = IMy * t616
    t1970 = t871 * t1968 * t230 * t1966
    t1974 = t886 * t1968
    t1975 = t1974 * t884 * t1966
    t1978 = t1529 * t1966
    t1979 = t12 * IMy
    t1980 = t900 * t1979
    t1981 = t1980 * t1978
    t1986 = t911 * t1968 * t909 * t1966
    contr[58] = (-3/8 * t881 * t1970 - 9/16 * t894 * t1975 + 3/8 * t905 * t1981 - 9/16 * t918 * t1986 - 3/16 * t923 * t1986) * t1965
    t1992 = psih + t149 + psig
    t1993 = cos(t1992)
    t2001 = t911 * IMy * t1042
    t2002 = t2001 * t1978
    contr[59] = (-3/8 * t1027 * t1970 + 9/16 * t1035 * t1975 + 3/8 * t1039 * t1981 - 9/16 * t1050 * t2002 + 3/16 * t1053 * t2002) * t1993
    t2008 = psih + t291 + psig
    t2009 = cos(t2008)
    t2018 = t1804 * t616 * t1097 * t1802
    contr[60] = (3/8 * t1070 * t1939 - 3/4 * t1085 * t1947 - 3/8 * t1094 * t1953 + 3/4 * t1106 * t2018 - 3/16 * t1109 * t2018) * t2009
    t2024 = -t291 + t214 - psih
    t2025 = cos(t2024)
    t2026 = t1558 * sdelta
    t2028 = t383 * t228
    t2032 = t155 * t88
    t2034 = t643 * t228
    t2039 = t49 * t35 * t167
    t2040 = 2 * t654
    t2041 = 2 * t657
    t2042 = 2 * t659
    t2044 = 2 * t335 * t181
    t2051 = 3/32 * t305 * t2028 * t155 * t2026 - 3/64 * t324 * t2034 * t2032 * t2026 + 3/16 * t352 * t669 * t309 * (t648 + t2039 + t2040 + t2041 - t2042 - t2044) * sdelta
    contr[61] = t2051 * t2025
    t2052 = -t291 + t214 + psih
    t2053 = cos(t2052)
    t2054 = t383 * t1856
    t2058 = t643 * t1856
    t2070 = -3/32 * t305 * t2054 * t634 + 3/64 * t324 * t2058 * t641 - 3/16 * t352 * t669 * (t648 - t2039 - 8 * t651 + t2040 - t658 - t2042 - 8 * t661 + t2044) * muM * t633
    contr[62] = t2070 * t2053
    t2071 = -t291 + psig + t214
    t2072 = cos(t2071)
    t2082 = t1099 * t248 * t309 * sdelta * t1722
    t2087 = 3/8 * t1701 * t1061 + 3/4 * t1712 * t1078 - 3/8 * t1719 * t1091 + 3/4 * t1731 * t2082 + 3/16 * t1734 * t2082
    contr[63] = t2087 * t2072
    t2088 = -t149 + t214 - psih
    t2089 = cos(t2088)
    t2090 = Q2 * t676
    t2092 = 2 * t2090 + 2 * t690
    t2097 = t35 * t23 * t66 + t33 * t2092 + t66 * t50
    t2100 = t100 * t359 * t2097 * t481
    t2101 = t49 * t44
    t2106 = 2 * t63 + 2 * t65
    t2110 = t1557 + t648 + t35 * t23 * (t2101 + t58) + 2 * t56 * t23 * t2106 - t734 - t2041
    t2112 = t370 * t2110 * t371
    t2114 = (t2100 + t2112) * muM
    t2120 = t133 * t749
    t2126 = t100 * t411 * t2097 * t509
    t2128 = t419 * t2110 * t421
    t2131 = t151 * t8
    contr[64] = (t395 * t712 * t151 * t2114 / 8 - t406 * t2120 * t558 * t2114 / 16 + 3/16 * t433 * t2120 * t2131 * muM * (t2126 + t2128)) * t2089
    t2137 = -t149 + t214 + psih
    t2138 = cos(t2137)
    t2142 = t33 * (2 * t2090 - 8 * t687 - t691)
    t2148 = t2142 + t35 * t23 * (6 * t63 + t65) + 8 * t716 - t725 - t718
    t2151 = t100 * t359 * t2148 * t481
    t2152 = IMx * t371
    t2160 = t1821 + t648 + t35 * t23 * (-t2101 + t58) - 2 * t56 * t23 * t2106 - t734 - t2041
    t2162 = t80 * t2160 * t2152
    t2164 = (t2151 + t2162) * sdelta
    t2165 = t85 * t10
    t2170 = t563 * t398
    t2177 = t100 * t411 * t2148 * t509
    t2178 = IMx * t421
    t2180 = t418 * t2160 * t2178
    contr[65] = (-t395 * t2165 * t2164 * t843 / 8 + t406 * t133 * t2164 * t2170 / 16 - 3/16 * t433 * t2120 * t151 * (t2177 + t2180) * t409) * t2138
    t2188 = -t763 + t214 - psih
    t2189 = cos(t2188)
    t2194 = q * t88
    t2202 = t75 * t80 * t8 * t311
    t2206 = 3/16 * t447 * t2028 * q * t2026 - 3/32 * t455 * t2034 * t2194 * t2026 + 3/16 * t472 * t2202 * t127 * t2026
    contr[66] = t2206 * t2189
    t2207 = -t763 + t214 + psih
    t2208 = cos(t2207)
    t2220 = -3/16 * t447 * t2054 * t767 + 3/32 * t455 * t2058 * t771 - 3/16 * t472 * t2202 * t126 * t1826 * t775
    contr[67] = t2220 * t2208
    t2221 = -psil + t214 - psih
    t2222 = cos(t2221)
    t2223 = t100 * t2097
    t2224 = t2223 * t481
    t2225 = IMx * t2110
    t2226 = t80 * t2225
    t2228 = (t2224 + t2226) * muM
    t2233 = t2 * t104
    t2238 = t499 * t409
    t2239 = t2223 * t509
    t2240 = t418 * t2225
    contr[68] = (3/8 * t496 * t793 * t2 * t2228 - 3/16 * t506 * t2120 * t2233 * t2228 + 3/16 * t521 * t133 * sdelta * (t2239 + t2240) * t2238) * t2222
    t2248 = -psil + t214 + psih
    t2249 = cos(t2248)
    t2250 = t100 * t2148
    t2251 = t2250 * t481
    t2252 = t2160 * IMx
    t2253 = t80 * t2252
    t2255 = (t2251 + t2253) * sdelta
    t2256 = t75 * t10
    t2265 = t2250 * t509
    t2266 = t418 * t2252
    contr[69] = (-3/8 * t496 * t2256 * t2255 * t479 + 3/16 * t506 * t133 * t2255 * t500 - 3/16 * t521 * t133 * sdelta * (t2265 + t2266) * t2238) * t2249
    t2274 = psil + t214 - psih
    t2275 = cos(t2274)
    t2277 = (-t2224 + t2226) * muM
    contr[70] = (-3/8 * t496 * t793 * t2 * t2277 + 3/16 * t506 * t2120 * t2233 * t2277 - 3/16 * t521 * t133 * sdelta * (-t2239 + t2240) * t2238) * t2275
    t2293 = psil + t214 + psih
    t2294 = cos(t2293)
    t2296 = (-t2251 + t2253) * sdelta
    contr[71] = (3/8 * t496 * t2256 * t2296 * t479 - 3/16 * t506 * t133 * t2296 * t500 + 3/16 * t521 * t133 * sdelta * (-t2265 + t2266) * t2238) * t2294
    t2312 = t763 + t214 - psih
    t2313 = cos(t2312)
    contr[72] = -t2206 * t2313
    t2315 = t763 + t214 + psih
    t2316 = cos(t2315)
    contr[73] = -t2220 * t2316
    t2318 = t149 + t214 - psih
    t2319 = cos(t2318)
    t2321 = (-t2100 + t2112) * sdelta
    contr[74] = (-t395 * t2165 * t2321 * t843 / 8 + t406 * t133 * t2321 * t2170 / 16 - 3/16 * t433 * t2120 * t2131 * (-t2126 + t2128) * muM) * t2319
    t2337 = t149 + t214 + psih
    t2338 = cos(t2337)
    t2339 = -t2151 + t2162
    contr[75] = (t395 * t712 * t2339 * t358 / 8 - t406 * t2120 * t2339 * t151 * t398 / 16 + 3/16 * t433 * t2120 * t2131 * muM * (-t2177 + t2180)) * t2338
    t2356 = t291 + t214 - psih
    t2357 = cos(t2356)
    contr[76] = -t2051 * t2357
    t2359 = t291 + t214 + psih
    t2360 = cos(t2359)
    contr[77] = -t2070 * t2360
    t2362 = t291 - psig + t214
    t2363 = cos(t2362)
    contr[78] = -t2087 * t2363
    t2365 = t214 - psih - t291 + psig
    t2366 = cos(t2365)
    t2367 = t155 * t1558
    t2368 = t1059 * t2367
    t2369 = t296 * t596
    t2370 = t2369 * t2368
    t2373 = t595 * t1059
    t2375 = t1946 * t2373 * t2367
    t2378 = t1951 * t1490
    t2379 = t2378 * t2368
    t2383 = t309 * t1722 * t1558
    t2384 = t1804 * t602
    t2385 = t2384 * t2383
    contr[79] = (3/16 * t1701 * t2370 + 3/8 * t1712 * t2375 - 3/16 * t1719 * t2379 + 3/8 * t1731 * t2385 + 3/32 * t1734 * t2385) * t2366
    t2391 = t214 - psih + t291 - psig
    t2392 = cos(t2391)
    t2393 = t1938 * t2368
    t2396 = t616 * t1059
    t2398 = t1946 * t2396 * t2367
    t2401 = t1952 * t2368
    t2404 = t1957 * t2383
    contr[80] = (-3/16 * t1701 * t2393 - 3/8 * t1712 * t2398 + 3/16 * t1719 * t2401 - 3/8 * t1731 * t2404 - 3/32 * t1734 * t2404) * t2392
    t2410 = t214 + psih - t291 + psig
    t2411 = cos(t2410)
    t2412 = t229 * t1826
    t2413 = t2412 * t309
    t2414 = t1938 * t2413
    t2417 = t616 * t2412
    t2419 = t1946 * t2417 * t309
    t2422 = t1952 * t2413
    t2425 = t1837 * t1723
    t2426 = t1957 * t2425
    contr[81] = (-3/16 * t1701 * t2414 - 3/8 * t1712 * t2419 + 3/16 * t1719 * t2422 - 3/8 * t1731 * t2426 - 3/32 * t1734 * t2426) * t2411
    t2432 = t214 + psih + t291 - psig
    t2433 = cos(t2432)
    t2434 = t2369 * t2413
    t2437 = t595 * t2412
    t2439 = t1946 * t2437 * t309
    t2442 = t2378 * t2413
    t2445 = t2384 * t2425
    contr[82] = (3/16 * t1701 * t2434 + 3/8 * t1712 * t2439 - 3/16 * t1719 * t2442 + 3/8 * t1731 * t2445 + 3/32 * t1734 * t2445) * t2433
    t2451 = -psig + t763 + t214 - psih
    t2452 = cos(t2451)
    t2453 = q * t1558
    t2454 = t1059 * t2453
    t2455 = t1938 * t2454
    t2459 = t1946 * t2396 * t2453
    t2462 = t1952 * t2454
    t2465 = muM * t1558
    t2466 = t1529 * t2465
    t2468 = t779 * IMz * t1461
    t2472 = t1461 * t616
    t2473 = t1804 * t2472
    contr[83] = (-3/16 * t1443 * t2455 - 3/16 * t1452 * t2459 + 3/16 * t1457 * t2462 - 3/16 * t1471 * t2468 * t2466 - 3/32 * t1480 * t2473 * t2454) * t2452
    t2478 = -psig + t763 + t214 + psih
    t2479 = cos(t2478)
    t2480 = t2412 * t450
    t2481 = t2369 * t2480
    t2485 = t1946 * t2437 * t450
    t2488 = t2378 * t2480
    t2491 = t602 * t1837
    t2495 = t1461 * t595
    t2496 = t1804 * t2495
    contr[84] = (3/16 * t1443 * t2481 + 3/16 * t1452 * t2485 - 3/16 * t1457 * t2488 + 3/16 * t1471 * t2468 * t2491 + 3/32 * t1480 * t2496 * t2480) * t2479
    t2501 = psig - t763 + t214 - psih
    t2502 = cos(t2501)
    t2503 = t2369 * t2454
    t2507 = t1946 * t2373 * t2453
    t2510 = t2378 * t2454
    t2513 = t602 * t2465
    contr[85] = (3/16 * t1443 * t2503 + 3/16 * t1452 * t2507 - 3/16 * t1457 * t2510 + 3/16 * t1471 * t2468 * t2513 + 3/32 * t1480 * t2496 * t2454) * t2502
    t2521 = psig - t763 + t214 + psih
    t2522 = cos(t2521)
    t2523 = t1938 * t2480
    t2527 = t1946 * t2417 * t450
    t2530 = t1952 * t2480
    t2533 = t1529 * t1837
    contr[86] = (-3/16 * t1443 * t2523 - 3/16 * t1452 * t2527 + 3/16 * t1457 * t2530 - 3/16 * t1471 * t2468 * t2533 - 3/32 * t1480 * t2473 * t2480) * t2522
    t2541 = -psih + t214 - psig - t763
    t2542 = cos(t2541)
    contr[87] = (3/16 * t1391 * t2455 - 3/16 * t1402 * t2459 - 3/16 * t1408 * t2462 + 3/16 * t1423 * t1924 * t2466 - 3/32 * t1431 * t1930 * t2454) * t2542
    t2556 = -psih + t214 + psig + t763
    t2557 = cos(t2556)
    t2569 = t8 * t1411 * t98 * t1490
    contr[88] = (-3/16 * t1391 * t2503 + 3/16 * t1402 * t2507 + 3/16 * t1408 * t2510 - 3/16 * t1423 * t1924 * t2513 + 3/32 * t1431 * t2569 * t2454) * t2557
    t2574 = psih + t214 - psig - t763
    t2575 = cos(t2574)
    contr[89] = (-3/16 * t1391 * t2481 + 3/16 * t1402 * t2485 + 3/16 * t1408 * t2488 - 3/16 * t1423 * t1924 * t2491 + 3/32 * t1431 * t2569 * t2480) * t2575
    t2589 = psih + t214 + psig + t763
    t2590 = cos(t2589)
    contr[90] = (3/16 * t1391 * t2523 - 3/16 * t1402 * t2527 - 3/16 * t1408 * t2530 + 3/16 * t1423 * t1924 * t2533 - 3/32 * t1431 * t1930 * t2480) * t2590
    t2604 = psih + t214 - t291 - psig
    t2605 = cos(t2604)
    t2613 = t1837 * t155 * t1097
    t2614 = t2384 * t2613
    contr[91] = (-3/16 * t1070 * t2434 + 3/8 * t1085 * t2439 + 3/16 * t1094 * t2442 - 3/8 * t1106 * t2614 + 3/32 * t1109 * t2614) * t2605
    t2620 = psih + t214 + t291 + psig
    t2621 = cos(t2620)
    t2628 = t1957 * t2613
    contr[92] = (3/16 * t1070 * t2414 - 3/8 * t1085 * t2419 - 3/16 * t1094 * t2422 + 3/8 * t1106 * t2628 - 3/32 * t1109 * t2628) * t2621
    t2634 = -t291 - psig + t214 - psih
    t2635 = cos(t2634)
    t2643 = t309 * t1097 * t1558
    t2644 = t1957 * t2643
    contr[93] = (3/16 * t1070 * t2393 - 3/8 * t1085 * t2398 - 3/16 * t1094 * t2401 + 3/8 * t1106 * t2644 - 3/32 * t1109 * t2644) * t2635
    t2650 = -t149 - psig + t214 - psih
    t2651 = cos(t2650)
    t2658 = t54 * (-t1551 - t684) - t33 * t2092 - t43 * t681
    t2659 = t616 * t2658
    t2661 = t871 * t11
    t2662 = t2661 * t2659 * t1059
    t2669 = 2 * t45
    t2676 = t717 + 2 * t56 * t23 * (t45 - t58 - t1741) + 2 * t56 * t23 * (-t2669 - t2101 + t1741) - (t36 + t50) * t588
    t2677 = t2676 * t229
    t2679 = t1974 * t2677 * t1755
    t2682 = t616 * t2676
    t2683 = t2682 * t1059
    t2684 = t1980 * t2683
    t2687 = t2001 * t2683
    contr[94] = (-3/16 * t1027 * t2662 + 9/32 * t1035 * t2679 + 3/16 * t1039 * t2684 - 9/32 * t1050 * t2687 + 3/32 * t1053 * t2687) * t2651
    t2693 = -t149 - psig + t214 + psih
    t2694 = cos(t2693)
    t2701 = t54 * (t1551 + t1815 - t684) + t2142 + (6 * t677 - 2 * t679) * t43
    t2703 = t2701 * t151 * t1979
    t2704 = t2703 * t1740
    t2717 = t717 + 2 * t56 * t23 * (t45 + t58 - t1741) + 2 * t56 * t23 * (t2669 - t2101 - t1741) + (t36 - t50) * t588
    t2720 = t104 * t2717 * t151 * t129
    t2721 = t2720 * t1756
    t2726 = t110 * t75 * t2717 * t871
    t2727 = t2726 * t1762
    t2732 = t8 * t1042 * t2717 * t563
    t2733 = t2732 * t1762
    contr[95] = (-3/16 * t1027 * t2704 + 9/32 * t1035 * t2721 + 3/16 * t1039 * t2727 - 9/32 * t1050 * t2733 + 3/32 * t1053 * t2733) * t2694
    t2739 = -t149 + psig + t214 - psih
    t2740 = cos(t2739)
    t2743 = t2661 * t2658 * t595 * t1059
    t2748 = t886 * IMy * t2676 * t1756
    t2752 = t2676 * t595 * t1059
    t2753 = t1980 * t2752
    t2758 = t8 * t908 * t151 * t129
    t2759 = t2758 * t2752
    contr[96] = (-3/16 * t881 * t2743 - 9/32 * t894 * t2748 + 3/16 * t905 * t2753 - 9/32 * t918 * t2759 - 3/32 * t923 * t2759) * t2740
    t2765 = -t149 + psig + t214 + psih
    t2766 = cos(t2765)
    t2767 = t1937 * t1059
    t2768 = t2703 * t2767
    t2771 = t1529 * t1755
    t2772 = t2720 * t2771
    t2775 = t1968 * t1059
    t2776 = t2726 * t2775
    t2781 = t8 * t2717 * t908 * t563
    t2782 = t2781 * t2775
    contr[97] = (-3/16 * t881 * t2768 - 9/32 * t894 * t2772 + 3/16 * t905 * t2776 - 9/32 * t918 * t2782 - 3/32 * t923 * t2782) * t2766
    t2788 = -psil - psig + t214 - psih
    t2789 = cos(t2788)
    t2790 = t2223 * t1635
    t2792 = IMx * t2110 * t980
    t2793 = t2790 + t2792
    t2795 = t616 * t2793 * t1059
    t2801 = t98 * t616
    t2802 = t953 * t2801
    t2809 = t2097 * IMy
    t2811 = t100 * t1228 * t2809
    t2813 = IMx * t2110 * t1231
    t2817 = t1339 * t1529 * (t2811 + t2813) * muM
    contr[98] = (3/16 * t1200 * t1263 * t2795 - 3/32 * t1209 * t2802 * t2793 * t104 * t1059 - 3/16 * t1219 * t1654 * t2795 + 3/32 * t1244 * t2817 - 3/32 * t1249 * t2817) * t2789
    t2823 = -psil - psig + t214 + psih
    t2824 = cos(t2823)
    t2825 = t2250 * t1635
    t2826 = IMx * t980
    t2827 = t2160 * t2826
    t2829 = (t2825 + t2827) * muM
    t2830 = t602 * t2829
    t2836 = t953 * t98 * t595
    t2843 = t2250 * t1229
    t2844 = IMx * t1231
    t2845 = t2160 * t2844
    t2849 = t462 * (t2843 + t2845) * t2 * t1620
    contr[99] = (-3/16 * t1200 * t1263 * t2830 + 3/32 * t1209 * t2836 * t1328 * t2829 + 3/16 * t1219 * t1654 * t2830 - 3/32 * t1244 * t2849 + 3/32 * t1249 * t2849) * t2824
    t2855 = -psil + psig + t214 - psih
    t2856 = cos(t2855)
    t2857 = t100 * t960
    t2858 = t2857 * t2809
    t2860 = IMx * t2110 * t932
    t2862 = (t2858 + t2860) * muM
    t2863 = t602 * t2862
    t2874 = t2223 * t1295
    t2876 = IMx * t2110 * t1297
    t2880 = t1339 * (t2874 + t2876) * t595 * t1059
    contr[100] = (3/16 * t1270 * t1263 * t2863 + 3/32 * t1279 * t2836 * t1328 * t2862 - 3/16 * t1287 * t1283 * t2863 + 3/32 * t1310 * t2880 + 3/32 * t1315 * t2880) * t2856
    t2886 = -psil + psig + t214 + psih
    t2887 = cos(t2886)
    t2888 = t2250 * t1255
    t2889 = IMx * t932
    t2890 = t2160 * t2889
    t2892 = (t2888 + t2890) * muM
    t2893 = t1529 * t2892
    t2904 = t2801 * t1059
    t2905 = t2250 * t1295
    t2906 = IMx * t1297
    t2907 = t2160 * t2906
    t2911 = t462 * t2 * (t2905 + t2907) * t2904
    contr[101] = (-3/16 * t1270 * t1263 * t2893 - 3/32 * t1279 * t2802 * t1328 * t2892 + 3/16 * t1287 * t1283 * t2893 - 3/32 * t1310 * t2911 - 3/32 * t1315 * t2911) * t2887
    t2917 = psil - psig + t214 - psih
    t2918 = cos(t2917)
    t2920 = (-t2858 + t2860) * muM
    t2921 = t1529 * t2920
    t2935 = t1339 * t616 * (-t2874 + t2876) * t1059
    contr[102] = (-3/16 * t1270 * t1263 * t2921 - 3/32 * t1279 * t2802 * t1328 * t2920 + 3/16 * t1287 * t1283 * t2921 - 3/32 * t1310 * t2935 - 3/32 * t1315 * t2935) * t2918
    t2941 = psil - psig + t214 + psih
    t2942 = cos(t2941)
    t2943 = t12 * t595
    t2944 = t2943 * t1059
    t2945 = -t2888 + t2890
    t2946 = t75 * t2945
    t2952 = t595 * t104 * t1059
    t2966 = t462 * (-t2905 + t2907) * t2 * t1620
    contr[103] = (3/16 * t1270 * t2946 * t1182 * t2944 + 3/32 * t1279 * t110 * t2946 * t499 * t2952 - 3/16 * t1287 * t1282 * t2945 * t2 * t2944 + 3/32 * t1310 * t2966 + 3/32 * t1315 * t2966) * t2942
    t2972 = psil + psig + t214 - psih
    t2973 = cos(t2972)
    t2974 = -t2790 + t2792
    t2993 = t75 * (-t2811 + t2813) * t1002 * t1620
    contr[104] = (-3/16 * t1200 * t952 * t2974 * t10 * t2944 + 3/32 * t1209 * t953 * t2974 * t98 * t2952 + 3/16 * t1219 * t1213 * t2 * t2974 * t2944 - 3/32 * t1244 * t2993 + 3/32 * t1249 * t2993) * t2973
    t2999 = psil + psig + t214 + psih
    t3000 = cos(t2999)
    t3002 = (-t2825 + t2827) * muM
    t3003 = t1529 * t3002
    t3017 = t1339 * t616 * (-t2843 + t2845) * t1059
    contr[105] = (3/16 * t1200 * t1263 * t3003 - 3/32 * t1209 * t2802 * t1328 * t3002 - 3/16 * t1219 * t1654 * t3003 + 3/32 * t1244 * t3017 - 3/32 * t1249 * t3017) * t3000
    t3023 = t149 - psig + t214 - psih
    t3024 = cos(t3023)
    t3031 = t2758 * t2683
    contr[106] = (-3/16 * t881 * t2662 - 9/32 * t894 * t2679 + 3/16 * t905 * t2684 - 9/32 * t918 * t3031 - 3/32 * t923 * t3031) * t3024
    t3037 = t149 - psig + t214 + psih
    t3038 = cos(t3037)
    t3045 = t2781 * t1762
    contr[107] = (-3/16 * t881 * t2704 - 9/32 * t894 * t2721 + 3/16 * t905 * t2727 - 9/32 * t918 * t3045 - 3/32 * t923 * t3045) * t3038
    t3051 = t149 + psig + t214 - psih
    t3052 = cos(t3051)
    t3059 = t2001 * t2752
    contr[108] = (-3/16 * t1027 * t2743 + 9/32 * t1035 * t2748 + 3/16 * t1039 * t2753 - 9/32 * t1050 * t3059 + 3/32 * t1053 * t3059) * t3052
    t3065 = t149 + psig + t214 + psih
    t3066 = cos(t3065)
    t3073 = t2732 * t2775
    contr[109] = (-3/16 * t1027 * t2768 + 9/32 * t1035 * t2772 + 3/16 * t1039 * t2776 - 9/32 * t1050 * t3073 + 3/32 * t1053 * t3073) * t3066
    t3079 = t291 + psig + t214 - psih
    t3080 = cos(t3079)
    t3087 = t2384 * t2643
    contr[110] = (-3/16 * t1070 * t2370 + 3/8 * t1085 * t2375 + 3/16 * t1094 * t2379 - 3/8 * t1106 * t3087 + 3/32 * t1109 * t3087) * t3080
    t3093 = sin(psig)
    t3094 = t69 * sdelta
    t3103 = t267 * t98
    t3105 = t248 * t409
    contr[111] = (3/4 * t243 * t231 * t12 * t3094 - 3/4 * t264 * t249 * t1832 * t3094 - 3/8 * t284 * t3105 * t3103 * t3094) * t3093
    t3110 = sin(psil)
    t3111 = t69 * muM
    t3112 = t3111 * t3
    t3114 = t1950 * IMx * t10
    t3116 = 0.1e1 / t126
    t3118 = t85 * t82
    t3123 = t98 * IMx
    contr[112] = (-3/2 * t495 * t3118 * t3116 * t78 * t3114 * t3112 + 3/4 * t323 * t404 * t113 * t3116 * t1611 * t3123 * t3112 - 3/4 * t1243 * t468 / t413 * t110 * t779 * t370 * t3112) * t3110
    t3140 = sin(t763)
    t3142 = t296 * t10 * t69
    t3146 = IMz * t69
    t3147 = t643 * t3146
    contr[113] = (-3/4 * t447 * t3142 * t441 + 3/8 * t455 * t3147 * t451 - 3/4 * t472 * t2202 * t126 * t69 * t458) * t3140
    t3157 = sin(t149)
    t3160 = 0.1e1 / t201
    t3182 = t201 ^ 2
    contr[114] = (-t495 * t3118 * t3160 * t78 * t3114 * t3111 * t152 / 2 + t323 * t404 * t113 * t3160 * t1611 * t189 * t151 * t164 * IMx * muM / 12 - t1243 * t468 / t3182 * t110 * t8 * t75 * t157 * t189 * muM * t152 * t3123 / 4) * t3157
    t3190 = sin(t291)
    contr[115] = (-3/8 * t305 * t3142 * t295 + 3/16 * t324 * t3147 * t310 - t352 * t343 * t189 * t155 * t459 / 4) * t3190
    t3203 = sin(t215)
    t3205 = IMz * t10
    t3211 = t217 * t228
    t3212 = t1126 * t229
    t3217 = t749 * t228
    t3218 = t8 * t267
    t3223 = -3/8 * t243 * t366 * t229 * t3205 * muM * t217 + 3/8 * t264 * t237 * t3212 * t3211 + 3/16 * t284 * t3218 * t3212 * t3217
    contr[116] = t3223 * t3203
    t3224 = sin(t288)
    contr[117] = -t3223 * t3224
    t3226 = sin(t292)
    t3228 = t366 * t12 * t3205
    t3232 = t104 * t1138
    t3233 = t3232 * t2032
    t3245 = 3/16 * t305 * t3228 * t295 - 3/32 * t324 * t3233 * t459 + 3/8 * t351 * t348 * t205 * t75 * t342 * t1126 * t155 * t459
    contr[118] = t3245 * t3226
    t3246 = sin(t356)
    t3250 = 2 * t100 * t359 * t377 * t481
    t3252 = t366 * t80 * t2152
    t3253 = t3250 + t3252
    t3266 = 2 * t100 * t411 * t377 * t509
    t3268 = t366 * t418 * t2178
    contr[119] = (t395 * t385 * t3253 * t358 / 4 - t406 * t401 * t3253 * t151 * t398 / 8 + 3/8 * t433 * t401 * t151 * (t3266 + t3268) * t409) * t3246
    t3276 = sin(t438)
    t3280 = t3232 * t2194
    t3289 = 3/8 * t447 * t3228 * t441 - 3/16 * t455 * t3280 * t459 + 3/8 * t472 * t462 * t460 * t1126 * t459
    contr[120] = t3289 * t3276
    t3290 = sin(t476)
    t3291 = t100 * t377
    t3293 = 2 * t3291 * t481
    t3294 = t366 * t370
    t3296 = (t3293 + t3294) * muM
    t3299 = t2256 * cdelta * t12
    t3308 = 2 * t3291 * t509
    t3309 = t366 * t419
    contr[121] = (3/4 * t496 * t3299 * t2 * t3296 - 3/8 * t506 * t401 * t2233 * t3296 + 3/8 * t521 * t401 * t1002 * (t3308 + t3309) * muM) * t3290
    t3317 = sin(t525)
    t3318 = -t3293 + t3294
    contr[122] = (-3/4 * t496 * t3299 * t3318 * t478 + 3/8 * t506 * t401 * t3318 * t2 * t398 - 3/8 * t521 * t401 * (-t3308 + t3309) * t2 * t409) * t3317
    t3335 = sin(t547)
    contr[123] = -t3289 * t3335
    t3337 = sin(t550)
    t3338 = -t3250 + t3252
    contr[124] = (-t395 * t385 * t3338 * t358 / 4 + t406 * t401 * t3338 * t151 * t398 / 8 - 3/8 * t433 * t401 * (-t3266 + t3268) * t151 * t409) * t3337
    t3355 = sin(t572)
    contr[125] = -t3245 * t3355
    t3358 = sin(psig - t763)
    t3359 = t3142 * t1382
    t3362 = t1945 * t1001
    t3363 = t3362 * t1394
    t3366 = t1951 * t3146
    t3367 = t3366 * t1382
    t3370 = t1461 * sdelta
    t3372 = t779 * t3146
    t3377 = t8 * t1001
    t3378 = t3377 * t248
    contr[126] = (-3/4 * t1443 * t3359 - 3/4 * t1452 * t3363 + 3/4 * t1457 * t3367 - 3/4 * t1471 * t3372 * t1059 * t3370 - 3/8 * t1480 * t3378 * t450 * t3370) * t3358
    t3384 = sin(psig + t763)
    contr[127] = (3/4 * t1391 * t3359 - 3/4 * t1402 * t3363 - 3/4 * t1408 * t3367 + 3/4 * t1423 * t3372 * t1413 - 3/8 * t1431 * t3378 * t450 * t1411 * sdelta) * t3384
    t3400 = sin(t575)
    t3401 = t595 * t1749
    contr[128] = (3/8 * t243 * t231 * t12 * t3401 - 3/8 * t264 * t249 * t1832 * t3401 - 3/16 * t284 * t3105 * t3103 * t3401) * t3400
    t3415 = sin(t614)
    t3416 = t616 * t1749
    contr[129] = (3/8 * t243 * t231 * t12 * t3416 - 3/8 * t264 * t249 * t1832 * t3416 - 3/16 * t284 * t3105 * t3103 * t3416) * t3415
    t3430 = sin(t631)
    t3431 = t1749 * sdelta
    t3456 = -3/16 * t305 * t2028 * t155 * t3431 + 3/32 * t324 * t2034 * t155 * t1749 * t640 - t352 * t669 * t309 * (6 * t722 + 6 * t724 + 12 * t716 + 3 * t718 - 12 * t726 + 6 * t728 - 4 * t47 - 2 * t51 + 4 * t52) * sdelta / 8
    contr[130] = t3456 * t3430
    t3457 = sin(t674)
    t3460 = t100 * t359 * t705 * t481
    t3462 = t370 * t371 * t694
    t3471 = t100 * t359 * t738 * t481
    t3473 = t370 * t371 * t730
    t3482 = t100 * t411 * t738 * t509
    t3484 = t419 * t421 * t730
    contr[131] = (t395 * t2165 * (t3460 - t3462) * sdelta * t843 / 4 - t406 * t133 * t104 * (t3471 - t3473) * t750 / 8 + 3/8 * t433 * t133 * t8 * (t3482 - t3484) * t750) * t3457
    t3492 = sin(t764)
    t3506 = -3/8 * t447 * t2028 * q * t3431 + 3/16 * t455 * t2034 * q * t1749 * t640 - 3/8 * t472 * t2202 * t127 * t3431
    contr[132] = t3506 * t3492
    t3507 = sin(t785)
    t3508 = t100 * t705
    t3509 = t3508 * t481
    t3510 = IMx * t694
    t3511 = t80 * t3510
    t3519 = t100 * t738
    t3520 = t3519 * t481
    t3521 = IMx * t730
    t3522 = t80 * t3521
    t3529 = t3519 * t509
    t3530 = t418 * t3521
    contr[133] = (3/4 * t496 * t75 * (t3509 - t3511) * t844 * t479 - 3/8 * t506 * t133 * t104 * (t3520 - t3522) * t749 * t478 + 3/8 * t521 * t812 * t499 * (t3529 - t3530) * muM) * t3507
    t3538 = sin(t817)
    contr[134] = (3/4 * t496 * t793 * (t3509 + t3511) * t478 - 3/8 * t506 * t745 * t98 * (t3520 + t3522) * t478 + 3/8 * t521 * t812 * t98 * (t3529 + t3530) * t478) * t3538
    t3557 = sin(t838)
    contr[135] = -t3506 * t3557
    t3559 = sin(t841)
    contr[136] = (t395 * t2165 * (t3460 + t3462) * sdelta * t843 / 4 - t406 * t133 * t104 * (t3471 + t3473) * t750 / 8 + 3/8 * t433 * t812 * t98 * (t3482 + t3484) * t358) * t3559
    t3579 = sin(t864)
    contr[137] = -t3456 * t3579
    t3582 = sin(-t291 + psig)
    t3583 = t3142 * t1060
    t3586 = t3362 * t1074
    t3589 = t3366 * t1060
    t3592 = t1722 * t269
    t3594 = t3592 * t3146 * t1060
    contr[138] = (-3/4 * t1701 * t3583 - 3/2 * t1712 * t3586 + 3/4 * t1719 * t3589 - 3/2 * t1731 * t3594 - 3/8 * t1734 * t3594) * t3582
    t3600 = sin(t927)
    t3603 = t929 * t69 * IMx * t869
    t3604 = 0.1e1 / t960
    t3611 = IMx * t229 * t775
    t3614 = t75 * t2233 * t1001 * t3611
    t3622 = t954 * t3611
    t3624 = t89 * t254
    t3631 = t932 * t1002 * t1001 * t3611
    t3632 = t960 ^ 2
    t3634 = t935 / t3632
    contr[139] = (-3/4 * t1243 * t935 * t3604 * t79 * t3603 - 3/8 * t323 * t116 * t10 * t945 * t3604 * t110 * t3614 + 3/4 * t263 * t3624 * t945 * t3604 * t3622 - 3/8 * t1243 * t141 * t3634 * t133 * t3631 - 3/8 * t922 * t101 * t3634 * t133 * t3631) * t3600
    t3646 = sin(t977)
    t3647 = 0.1e1 / t1003
    t3668 = t2 * t980 * t8 * t1001 * t3611
    t3669 = t1003 ^ 2
    t3671 = t983 / t3669
    contr[140] = (3/4 * t1243 * t983 * t3647 * t79 * t3603 - 3/8 * t323 * t116 * t10 * t990 * t3647 * t110 * t3614 - 3/4 * t263 * t3624 * t990 * t3647 * t3622 + 3/8 * t1243 * t141 * t3671 * t133 * t3668 - 3/8 * t922 * t101 * t3671 * t133 * t3668) * t3646
    t3684 = sin(t291 + psig)
    t3692 = t3377 * t1098 * t1060
    contr[141] = (3/4 * t1070 * t3583 - 3/2 * t1085 * t3586 - 3/4 * t1094 * t3589 + 3/2 * t1106 * t3692 - 3/8 * t1109 * t3692) * t3684
    t3698 = sin(t1057)
    t3699 = t3228 * t1060
    t3703 = t229 * t749 * t228
    t3707 = t155 * t229
    t3709 = t1139 * t3707 * t3211
    t3715 = t8 * t1097 * t1126 * t3707 * t3217
    t3720 = -3/8 * t1070 * t3699 + 3/4 * t1085 * t3233 * t3703 + 3/8 * t1094 * t3709 - 3/4 * t1106 * t3715 + 3/16 * t1109 * t3715
    contr[142] = t3720 * t3698
    t3721 = sin(t1113)
    t3723 = t229 * t226 * t775
    t3724 = t2661 * t3723
    t3729 = t886 * t897
    t3730 = t3729 * t101 * t226 * t775
    t3733 = t1980 * t3723
    t3736 = t2001 * t3723
    t3741 = -3/8 * t1027 * t3724 + 9/16 * t1035 * t3730 + 3/8 * t1039 * t3733 - 9/16 * t1050 * t3736 + 3/16 * t1053 * t3736
    contr[143] = t3741 * t3721
    t3742 = sin(t1156)
    t3751 = t911 * t897
    t3752 = t3751 * t246 * t908 * sdelta
    t3757 = -3/8 * t881 * t3724 - 9/16 * t894 * t3730 + 3/8 * t905 * t3733 - 9/16 * t918 * t3752 - 3/16 * t923 * t3752
    contr[144] = t3757 * t3742
    t3758 = sin(t1179)
    t3760 = 2 * t3291 * t1635
    t3761 = t366 * t2826
    t3762 = t3760 + t3761
    t3779 = 2 * t3291 * t1229
    t3780 = t366 * t2844
    t3784 = t462 * t2 * (t3779 + t3780) * t1222
    contr[145] = (-3/8 * t1200 * t952 * t12 * t3762 * t869 + 3/16 * t1209 * t953 * t98 * t3762 * t1203 + 3/8 * t1219 * t1654 * t3762 * sdelta * t1059 - 3/16 * t1244 * t3784 + 3/16 * t1249 * t3784) * t3758
    t3790 = sin(t1253)
    t3791 = t377 * IMy
    t3793 = 2 * t2857 * t3791
    t3794 = t366 * t2889
    t3796 = (t3793 + t3794) * muM
    t3798 = t952 * t217
    t3810 = t100 * t1294
    t3812 = 2 * t3810 * t3791
    t3813 = t366 * t2906
    t3817 = t462 * t2 * (t3812 + t3813) * t1222
    contr[146] = (-3/8 * t1270 * t3798 * t230 * t3796 - 3/16 * t1279 * t1275 * t1328 * t3796 + 3/8 * t1287 * t1283 * t1323 * t3796 - 3/16 * t1310 * t3817 - 3/16 * t1315 * t3817) * t3790
    t3823 = sin(t1319)
    t3825 = (-t3793 + t3794) * muM
    t3841 = t1339 * t1323 * (-t3812 + t3813) * muM
    contr[147] = (3/8 * t1270 * t3798 * t230 * t3825 + 3/16 * t1279 * t1275 * t1328 * t3825 - 3/8 * t1287 * t1283 * t1323 * t3825 + 3/16 * t1310 * t3841 + 3/16 * t1315 * t3841) * t3823
    t3847 = sin(t1346)
    t3848 = -t3760 + t3761
    t3867 = t1339 * (-t3779 + t3780) * sdelta * t1059
    contr[148] = (3/8 * t1200 * t952 * t3848 * t12 * t869 - 3/16 * t1209 * t953 * t3848 * t98 * t1203 - 3/8 * t1219 * t1213 * t2 * t3848 * t1181 + 3/16 * t1244 * t3867 - 3/16 * t1249 * t3867) * t3847
    t3873 = sin(t1373)
    contr[149] = t3757 * t3873
    t3874 = sin(t1375)
    contr[150] = t3741 * t3874
    t3875 = sin(t1377)
    contr[151] = -t3720 * t3875
    t3877 = sin(t1380)
    t3878 = t3228 * t1382
    t3884 = q * t229
    t3886 = t1139 * t3884 * t3211
    t3903 = -3/8 * t1391 * t3878 + 3/8 * t1402 * t3280 * t3703 + 3/8 * t1408 * t3886 - 3/8 * t1423 * t8 * t75 * t1411 * t3212 * t3217 + 3/16 * t283 * t1429 * t205 * t75 * t1411 * t1126 * t3884 * t3217
    contr[152] = t3903 * t3877
    t3904 = sin(t1435)
    t3909 = -t1437
    t3910 = 0.1e1 / t3909
    t3925 = t3909 ^ 2
    t3926 = 0.1e1 / t3925
    t3941 = 3/8 * t1443 * t3878 - 3/8 * t323 * t1450 * t3910 * t104 * t1139 * t2194 * t3703 + 3/8 * t263 * t254 * t1448 * t3910 * t3886 + 3/8 * t471 * t1469 * t3926 * t8 * t110 * t75 * t1461 * t3212 * t3217 + 3/16 * t283 * t1440 * t3926 * t205 * t75 * t1461 * t1126 * t3884 * t3217
    contr[153] = t3941 * t3904
    t3942 = sin(t1484)
    contr[154] = -t3941 * t3942
    t3944 = sin(t1487)
    t3946 = t296 * t10 * t1749
    t3947 = t3946 * t1503
    t3950 = q * t595
    t3951 = t1749 * t1059
    t3953 = t1946 * t3951 * t3950
    t3956 = IMz * t1749
    t3957 = t1951 * t3956
    t3958 = t3957 * t1503
    t3961 = t1059 * t2495
    t3962 = t779 * t3956
    t3966 = t450 * t2495
    t3967 = t1749 * t229
    t3968 = t1804 * t3967
    contr[155] = (-3/8 * t1443 * t3947 - 3/8 * t1452 * t3953 + 3/8 * t1457 * t3958 - 3/8 * t1471 * t3962 * t3961 - 3/16 * t1480 * t3968 * t3966) * t3944
    t3973 = sin(t1522)
    t3974 = t3967 * t450
    t3975 = t1938 * t3974
    t3980 = t1946 * t616 * t3967 * t450
    t3983 = t1952 * t3974
    contr[156] = (-3/8 * t1443 * t3975 - 3/8 * t1452 * t3980 + 3/8 * t1457 * t3983 - 3/8 * t1471 * t779 * t1524 * t3967 * muM * t1461 - 3/16 * t1480 * t1804 * t3416 * t1059 * q * t1461) * t3973
    t3999 = sin(t1546)
    contr[157] = -t3903 * t3999
    t4001 = sin(t1549)
    t4012 = t3218 * t248
    contr[158] = (-3/16 * t243 * t231 * t12 * t2659 + 3/16 * t264 * t249 * t1832 * t2682 + 3/32 * t284 * t4012 * muM * t98 * t2682) * t4001
    t4017 = sin(t1577)
    contr[159] = (3/16 * t243 * t597 * muM * t12 * t2658 - 3/16 * t264 * t249 * t1582 * t12 * t2676 - 3/32 * t284 * t4012 * t1582 * t98 * t2676) * t4017
    t4034 = sin(t1593)
    t4035 = t10 * muM
    t4037 = t2857 * t705 * IMy
    t4038 = t932 * t3510
    t4042 = t952 * t2943
    t4046 = t738 * IMy
    t4047 = t2857 * t4046
    t4048 = t932 * t3521
    t4051 = t595 * (t4047 + t4048) * t1059
    t4058 = t3810 * t4046
    t4060 = IMx * t730 * t1297
    t4064 = t1339 * t602 * (t4058 + t4060) * muM
    contr[160] = (-3/8 * t1270 * t4042 * (t4037 + t4038) * t229 * t4035 - 3/16 * t1279 * t1612 * t4051 + 3/8 * t1287 * t1283 * t4051 - 3/16 * t1310 * t4064 - 3/16 * t1315 * t4064) * t4034
    t4070 = sin(t1633)
    t4071 = t3508 * t1635
    t4073 = IMx * t980 * t694
    t4080 = t3519 * t1635
    t4082 = IMx * t980 * t730
    t4085 = (t4080 - t4082) * t595 * t1059
    t4092 = t3519 * t1229
    t4094 = IMx * t730 * t1231
    t4098 = t1339 * t595 * (t4092 - t4094) * t1059
    contr[161] = (-3/8 * t1200 * t952 * t12 * (t4071 - t4073) * t1740 + 3/16 * t1209 * t1612 * t4085 + 3/8 * t1219 * t1654 * t4085 - 3/16 * t1244 * t4098 + 3/16 * t1249 * t4098) * t4070
    t4104 = sin(t1669)
    t4114 = t450 * t1677
    contr[162] = (3/8 * t1391 * t3947 - 3/8 * t1402 * t3953 - 3/8 * t1408 * t3958 + 3/8 * t1423 * t3962 * t1678 - 3/16 * t1431 * t3968 * t4114) * t4104
    t4119 = sin(t1691)
    t4120 = t3946 * t1715
    t4123 = t155 * t595
    t4125 = t1946 * t3951 * t4123
    t4128 = t3957 * t1715
    t4131 = t3592 * t3956
    t4132 = t4131 * t1715
    contr[163] = (-3/8 * t1701 * t4120 - 3/4 * t1712 * t4125 + 3/8 * t1719 * t4128 - 3/4 * t1731 * t4132 - 3/16 * t1734 * t4132) * t4119
    t4138 = sin(t1738)
    t4139 = t1801 * t1582
    t4140 = t2661 * t4139
    t4145 = t3729 * t101 * t592 * t1582
    t4148 = t1980 * t4139
    t4153 = t3751 * t1922 * t908 * t595
    contr[164] = (-3/8 * t881 * t4140 - 9/16 * t894 * t4145 + 3/8 * t905 * t4148 - 9/16 * t918 * t4153 - 3/16 * t923 * t4153) * t4138
    t4159 = sin(t1777)
    t4166 = t2001 * t4139
    contr[165] = (-3/8 * t1027 * t4140 + 9/16 * t1035 * t4145 + 3/8 * t1039 * t4148 - 9/16 * t1050 * t4166 + 3/16 * t1053 * t4166) * t4159
    t4172 = sin(t1793)
    t4180 = t1804 * t1097 * t1749
    t4181 = t4180 * t1715
    contr[166] = (3/8 * t1070 * t4120 - 3/4 * t1085 * t4125 - 3/8 * t1094 * t4128 + 3/4 * t1106 * t4181 - 3/16 * t1109 * t4181) * t4172
    t4187 = sin(t1812)
    contr[167] = (-3/16 * t243 * t597 * muM * t2701 * t12 + 3/16 * t264 * t249 * t1582 * t2717 * t12 + 3/32 * t284 * t4012 * t1582 * t2717 * t98) * t4187
    t4204 = sin(t1843)
    t4209 = muM * t2717
    contr[168] = (3/16 * t243 * t231 * t2701 * t1850 - 3/16 * t264 * t249 * t4209 * t1850 - 3/32 * t284 * t4012 * t4209 * t2801) * t4204
    t4219 = sin(t1862)
    t4228 = (t4047 - t4048) * t616 * t1059
    t4238 = t1339 * t1529 * (t4058 - t4060) * muM
    contr[169] = (3/8 * t1270 * t952 * t12 * (t4037 - t4038) * t2767 + 3/16 * t1279 * t1612 * t4228 - 3/8 * t1287 * t1283 * t4228 + 3/16 * t1310 * t4238 + 3/16 * t1315 * t4238) * t4219
    t4244 = sin(t1888)
    t4252 = t2 * (t4080 + t4082)
    t4257 = t1850 * t1059
    t4265 = t462 * (t4092 + t4094) * t2 * t2904
    contr[170] = (3/8 * t1200 * t952 * (t4071 + t4073) * t12 * t2767 - 3/16 * t1209 * t1611 * t4252 * t2904 - 3/8 * t1219 * t1213 * t4252 * t4257 + 3/16 * t1244 * t4265 - 3/16 * t1249 * t4265) * t4244
    t4271 = sin(t1914)
    t4278 = t1059 * t1929
    t4282 = t450 * t1929
    contr[171] = (3/8 * t1391 * t3975 - 3/8 * t1402 * t3980 - 3/8 * t1408 * t3983 + 3/8 * t1423 * t3962 * t4278 - 3/16 * t1431 * t3968 * t4282) * t4271
    t4287 = sin(t1935)
    t4288 = t155 * t616
    t4289 = t1059 * t4288
    t4290 = t3946 * t4289
    t4294 = t1946 * t3951 * t4288
    t4297 = t3957 * t4289
    t4300 = t4131 * t4289
    contr[172] = (-3/8 * t1701 * t4290 - 3/4 * t1712 * t4294 + 3/8 * t1719 * t4297 - 3/4 * t1731 * t4300 - 3/16 * t1734 * t4300) * t4287
    t4306 = sin(t1964)
    t4307 = t10 * t151
    t4309 = t4307 * t593 * t2775
    t4312 = t592 * IMy
    t4314 = t886 * t4312 * t2771
    t4318 = t900 * t593 * t2775
    t4322 = t1059 * t908 * t616
    t4324 = t911 * t4312 * t4322
    contr[173] = (3/8 * t881 * t4309 + 9/16 * t894 * t4314 - 3/8 * t905 * t4318 + 9/16 * t918 * t4324 + 3/16 * t923 * t4324) * t4306
    t4330 = sin(t1992)
    t4338 = t1042 * t2131
    t4340 = t4338 * t98 * t592 * t2775
    contr[174] = (3/8 * t1027 * t4309 - 9/16 * t1035 * t4314 - 3/8 * t1039 * t4318 + 9/16 * t1050 * t4340 - 3/16 * t1053 * t4340) * t4330
    t4346 = sin(t2008)
    t4353 = t4180 * t4289
    contr[175] = (3/8 * t1070 * t4290 - 3/4 * t1085 * t4294 - 3/8 * t1094 * t4297 + 3/4 * t1106 * t4353 - 3/16 * t1109 * t4353) * t4346
    t4359 = sin(t2024)
    t4361 = t383 * IMz * t2658
    t4365 = IMz * t2676
    t4366 = t643 * t4365
    t4371 = t80 * muM * t633
    t4374 = t98 * IMz * t443
    t4380 = t351 * t82 * t347 * t110 * t462
    t4383 = -3/32 * t305 * t4361 * t634 + 3/64 * t324 * t4366 * t641 - 3/16 * t4380 * t4374 * t2676 * t126 * t4371
    contr[176] = t4383 * t4359
    t4384 = sin(t2052)
    t4386 = t383 * IMz * t2701
    t4391 = t643 * IMz * t2717
    t4400 = -3/32 * t305 * t4386 * t634 + 3/64 * t324 * t4391 * t641 - 3/16 * t4380 * t4374 * t126 * t2717 * t4371
    contr[177] = t4400 * t4384
    t4401 = sin(t2071)
    t4406 = -t1695
    t4407 = 0.1e1 / t4406
    t4421 = t8 * t1722 * t1126 * t3707 * t3217
    t4422 = t4406 ^ 2
    t4425 = t1698 / t4422 * t133
    t4432 = -3/8 * t1701 * t3699 + 3/4 * t323 * t1710 * t4407 * t104 * t1139 * t2032 * t3703 - 3/8 * t263 * t254 * t1708 * t4407 * t3709 - 3/4 * t351 * t4425 * t4421 - 3/16 * t283 * t4425 * t4421
    contr[178] = t4432 * t4401
    t4433 = sin(t2088)
    t4434 = IMy * t2110
    t4437 = t100 * t359 * t126 * t4434
    t4438 = t80 * t2097
    t4439 = t2152 * t4438
    t4440 = t4437 - t4439
    t4452 = t100 * t411 * t414 * t4434
    t4453 = t418 * t2097
    t4454 = t2178 * t4453
    contr[179] = (-t395 * t712 * t4440 * t358 / 8 + t406 * t2120 * t4440 * t151 * t398 / 16 - 3/16 * t433 * t2120 * t2131 * (t4452 - t4454) * muM) * t4433
    t4462 = sin(t2137)
    t4465 = t100 * t359 * t2160 * t481
    t4467 = IMx * t2148
    t4468 = t4467 * t371 * t80
    t4470 = (t4465 - t4468) * muM
    t4481 = t100 * t411 * t2160 * t509
    t4483 = t4467 * t421 * t418
    contr[180] = (t395 * t712 * t151 * t4470 / 8 - t406 * t2120 * t558 * t4470 / 16 + 3/16 * t433 * t2120 * (t4481 - t4483) * t151 * t409) * t4462
    t4491 = sin(t2188)
    t4500 = t779 * t4365
    t4504 = -3/16 * t447 * t4361 * t767 + 3/32 * t455 * t4366 * t771 - 3/16 * t472 * t4500 * t126 * t80 * t775
    contr[181] = t4504 * t4491
    t4505 = sin(t2207)
    t4517 = -3/16 * t447 * t4386 * t767 + 3/32 * t455 * t4391 * t771 - 3/16 * t472 * t780 * t2717 * t80 * t775
    contr[182] = t4517 * t4505
    t4518 = sin(t2221)
    t4520 = t100 * t126 * t4434
    t4521 = IMx * t4438
    t4522 = t4520 - t4521
    t4533 = t100 * t414 * t4434
    t4534 = IMx * t4453
    contr[183] = (-3/8 * t496 * t793 * t4522 * t478 + 3/16 * t506 * t2120 * t4522 * t2 * t398 - 3/16 * t521 * t2120 * t1002 * (t4533 - t4534) * muM) * t4518
    t4542 = sin(t2248)
    t4543 = t100 * t2160
    t4544 = t4543 * t481
    t4546 = IMx * t2148 * t80
    t4548 = sdelta * (t4544 - t4546)
    t4557 = t4543 * t509
    t4559 = IMx * t2148 * t418
    contr[184] = (3/8 * t496 * t2256 * t4548 * t479 - 3/16 * t506 * t133 * t4548 * t500 + 3/16 * t521 * t133 * sdelta * (t4557 - t4559) * t2238) * t4542
    t4567 = sin(t2274)
    t4568 = t4520 + t4521
    contr[185] = (-3/8 * t496 * t793 * t4568 * t478 + 3/16 * t506 * t2120 * t4568 * t2 * t398 - 3/16 * t521 * t2120 * t1002 * (t4533 + t4534) * muM) * t4567
    t4585 = sin(t2293)
    t4586 = t4544 + t4546
    contr[186] = (3/8 * t496 * t793 * t4586 * t478 - 3/16 * t506 * t2120 * t4586 * t2 * t398 + 3/16 * t521 * t2120 * t1002 * (t4557 + t4559) * muM) * t4585
    t4603 = sin(t2312)
    contr[187] = -t4504 * t4603
    t4605 = sin(t2315)
    contr[188] = -t4517 * t4605
    t4607 = sin(t2318)
    t4608 = t4437 + t4439
    contr[189] = (-t395 * t712 * t4608 * t358 / 8 + t406 * t2120 * t4608 * t151 * t398 / 16 - 3/16 * t433 * t2120 * (t4452 + t4454) * t151 * t409) * t4607
    t4625 = sin(t2337)
    t4626 = t4465 + t4468
    contr[190] = (t395 * t85 * t4626 * t844 * t843 / 8 - t406 * t133 * t4626 * sdelta * t2170 / 16 + 3/16 * t433 * t2120 * t2131 * (t4481 + t4483) * muM) * t4625
    t4644 = sin(t2356)
    contr[191] = -t4383 * t4644
    t4646 = sin(t2359)
    contr[192] = -t4400 * t4646
    t4648 = sin(t2362)
    contr[193] = -t4432 * t4648
    t4650 = sin(t2365)
    t4651 = t4361 * t1715
    t4654 = t2676 * t1059
    t4655 = t4654 * t4123
    t4657 = t1708 * t1944 * t311
    t4661 = t323 * t116 * t2256 * t1706
    t4665 = t1696 * t1708 * t12
    t4666 = t4665 * t4365
    t4669 = t263 * t254 * t133
    t4672 = t3592 * t4365
    t4673 = t4672 * t1715
    contr[194] = (-3/16 * t1701 * t4651 - 3/8 * t4661 * t4657 * t4655 + 3/16 * t4669 * t4666 * t1715 - 3/8 * t1731 * t4673 - 3/32 * t1734 * t4673) * t4650
    t4679 = sin(t2391)
    t4680 = t4361 * t4289
    t4683 = t4654 * t4288
    t4690 = t4672 * t4289
    contr[195] = (3/16 * t1701 * t4680 + 3/8 * t4661 * t4657 * t4683 - 3/16 * t4669 * t4666 * t4289 + 3/8 * t1731 * t4690 + 3/32 * t1734 * t4690) * t4679
    t4696 = sin(t2410)
    t4697 = t2701 * muM
    t4699 = t296 * t230
    t4700 = t4699 * t4697 * t4288
    t4703 = t229 * t4209
    t4704 = t4703 * t4288
    t4708 = t4209 * t4288
    t4709 = t4665 * t248
    t4713 = t3592 * t248
    t4714 = t4713 * t4708
    contr[196] = (-3/16 * t1701 * t4700 - 3/8 * t4661 * t4657 * t4704 + 3/16 * t4669 * t4709 * t4708 - 3/8 * t1731 * t4714 - 3/32 * t1734 * t4714) * t4696
    t4720 = sin(t2432)
    t4722 = t4699 * t4697 * t4123
    t4725 = t4703 * t4123
    t4729 = t4209 * t4123
    t4733 = t4713 * t4729
    contr[197] = (3/16 * t1701 * t4722 + 3/8 * t4661 * t4657 * t4725 - 3/16 * t4669 * t4709 * t4729 + 3/8 * t1731 * t4733 + 3/32 * t1734 * t4733) * t4720
    t4739 = sin(t2451)
    t4740 = t4361 * t1535
    t4743 = q * t616
    t4745 = t1946 * t4654 * t4743
    t4748 = t1951 * t4365
    t4749 = t4748 * t1535
    t4756 = t450 * t2472
    t4757 = t1804 * t2677
    contr[198] = (3/16 * t1443 * t4740 + 3/16 * t1452 * t4745 - 3/16 * t1457 * t4749 + 3/16 * t1471 * t4500 * t1059 * t2472 + 3/32 * t1480 * t4757 * t4756) * t4739
    t4762 = sin(t2478)
    t4764 = t4699 * t4697 * t3950
    t4768 = t1946 * t4703 * t3950
    t4772 = t1951 * t248
    t4773 = t4772 * t4209 * t3950
    t4777 = t779 * t248
    t4782 = t1804 * t229 * t2717
    contr[199] = (3/16 * t1443 * t4764 + 3/16 * t1452 * t4768 - 3/16 * t1457 * t4773 + 3/16 * t1471 * t4777 * t4209 * t2495 + 3/32 * t1480 * t4782 * t3966) * t4762
    t4787 = sin(t2501)
    t4788 = t4361 * t1503
    t4792 = t1946 * t4654 * t3950
    t4795 = t4748 * t1503
    contr[200] = (-3/16 * t1443 * t4788 - 3/16 * t1452 * t4792 + 3/16 * t1457 * t4795 - 3/16 * t1471 * t4500 * t3961 - 3/32 * t1480 * t4757 * t3966) * t4787
    t4805 = sin(t2521)
    t4807 = t4699 * t4697 * t4743
    t4811 = t1946 * t4703 * t4743
    t4815 = t4772 * t4209 * t4743
    contr[201] = (-3/16 * t1443 * t4807 - 3/16 * t1452 * t4811 + 3/16 * t1457 * t4815 - 3/16 * t1471 * t4777 * t4209 * t2472 - 3/32 * t1480 * t4782 * t4756) * t4805
    t4826 = sin(t2541)
    contr[202] = (-3/16 * t1391 * t4740 + 3/16 * t1402 * t4745 + 3/16 * t1408 * t4749 - 3/16 * t1423 * t4500 * t4278 + 3/32 * t1431 * t4757 * t4282) * t4826
    t4840 = sin(t2556)
    contr[203] = (3/16 * t1391 * t4788 - 3/16 * t1402 * t4792 - 3/16 * t1408 * t4795 + 3/16 * t1423 * t4500 * t1678 - 3/32 * t1431 * t4757 * t4114) * t4840
    t4854 = sin(t2574)
    contr[204] = (-3/16 * t1391 * t4764 + 3/16 * t1402 * t4768 + 3/16 * t1408 * t4773 - 3/16 * t1423 * t4777 * t4209 * t1677 + 3/32 * t1431 * t4782 * t4114) * t4854
    t4869 = sin(t2589)
    contr[205] = (3/16 * t1391 * t4807 - 3/16 * t1402 * t4811 - 3/16 * t1408 * t4815 + 3/16 * t1423 * t4777 * t4209 * t1929 - 3/32 * t1431 * t4782 * t4282) * t4869
    t4884 = sin(t2604)
    t4894 = t8 * t1097 * t98
    t4895 = t4894 * t248
    t4896 = t4895 * t4729
    contr[206] = (-3/16 * t1070 * t4722 + 3/8 * t1085 * t1946 * t4725 + 3/16 * t1094 * t4772 * t4729 - 3/8 * t1106 * t4896 + 3/32 * t1109 * t4896) * t4884
    t4902 = sin(t2620)
    t4911 = t4895 * t4708
    contr[207] = (3/16 * t1070 * t4700 - 3/8 * t1085 * t1946 * t4704 - 3/16 * t1094 * t4772 * t4708 + 3/8 * t1106 * t4911 - 3/32 * t1109 * t4911) * t4902
    t4917 = sin(t2634)
    t4927 = t4894 * t4365 * t4289
    contr[208] = (-3/16 * t1070 * t4680 + 3/8 * t1085 * t1946 * t4683 + 3/16 * t1094 * t4748 * t4289 - 3/8 * t1106 * t4927 + 3/32 * t1109 * t4927) * t4917
    t4933 = sin(t2650)
    t4934 = t4307 * t1559
    t4935 = t4934 * t2775
    t4938 = t1558 * IMy
    t4939 = t886 * t4938
    t4940 = t4939 * t2771
    t4943 = t900 * t1559
    t4944 = t4943 * t2775
    t4947 = t4338 * t1568
    t4948 = t4947 * t2775
    contr[209] = (-3/16 * t1027 * t4935 + 9/32 * t1035 * t4940 + 3/16 * t1039 * t4944 - 9/32 * t1050 * t4948 + 3/32 * t1053 * t4948) * t4933
    t4954 = sin(t2693)
    t4955 = t1826 * t151
    t4956 = t4955 * t383
    t4957 = t4956 * t1762
    t4961 = t104 * t4955 * t129
    t4962 = t4961 * t1756
    t4967 = t110 * t75 * t1826 * t871
    t4968 = t4967 * t1762
    t4972 = t8 * t4955
    t4973 = t4972 * t1042 * t98
    t4974 = t4973 * t1762
    contr[210] = (3/16 * t1027 * t4957 - 9/32 * t1035 * t4962 - 3/16 * t1039 * t4968 + 9/32 * t1050 * t4974 - 3/32 * t1053 * t4974) * t4954
    t4980 = sin(t2739)
    t4981 = t4934 * t1762
    t4984 = t4939 * t1756
    t4987 = t4943 * t1762
    t4990 = t911 * t4938
    t4991 = t4990 * t1769
    contr[211] = (-3/16 * t881 * t4981 - 9/32 * t894 * t4984 + 3/16 * t905 * t4987 - 9/32 * t918 * t4991 - 3/32 * t923 * t4991) * t4980
    t4997 = sin(t2765)
    t4998 = t4956 * t2775
    t5001 = t4961 * t2771
    t5004 = t4967 * t2775
    t5007 = t4972 * t129
    t5008 = t5007 * t4322
    contr[212] = (3/16 * t881 * t4998 + 9/32 * t894 * t5001 - 3/16 * t905 * t5004 + 9/32 * t918 * t5008 + 3/32 * t923 * t5008) * t4997
    t5014 = sin(t2788)
    t5015 = t1183 * t4434
    t5017 = IMx * t980 * t2097
    t5018 = t5015 - t5017
    t5019 = t75 * t5018
    t5025 = t616 * t104 * t1059
    t5036 = t100 * t2110
    t5037 = t5036 * t1229
    t5039 = t1231 * IMx * t2097
    t5043 = t462 * t2 * (t5037 - t5039) * t2904
    contr[213] = (-3/16 * t1200 * t5019 * t929 * t2767 + 3/32 * t1209 * t110 * t5019 * t499 * t5025 + 3/16 * t1219 * t1213 * t5018 * t2 * t4257 - 3/32 * t1244 * t5043 + 3/32 * t1249 * t5043) * t5014
    t5049 = sin(t2823)
    t5050 = t2160 * IMy
    t5051 = t1183 * t5050
    t5053 = IMx * t2148 * t980
    t5054 = t5051 - t5053
    t5070 = t4543 * t1229
    t5071 = t1231 * t4467
    t5075 = t462 * (t5070 - t5071) * t2 * t1620
    contr[214] = (3/16 * t1200 * t4042 * t5054 * t229 * t4035 - 3/32 * t1209 * t2836 * t5054 * t104 * t1059 - 3/16 * t1219 * t1654 * t595 * t5054 * t1059 + 3/32 * t1244 * t5075 - 3/32 * t1249 * t5075) * t5049
    t5081 = sin(t2855)
    t5082 = t5036 * t1255
    t5084 = IMx * t932 * t2097
    t5085 = t5082 - t5084
    t5086 = t75 * t5085
    t5101 = t3810 * t4434
    t5103 = IMx * t1297 * t2097
    t5107 = t75 * (t5101 - t5103) * t1002 * t1620
    contr[215] = (-3/16 * t1270 * t5086 * t929 * t1740 - 3/32 * t1279 * t110 * t5086 * t499 * t2952 + 3/16 * t1287 * t1282 * t5085 * t2 * t2944 - 3/32 * t1310 * t5107 - 3/32 * t1315 * t5107) * t5081
    t5113 = sin(t2886)
    t5114 = t4543 * t1255
    t5116 = IMx * t2148 * t932
    t5117 = t5114 - t5116
    t5118 = t75 * t5117
    t5133 = t3810 * t5050
    t5135 = IMx * t2148 * t1297
    t5139 = t1339 * t1529 * (t5133 - t5135) * muM
    contr[216] = (3/16 * t1270 * t5118 * t929 * t2767 + 3/32 * t1279 * t110 * t5118 * t499 * t5025 - 3/16 * t1287 * t1282 * t5117 * t2 * t4257 + 3/32 * t1310 * t5139 + 3/32 * t1315 * t5139) * t5113
    t5145 = sin(t2917)
    t5147 = muM * (t5082 + t5084)
    t5164 = t75 * (t5101 + t5103) * t1002 * t2904
    contr[217] = (-3/16 * t1270 * t952 * t1850 * t230 * t5147 - 3/32 * t1279 * t2802 * t1328 * t5147 + 3/16 * t1287 * t1283 * t1529 * t5147 - 3/32 * t1310 * t5164 - 3/32 * t1315 * t5164) * t5145
    t5170 = sin(t2941)
    t5171 = t5114 + t5116
    t5190 = t1339 * t602 * (t5133 + t5135) * muM
    contr[218] = (3/16 * t1270 * t4042 * t5171 * t229 * t4035 + 3/32 * t1279 * t2836 * t5171 * t104 * t1059 - 3/16 * t1287 * t1283 * t595 * t5171 * t1059 + 3/32 * t1310 * t5190 + 3/32 * t1315 * t5190) * t5170
    t5196 = sin(t2972)
    t5197 = t5015 + t5017
    t5216 = t1339 * t595 * (t5037 + t5039) * t1059
    contr[219] = (-3/16 * t1200 * t4042 * t5197 * t229 * t4035 + 3/32 * t1209 * t2836 * t5197 * t104 * t1059 + 3/16 * t1219 * t1654 * t595 * t5197 * t1059 - 3/32 * t1244 * t5216 + 3/32 * t1249 * t5216) * t5196
    t5222 = sin(t2999)
    t5223 = t5051 + t5053
    t5242 = t1339 * t1529 * (t5070 + t5071) * muM
    contr[220] = (3/16 * t1200 * t952 * t5223 * t12 * t2767 - 3/32 * t1209 * t953 * t5223 * t98 * t5025 - 3/16 * t1219 * t1213 * t2 * t5223 * t4257 + 3/32 * t1244 * t5242 - 3/32 * t1249 * t5242) * t5222
    t5248 = sin(t3023)
    t5255 = t4990 * t4322
    contr[221] = (-3/16 * t881 * t4935 - 9/32 * t894 * t4940 + 3/16 * t905 * t4944 - 9/32 * t918 * t5255 - 3/32 * t923 * t5255) * t5248
    t5261 = sin(t3037)
    t5268 = t5007 * t1769
    contr[222] = (3/16 * t881 * t4957 + 9/32 * t894 * t4962 - 3/16 * t905 * t4968 + 9/32 * t918 * t5268 + 3/32 * t923 * t5268) * t5261
    t5274 = sin(t3051)
    t5281 = t4947 * t1762
    contr[223] = (-3/16 * t1027 * t4981 + 9/32 * t1035 * t4984 + 3/16 * t1039 * t4987 - 9/32 * t1050 * t5281 + 3/32 * t1053 * t5281) * t5274
    t5287 = sin(t3065)
    t5294 = t4973 * t2775
    contr[224] = (3/16 * t1027 * t4998 - 9/32 * t1035 * t5001 - 3/16 * t1039 * t5004 + 9/32 * t1050 * t5294 - 3/32 * t1053 * t5294) * t5287
    t5300 = sin(t3079)
    t5310 = t4757 * t309 * t1803
    contr[225] = (3/16 * t1070 * t4651 - 3/8 * t1085 * t1946 * t4655 - 3/16 * t1094 * t4748 * t1715 + 3/8 * t1106 * t5310 - 3/32 * t1109 * t5310) * t5300   
    der_Jl = sum(contr);
    return der_Jl;

end

function derivativechiM2_JgP1(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)

    contr = zeros(225);
    t1 = cos(psil)
    t2 = sqrt(q)
    t3 = t2 * cdelta
    t4 = -1 + m
    t7 = k + m
    t9 = KK * t4 * k + t7 * EE
    t10 = t9 * muM
    t12 = IMy * pi
    t14 = sqrt(1 + k)
    t15 = sqrt(t7)
    t16 = 0.1e1 / t15
    t17 = t16 * t14
    t18 = Q1 ^ 2
    t19 = Q2 ^ 2
    t20 = t18 + t19 + 1
    t21 = t20 ^ 2
    t22 = 1 / t21
    t23 = t18 * t22
    t28 = 1 / t20
    t29 = Q1 * t28
    t30 = cpa1EQ * t29
    t32 = Q2 * t28
    t33 = cpa2EQ * t32
    t37 = cpa3EQ * (-t18 - t19 + 1) * t28
    t38 = -2 * t30 + 2 * t33 + t37
    t40 = -t18 + t19 + 1
    t41 = t40 * t28
    t42 = cpa1EQ * t41
    t44 = Q2 * cpa2EQ * t29
    t46 = cpa3EQ * t29
    t48 = t42 + 2 * t44 + 2 * t46
    t49 = t28 * t48
    t50 = t40 * t49
    t52 = Q2 * cpa1EQ * t29
    t54 = t18 - t19 + 1
    t55 = t54 * t28
    t56 = cpa2EQ * t55
    t57 = cpa3EQ * t32
    t59 = 2 * t52 + t56 - 2 * t57
    t60 = t28 * t59
    t61 = Q1 * Q2
    t62 = t61 * t60
    t63 = 2 * t62
    t64 = t50 + t63
    t67 = 2 * Q1 * t28 * t64
    t68 = t61 * t49
    t69 = 2 * t68
    t70 = t54 * t60
    t71 = t69 + t70
    t74 = t38 * (4 * t23 + 4 * t19 * t22 - 2/3) - t67 + 2 * t71 * t32
    t76 = t74 * t17 * t12
    t78 = rc ^ 2
    t80 = 0.1e1 / t78 / rc
    t81 = KK ^ 2
    t83 = 1 / t81 / KK
    t84 = t83 * t80
    t85 = q - 1
    t86 = 0.1e1 / t85
    t87 = 0.1e1 / npsil
    t88 = t87 * t86
    t90 = 1 / m
    t91 = 1 / t4
    t92 = t91 * t90
    t95 = -m * KK + PP * t7
    t96 = 1 / k
    t98 = 0.1e1 / Jg
    t100 = t98 * t96 * t95 * t92
    t104 = muM * IMy
    t106 = pi ^ 2
    t107 = t74 * t106
    t108 = t81 ^ 2
    t109 = 1 / t108
    t110 = t109 * t80
    t113 = npsil ^ 2
    t114 = 0.1e1 / t113
    t116 = -C + A
    t117 = sqrt(k)
    t118 = 0.1e1 / t117
    t119 = t118 * t116
    t124 = EE * KK * m
    t128 = 1 / C * t90
    t129 = 0.1e1 / A
    t131 = t129 * t128 * t91 * (-PP * t9 + t124)
    t135 = 1 + q
    t138 = t106 * IMy
    t143 = t85 ^ 2
    t151 = KK * (-KP + EP) + EE * KP
    t154 = t98 * t96 * t91
    t155 = t154 * t90 * t151
    t166 = 1 / KK
    t168 = t98 * cdelta
    contr[1] = (-3 * t100 * t88 * t84 * t76 * t10 * t3 - 3/2 * t131 * t119 * t114 * t86 * t110 * t107 * t104 * t3 - 3/2 * t155 * t95 * t87 / t143 * t110 * t74 * t15 * t14 * t138 * t135 * muM * t3) * t1 + 3 * t168 * t88 * t166 * t80 * t74 * t17 * t12 * muM * t2 * t1
    t173 = 3 * psil
    t174 = cos(t173)
    t175 = t2 * q
    t176 = t175 * cdelta
    t179 = q ^ 2
    t180 = t179 * q
    t181 = t180 - 1
    t182 = 0.1e1 / t181
    t183 = t87 * t182
    t187 = t106 * cdelta
    t189 = t22 * t48
    t190 = Q1 * t40
    t191 = t190 * t189
    t193 = t19 * Q1
    t194 = t193 * t189
    t196 = t22 * t59
    t197 = Q2 * t18
    t198 = t197 * t196
    t200 = Q2 * t54
    t201 = t200 * t196
    t203 = t22 * t38
    t204 = t18 * t203
    t206 = t19 * t203
    t211 = -6 * t191 + 12 * t194 - 12 * t198 + 6 * t201 + 12 * t204 + 12 * t206 + 4 * t30 - 4 * t33 - 2 * t37
    t212 = t211 * t175
    t222 = t180 + 1
    t227 = t109 * t15
    t228 = t181 ^ 2
    t243 = t16 * t80
    t244 = t166 * t243
    contr[2] = (-t100 * t183 * t84 * t76 * t10 * t176 - t131 * t119 * t114 * t182 * t110 * t212 * t187 * t104 / 6 - t155 * t95 * t87 / t228 * t227 * t80 * t222 * t211 * t14 * t106 * t104 * t176 / 2) * t174 + t168 * t183 * t244 * t212 * t14 * pi * muM * IMy * t174 / 3
    t249 = 2 * TL
    t250 = t249 - psig
    t251 = cos(t250)
    t252 = t118 * sdelta
    t253 = t16 * pi
    t254 = t253 * t252
    t255 = t28 * t38
    t256 = Q2 * t255
    t261 = t64 * t32
    t263 = -2 * Q1 * t28 * (t69 + t70 + 4 * t256) + 2 * t261
    t264 = muM * t263
    t265 = exp(sigma)
    t266 = t265 * IMz
    t268 = t266 * t264 * t254
    t269 = t80 * t9
    t271 = exp(2 * sigma)
    t272 = -1 + t271
    t273 = 0.1e1 / t272
    t274 = t83 * t273
    t276 = 0.1e1 / npsig
    t278 = t95 * t91
    t279 = t98 * t278
    t280 = t279 * t90 * t276
    t281 = t280 * t274 * t269
    t285 = npsig ^ 2
    t287 = 1 / t285 * t109
    t289 = t7 * t116
    t290 = PP ^ 2
    t304 = -t290 * t9 * t289 + 2 * PP * t289 * t124 + (KK * t4 * A * k - t116 * EE * m) * m * t81
    t306 = t91 * t128
    t307 = t306 * t129 * t304
    t308 = t307 * t287 * t273 * t80
    t311 = 1 + t271
    t313 = t106 * t118
    t316 = IMz * muM
    t317 = t265 * t316
    t320 = t272 ^ 2
    t328 = (EE - KK) * FA + KK * EA
    t331 = t91 * t98 * t90
    t332 = t331 * t328 * t95
    t333 = t332 * t276 * t109 / t320 * t80
    t336 = -3/4 * t281 * t268 + 3/4 * t308 * t268 + 3/8 * t333 * t317 * t263 * t15 * t313 * sdelta * t311
    contr[3] = t336 * t251
    t337 = t249 + psig
    t338 = cos(t337)
    contr[4] = -t336 * t338
    t340 = 4 * psil
    t341 = t249 - t340
    t342 = cos(t341)
    t343 = t118 * cdelta
    t344 = muM * t179
    t345 = t344 * t343
    t346 = IMz * pi
    t347 = t16 * t9
    t348 = t347 * t346
    t349 = t348 * t345
    t350 = t80 * t263
    t351 = t179 ^ 2
    t352 = t351 + 1
    t353 = 0.1e1 / t352
    t354 = t353 * t83
    t357 = t279 * t90 * t87
    t361 = t179 * cdelta
    t363 = t263 * t106
    t364 = t110 * t363
    t367 = 0.1e1 / t14
    t368 = t367 * t116
    t370 = t131 * t368 * t114 * t353
    t373 = t106 * IMz
    t381 = t54 * Q1
    t386 = 2 * Q2 * t40 * t189 - 4 * t197 * t189 + 4 * t193 * t196 - 2 * t381 * t196 - 8 * t61 * t203
    t387 = t351 - 1
    t392 = t352 ^ 2
    t393 = 0.1e1 / t392
    t394 = t87 * t393
    t396 = t151 * t95
    t397 = t331 * t396
    t398 = t397 * t394 * t110
    t401 = 3/8 * t357 * t354 * t350 * t349 + 3/16 * t370 * t364 * t316 * t361 + 3/4 * t398 * t15 * t387 * t386 * t373 * t345
    t403 = IMz * t179
    t405 = cdelta * pi
    t406 = t264 * t405
    t407 = t406 * t16 * t403
    t411 = t98 * t87
    t412 = t411 * t353 * t166
    contr[5] = t401 * t342 - 3/8 * t412 * t80 * t117 * t342 * t407
    t416 = t249 - t173
    t417 = cos(t416)
    t418 = t16 * muM
    t419 = t179 - q + 1
    t420 = t419 * IMy
    t421 = 4 * t204
    t422 = 2 * t256
    t426 = t421 - t67 - 2 * (t69 + t70 + t422) * t32
    t429 = t14 * t426 * t135 * t420
    t430 = IMx * t85
    t431 = t179 + q + 1
    t437 = -2 * Q1 * t28 * (t422 + t68 + t70 / 2) + t261
    t440 = 2 * t437 * t431 * t430
    t441 = t429 - t440
    t444 = t9 * pi
    t446 = t90 * cdelta * t444
    t450 = t351 * t179 - 1
    t451 = 0.1e1 / t450
    t455 = t98 * t96
    t457 = t455 * t95 * t83 * t451 * t91 * t80 * t87
    t460 = t175 * muM
    t463 = t80 * cdelta
    t464 = t114 * t109
    t465 = t464 * t463
    t468 = t118 * t367
    t470 = t131 * t468 * t116 * t451
    t473 = t15 * muM
    t474 = t419 ^ 2
    t475 = t474 * t419
    t476 = t475 * IMy
    t477 = t135 ^ 2
    t478 = t477 * t135
    t481 = t14 * t426 * t478 * t476
    t482 = t143 * t85
    t483 = IMx * t482
    t484 = t431 ^ 2
    t485 = t484 * t431
    t488 = 2 * t437 * t485 * t483
    t492 = t110 * t187
    t494 = t450 ^ 2
    t498 = t455 * t92
    t499 = t498 * t396 / t494 * t87
    t505 = t431 * t263 * t430
    t509 = muM * pi
    t510 = t16 * t509
    t512 = t80 * t175
    t516 = t98 * t451 * t87 * t166 * t512
    contr[6] = (-t457 * t446 * t441 * t175 * t418 / 2 - t470 * t465 * t106 * t441 * t460 / 4 - 3/4 * t499 * t492 * (t481 - t488) * t175 * t473) * t417 + t516 * t510 * cdelta * (t429 - t505) * t417 / 2
    t520 = 2 * TL - 2 * psil
    t521 = cos(t520)
    t522 = q * muM
    t523 = t522 * t343
    t524 = t348 * t523
    t525 = t179 + 1
    t526 = 0.1e1 / t525
    t527 = t526 * t83
    t532 = cdelta * q
    t537 = t131 * t368 * t114 * t526
    t542 = t179 - 1
    t544 = t80 * t15 * t542
    t547 = t525 ^ 2
    t548 = 0.1e1 / t547
    t550 = t95 * t87
    t553 = t331 * t151 * q
    t554 = t553 * t550 * t548 * t109
    t557 = 3/4 * t357 * t527 * t350 * t524 + 3/8 * t537 * t364 * t316 * t532 + 3/4 * t554 * t544 * t386 * t106 * t316 * t343
    t559 = IMz * q
    t561 = t406 * t16 * t559
    t565 = t411 * t526 * t166
    contr[7] = t557 * t521 - 3/4 * t565 * t80 * t117 * t521 * t561
    t569 = t249 - psil
    t570 = cos(t569)
    t571 = pi * t2
    t572 = t571 * t418
    t574 = t135 * IMy
    t575 = t14 * t426
    t576 = t575 * t574
    t578 = 2 * t437 * t430
    t580 = t80 * (t576 - t578)
    t584 = 0.1e1 / t542
    t588 = t455 * t278 * t90 * t584 * t87 * t83
    t591 = t2 * muM
    t597 = t131 * t468 * t116 * t584
    t600 = t478 * IMy
    t601 = t575 * t600
    t603 = 2 * t437 * t483
    t608 = t542 ^ 2
    t612 = t498 * t396 / t608 * t87
    t619 = t2 * t418
    t621 = t263 * t430
    t626 = t98 * t584 * t87
    contr[8] = (-3/2 * t588 * t580 * cdelta * t9 * t572 - 3/4 * t597 * t464 * t580 * t187 * t591 - 3/4 * t612 * t492 * (t601 - t603) * t2 * t473) * t570 + 3/2 * t626 * t166 * t80 * (t576 - t621) * t619 * pi * cdelta * t570
    t630 = t249 + psil
    t631 = cos(t630)
    t632 = t576 + t578
    contr[9] = (-3/2 * t588 * t463 * t9 * t632 * t572 - 3/4 * t597 * t465 * t632 * t106 * t591 - 3/4 * t612 * t492 * (t601 + t603) * t2 * t473) * t631 + 3/2 * t626 * t166 * t80 * (t576 + t621) * t619 * pi * cdelta * t631
    t661 = 2 * TL + 2 * psil
    t662 = cos(t661)
    contr[10] = -t557 * t662 + 3/4 * t565 * t80 * t117 * t662 * t561
    t670 = t249 + t173
    t671 = cos(t670)
    t673 = (t429 + t440) * muM
    t674 = t175 * t16
    t679 = t106 * t175
    contr[11] = (-t457 * t446 * t674 * t673 / 2 - t470 * t465 * t679 * t673 / 4 - 3/4 * t499 * t110 * (t481 + t488) * cdelta * t679 * t473) * t671 + t516 * t510 * cdelta * (t429 + t505) * t671 / 2
    t699 = t249 + t340
    t700 = cos(t699)
    contr[12] = -t401 * t700 + 3/8 * t412 * t80 * t117 * t700 * t407
    t708 = -psih + psig
    t709 = cos(t708)
    t710 = t40 ^ 2
    t711 = t710 * t22
    t712 = t19 * t23
    t713 = 4 * t712
    t715 = t48 * (t711 + t713 - 2/3)
    t716 = Q1 * t255
    t720 = t40 * t28 * (2 * t62 - 2 * t716)
    t721 = t70 + t422
    t724 = 2 * t721 * Q2 * t29
    t725 = t715 + t720 + t724
    t727 = t253 * t118 * t725
    t728 = t9 * t265
    t729 = t728 * t316
    t731 = cdelta - 1
    t737 = t731 * t265
    t738 = t737 * t316
    t743 = t313 * t725 * t311
    t753 = t316 * t253
    t755 = t80 * t265
    t759 = t168 * t276 * t166 * t273 * t755
    contr[13] = (3/4 * t280 * t274 * t80 * t731 * t729 * t727 - 3/4 * t308 * t738 * t727 - 3/8 * t333 * t731 * t266 * t473 * t743) * t709 - 3/4 * t759 * t753 * t117 * t725 * t709
    t762 = psih + psig
    t763 = cos(t762)
    t764 = cdelta + 1
    t765 = muM * t764
    t766 = t266 * t765
    t767 = t766 * t727
    t772 = t764 * t15
    contr[14] = (-3/4 * t281 * t767 + 3/4 * t308 * t767 + 3/8 * t333 * t317 * t772 * t743) * t763 + 3/4 * t759 * t753 * t117 * t725 * t763
    t784 = psih - t340
    t785 = cos(t784)
    t786 = t344 * t252
    t788 = t444 * IMz * t725
    t791 = t357 * t354 * t243
    t794 = t179 * sdelta
    t795 = t725 * muM
    t797 = t110 * t373
    t801 = t710 * t189
    t803 = t19 * t18
    t804 = t803 * t189
    t806 = Q2 * t190
    t807 = t806 * t196
    t809 = t54 * t61
    t810 = t809 * t196
    t811 = 6 * t810
    t812 = t190 * t203
    t814 = t193 * t203
    t822 = t15 * t387 * t106
    t827 = 3/8 * t791 * t788 * t786 + 3/16 * t370 * t797 * t795 * t794 + t398 * t822 * IMz * (3 * t801 + 12 * t804 + 6 * t807 + t811 - 6 * t812 + 12 * t814 - 2 * t42 - 4 * t44 - 4 * t46) * t786 / 4
    contr[15] = t827 * t785
    t828 = psih - t173
    t829 = cos(t828)
    t830 = t40 * t22
    t831 = t61 * t830
    t832 = Q1 * t22
    t833 = t200 * t832
    t835 = 2 * t831 + 2 * t833
    t836 = t48 * t835
    t837 = t54 ^ 2
    t838 = t837 * t22
    t840 = t59 * (t713 + t838 - 2/3)
    t841 = Q2 * t23
    t844 = Q2 * t54 * t22
    t845 = 2 * t844
    t848 = t836 + t840 + (-4 * t841 + t845) * t38
    t851 = t14 * t848 * t135 * t420
    t852 = t835 * t59
    t853 = Q1 * t830
    t854 = 2 * t853
    t855 = t19 * t832
    t859 = t715 + t852 + (-t854 + 4 * t855) * t38
    t861 = t859 * t431 * t430
    t866 = t90 * sdelta * t444
    t870 = t803 * t196
    t871 = 4 * t870
    t872 = t837 * t196
    t876 = t806 * t189
    t878 = t809 * t189
    t879 = 2 * t878
    t880 = t197 * t203
    t882 = t200 * t203
    t884 = t871 + t872 - 4/3 * t52 - 2/3 * t56 + 4/3 * t57 + 2 * t876 + t879 - 4 * t880 + 2 * t882
    t887 = t14 * t884 * t135 * t420
    t888 = 4 * t804
    t892 = t801 + t720 + t888 + t724 - 2/3 * t42 - 4/3 * t44 - 4/3 * t46
    t894 = t892 * t431 * t430
    t898 = t80 * sdelta
    t899 = t464 * t898
    t903 = sdelta * t106
    t904 = t903 * t460
    t907 = t14 * t884 * t478 * t476
    t909 = t892 * t485 * t483
    contr[16] = (t457 * t866 * t674 * (t851 + t861) * muM / 2 + t470 * t899 * t679 * (t887 + t894) * muM / 4 + 3/4 * t499 * t110 * t15 * (t907 + t909) * t904) * t829
    t917 = 2 * psil
    t918 = psih - t917
    t919 = cos(t918)
    t920 = t522 * t252
    t923 = t357 * t527 * t243
    t926 = sdelta * q
    t933 = t15 * t373
    t934 = t933 * t135 * t85
    t939 = t553 * t95 * t87 * t548 * t110
    t942 = 3/4 * t923 * t788 * t920 + 3/8 * t537 * t797 * t795 * t926 + 3/4 * t939 * t934 * t795 * t252
    contr[17] = t942 * t919
    t943 = psih - psil
    t944 = cos(t943)
    t945 = t14 * t848
    t946 = t945 * t574
    t947 = t859 * t430
    t951 = t898 * t444
    t955 = t14 * t884
    t956 = t955 * t574
    t957 = t892 * t430
    t964 = t955 * t600
    t965 = t892 * t483
    t970 = t110 * t15 * sdelta
    contr[18] = (3/2 * t588 * t951 * (t946 + t947) * t2 * t418 + 3/4 * t597 * t899 * t106 * (t956 + t957) * t591 + 3/4 * t612 * t970 * t106 * (t964 + t965) * t591) * t944
    t975 = psih + psil
    t976 = cos(t975)
    t991 = t106 * t2
    contr[19] = (-3/2 * t588 * t898 * t9 * (-t946 + t947) * t572 - 3/4 * t597 * t899 * (-t956 + t957) * t106 * t591 - 3/4 * t612 * t970 * t991 * (-t964 + t965) * muM) * t976
    t997 = psih + t917
    t998 = cos(t997)
    contr[20] = -t942 * t998
    t1000 = psih + t173
    t1001 = cos(t1000)
    t1002 = pi * t175
    t1003 = t1002 * t418
    t1004 = sdelta * t9
    contr[21] = (-t457 * t90 * (-t851 + t861) * t1004 * t1003 / 2 - t470 * t464 * t80 * (-t887 + t894) * t904 / 4 - 3/4 * t499 * t110 * t15 * (-t907 + t909) * t904) * t1001
    t1024 = psih + t340
    t1025 = cos(t1024)
    contr[22] = -t827 * t1025
    t1028 = cos(-t173 + psig)
    t1029 = sdelta * muM
    t1030 = t265 * t14
    t1031 = t1030 * t1029
    t1032 = IMy * t9
    t1033 = pi * t74
    t1036 = t175 * t1033 * t1032 * t1031
    t1037 = t180 + t271
    t1038 = 0.1e1 / t1037
    t1040 = 3 * npsil
    t1041 = -t1040 + npsig
    t1042 = 1 / t1041
    t1043 = t1042 * t1038 * t83
    t1045 = t100 * t1043 * t243
    t1048 = IMy * t265
    t1049 = t1048 * t1029
    t1050 = t109 * t512
    t1052 = t1050 * t107 * t1049
    t1053 = t1041 ^ 2
    t1055 = 1 / t1053 * t1038
    t1057 = t131 * t119 * t1055
    t1060 = t74 * IMy
    t1061 = t16 * t1002
    t1063 = t1061 * t1060 * t1031
    t1064 = t304 * t1055
    t1067 = t306 * t129 * t96
    t1068 = t1067 * t1064 * t110
    t1071 = t180 - t271
    t1073 = t265 * t14 * t1071
    t1075 = t15 * t679
    t1076 = t1075 * t1060
    t1077 = t1076 * t1073 * t1029
    t1078 = t1037 ^ 2
    t1081 = t95 * t1042 / t1078
    t1082 = t1081 * t110
    t1083 = t155 * t1082
    t1087 = t154 * t90 * t328
    t1088 = t1087 * t1082
    contr[23] = (3/2 * t1045 * t1036 - 9/4 * t1057 * t1052 - 3/2 * t1068 * t1063 + 9/4 * t1083 * t1077 + 3/4 * t1088 * t1077) * t1028
    t1092 = -psil + psig
    t1093 = cos(t1092)
    t1096 = t2 * t1033 * t1032 * t1031
    t1097 = q + t271
    t1098 = 0.1e1 / t1097
    t1100 = -npsil + npsig
    t1101 = 1 / t1100
    t1107 = t80 * t2
    t1109 = t109 * t1107 * t107
    t1110 = t1109 * t1049
    t1111 = t1100 ^ 2
    t1112 = 1 / t1111
    t1113 = t1112 * t1098
    t1118 = t16 * t571
    t1120 = t1118 * t1060 * t1031
    t1126 = q - t271
    t1131 = t15 * t991 * t1060 * t1126 * t1030 * t1029
    t1132 = t1097 ^ 2
    t1136 = t95 * t1101 / t1132 * t110
    contr[24] = (3/2 * t100 * t1101 * t1098 * t83 * t243 * t1096 - 3/4 * t131 * t119 * t1113 * t1110 - 3/2 * t1067 * t304 * t1113 * t110 * t1120 + 3/4 * t155 * t1136 * t1131 + 3/4 * t1087 * t1136 * t1131) * t1093
    t1144 = psil + psig
    t1145 = cos(t1144)
    t1146 = q * t271
    t1147 = 1 + t1146
    t1148 = 0.1e1 / t1147
    t1150 = npsil + npsig
    t1151 = 1 / t1150
    t1157 = t1150 ^ 2
    t1158 = 1 / t1157
    t1159 = t1158 * t1148
    t1171 = t15 * t2
    t1172 = t1146 - 1
    t1175 = t1172 * t1171 * t107 * IMy * t1030 * t1029
    t1176 = t1147 ^ 2
    t1180 = t95 * t1151 / t1176 * t110
    contr[25] = (3/2 * t100 * t1151 * t1148 * t83 * t243 * t1096 + 3/4 * t131 * t119 * t1159 * t1110 - 3/2 * t1067 * t304 * t1159 * t110 * t1120 + 3/4 * t155 * t1180 * t1175 - 3/4 * t1087 * t1180 * t1175) * t1145
    t1189 = cos(t173 + psig)
    t1190 = t180 * t271
    t1191 = 1 + t1190
    t1192 = 0.1e1 / t1191
    t1194 = t1040 + npsig
    t1195 = 1 / t1194
    t1196 = t1195 * t1192 * t83
    t1198 = t100 * t1196 * t243
    t1201 = t1194 ^ 2
    t1203 = 1 / t1201 * t1192
    t1205 = t131 * t119 * t1203
    t1208 = t304 * t1203
    t1210 = t1067 * t1208 * t110
    t1213 = t1190 - 1
    t1216 = t1076 * t1213 * t1030 * t1029
    t1217 = t1191 ^ 2
    t1220 = t95 * t1195 / t1217
    t1221 = t1220 * t110
    t1222 = t155 * t1221
    t1225 = t1087 * t1221
    contr[26] = (3/2 * t1198 * t1036 + 9/4 * t1205 * t1052 - 3/2 * t1210 * t1063 + 9/4 * t1222 * t1216 - 3/4 * t1225 * t1216) * t1189
    t1229 = t249 - t340 - psig
    t1230 = cos(t1229)
    t1231 = t265 * muM
    t1232 = t1231 * t794
    t1233 = IMz * t9
    t1234 = t118 * t253
    t1235 = t1234 * t1233
    t1236 = t1235 * t1232
    t1237 = t351 * t271
    t1238 = t1237 - 1
    t1239 = 0.1e1 / t1238
    t1240 = t1239 * t83
    t1242 = 4 * npsil
    t1243 = t1242 + npsig
    t1244 = 1 / t1243
    t1246 = t279 * t90 * t1244
    t1251 = t109 * t350 * t373
    t1252 = t1251 * t1232
    t1253 = t1243 ^ 2
    t1255 = 1 / t1253 * t1239
    t1257 = t131 * t368 * t1255
    t1260 = t118 * t16
    t1262 = t263 * t1260 * t346
    t1263 = t1262 * t1232
    t1265 = t307 * t1255 * t110
    t1268 = t1237 + 1
    t1269 = IMz * t1268
    t1270 = t15 * t106
    t1271 = t118 * t1270
    t1273 = t1271 * t1269 * t1232
    t1274 = t1238 ^ 2
    t1277 = t1244 / t1274 * t109
    t1278 = t1277 * t350
    t1285 = -3/4 * t1246 * t1240 * t350 * t1236 - 3/2 * t1257 * t1252 + 3/4 * t1265 * t1263 - 3/2 * t397 * t1278 * t1273 + 3/8 * t332 * t1278 * t1273
    contr[27] = t1285 * t1230
    t1286 = t249 - t173 - psig
    t1287 = cos(t1286)
    t1288 = t426 * t9
    t1289 = t175 * t12
    t1291 = t1289 * t1288 * t1031
    t1301 = -2 * t191 - 4 * t194 - 4 * t198 - 2 * t201 + t421 - 4 * t206
    t1302 = t80 * t1301
    t1303 = t109 * t1302
    t1305 = t1303 * t175 * t265 * t903 * t104
    t1308 = sdelta * pi
    t1313 = t80 * t1301 * t175 * t1030 * t1308 * t104
    t1314 = t16 * t109
    t1320 = t265 * t903 * t104
    t1321 = t175 * t14
    t1325 = t80 * t1213 * t1301 * t1321 * t1320
    t1326 = t1220 * t227
    t1333 = 3/4 * t1198 * t1291 + 9/8 * t1205 * t1305 - 3/4 * t1067 * t1208 * t1314 * t1313 + 9/8 * t155 * t1326 * t1325 - 3/8 * t1087 * t1326 * t1325
    contr[28] = t1333 * t1287
    t1334 = t249 - t173 + psig
    t1335 = cos(t1334)
    t1348 = -t80 * t1071 * t1301 * t1321 * t1320
    t1349 = t1081 * t227
    t1356 = 3/4 * t1045 * t1291 - 9/8 * t1057 * t1305 - 3/4 * t1067 * t1064 * t1314 * t1313 - 9/8 * t155 * t1349 * t1348 - 3/8 * t1087 * t1349 * t1348
    contr[29] = t1356 * t1335
    t1357 = t249 - psil - psig
    t1358 = cos(t1357)
    t1359 = sdelta * t16
    t1360 = t1359 * t1231
    t1362 = t14 * t1172
    t1363 = t1362 * t426 * IMy
    t1364 = IMx * t437
    t1366 = 2 * t1147 * t1364
    t1367 = t1363 - t1366
    t1368 = t1367 * t2
    t1372 = exp(4 * sigma)
    t1373 = t179 * t1372
    t1374 = t1373 - 1
    t1375 = 0.1e1 / t1374
    t1376 = t1375 * t1151
    t1378 = t100 * t1376 * t84
    t1381 = t903 * t1231
    t1382 = t1158 * t110
    t1387 = t131 * t468 * t116 * t1375
    t1396 = t1067 * t304 * t1375 * t1158 * t109
    t1400 = exp(6 * sigma)
    t1401 = t180 * t1400
    t1402 = 3 * t1373
    t1403 = 3 * t1146
    t1404 = t1401 - t1402 + t1403 - 1
    t1405 = IMy * t1404
    t1406 = t575 * t1405
    t1407 = t1401 + t1402 + t1403 + 1
    t1409 = 2 * t1407 * t1364
    t1412 = t80 * t15
    t1414 = t1412 * (t1406 - t1409) * t2 * t1381
    t1416 = t1374 ^ 2
    t1419 = t95 / t1416 * t1151 * t109
    t1420 = t155 * t1419
    t1423 = t1087 * t1419
    contr[30] = (3/4 * t1378 * t1368 * t444 * t1360 + 3/8 * t1387 * t1382 * t1368 * t1381 - 3/4 * t1396 * t80 * t1367 * t571 * t1360 + 3/8 * t1420 * t1414 - 3/8 * t1423 * t1414) * t1358
    t1427 = t249 - psil + psig
    t1428 = cos(t1427)
    t1429 = IMy * t1126
    t1430 = t575 * t1429
    t1433 = 2 * IMx * t437 * t1097
    t1434 = t1430 - t1433
    t1436 = t1434 * t16 * t1231
    t1437 = t2 * t9
    t1438 = t1437 * t1308
    t1440 = t179 - t1372
    t1441 = 0.1e1 / t1440
    t1442 = t1441 * t1101
    t1444 = t100 * t1442 * t84
    t1449 = t1112 * t110
    t1450 = t1449 * t991
    t1454 = t131 * t468 * t116 * t1441
    t1457 = t1107 * t1308
    t1462 = t1067 * t304 * t1441 * t1112 * t109
    t1465 = t179 * t271
    t1466 = 3 * t1465
    t1468 = 3 * q * t1372
    t1469 = t180 - t1466 + t1468 - t1400
    t1470 = IMy * t1469
    t1471 = t575 * t1470
    t1472 = t180 + t1466 + t1468 + t1400
    t1475 = 2 * IMx * t1472 * t437
    t1479 = t1412 * t2 * (t1471 - t1475) * t1381
    t1481 = t1440 ^ 2
    t1484 = t95 / t1481 * t1101 * t109
    t1485 = t155 * t1484
    t1488 = t1087 * t1484
    contr[31] = (3/4 * t1444 * t1438 * t1436 - 3/8 * t1454 * t1450 * sdelta * t1434 * t1231 - 3/4 * t1462 * t1457 * t1436 + 3/8 * t1485 * t1479 + 3/8 * t1488 * t1479) * t1428
    t1492 = t249 + psil - psig
    t1493 = cos(t1492)
    t1495 = (t1430 + t1433) * muM
    t1496 = t16 * t265
    t1497 = t1496 * t1495
    t1501 = sdelta * t265
    t1512 = t1412 * t991
    t1513 = t1512 * t1501 * (t1471 + t1475) * muM
    contr[32] = (3/4 * t1444 * t1438 * t1497 - 3/8 * t1454 * t1450 * t1501 * t1495 - 3/4 * t1462 * t1457 * t1497 + 3/8 * t1485 * t1513 + 3/8 * t1488 * t1513) * t1493
    t1519 = t249 + psil + psig
    t1520 = cos(t1519)
    t1521 = t1363 + t1366
    t1522 = t1521 * t2
    t1539 = t1512 * (t1406 + t1409) * sdelta * t1231
    contr[33] = (3/4 * t1378 * t1522 * t444 * t1360 + 3/8 * t1387 * t1382 * t1522 * t1381 - 3/4 * t1396 * t80 * t1521 * t571 * t1360 + 3/8 * t1420 * t1539 - 3/8 * t1423 * t1539) * t1520
    t1545 = t249 + t173 - psig
    t1546 = cos(t1545)
    contr[34] = t1356 * t1546
    t1547 = t249 + t173 + psig
    t1548 = cos(t1547)
    contr[35] = t1333 * t1548
    t1549 = t249 + t340 + psig
    t1550 = cos(t1549)
    contr[36] = -t1285 * t1550
    t1552 = -psig - t917 + t249
    t1553 = cos(t1552)
    t1554 = t1231 * t926
    t1555 = t1235 * t1554
    t1556 = t1465 - 1
    t1557 = 0.1e1 / t1556
    t1558 = t1557 * t83
    t1560 = 2 * npsil
    t1561 = t1560 + npsig
    t1562 = 1 / t1561
    t1564 = t279 * t90 * t1562
    t1568 = t1251 * t1554
    t1569 = t1561 ^ 2
    t1571 = 1 / t1569 * t1557
    t1573 = t131 * t368 * t1571
    t1576 = t1262 * t1554
    t1578 = t307 * t1571 * t110
    t1581 = t1465 + 1
    t1583 = t1581 * t265 * t1029
    t1584 = t118 * t15
    t1588 = t1556 ^ 2
    t1589 = 0.1e1 / t1588
    t1591 = t95 * t1562 * t1589
    t1593 = t553 * t1591 * t110
    t1597 = t1271 * IMz * t1581
    t1600 = t1562 * t1589 * t109
    t1605 = -3/4 * t1564 * t1558 * t350 * t1555 - 3/4 * t1573 * t1568 + 3/4 * t1578 * t1576 - 3/4 * t1593 * t263 * t1584 * t373 * t1583 + 3/8 * t332 * t1600 * t350 * t1597 * t1554
    contr[37] = t1605 * t1553
    t1606 = -psig + t917 + t249
    t1607 = cos(t1606)
    t1608 = -t271 + t179
    t1609 = 0.1e1 / t1608
    t1610 = t1609 * t83
    t1612 = -t1560 + npsig
    t1613 = 1 / t1612
    t1615 = t279 * t90 * t1613
    t1619 = t1612 ^ 2
    t1620 = 1 / t1619
    t1621 = t1620 * t1609
    t1623 = t131 * t368 * t1621
    t1627 = t307 * t1621 * t110
    t1631 = t179 + t271
    t1632 = t1631 * t118
    t1636 = t1608 ^ 2
    t1637 = 0.1e1 / t1636
    t1641 = t553 * t95 * t1613 * t1637 * t110
    t1645 = t1631 * t1584 * t373
    t1648 = t1613 * t1637 * t109
    t1653 = 3/4 * t1615 * t1610 * t350 * t1555 - 3/4 * t1623 * t1568 - 3/4 * t1627 * t1576 + 3/4 * t1641 * t263 * t1632 * t1270 * t266 * t1029 + 3/8 * t332 * t1648 * t350 * t1645 * t1554
    contr[38] = t1653 * t1607
    t1654 = psig - t917 + t249
    t1655 = cos(t1654)
    contr[39] = -t1653 * t1655
    t1657 = psig - t917 - psih
    t1658 = cos(t1657)
    t1659 = t728 * t522
    t1660 = IMz * t731
    t1661 = t1234 * t1660
    t1662 = t1661 * t1659
    t1663 = t80 * t725
    t1665 = t1615 * t1610 * t1663
    t1668 = t737 * t522
    t1670 = t109 * t1663 * t373
    t1671 = t1670 * t1668
    t1675 = t725 * t1260 * t346
    t1676 = t1675 * t1668
    t1680 = t725 * t1632 * t1270
    t1686 = t332 * t1648 * t1663
    t1693 = t253 * t266
    t1696 = t166 * t80
    t1697 = t1696 * t725 * t117
    t1699 = t168 * t1613 * t1609
    t1700 = t1699 * t1697
    contr[40] = (-3/4 * t1665 * t1662 + 3/4 * t1623 * t1671 + 3/4 * t1627 * t1676 - 3/4 * t1641 * t1680 * t738 - 3/8 * t1686 * t1645 * t1668) * t1658 + 3/4 * t1700 * t1693 * muM * q * t1658
    t1703 = psig - t917 + psih
    t1704 = cos(t1703)
    t1705 = IMz * t764
    t1706 = t1234 * t1705
    t1710 = t764 * t265
    t1711 = t1710 * t522
    t1712 = t1670 * t1711
    t1715 = t1675 * t1711
    contr[41] = (3/4 * t1665 * t1706 * t1659 - 3/4 * t1623 * t1712 - 3/4 * t1627 * t1715 + 3/4 * t1641 * t1680 * t766 + 3/8 * t1686 * t1645 * t1711) * t1704 - 3/4 * t1700 * t1693 * muM * q * t1704
    t1731 = psig + t917 + t249
    t1732 = cos(t1731)
    contr[42] = -t1605 * t1732
    t1734 = -psih + t249 - psig
    t1735 = cos(t1734)
    t1736 = pi * t118
    t1737 = t54 * t830
    t1740 = t54 * t832
    t1743 = t38 * (-2 * t853 - 2 * t1740)
    t1744 = t48 * (t711 + t1737) + t1743 + t852
    t1746 = t9 * t1744 * t1736
    t1747 = t764 * t16
    t1751 = t280 * t274 * t755
    t1754 = t16 * t1744
    t1755 = t1754 * t1736
    t1760 = t15 * t1744 * t313
    t1761 = t311 * t266
    t1770 = t316 * t1754
    contr[43] = (-3/8 * t1751 * t316 * t1747 * t1746 + 3/8 * t308 * t766 * t1755 + 3/16 * t333 * t1761 * t765 * t1760) * t1735 + 3/8 * t759 * t1770 * pi * t117 * t1735
    t1774 = -psih + t249 + psig
    t1775 = cos(t1774)
    t1783 = t731 * muM
    contr[44] = (3/8 * t1751 * t1660 * t418 * t1746 - 3/8 * t308 * t738 * t1755 - 3/16 * t333 * t1761 * t1783 * t1760) * t1775 - 3/8 * t759 * t1770 * pi * t117 * t1775
    t1795 = -psih + psig - psil
    t1796 = cos(t1795)
    t1797 = t1496 * t1783
    t1798 = t945 * t1429
    t1800 = IMx * t859 * t1097
    t1807 = t955 * t1429
    t1809 = IMx * t892 * t1097
    t1810 = -t1807 + t1809
    t1812 = t1810 * t265 * t1783
    t1816 = t243 * t571
    t1821 = t106 * t265 * t1783
    t1822 = t955 * t1470
    t1824 = IMx * t892 * t1472
    t1828 = t1412 * t2 * (-t1822 + t1824) * t1821
    t1840 = t168 * t1442
    t1841 = t1840 * t244
    contr[45] = (-3/4 * t1444 * t1437 * pi * (-t1798 + t1800) * t1797 + 3/8 * t1454 * t1450 * t1812 + 3/4 * t1462 * t1816 * t1812 - 3/8 * t1485 * t1828 - 3/8 * t1488 * t1828) * t1796 + 3/4 * t1841 * t2 * pi * t1810 * t265 * muM * t1796
    t1844 = -psih + psig + psil
    t1845 = cos(t1844)
    t1846 = t1172 * IMy
    t1847 = t945 * t1846
    t1849 = t1147 * IMx * t859
    t1857 = t955 * t1846
    t1858 = IMx * t892
    t1859 = t1147 * t1858
    t1860 = t1857 + t1859
    t1862 = t265 * t1860 * t1783
    t1863 = t1382 * t991
    t1870 = t955 * t1405
    t1871 = t1407 * t1858
    t1875 = t1412 * (t1870 + t1871) * t2 * t1821
    t1884 = pi * t265
    t1887 = t168 * t1376
    t1888 = t1887 * t244
    contr[46] = (3/4 * t1378 * t1437 * t253 * t265 * (t1847 + t1849) * t1783 + 3/8 * t1387 * t1863 * t1862 - 3/4 * t1396 * t1816 * t1862 + 3/8 * t1420 * t1875 - 3/8 * t1423 * t1875) * t1845 - 3/4 * t1888 * t2 * t1884 * t1860 * muM * t1845
    t1891 = -psih + psig + t917
    t1892 = cos(t1891)
    t1901 = t1581 * t731
    t1902 = t1901 * t1231
    t1919 = t168 * t1562 * t1557
    contr[47] = (3/4 * t1564 * t1558 * t1663 * t1662 + 3/4 * t1573 * t1671 - 3/4 * t1578 * t1676 + 3/4 * t1593 * t725 * t1584 * t373 * t1902 - 3/8 * t332 * t1600 * t1663 * t1597 * t1668) * t1892 - 3/4 * t1919 * t1697 * t1693 * muM * q * t1892
    t1923 = -psih - t340 + psig
    t1924 = cos(t1923)
    t1927 = t351 - t271
    t1928 = 0.1e1 / t1927
    t1929 = t1928 * t83
    t1931 = -t1242 + npsig
    t1932 = 1 / t1931
    t1934 = t279 * t90 * t1932
    t1938 = t737 * t344
    t1939 = t1670 * t1938
    t1940 = t1931 ^ 2
    t1941 = 1 / t1940
    t1942 = t1941 * t1928
    t1944 = t131 * t368 * t1942
    t1947 = t1675 * t1938
    t1949 = t307 * t1942 * t110
    t1952 = t351 + t271
    t1953 = t179 * t1952
    t1956 = t1271 * t1660 * t1231 * t1953
    t1957 = t1927 ^ 2
    t1960 = t1932 / t1957 * t109
    t1961 = t1960 * t1663
    t1974 = t168 * t1932 * t1928
    t1975 = t1974 * t1697
    contr[48] = (-3/4 * t1934 * t1929 * t1663 * t1661 * t728 * t344 + 3/2 * t1944 * t1939 + 3/4 * t1949 * t1947 - 3/2 * t397 * t1961 * t1956 - 3/8 * t332 * t1961 * t1956) * t1924 + 3/4 * t1975 * t1693 * muM * t179 * t1924
    t1978 = -psih - t173 + psig
    t1979 = cos(t1978)
    t1980 = t14 * muM
    t1982 = IMy * t731
    t1983 = 2 * t716
    t1991 = t840 + 2 * t61 * t28 * (t50 - t1983) + (2 * t68 + 2 * t256) * t55
    t1992 = pi * t1991
    t1995 = t175 * t1992 * t1982 * t728 * t1980
    t1998 = t1982 * t1231
    t2001 = t1050 * t106 * t1991 * t1998
    t2004 = t737 * t1980
    t2005 = t1991 * IMy
    t2007 = t1061 * t2005 * t2004
    t2012 = t731 * t1030 * t1071 * muM
    t2013 = t1075 * t2005
    t2014 = t2013 * t2012
    t2023 = t1992 * t1048
    t2025 = t1696 * t674
    t2027 = t168 * t1042 * t1038
    t2028 = t2027 * t2025
    contr[49] = (3/4 * t1045 * t1995 - 9/8 * t1057 * t2001 - 3/4 * t1068 * t2007 + 9/8 * t1083 * t2014 + 3/8 * t1088 * t2014) * t1979 - 3/4 * t2028 * t2023 * t14 * muM * t1979
    t2031 = -psih + t173 + psig
    t2032 = cos(t2031)
    t2041 = t2013 * t1213 * t737 * t1980
    t2052 = t168 * t1195 * t1192
    t2053 = t2052 * t2025
    contr[50] = (3/4 * t1198 * t1995 + 9/8 * t1205 * t2001 - 3/4 * t1210 * t2007 + 9/8 * t1222 * t2041 - 3/8 * t1225 * t2041) * t2032 - 3/4 * t2053 * t2023 * t14 * muM * t2032
    t2056 = -psih + t340 + psig
    t2057 = cos(t2056)
    t2058 = t265 * t725
    t2059 = t2058 * t344
    t2061 = t16 * t346
    t2062 = t2061 * t731 * t9
    t2064 = t80 * t118
    t2066 = t1246 * t1240 * t2064
    t2073 = t731 * t1268
    t2075 = t933 * t2073 * t2059
    t2076 = t1277 * t2064
    t2077 = t397 * t2076
    t2080 = t332 * t2076
    t2087 = t346 * t2058
    t2090 = t1696 * t117 * t16
    t2093 = t168 * t1244 * t1239 * t2090
    contr[51] = (3/4 * t2066 * t2062 * t2059 + 3/2 * t1257 * t1939 - 3/4 * t1265 * t1947 + 3/2 * t2077 * t2075 - 3/8 * t2080 * t2075) * t2057 - 3/4 * t2093 * t2087 * muM * t179 * t2057
    t2096 = psih + t249 - psig
    t2097 = cos(t2096)
    t2098 = t347 * t1736
    t2099 = 8 * t712
    t2105 = t38 * (-t854 - 8 * t855 + 2 * t1740)
    t2110 = t48 * (t711 - t1737 - t2099) + t2105 + (2 * t831 - 6 * t833) * t59
    t2111 = t2110 * muM
    t2117 = t731 * t2110
    t2131 = IMz * t2110
    t2132 = t2131 * t418
    contr[52] = (3/8 * t1751 * t1660 * t2111 * t2098 - 3/8 * t308 * t266 * t2117 * t418 * t1736 - 3/16 * t333 * t1761 * t2117 * t473 * t313) * t2097 - 3/8 * t759 * t2132 * pi * t117 * t2097
    t2136 = psih + t249 + psig
    t2137 = cos(t2136)
    contr[53] = (-3/8 * t1751 * t2131 * t765 * t2098 + 3/8 * t308 * t266 * t2111 * t1747 * t1736 + 3/16 * t333 * t1761 * t2111 * t772 * t313) * t2137 + 3/8 * t759 * t2132 * pi * t117 * t2137
    t2159 = psih + psig - psil
    t2160 = cos(t2159)
    t2164 = pi * t764
    t2165 = t1437 * t2164
    t2169 = t1807 + t1809
    t2171 = t764 * t2169 * t1231
    t2181 = t1512 * t1710 * (t1822 + t1824) * muM
    contr[54] = (3/4 * t1444 * t2165 * (t1798 + t1800) * t16 * t1231 - 3/8 * t1454 * t1450 * t2171 - 3/4 * t1462 * t1816 * t2171 + 3/8 * t1485 * t2181 + 3/8 * t1488 * t2181) * t2160 - 3/4 * t1841 * t2 * pi * t2169 * t265 * muM * t2160
    t2195 = psih + psig + psil
    t2196 = cos(t2195)
    t2203 = -t1857 + t1859
    t2205 = t764 * t2203 * t1231
    t2215 = t1512 * (-t1870 + t1871) * t764 * t1231
    contr[55] = (-3/4 * t1378 * t2165 * (-t1847 + t1849) * t16 * t1231 - 3/8 * t1387 * t1863 * t2205 + 3/4 * t1396 * t1816 * t2205 - 3/8 * t1420 * t2215 + 3/8 * t1423 * t2215) * t2196 + 3/4 * t1888 * t2 * pi * t2203 * t265 * muM * t2196
    t2229 = psih + psig + t917
    t2230 = cos(t2229)
    t2231 = t2058 * t522
    t2232 = t764 * t9
    t2233 = t2061 * t2232
    t2236 = t1564 * t1558 * t2064
    t2247 = t1581 * t764
    t2248 = t933 * t2247
    t2251 = t332 * t1600 * t2064
    t2259 = t1919 * t2090
    contr[56] = (-3/4 * t2236 * t2233 * t2231 - 3/4 * t1573 * t1712 + 3/4 * t1578 * t1715 - 3/4 * t1593 * t1597 * t1710 * t795 + 3/8 * t2251 * t2248 * t2231) * t2230 + 3/4 * t2259 * t2087 * muM * q * t2230
    t2262 = psih - t340 + psig
    t2263 = cos(t2262)
    t2264 = t2233 * t2059
    t2266 = t1934 * t1929 * t2064
    t2270 = t109 * t80 * t106
    t2271 = t2270 * t1705
    t2272 = t2271 * t2059
    t2275 = t1706 * t2059
    t2279 = t933 * t1710
    t2280 = t2279 * t795 * t1953
    t2281 = t1960 * t2064
    t2282 = t397 * t2281
    t2285 = t332 * t2281
    contr[57] = (3/4 * t2266 * t2264 - 3/2 * t1944 * t2272 - 3/4 * t1949 * t2275 + 3/2 * t2282 * t2280 + 3/8 * t2285 * t2280) * t2263 - 3/4 * t1975 * t1693 * muM * t179 * t2263
    t2295 = psih - t173 + psig
    t2296 = cos(t2295)
    t2297 = muM * t1991
    t2298 = t1030 * t2297
    t2299 = t1289 * t2232
    t2300 = t2299 * t2298
    t2304 = t1050 * t138
    t2305 = t2304 * t1710 * t2297
    t2308 = IMy * t764
    t2309 = t1061 * t2308
    t2310 = t2309 * t2298
    t2315 = t1075 * t2308 * t1073 * t2297
    contr[58] = (3/4 * t1045 * t2300 - 9/8 * t1057 * t2305 - 3/4 * t1068 * t2310 + 9/8 * t1083 * t2315 + 3/8 * t1088 * t2315) * t2296 - 3/4 * t2028 * t2023 * t14 * muM * t2296
    t2327 = psih + t173 + psig
    t2328 = cos(t2327)
    t2338 = t1075 * IMy * t1213
    t2339 = t2338 * t764 * t1030 * t2297
    contr[59] = (3/4 * t1198 * t2300 + 9/8 * t1205 * t2305 - 3/4 * t1210 * t2310 + 9/8 * t1222 * t2339 - 3/8 * t1225 * t2339) * t2328 - 3/4 * t2053 * t2023 * t14 * muM * t2328
    t2351 = psih + t340 + psig
    t2352 = cos(t2351)
    t2361 = t933 * t764 * t1268 * t2059
    contr[60] = (-3/4 * t2066 * t2264 - 3/2 * t1257 * t2272 + 3/4 * t1265 * t2275 - 3/2 * t2077 * t2361 + 3/8 * t2080 * t2361) * t2352 + 3/4 * t2093 * t2087 * muM * t179 * t2352
    t2373 = -t340 + t249 - psih
    t2374 = cos(t2373)
    t2375 = t1744 * sdelta
    t2376 = t179 * t118
    t2380 = t357 * t354 * t269
    t2388 = t54 * t40 * t189
    t2389 = 2 * t807
    t2390 = 2 * t810
    t2391 = 2 * t812
    t2393 = 2 * t381 * t203
    t2397 = t822 * t316
    t2401 = -3/16 * t2380 * t753 * t2376 * t2375 - 3/32 * t370 * t797 * t344 * t2375 - 3/8 * t398 * t2397 * t2376 * (t801 + t2388 + t2389 + t2390 - t2391 - t2393) * sdelta
    contr[61] = t2401 * t2374
    t2402 = -t340 + t249 + psih
    t2403 = cos(t2402)
    t2404 = t253 * t2131
    t2420 = 3/16 * t2380 * t2404 * t786 + 3/32 * t370 * t797 * t2111 * t794 + 3/8 * t398 * t822 * IMz * (t801 - t2388 - 8 * t804 + t2389 - t811 - t2391 - 8 * t814 + t2393) * t786
    contr[62] = t2420 * t2403
    t2421 = -t340 + psig + t249
    t2422 = cos(t2421)
    t2437 = t15 * t363 * t266 * t344 * sdelta * t1952
    t2442 = -3/4 * t2266 * t16 * pi * t263 * t1233 * t1232 + 3/2 * t1944 * t1252 + 3/4 * t1949 * t1263 - 3/2 * t2282 * t2437 - 3/8 * t2285 * t2437
    contr[63] = t2442 * t2422
    t2443 = -t173 + t249 - psih
    t2444 = cos(t2443)
    t2445 = Q2 * t830
    t2447 = 2 * t2445 + 2 * t844
    t2448 = t38 * t2447
    t2452 = t40 * t28 * t71 + t71 * t55 + t2448
    t2455 = t14 * t419 * t2452 * t574
    t2456 = t54 * t49
    t2461 = 2 * t68 + 2 * t70
    t2465 = t1743 + t801 + t40 * t28 * (t2456 + t63) + 2 * t61 * t28 * t2461 - t888 - t2390
    t2467 = t430 * t2465 * t431
    t2469 = (t2455 + t2467) * muM
    t2480 = t14 * t475 * t2452 * t600
    t2482 = t483 * t2465 * t485
    t2485 = t175 * t15
    t2487 = t110 * t903
    contr[64] = (-t457 * t866 * t674 * t2469 / 4 - t470 * t899 * t679 * t2469 / 8 - 3/8 * t499 * t2487 * t2485 * muM * (t2480 + t2482)) * t2444
    t2492 = -t173 + t249 + psih
    t2493 = cos(t2492)
    t2497 = t38 * (2 * t2445 - 8 * t841 - t845)
    t2503 = t2497 + t40 * t28 * (6 * t68 + t70) + 8 * t870 - t879 - t872
    t2506 = t14 * t419 * t2503 * t574
    t2507 = IMx * t431
    t2515 = t2105 + t801 + t40 * t28 * (-t2456 + t63) - 2 * t61 * t28 * t2461 - t888 - t2390
    t2517 = t85 * t2515 * t2507
    t2518 = t2506 + t2517
    t2520 = t90 * t9
    t2532 = t14 * t475 * t2503 * t600
    t2533 = IMx * t485
    t2535 = t482 * t2515 * t2533
    contr[65] = (t457 * t2520 * t2518 * sdelta * t1003 / 4 + t470 * t464 * t80 * t2518 * t904 / 8 + 3/8 * t499 * t2487 * t175 * (t2532 + t2535) * t473) * t2493
    t2543 = -t917 + t249 - psih
    t2544 = cos(t2543)
    t2549 = t357 * t527 * t269
    t2561 = -3/8 * t2549 * t753 * q * t118 * t2375 - 3/16 * t537 * t797 * t522 * t2375 - 3/8 * t939 * t934 * muM * t118 * t2375
    contr[66] = t2561 * t2544
    t2562 = -t917 + t249 + psih
    t2563 = cos(t2562)
    t2575 = 3/8 * t2549 * t2404 * t920 + 3/16 * t537 * t797 * t2111 * t926 + 3/8 * t939 * t934 * t2111 * t252
    contr[67] = t2575 * t2563
    t2576 = -psil + t249 - psih
    t2577 = cos(t2576)
    t2578 = t14 * t2452
    t2579 = t2578 * t574
    t2580 = IMx * t2465
    t2581 = t85 * t2580
    t2583 = (t2579 + t2581) * muM
    t2584 = t2 * t16
    t2593 = t991 * t473
    t2594 = t2578 * t600
    t2595 = t482 * t2580
    contr[68] = (-3/4 * t588 * t951 * t2584 * t2583 - 3/8 * t597 * t899 * t991 * t2583 - 3/8 * t612 * t110 * sdelta * (t2594 + t2595) * t2593) * t2577
    t2603 = -psil + t249 + psih
    t2604 = cos(t2603)
    t2605 = t14 * t2503
    t2606 = t2605 * t574
    t2607 = t2515 * IMx
    t2608 = t85 * t2607
    t2609 = t2606 + t2608
    t2615 = t903 * t591
    t2621 = t2605 * t600
    t2622 = t482 * t2607
    contr[69] = (3/4 * t588 * t269 * t2609 * sdelta * t572 + 3/8 * t597 * t464 * t80 * t2609 * t2615 + 3/8 * t612 * t110 * sdelta * (t2621 + t2622) * t2593) * t2604
    t2630 = psil + t249 - psih
    t2631 = cos(t2630)
    t2633 = (-t2579 + t2581) * muM
    contr[70] = (3/4 * t588 * t951 * t2584 * t2633 + 3/8 * t597 * t899 * t991 * t2633 + 3/8 * t612 * t110 * sdelta * (-t2594 + t2595) * t2593) * t2631
    t2649 = psil + t249 + psih
    t2650 = cos(t2649)
    t2651 = -t2606 + t2608
    contr[71] = (-3/4 * t588 * t269 * t2651 * sdelta * t572 - 3/8 * t597 * t464 * t80 * t2651 * t2615 - 3/8 * t612 * t110 * sdelta * (-t2621 + t2622) * t2593) * t2650
    t2669 = t917 + t249 - psih
    t2670 = cos(t2669)
    contr[72] = -t2561 * t2670
    t2672 = t917 + t249 + psih
    t2673 = cos(t2672)
    contr[73] = -t2575 * t2673
    t2675 = t173 + t249 - psih
    t2676 = cos(t2675)
    t2677 = -t2455 + t2467
    contr[74] = (t457 * t2520 * t2677 * sdelta * t1003 / 4 + t470 * t464 * t80 * t2677 * t904 / 8 + 3/8 * t499 * t2487 * t2485 * (-t2480 + t2482) * muM) * t2676
    t2695 = t173 + t249 + psih
    t2696 = cos(t2695)
    t2697 = -t2506 + t2517
    contr[75] = (-t457 * t866 * t2697 * t175 * t418 / 4 - t470 * t899 * t106 * t2697 * t460 / 8 - 3/8 * t499 * t2487 * t2485 * muM * (-t2532 + t2535)) * t2696
    t2715 = t340 + t249 - psih
    t2716 = cos(t2715)
    contr[76] = -t2401 * t2716
    t2718 = t340 + t249 + psih
    t2719 = cos(t2718)
    contr[77] = -t2420 * t2719
    t2721 = t340 - psig + t249
    t2722 = cos(t2721)
    contr[78] = -t2442 * t2722
    t2724 = t249 - psih - t340 + psig
    t2725 = cos(t2724)
    t2727 = t1231 * t179 * t1744
    t2728 = t2062 * t2727
    t2731 = t2270 * t1660
    t2732 = t2731 * t2727
    t2735 = t1661 * t2727
    t2739 = t344 * t1952 * t1744
    t2740 = t933 * t737
    t2741 = t2740 * t2739
    t2750 = t346 * t1231
    t2752 = t1974 * t2090
    contr[79] = (-3/8 * t2266 * t2728 + 3/4 * t1944 * t2732 + 3/8 * t1949 * t2735 - 3/4 * t2282 * t2741 - 3/16 * t2285 * t2741) * t2725 + 3/8 * t2752 * t2750 * t179 * t1744 * t2725
    t2755 = t249 - psih + t340 - psig
    t2756 = cos(t2755)
    t2757 = t2233 * t2727
    t2760 = t2271 * t2727
    t2763 = t1706 * t2727
    t2766 = t2279 * t2739
    contr[80] = (3/8 * t2266 * t2757 - 3/4 * t1944 * t2760 - 3/8 * t1949 * t2763 + 3/4 * t2282 * t2766 + 3/16 * t2285 * t2766) * t2756 - 3/8 * t2752 * t2750 * t179 * t1744 * t2756
    t2778 = t249 + psih - t340 + psig
    t2779 = cos(t2778)
    t2780 = t265 * t2110
    t2781 = t2780 * t344
    t2782 = t2233 * t2781
    t2785 = t2271 * t2781
    t2788 = t1706 * t2781
    t2791 = t2111 * t1953
    t2792 = t2279 * t2791
    t2801 = t346 * t2780
    contr[81] = (3/8 * t2266 * t2782 - 3/4 * t1944 * t2785 - 3/8 * t1949 * t2788 + 3/4 * t2282 * t2792 + 3/16 * t2285 * t2792) * t2779 - 3/8 * t2752 * t2801 * muM * t179 * t2779
    t2805 = t249 + psih + t340 - psig
    t2806 = cos(t2805)
    t2807 = t2062 * t2781
    t2810 = t2731 * t2781
    t2813 = t1661 * t2781
    t2816 = t2740 * t2791
    contr[82] = (-3/8 * t2266 * t2807 + 3/4 * t1944 * t2810 + 3/8 * t1949 * t2813 - 3/4 * t2282 * t2816 - 3/16 * t2285 * t2816) * t2806 + 3/8 * t2752 * t2801 * muM * t179 * t2806
    t2828 = -psig + t917 + t249 - psih
    t2829 = cos(t2828)
    t2831 = t1231 * q * t1744
    t2832 = t2233 * t2831
    t2834 = t1615 * t1610 * t2064
    t2837 = t2271 * t2831
    t2840 = t1706 * t2831
    t2843 = muM * t1744
    t2844 = t1710 * t2843
    t2848 = t1631 * t764
    t2849 = t933 * t2848
    t2852 = t332 * t1648 * t2064
    t2860 = t1699 * t2090
    contr[83] = (3/8 * t2834 * t2832 - 3/8 * t1623 * t2837 - 3/8 * t1627 * t2840 + 3/8 * t1641 * t1645 * t2844 + 3/16 * t2852 * t2849 * t2831) * t2829 - 3/8 * t2860 * t2750 * q * t1744 * t2829
    t2863 = -psig + t917 + t249 + psih
    t2864 = cos(t2863)
    t2865 = t2780 * t522
    t2866 = t2062 * t2865
    t2869 = t2731 * t2865
    t2872 = t1661 * t2865
    t2875 = t737 * t2111
    t2879 = t1631 * t731
    t2880 = t933 * t2879
    contr[84] = (-3/8 * t2834 * t2866 + 3/8 * t1623 * t2869 + 3/8 * t1627 * t2872 - 3/8 * t1641 * t1645 * t2875 - 3/16 * t2852 * t2880 * t2865) * t2864 + 3/8 * t2860 * t2801 * muM * q * t2864
    t2891 = psig - t917 + t249 - psih
    t2892 = cos(t2891)
    t2893 = t2062 * t2831
    t2896 = t2731 * t2831
    t2899 = t1661 * t2831
    t2902 = t737 * t2843
    contr[85] = (-3/8 * t2834 * t2893 + 3/8 * t1623 * t2896 + 3/8 * t1627 * t2899 - 3/8 * t1641 * t1645 * t2902 - 3/16 * t2852 * t2880 * t2831) * t2892 + 3/8 * t2860 * t2750 * q * t1744 * t2892
    t2916 = psig - t917 + t249 + psih
    t2917 = cos(t2916)
    t2918 = t2233 * t2865
    t2921 = t2271 * t2865
    t2924 = t1706 * t2865
    t2927 = t1710 * t2111
    contr[86] = (3/8 * t2834 * t2918 - 3/8 * t1623 * t2921 - 3/8 * t1627 * t2924 + 3/8 * t1641 * t1645 * t2927 + 3/16 * t2852 * t2849 * t2865) * t2917 - 3/8 * t2860 * t2801 * muM * q * t2917
    t2941 = -psih + t249 - psig - t917
    t2942 = cos(t2941)
    contr[87] = (-3/8 * t2236 * t2832 - 3/8 * t1573 * t2837 + 3/8 * t1578 * t2840 - 3/8 * t1593 * t1597 * t2844 + 3/16 * t2251 * t2248 * t2831) * t2942 + 3/8 * t2259 * t2750 * q * t1744 * t2942
    t2962 = -psih + t249 + psig + t917
    t2963 = cos(t2962)
    t2975 = t15 * t1581 * t106 * t1660
    contr[88] = (3/8 * t2236 * t2893 + 3/8 * t1573 * t2896 - 3/8 * t1578 * t2899 + 3/8 * t1593 * t1597 * t2902 - 3/16 * t2251 * t2975 * t2831) * t2963 - 3/8 * t2259 * t2750 * q * t1744 * t2963
    t2986 = psih + t249 - psig - t917
    t2987 = cos(t2986)
    contr[89] = (3/8 * t2236 * t2866 + 3/8 * t1573 * t2869 - 3/8 * t1578 * t2872 + 3/8 * t1593 * t1597 * t2875 - 3/16 * t2251 * t2975 * t2865) * t2987 - 3/8 * t2259 * t2801 * muM * q * t2987
    t3007 = psih + t249 + psig + t917
    t3008 = cos(t3007)
    contr[90] = (-3/8 * t2236 * t2918 - 3/8 * t1573 * t2921 + 3/8 * t1578 * t2924 - 3/8 * t1593 * t1597 * t2927 + 3/16 * t2251 * t2248 * t2865) * t3008 + 3/8 * t2259 * t2801 * muM * q * t3008
    t3028 = psih + t249 - t340 - psig
    t3029 = cos(t3028)
    t3037 = t2111 * t179 * t1268
    t3038 = t2740 * t3037
    contr[91] = (3/8 * t2066 * t2807 + 3/4 * t1257 * t2810 - 3/8 * t1265 * t2813 + 3/4 * t2077 * t3038 - 3/16 * t2080 * t3038) * t3029 - 3/8 * t2093 * t2801 * muM * t179 * t3029
    t3050 = psih + t249 + t340 + psig
    t3051 = cos(t3050)
    t3058 = t2279 * t3037
    contr[92] = (-3/8 * t2066 * t2782 - 3/4 * t1257 * t2785 + 3/8 * t1265 * t2788 - 3/4 * t2077 * t3058 + 3/16 * t2080 * t3058) * t3051 + 3/8 * t2093 * t2801 * muM * t179 * t3051
    t3070 = -t340 - psig + t249 - psih
    t3071 = cos(t3070)
    t3079 = t344 * t1268 * t1744
    t3080 = t2279 * t3079
    contr[93] = (-3/8 * t2066 * t2757 - 3/4 * t1257 * t2760 + 3/8 * t1265 * t2763 - 3/4 * t2077 * t3080 + 3/16 * t2080 * t3080) * t3071 + 3/8 * t2093 * t2750 * t179 * t1744 * t3071
    t3092 = -t173 - psig + t249 - psih
    t3093 = cos(t3092)
    t3094 = -t1737 - t838
    t3097 = -t38 * t2447
    t3100 = t59 * t3094 - t48 * t835 + t3097
    t3103 = t2299 * t3100 * t265 * t1980
    t3106 = t50 - t63 - t1983
    t3110 = 2 * t50
    t3111 = -t3110 - t2456 + t1983
    t3116 = (t41 + t55) * t721
    t3117 = 2 * t61 * t28 * t3106 + 2 * t61 * t28 * t3111 - t3116 + t871
    t3118 = t764 * t3117
    t3120 = t2304 * t3118 * t1231
    t3123 = t3117 * t265
    t3125 = t2309 * t3123 * t1980
    t3129 = t764 * t3123 * t1980
    t3130 = t2338 * t3129
    t3139 = -t59 * t3094 + t2448 + t836
    t3141 = cdelta * IMy * t3139
    t3145 = t243 * t1321
    t3148 = t98 * t1195 * t1192 * t166
    t3149 = t3148 * t3145
    contr[94] = (3/8 * t1198 * t3103 + 9/16 * t1205 * t3120 - 3/8 * t1210 * t3125 + 9/16 * t1222 * t3130 - 3/16 * t1225 * t3130) * t3093 + 3/8 * t3149 * t3093 * muM * t1884 * t3141
    t3152 = -t173 - psig + t249 + psih
    t3153 = cos(t3152)
    t3154 = t1061 * t1032
    t3155 = t3154 * t2004
    t3162 = t59 * (t1737 + t2099 - t838) + t2497 + (6 * t831 - 2 * t833) * t48
    t3163 = t80 * t3162
    t3165 = t100 * t1196 * t3163
    t3178 = t871 + 2 * t61 * t28 * (t50 + t63 - t1983) + 2 * t61 * t28 * (t3110 - t2456 - t1983) + (t41 - t55) * t721
    t3181 = t109 * t80 * t3178 * t679
    t3182 = t3181 * t1998
    t3187 = t16 * t3178 * t175 * t12
    t3188 = t3187 * t2004
    t3192 = IMy * t737 * t1980
    t3195 = t15 * t1213 * t3178 * t679
    t3196 = t3195 * t3192
    t3205 = t460 * t1884
    t3208 = t243 * t3162 * t14
    t3209 = t3148 * t3208
    contr[95] = (3/8 * t3165 * t3155 + 9/16 * t1205 * t3182 - 3/8 * t1210 * t3188 + 9/16 * t1222 * t3196 - 3/16 * t1225 * t3196) * t3153 - 3/8 * t3209 * t3205 * cdelta * IMy * t3153
    t3212 = -t173 + psig + t249 - psih
    t3213 = cos(t3212)
    t3214 = t9 * t3100
    t3216 = t1289 * t3214 * t2004
    t3221 = t2304 * t3117 * t731 * t1231
    t3226 = t1061 * IMy * t3117 * t2004
    t3230 = t3117 * t737 * t1980
    t3233 = t15 * t1071 * t175 * t138
    t3234 = t3233 * t3230
    t3243 = t265 * cdelta
    t3244 = t509 * t3243
    t3248 = t98 * t1042 * t1038 * t166
    t3249 = t3248 * t3145
    contr[96] = (3/8 * t1045 * t3216 - 9/16 * t1057 * t3221 - 3/8 * t1068 * t3226 + 9/16 * t1083 * t3234 + 3/16 * t1088 * t3234) * t3213 + 3/8 * t3249 * t3244 * IMy * t3139 * t3213
    t3252 = -t173 + psig + t249 + psih
    t3253 = cos(t3252)
    t3254 = t1710 * t1980
    t3255 = t3154 * t3254
    t3257 = t100 * t1043 * t3163
    t3260 = t2308 * t1231
    t3261 = t3181 * t3260
    t3264 = t3187 * t3254
    t3268 = IMy * t1710 * t1980
    t3271 = t15 * t3178 * t1071 * t679
    t3272 = t3271 * t3268
    t3280 = t265 * cdelta * IMy
    t3284 = t3248 * t3208
    contr[97] = (3/8 * t3257 * t3255 - 9/16 * t1057 * t3261 - 3/8 * t1068 * t3264 + 9/16 * t1083 * t3272 + 3/16 * t1088 * t3272) * t3253 - 3/8 * t3284 * t460 * pi * t3253 * t3280
    t3287 = -psil - psig + t249 - psih
    t3288 = cos(t3287)
    t3289 = t2578 * t1846
    t3291 = IMx * t2465 * t1147
    t3292 = t3289 + t3291
    t3294 = t3292 * t16 * t1231
    t3303 = t1107 * t2164
    t3307 = t2452 * IMy
    t3309 = t14 * t1404 * t3307
    t3311 = IMx * t2465 * t1407
    t3315 = t1512 * t1710 * (t3309 + t3311) * muM
    t3328 = -t40 * t28 * t71 + t3097 - t872 - t879
    t3331 = t14 * IMy * t1172 * t3328
    t3335 = t80 * t1496
    t3338 = t98 * t1375 * t1151 * t166
    t3339 = t3338 * t3335
    contr[98] = (-3/8 * t1378 * t2165 * t3294 - 3/16 * t1387 * t1863 * t764 * t3292 * t1231 + 3/8 * t1396 * t3303 * t3294 - 3/16 * t1420 * t3315 + 3/16 * t1423 * t3315) * t3288 + 3/8 * t3339 * (-t3331 + t3291) * cdelta * muM * t2 * pi * t3288
    t3342 = -psil - psig + t249 + psih
    t3343 = cos(t3342)
    t3344 = t2605 * t1846
    t3345 = IMx * t1147
    t3346 = t2515 * t3345
    t3347 = t3344 + t3346
    t3348 = t3347 * muM
    t3349 = t1496 * t3348
    t3350 = pi * t731
    t3351 = t1437 * t3350
    t3359 = t1107 * t3350
    t3363 = t2605 * t1405
    t3364 = IMx * t1407
    t3365 = t2515 * t3364
    t3369 = t1412 * (t3363 + t3365) * t2 * t1821
    t3378 = pi * t1496
    t3380 = t166 * t1107
    t3381 = t1887 * t3380
    contr[99] = (3/8 * t1378 * t3351 * t3349 + 3/16 * t1387 * t1863 * t737 * t3348 - 3/8 * t1396 * t3359 * t3349 + 3/16 * t1420 * t3369 - 3/16 * t1423 * t3369) * t3343 - 3/8 * t3381 * t3378 * t3347 * muM * t3343
    t3384 = -psil + psig + t249 - psih
    t3385 = cos(t3384)
    t3386 = t14 * t1126
    t3387 = t3386 * t3307
    t3389 = IMx * t2465 * t1097
    t3391 = (t3387 + t3389) * muM
    t3392 = t1496 * t3391
    t3403 = t2578 * t1470
    t3405 = IMx * t2465 * t1472
    t3409 = t1512 * (t3403 + t3405) * t731 * t1231
    t3417 = t3386 * IMy * t3328
    t3421 = cdelta * t591
    t3425 = t98 * t1441 * t1101 * t166
    t3426 = t3425 * t3335
    contr[100] = (-3/8 * t1444 * t3351 * t3392 + 3/16 * t1454 * t1450 * t737 * t3391 + 3/8 * t1462 * t3359 * t3392 - 3/16 * t1485 * t3409 - 3/16 * t1488 * t3409) * t3385 + 3/8 * t3426 * t3421 * pi * (-t3417 + t3389) * t3385
    t3429 = -psil + psig + t249 + psih
    t3430 = cos(t3429)
    t3431 = t2605 * t1429
    t3432 = IMx * t1097
    t3433 = t2515 * t3432
    t3434 = t3431 + t3433
    t3435 = t3434 * muM
    t3436 = t1496 * t3435
    t3448 = t106 * t764 * t1231
    t3449 = t2605 * t1470
    t3450 = IMx * t1472
    t3451 = t2515 * t3450
    t3455 = t1412 * t2 * (t3449 + t3451) * t3448
    t3465 = t1840 * t3380
    contr[101] = (3/8 * t1444 * t2165 * t3436 - 3/16 * t1454 * t1450 * t1710 * t3435 - 3/8 * t1462 * t3303 * t3436 + 3/16 * t1485 * t3455 + 3/16 * t1488 * t3455) * t3430 - 3/8 * t3465 * t3378 * t3434 * muM * t3430
    t3468 = psil - psig + t249 - psih
    t3469 = cos(t3468)
    t3471 = (-t3387 + t3389) * muM
    t3472 = t1496 * t3471
    t3486 = t1512 * t764 * (-t3403 + t3405) * t1231
    contr[102] = (3/8 * t1444 * t2165 * t3472 - 3/16 * t1454 * t1450 * t1710 * t3471 - 3/8 * t1462 * t3303 * t3472 + 3/16 * t1485 * t3486 + 3/16 * t1488 * t3486) * t3469 - 3/8 * t3426 * cdelta * (t3417 + t3389) * muM * t2 * pi * t3469
    t3501 = psil - psig + t249 + psih
    t3502 = cos(t3501)
    t3503 = -t3431 + t3433
    t3504 = t3503 * t2
    t3513 = t80 * t3503
    t3521 = t1412 * (-t3449 + t3451) * t2 * t1821
    contr[103] = (-3/8 * t1444 * t3504 * t444 * t1797 + 3/16 * t1454 * t1449 * t3504 * t1821 + 3/8 * t1462 * t3513 * t571 * t1797 - 3/16 * t1485 * t3521 - 3/16 * t1488 * t3521) * t3502 + 3/8 * t1840 * t166 * t3513 * t1118 * t265 * muM * t3502
    t3535 = psil + psig + t249 - psih
    t3536 = cos(t3535)
    t3537 = -t3289 + t3291
    t3538 = t2 * t3537
    t3555 = t80 * (-t3309 + t3311) * t1171 * t1821
    contr[104] = (3/8 * t1378 * t3538 * t444 * t1797 + 3/16 * t1387 * t1382 * t3538 * t1821 - 3/8 * t1396 * t1107 * t3537 * pi * t1797 + 3/16 * t1420 * t3555 - 3/16 * t1423 * t3555) * t3536 - 3/8 * t3339 * t3421 * pi * t3536 * (t3331 + t3291)
    t3568 = psil + psig + t249 + psih
    t3569 = cos(t3568)
    t3570 = -t3344 + t3346
    t3571 = t3570 * muM
    t3572 = t1496 * t3571
    t3586 = t1512 * t764 * (-t3363 + t3365) * t1231
    contr[105] = (-3/8 * t1378 * t2165 * t3572 - 3/16 * t1387 * t1863 * t1710 * t3571 + 3/8 * t1396 * t3303 * t3572 - 3/16 * t1420 * t3586 + 3/16 * t1423 * t3586) * t3569 + 3/8 * t3381 * t3378 * t3570 * muM * t3569
    t3598 = t173 - psig + t249 - psih
    t3599 = cos(t3598)
    t3606 = t3233 * t3129
    contr[106] = (3/8 * t1045 * t3103 - 9/16 * t1057 * t3120 - 3/8 * t1068 * t3125 + 9/16 * t1083 * t3606 + 3/16 * t1088 * t3606) * t3599 + 3/8 * t3249 * t509 * t3599 * t265 * t3141
    t3618 = t173 - psig + t249 + psih
    t3619 = cos(t3618)
    t3626 = t3271 * t3192
    contr[107] = (3/8 * t3257 * t3155 - 9/16 * t1057 * t3182 - 3/8 * t1068 * t3188 + 9/16 * t1083 * t3626 + 3/16 * t1088 * t3626) * t3619 - 3/8 * t3284 * t175 * t3619 * t509 * t3280
    t3638 = t173 + psig + t249 - psih
    t3639 = cos(t3638)
    t3646 = t2338 * t3230
    contr[108] = (3/8 * t1198 * t3216 + 9/16 * t1205 * t3221 - 3/8 * t1210 * t3226 + 9/16 * t1222 * t3646 - 3/16 * t1225 * t3646) * t3639 + 3/8 * t3149 * t3639 * muM * t1884 * t3141
    t3658 = t173 + psig + t249 + psih
    t3659 = cos(t3658)
    t3666 = t3195 * t3268
    contr[109] = (3/8 * t3165 * t3255 + 9/16 * t1205 * t3261 - 3/8 * t1210 * t3264 + 9/16 * t1222 * t3666 - 3/16 * t1225 * t3666) * t3659 - 3/8 * t3209 * t3205 * cdelta * t3659 * IMy
    t3678 = t340 + psig + t249 - psih
    t3679 = cos(t3678)
    t3686 = t2740 * t3079
    contr[110] = (3/8 * t2066 * t2728 + 3/4 * t1257 * t2732 - 3/8 * t1265 * t2735 + 3/4 * t2077 * t3686 - 3/16 * t2080 * t3686) * t3679 - 3/8 * t2093 * t2750 * t179 * t1744 * t3679
    t3698 = sin(psig)
    t3699 = t74 * sdelta
    t3700 = t1736 * t3699
    t3701 = t1233 * t418
    t3705 = t266 * t418
    t3711 = t317 * t15 * t311
    contr[111] = (-3/2 * t1751 * t3701 * t3700 + 3/2 * t308 * t3705 * t3700 + 3/4 * t333 * t3711 * t313 * t3699) * t3698
    t3716 = sin(psil)
    t3717 = t74 * muM
    t3718 = t3717 * t3
    t3720 = t253 * IMx * t9
    t3722 = 0.1e1 / t135
    t3723 = t87 * t3722
    t3728 = t106 * IMx
    t3734 = t131 * t468 * t116 * t114
    t3750 = IMx * t74
    contr[112] = (3 * t100 * t3723 * t84 * t3720 * t3718 + 3/2 * t3734 * t3722 * t110 * t3728 * t3718 + 3/2 * t155 * t550 / t477 * t109 * t80 * t1270 * t430 * t3718) * t3716 - 3 * t168 * t3723 * t244 * pi * t3750 * muM * t2 * t3716
    t3757 = sin(t917)
    t3759 = t346 * t9 * t74
    t3775 = t346 * t3717
    t3779 = t168 * t87 * t526 * t244
    contr[113] = (3/2 * t923 * t3759 * t523 + 3/4 * t537 * t797 * t3717 * t532 + 3/2 * t939 * t934 * t3717 * t343) * t3757 - 3/2 * t3779 * t3775 * q * t117 * t3757
    t3782 = sin(t173)
    t3785 = 0.1e1 / t222
    t3786 = t87 * t3785
    t3803 = t222 ^ 2
    contr[114] = (t100 * t3786 * t84 * t3720 * t3717 * t176 + t3734 * t3785 * t110 * t212 * t187 * IMx * muM / 6 + t155 * t550 / t3803 * t109 * t15 * t80 * t181 * t211 * muM * t176 * t3728 / 2) * t3782 - t168 * t3786 * t244 * t211 * t1002 * muM * IMx * t3782 / 3
    t3820 = sin(t340)
    t3828 = t187 * t316
    t3842 = t168 * t87 * t353 * t244
    contr[115] = (3/4 * t791 * t3759 * t345 + 3/8 * t370 * t797 * t3717 * t361 + t398 * t15 * t387 * t211 * t2376 * t3828 / 2) * t3820 - 3/4 * t3842 * t3775 * t179 * t117 * t3820
    t3845 = sin(t250)
    t3847 = t80 * t426
    t3852 = t1308 * t316
    t3853 = t118 * t265
    t3861 = t903 * t316
    t3868 = 3/4 * t280 * t274 * t3847 * t729 * t254 - 3/4 * t307 * t287 * t16 * t273 * t1302 * t3853 * t3852 - 3/8 * t333 * t15 * t311 * t1301 * t3853 * t3861
    contr[116] = t3868 * t3845
    t3869 = sin(t337)
    contr[117] = -t3868 * t3869
    t3871 = sin(t341)
    t3876 = t1301 * t179
    t3889 = -3/8 * t357 * t354 * t3847 * t349 - 3/16 * t370 * t110 * t3876 * t3828 - 3/4 * t397 * t394 * t227 * t80 * t387 * t1301 * t2376 * t3828
    t3893 = t117 * pi
    t3894 = t3876 * t3893
    contr[118] = t3889 * t3871 + 3/8 * t3842 * t3894 * muM * IMz * t3871
    t3898 = sin(t416)
    t3902 = 2 * t14 * t419 * t437 * t574
    t3904 = t426 * t85 * t2507
    t3905 = t3902 + t3904
    t3919 = 2 * t14 * t475 * t437 * t600
    t3921 = t426 * t482 * t2533
    t3932 = IMy * t263
    t3934 = t14 * t419 * t135
    t3935 = t3934 * t3932
    contr[119] = (-t457 * t446 * t3905 * t175 * t418 / 2 - t470 * t465 * t106 * t3905 * t460 / 4 - 3/4 * t499 * t492 * t175 * (t3919 + t3921) * t473) * t3898 + t516 * t16 * (t3935 + t3904) * muM * pi * cdelta * t3898 / 2
    t3942 = sin(t520)
    t3947 = t1301 * q
    t3957 = -3/4 * t357 * t527 * t3847 * t524 - 3/8 * t537 * t110 * t3947 * t3828 - 3/4 * t554 * t544 * t1301 * t118 * t3828
    t3961 = t3947 * t3893
    contr[120] = t3957 * t3942 + 3/4 * t3779 * t3961 * muM * IMz * t3942
    t3965 = sin(t569)
    t3966 = t14 * t437
    t3968 = 2 * t3966 * t574
    t3969 = t426 * t430
    t3971 = (t3968 + t3969) * muM
    t3973 = t269 * t405
    t3982 = 2 * t3966 * t600
    t3983 = t426 * t483
    t3992 = t14 * t135
    t3993 = t3992 * t3932
    t3998 = t626 * t3380
    contr[121] = (-3/2 * t588 * t3973 * t2584 * t3971 - 3/4 * t597 * t465 * t991 * t3971 - 3/4 * t612 * t492 * t1171 * (t3982 + t3983) * muM) * t3965 + 3/2 * t3998 * t510 * cdelta * (t3993 + t3969) * t3965
    t4001 = sin(t630)
    t4002 = -t3968 + t3969
    contr[122] = (3/2 * t588 * t3973 * t4002 * t2 * t418 + 3/4 * t597 * t465 * t106 * t4002 * t591 + 3/4 * t612 * t492 * (-t3982 + t3983) * t2 * t473) * t4001 - 3/2 * t3998 * t510 * cdelta * (-t3993 + t3969) * t4001
    t4027 = sin(t661)
    contr[123] = -t3957 * t4027 - 3/4 * t3779 * t3961 * muM * IMz * t4027
    t4035 = sin(t670)
    t4036 = -t3902 + t3904
    contr[124] = (t457 * t446 * t4036 * t175 * t418 / 2 + t470 * t465 * t106 * t4036 * t460 / 4 + 3/4 * t499 * t492 * (-t3919 + t3921) * t175 * t473) * t4035 - t516 * t510 * cdelta * (-t3935 + t3904) * t4035 / 2
    t4061 = sin(t699)
    contr[125] = -t3889 * t4061 - 3/8 * t3842 * t3894 * muM * IMz * t4061
    t4070 = sin(psig - t917)
    t4072 = t16 * t1033 * t1233
    t4073 = t4072 * t1554
    t4076 = t74 * IMz
    t4077 = t2270 * t4076
    t4078 = t4077 * t1554
    t4081 = t1234 * t4076
    t4082 = t4081 * t1554
    t4085 = t1631 * sdelta
    t4087 = t1271 * t4076
    t4092 = t15 * t107
    t4093 = t4092 * t266
    contr[126] = (3/2 * t2834 * t4073 - 3/2 * t1623 * t4078 - 3/2 * t1627 * t4082 + 3/2 * t1641 * t4087 * t1231 * t4085 + 3/4 * t2852 * t4093 * t522 * t4085) * t4070
    t4099 = sin(psig + t917)
    contr[127] = (-3/2 * t2236 * t4073 - 3/2 * t1573 * t4078 + 3/2 * t1578 * t4082 - 3/2 * t1593 * t4087 * t1583 + 3/4 * t2251 * t4093 * t522 * t1581 * sdelta) * t4099
    t4115 = sin(t708)
    t4116 = t731 * t1991
    t4117 = t1736 * t4116
    contr[128] = (-3/4 * t1751 * t3701 * t4117 + 3/4 * t308 * t3705 * t4117 + 3/8 * t333 * t3711 * t313 * t4116) * t4115 + 3/4 * t759 * t753 * t117 * t1991 * t4115
    t4135 = sin(t762)
    t4136 = t764 * t1991
    t4137 = t1736 * t4136
    contr[129] = (-3/4 * t1751 * t3701 * t4137 + 3/4 * t308 * t3705 * t4137 + 3/8 * t333 * t3711 * t313 * t4136) * t4135 + 3/4 * t759 * t753 * t117 * t1991 * t4135
    t4155 = sin(t784)
    t4158 = t346 * t10
    t4162 = t1991 * sdelta
    t4182 = 3/8 * t791 * t4158 * t179 * t1991 * t252 + 3/16 * t370 * t797 * t344 * t4162 + t398 * t2397 * t179 * (6 * t876 + 6 * t878 + 12 * t870 + 3 * t872 - 12 * t880 + 6 * t882 - 4 * t52 - 2 * t56 + 4 * t57) * t252 / 4
    contr[130] = t4182 * t4155
    t4183 = sin(t828)
    t4186 = t14 * t419 * t859 * t574
    t4188 = t430 * t431 * t848
    t4197 = t14 * t419 * t892 * t574
    t4199 = t430 * t431 * t884
    t4208 = t14 * t475 * t892 * t600
    t4210 = t483 * t485 * t884
    contr[131] = (-t457 * t2520 * (t4186 - t4188) * sdelta * t1003 / 2 - t470 * t464 * t80 * (t4197 - t4199) * t904 / 4 - 3/4 * t499 * t110 * t15 * (t4208 - t4210) * t904) * t4183
    t4218 = sin(t918)
    t4232 = 3/4 * t923 * t4158 * q * t1991 * t252 + 3/8 * t537 * t797 * t522 * t4162 + 3/4 * t939 * t934 * t2297 * t252
    contr[132] = t4232 * t4218
    t4233 = sin(t943)
    t4234 = t14 * t859
    t4235 = t4234 * t574
    t4236 = IMx * t848
    t4237 = t85 * t4236
    t4244 = t14 * t892
    t4245 = t4244 * t574
    t4246 = IMx * t884
    t4247 = t85 * t4246
    t4254 = t4244 * t600
    t4255 = t482 * t4246
    contr[133] = (-3/2 * t588 * t80 * (t4235 - t4237) * t1004 * t572 - 3/4 * t597 * t464 * t80 * (t4245 - t4247) * t2615 - 3/4 * t612 * t970 * t991 * (t4254 - t4255) * muM) * t4233
    t4263 = sin(t975)
    contr[134] = (-3/2 * t588 * t951 * (t4235 + t4237) * t2 * t418 - 3/4 * t597 * t899 * t106 * (t4245 + t4247) * t591 - 3/4 * t612 * t970 * t106 * (t4254 + t4255) * t591) * t4263
    t4283 = sin(t997)
    contr[135] = -t4232 * t4283
    t4285 = sin(t1000)
    contr[136] = (-t457 * t2520 * (t4186 + t4188) * sdelta * t1003 / 2 - t470 * t464 * t80 * (t4197 + t4199) * t904 / 4 - 3/4 * t499 * t970 * t106 * (t4208 + t4210) * t460) * t4285
    t4305 = sin(t1024)
    contr[137] = -t4182 * t4305
    t4308 = sin(-t340 + psig)
    t4309 = t4072 * t1232
    t4312 = t4077 * t1232
    t4315 = t4081 * t1232
    t4318 = t4087 * t1232
    t4320 = t1960 * t80 * t1952
    t4321 = t397 * t4320
    t4324 = t332 * t4320
    contr[138] = (3/2 * t2266 * t4309 - 3 * t1944 * t4312 - 3/2 * t1949 * t4315 + 3 * t4321 * t4318 + 3/4 * t4324 * t4318) * t4308
    t4328 = sin(t1092)
    t4331 = t1118 * t3750 * t728 * t1029
    t4332 = 0.1e1 / t1126
    t4339 = IMx * t265 * t1029
    t4340 = t1109 * t4339
    t4342 = t118 * t368
    t4349 = t80 * t2584 * t1033 * t4339
    t4358 = t1097 * t1171 * t107 * t4339
    t4359 = t1126 ^ 2
    t4363 = t95 * t1101 / t4359 * t110
    contr[139] = (3/2 * t100 * t1101 * t4332 * t84 * t4331 - 3/4 * t131 * t4342 * t1112 * t4332 * t4340 - 3/2 * t1067 * t304 * t1112 * t4332 * t109 * t4349 + 3/4 * t155 * t4363 * t4358 + 3/4 * t1087 * t4363 * t4358) * t4328
    t4371 = sin(t1144)
    t4372 = 0.1e1 / t1172
    t4392 = t2 * t1147 * t15 * t107 * t4339
    t4393 = t1172 ^ 2
    t4397 = t95 * t1151 / t4393 * t110
    contr[140] = (-3/2 * t100 * t1151 * t4372 * t84 * t4331 - 3/4 * t131 * t4342 * t1158 * t4372 * t4340 + 3/2 * t1067 * t304 * t1158 * t4372 * t109 * t4349 - 3/4 * t155 * t4397 * t4392 + 3/4 * t1087 * t4397 * t4392) * t4371
    t4406 = sin(t340 + psig)
    t4414 = t4092 * t1269 * t1232
    contr[141] = (-3/2 * t2066 * t4309 - 3 * t1257 * t4312 + 3/2 * t1265 * t4315 - 3 * t2077 * t4414 + 3/4 * t2080 * t4414) * t4406
    t4420 = sin(t1229)
    t4427 = t1303 * t179 * t265 * t3861
    t4432 = t80 * t3876 * t3853 * t3852
    t4439 = t1268 * t3876 * t3853 * t3861
    t4440 = t1277 * t1412
    t4441 = t397 * t4440
    t4444 = t332 * t4440
    t4447 = 3/4 * t1246 * t1240 * t3847 * t1236 + 3/2 * t1257 * t4427 - 3/4 * t307 * t1255 * t1314 * t4432 + 3/2 * t4441 * t4439 - 3/8 * t4444 * t4439
    contr[142] = t4447 * t4420
    t4448 = sin(t1286)
    t4449 = t14 * t263
    t4450 = t4449 * t1029
    t4451 = t1289 * t728
    t4452 = t4451 * t4450
    t4457 = t2304 * t265 * t263 * t1029
    t4460 = t1061 * t1048
    t4461 = t4460 * t4450
    t4466 = t2338 * t265 * t4449 * t1029
    t4471 = 3/4 * t1198 * t4452 + 9/8 * t1205 * t4457 - 3/4 * t1210 * t4461 + 9/8 * t1222 * t4466 - 3/8 * t1225 * t4466
    contr[143] = t4471 * t4448
    t4472 = sin(t1334)
    t4482 = t1075 * t1048
    t4483 = t4482 * t14 * t264 * t1071 * sdelta
    t4488 = 3/4 * t1045 * t4452 - 9/8 * t1057 * t4457 - 3/4 * t1068 * t4461 + 9/8 * t1083 * t4483 + 3/8 * t1088 * t4483
    contr[144] = t4488 * t4472
    t4489 = sin(t1357)
    t4490 = t1496 * t10
    t4492 = 2 * t3966 * t1846
    t4493 = t426 * t3345
    t4494 = t4492 + t4493
    t4495 = t4494 * sdelta
    t4510 = 2 * t3966 * t1405
    t4511 = t426 * t3364
    t4515 = t1412 * t2 * (t4510 + t4511) * t1381
    contr[145] = (3/4 * t1378 * t571 * t4495 * t4490 + 3/8 * t1387 * t1863 * t4495 * t1231 - 3/4 * t1396 * t1107 * pi * t4494 * t1360 + 3/8 * t1420 * t4515 - 3/8 * t1423 * t4515) * t4489
    t4521 = sin(t1427)
    t4522 = t437 * IMy
    t4524 = 2 * t3386 * t4522
    t4525 = t426 * t3432
    t4527 = (t4524 + t4525) * muM
    t4529 = t571 * t1359
    t4541 = t14 * t1469
    t4543 = 2 * t4541 * t4522
    t4544 = t426 * t3450
    t4548 = t1412 * t2 * (t4543 + t4544) * t1381
    contr[146] = (3/4 * t1444 * t4529 * t728 * t4527 - 3/8 * t1454 * t1450 * t1501 * t4527 - 3/4 * t1462 * t1457 * t1496 * t4527 + 3/8 * t1485 * t4548 + 3/8 * t1488 * t4548) * t4521
    t4554 = sin(t1492)
    t4556 = (-t4524 + t4525) * muM
    t4572 = t1512 * t1501 * (-t4543 + t4544) * muM
    contr[147] = (-3/4 * t1444 * t4529 * t728 * t4556 + 3/8 * t1454 * t1450 * t1501 * t4556 + 3/4 * t1462 * t1457 * t1496 * t4556 - 3/8 * t1485 * t4572 - 3/8 * t1488 * t4572) * t4554
    t4578 = sin(t1519)
    t4579 = -t4492 + t4493
    t4580 = t2 * t4579
    t4597 = t1512 * (-t4510 + t4511) * sdelta * t1231
    contr[148] = (-3/4 * t1378 * t4580 * t1308 * t4490 - 3/8 * t1387 * t1382 * t4580 * t1381 + 3/4 * t1396 * t1107 * t4579 * pi * t1360 - 3/8 * t1420 * t4597 + 3/8 * t1423 * t4597) * t4578
    t4603 = sin(t1545)
    contr[149] = t4488 * t4603
    t4604 = sin(t1547)
    contr[150] = t4471 * t4604
    t4605 = sin(t1549)
    contr[151] = -t4447 * t4605
    t4607 = sin(t1552)
    t4614 = t1303 * q * t265 * t3861
    t4619 = t80 * t3947 * t3853 * t3852
    t4636 = t332 * t1600 * t1412
    t4639 = 3/4 * t1564 * t1558 * t3847 * t1555 + 3/4 * t1573 * t4614 - 3/4 * t307 * t1571 * t1314 * t4619 + 3/4 * t553 * t1591 * t227 * t80 * t1581 * t1301 * t3853 * t3861 - 3/8 * t4636 * t1581 * t3947 * t3853 * t3861
    contr[152] = t4639 * t4607
    t4640 = sin(t1606)
    t4645 = -t1608
    t4647 = t1620 / t4645
    t4660 = t4645 ^ 2
    t4661 = 0.1e1 / t4660
    t4677 = -3/4 * t1615 * t1610 * t3847 * t1555 - 3/4 * t131 * t368 * t4647 * t4614 - 3/4 * t307 * t4647 * t1314 * t4619 - 3/4 * t553 * t95 * t1613 * t4661 * t227 * t80 * t1631 * t1301 * t3853 * t3861 - 3/8 * t332 * t1613 * t4661 * t15 * t110 * t1631 * t3947 * t3853 * t3861
    contr[153] = t4677 * t4640
    t4678 = sin(t1654)
    contr[154] = -t4677 * t4678
    t4680 = sin(t1657)
    t4682 = t2061 * t9 * t1991
    t4683 = t4682 * t1668
    t4686 = IMz * t1991
    t4687 = t2270 * t4686
    t4688 = t4687 * t1668
    t4691 = t1234 * t4686
    t4692 = t4691 * t1668
    t4695 = t1231 * t2879
    t4696 = t1271 * t4686
    t4700 = t522 * t2879
    t4701 = t1991 * t265
    t4702 = t933 * t4701
    t4710 = t346 * t4701
    contr[155] = (3/4 * t2834 * t4683 - 3/4 * t1623 * t4688 - 3/4 * t1627 * t4692 + 3/4 * t1641 * t4696 * t4695 + 3/8 * t2852 * t4702 * t4700) * t4680 - 3/4 * t2860 * t4710 * muM * q * t4680
    t4714 = sin(t1703)
    t4715 = t4701 * t522
    t4716 = t2233 * t4715
    t4719 = t2271 * t4715
    t4722 = t1706 * t4715
    contr[156] = (3/4 * t2834 * t4716 - 3/4 * t1623 * t4719 - 3/4 * t1627 * t4722 + 3/4 * t1641 * t1271 * t1705 * t4701 * muM * t1631 + 3/8 * t2852 * t933 * t4136 * t1231 * q * t1631) * t4714 - 3/4 * t2860 * t4710 * muM * q * t4714
    t4744 = sin(t1731)
    contr[157] = -t4639 * t4744
    t4746 = sin(t1734)
    t4771 = (-2 * t61 * t28 * t3106 - 2 * t61 * t28 * t3111 + t3116 - t871) * muM
    t4780 = t98 * t276 * t166 * t273
    t4781 = t4780 * t80 * t16 * cdelta
    contr[158] = (3/8 * t281 * t3705 * t1736 * t764 * t3100 - 3/8 * t308 * t3705 * t1736 * t3118 - 3/16 * t333 * t3711 * t313 * t3118) * t4746 + 3/8 * t4781 * t1884 * IMz * t117 * t4746 * t4771
    t4784 = sin(t1774)
    t4790 = t118 * t3117
    t4792 = t1496 * t1660
    t4800 = t15 * t311 * t265 * t1660
    t4807 = t3243 * t346
    contr[159] = (-3/8 * t281 * t738 * t253 * t118 * t3100 + 3/8 * t308 * t4792 * t509 * t4790 + 3/16 * t333 * t4800 * muM * t106 * t4790) * t4784 - 3/8 * t4780 * t80 * t16 * t4784 * t4807 * t117 * t4771
    t4814 = sin(t1795)
    t4816 = t3386 * t859 * IMy
    t4817 = t1097 * t4236
    t4824 = t892 * IMy
    t4825 = t3386 * t4824
    t4826 = t1097 * t4246
    t4827 = t4825 + t4826
    t4829 = t731 * t4827 * t1231
    t4836 = t4541 * t4824
    t4838 = IMx * t884 * t1472
    t4842 = t1512 * t737 * (t4836 + t4838) * muM
    contr[160] = (3/4 * t1444 * t571 * t731 * (t4816 + t4817) * t4490 - 3/8 * t1454 * t1450 * t4829 - 3/4 * t1462 * t1816 * t4829 + 3/8 * t1485 * t4842 + 3/8 * t1488 * t4842) * t4814 - 3/4 * t1841 * t2 * pi * t4827 * t265 * muM * t4814
    t4856 = sin(t1844)
    t4857 = t4234 * t1846
    t4859 = IMx * t1147 * t848
    t4866 = t4244 * t1846
    t4868 = IMx * t1147 * t884
    t4869 = t4866 - t4868
    t4871 = t4869 * t731 * t1231
    t4878 = t4244 * t1405
    t4880 = IMx * t884 * t1407
    t4884 = t1512 * t731 * (t4878 - t4880) * t1231
    contr[161] = (3/4 * t1378 * t571 * (t4857 - t4859) * t731 * t4490 + 3/8 * t1387 * t1863 * t4871 - 3/4 * t1396 * t1816 * t4871 + 3/8 * t1420 * t4884 - 3/8 * t1423 * t4884) * t4856 - 3/4 * t1888 * t2 * pi * t4869 * t265 * muM * t4856
    t4898 = sin(t1891)
    t4908 = t522 * t1901
    contr[162] = (-3/4 * t2236 * t4683 - 3/4 * t1573 * t4688 + 3/4 * t1578 * t4692 - 3/4 * t1593 * t4696 * t1902 + 3/8 * t2251 * t4702 * t4908) * t4898 + 3/4 * t2259 * t4710 * muM * q * t4898
    t4919 = sin(t1923)
    t4920 = t4682 * t1938
    t4923 = t4687 * t1938
    t4926 = t4691 * t1938
    t4929 = t4696 * t1938
    contr[163] = (3/4 * t2266 * t4920 - 3/2 * t1944 * t4923 - 3/4 * t1949 * t4926 + 3/2 * t4321 * t4929 + 3/8 * t4324 * t4929) * t4919 - 3/4 * t2752 * t4710 * muM * t179 * t4919
    t4941 = sin(t1978)
    t4942 = t14 * t725
    t4943 = t4942 * t1783
    t4944 = t4451 * t4943
    t4948 = t2304 * t2058 * t1783
    t4951 = t4460 * t4943
    t4957 = t4482 * t14 * t795 * t1071 * t731
    t4966 = t12 * t1030
    contr[164] = (3/4 * t1045 * t4944 - 9/8 * t1057 * t4948 - 3/4 * t1068 * t4951 + 9/8 * t1083 * t4957 + 3/8 * t1088 * t4957) * t4941 - 3/4 * t2028 * t4966 * t725 * muM * t4941
    t4970 = sin(t2031)
    t4979 = t2338 * t265 * t4942 * t1783
    contr[165] = (3/4 * t1198 * t4944 + 9/8 * t1205 * t4948 - 3/4 * t1210 * t4951 + 9/8 * t1222 * t4979 - 3/8 * t1225 * t4979) * t4970 - 3/4 * t2053 * t4966 * t725 * muM * t4970
    t4991 = sin(t2056)
    t4999 = t933 * t1268 * t1991
    t5000 = t4999 * t1938
    contr[166] = (-3/4 * t2066 * t4920 - 3/2 * t1257 * t4923 + 3/4 * t1265 * t4926 - 3/2 * t2077 * t5000 + 3/8 * t2080 * t5000) * t4991 + 3/4 * t2093 * t4710 * muM * t179 * t4991
    t5012 = sin(t2096)
    t5018 = muM * t3178
    t5031 = t266 * t5018
    contr[167] = (3/8 * t281 * t738 * t16 * t3162 * t1736 - 3/8 * t308 * t4792 * t5018 * t1736 - 3/16 * t333 * t4800 * t5018 * t313) * t5012 - 3/8 * t4781 * t5031 * pi * t117 * t5012
    t5035 = sin(t2136)
    t5036 = t118 * t764
    t5037 = t3162 * pi
    contr[168] = (-3/8 * t281 * t3705 * t5037 * t5036 + 3/8 * t308 * t3705 * t3178 * pi * t5036 + 3/16 * t333 * t3711 * t3178 * t106 * t5036) * t5035 + 3/8 * t4781 * t5031 * pi * t117 * t5035
    t5059 = sin(t2159)
    t5066 = t4825 - t4826
    t5068 = t5066 * t764 * t1231
    t5078 = t1512 * t1710 * (t4836 - t4838) * muM
    contr[169] = (-3/4 * t1444 * t571 * (t4816 - t4817) * t764 * t4490 + 3/8 * t1454 * t1450 * t5068 + 3/4 * t1462 * t1816 * t5068 - 3/8 * t1485 * t5078 - 3/8 * t1488 * t5078) * t5059 + 3/4 * t1841 * t2 * pi * t5066 * t265 * muM * t5059
    t5092 = sin(t2195)
    t5099 = t4866 + t4868
    t5100 = t2 * t5099
    t5113 = t1412 * (t4878 + t4880) * t2 * t3448
    contr[170] = (-3/4 * t1378 * t2 * (t4857 + t4859) * t2164 * t4490 - 3/8 * t1387 * t1382 * t5100 * t3448 + 3/4 * t1396 * t243 * t5100 * t2164 * t1231 - 3/8 * t1420 * t5113 + 3/8 * t1423 * t5113) * t5092 + 3/4 * t1888 * t2 * t5099 * pi * t265 * muM * t5092
    t5127 = sin(t2229)
    t5134 = t1231 * t2247
    t5138 = t522 * t2247
    contr[171] = (-3/4 * t2236 * t4716 - 3/4 * t1573 * t4719 + 3/4 * t1578 * t4722 - 3/4 * t1593 * t4696 * t5134 + 3/8 * t2251 * t4702 * t5138) * t5127 + 3/4 * t2259 * t4710 * muM * q * t5127
    t5149 = sin(t2262)
    t5150 = t179 * t764
    t5151 = t1231 * t5150
    t5152 = t4682 * t5151
    t5155 = t4687 * t5151
    t5158 = t4691 * t5151
    t5161 = t4696 * t5151
    contr[172] = (3/4 * t2266 * t5152 - 3/2 * t1944 * t5155 - 3/4 * t1949 * t5158 + 3/2 * t4321 * t5161 + 3/8 * t4324 * t5161) * t5149 - 3/4 * t2752 * t4710 * muM * t179 * t5149
    t5173 = sin(t2295)
    t5174 = t725 * IMy
    t5175 = t9 * t1002
    t5177 = t5175 * t5174 * t3254
    t5180 = t106 * t725
    t5182 = t1050 * t5180 * t3260
    t5186 = t1061 * t5174 * t3254
    t5191 = t265 * t1980 * t1071 * t764
    t5193 = t1075 * t5174 * t5191
    contr[173] = (-3/4 * t1045 * t5177 + 9/8 * t1057 * t5182 + 3/4 * t1068 * t5186 - 9/8 * t1083 * t5193 - 3/8 * t1088 * t5193) * t5173 + 3/4 * t2028 * t4966 * t725 * muM * t5173
    t5205 = sin(t2327)
    t5212 = t1213 * t2485
    t5214 = t5212 * t5180 * t3268
    contr[174] = (-3/4 * t1198 * t5177 - 9/8 * t1205 * t5182 + 3/4 * t1210 * t5186 - 9/8 * t1222 * t5214 + 3/8 * t1225 * t5214) * t5205 + 3/4 * t2053 * t4966 * t725 * muM * t5205
    t5226 = sin(t2351)
    t5233 = t4999 * t5151
    contr[175] = (-3/4 * t2066 * t5152 - 3/2 * t1257 * t5155 + 3/4 * t1265 * t5158 - 3/2 * t2077 * t5233 + 3/8 * t2080 * t5233) * t5226 + 3/4 * t2093 * t4710 * muM * t179 * t5226
    t5245 = sin(t2373)
    t5247 = t253 * IMz * t3100
    t5251 = t3117 * muM
    t5257 = t85 * t344 * t252
    t5258 = t3117 * t135
    t5260 = t106 * IMz * t525
    t5266 = t397 * t87 * t393 * t109 * t1412
    t5269 = 3/16 * t2380 * t5247 * t786 + 3/32 * t370 * t797 * t5251 * t794 + 3/8 * t5266 * t5260 * t5258 * t5257
    contr[176] = t5269 * t5245
    t5270 = sin(t2402)
    t5272 = t253 * IMz * t3162
    t5280 = t135 * t3178
    t5285 = 3/16 * t2380 * t5272 * t786 + 3/32 * t370 * t797 * t5018 * t794 + 3/8 * t5266 * t5260 * t5280 * t5257
    contr[177] = t5285 * t5270
    t5286 = sin(t2421)
    t5291 = -t1927
    t5293 = t1941 / t5291
    t5304 = t1952 * t3876 * t3853 * t3861
    t5305 = t5291 ^ 2
    t5309 = t1932 / t5305 * t109 * t1412
    t5316 = 3/4 * t2266 * t2061 * t1288 * t1232 + 3/2 * t131 * t368 * t5293 * t4427 + 3/4 * t307 * t5293 * t1314 * t4432 + 3/2 * t397 * t5309 * t5304 + 3/8 * t332 * t5309 * t5304
    contr[178] = t5316 * t5286
    t5317 = sin(t2443)
    t5318 = IMy * t2465
    t5319 = t3934 * t5318
    t5320 = t85 * t2452
    t5321 = t2507 * t5320
    t5322 = t5319 - t5321
    t5335 = t14 * t475 * t478 * t5318
    t5336 = t482 * t2452
    t5337 = t2533 * t5336
    contr[179] = (t457 * t866 * t5322 * t175 * t418 / 4 + t470 * t899 * t106 * t5322 * t460 / 8 + 3/8 * t499 * t2487 * t2485 * (t5335 - t5337) * muM) * t5317
    t5345 = sin(t2492)
    t5348 = t14 * t419 * t2515 * t574
    t5350 = IMx * t2503
    t5351 = t5350 * t431 * t85
    t5353 = (t5348 - t5351) * muM
    t5364 = t14 * t475 * t2515 * t600
    t5366 = t5350 * t485 * t482
    contr[180] = (-t457 * t866 * t674 * t5353 / 4 - t470 * t899 * t679 * t5353 / 8 - 3/8 * t499 * t2487 * (t5364 - t5366) * t175 * t473) * t5345
    t5374 = sin(t2543)
    t5383 = t85 * muM * t252
    t5388 = 3/8 * t2549 * t5247 * t920 + 3/16 * t537 * t797 * t5251 * t926 + 3/8 * t939 * t933 * t5258 * t5383
    contr[181] = t5388 * t5374
    t5389 = sin(t2562)
    t5401 = 3/8 * t2549 * t5272 * t920 + 3/16 * t537 * t797 * t5018 * t926 + 3/8 * t939 * t933 * t5280 * t5383
    contr[182] = t5401 * t5389
    t5402 = sin(t2576)
    t5403 = t3992 * t5318
    t5404 = IMx * t5320
    t5405 = t5403 - t5404
    t5417 = t14 * t478 * t5318
    t5418 = IMx * t5336
    contr[183] = (3/4 * t588 * t951 * t5405 * t2 * t418 + 3/8 * t597 * t899 * t106 * t5405 * t591 + 3/8 * t612 * t2487 * t1171 * (t5417 - t5418) * muM) * t5402
    t5426 = sin(t2603)
    t5427 = t14 * t2515
    t5428 = t5427 * t574
    t5430 = IMx * t2503 * t85
    t5431 = t5428 - t5430
    t5442 = t5427 * t600
    t5444 = IMx * t2503 * t482
    contr[184] = (-3/4 * t588 * t269 * sdelta * t5431 * t572 - 3/8 * t597 * t899 * t5431 * t106 * t591 - 3/8 * t612 * t110 * sdelta * (t5442 - t5444) * t2593) * t5426
    t5452 = sin(t2630)
    t5453 = t5403 + t5404
    contr[185] = (3/4 * t588 * t951 * t5453 * t2 * t418 + 3/8 * t597 * t899 * t106 * t5453 * t591 + 3/8 * t612 * t2487 * t1171 * (t5417 + t5418) * muM) * t5452
    t5471 = sin(t2649)
    t5472 = t5428 + t5430
    contr[186] = (-3/4 * t588 * t951 * t5472 * t2 * t418 - 3/8 * t597 * t899 * t106 * t5472 * t591 - 3/8 * t612 * t2487 * t1171 * (t5442 + t5444) * muM) * t5471
    t5490 = sin(t2669)
    contr[187] = -t5388 * t5490
    t5492 = sin(t2672)
    contr[188] = -t5401 * t5492
    t5494 = sin(t2675)
    t5495 = t5319 + t5321
    contr[189] = (t457 * t866 * t5495 * t175 * t418 / 4 + t470 * t899 * t106 * t5495 * t460 / 8 + 3/8 * t499 * t2487 * (t5335 + t5337) * t175 * t473) * t5494
    t5513 = sin(t2695)
    t5514 = t5348 + t5351
    contr[190] = (-t457 * t90 * t5514 * t1004 * t1003 / 4 - t470 * t464 * t80 * t5514 * t904 / 8 - 3/8 * t499 * t2487 * t2485 * (t5364 + t5366) * muM) * t5513
    t5532 = sin(t2715)
    contr[191] = -t5269 * t5532
    t5534 = sin(t2718)
    contr[192] = -t5285 * t5534
    t5536 = sin(t2721)
    contr[193] = -t5316 * t5536
    t5538 = sin(t2724)
    t5539 = t2061 * t3214
    t5540 = t5539 * t1938
    t5543 = IMz * t3117
    t5545 = t1928 * t1941 * t106
    t5546 = t5545 * t5543
    t5549 = t131 * t368 * t110
    t5552 = t1234 * t5543
    t5553 = t5552 * t1938
    t5556 = t1952 * t313
    t5557 = t5556 * t5543
    t5558 = t5557 * t1938
    t5559 = t1960 * t1412
    t5560 = t397 * t5559
    t5563 = t332 * t5559
    t5569 = IMz * t179 * t3139
    t5573 = t117 * muM
    t5574 = t1932 * t16
    t5578 = t98 * t80 * t166 * t1928
    t5579 = t5578 * t5574 * t5573
    contr[194] = (3/8 * t2266 * t5540 - 3/4 * t5549 * t5546 * t1938 - 3/8 * t1949 * t5553 + 3/4 * t5560 * t5558 + 3/16 * t5563 * t5558) * t5538 + 3/8 * t5579 * t5538 * pi * t3243 * t5569
    t5582 = sin(t2755)
    t5583 = t5539 * t5151
    t5589 = t5552 * t5151
    t5592 = t5557 * t5151
    contr[195] = (-3/8 * t2266 * t5583 + 3/4 * t5549 * t5546 * t5151 + 3/8 * t1949 * t5589 - 3/4 * t5560 * t5592 - 3/16 * t5563 * t5592) * t5582 - 3/8 * t5579 * t4807 * t179 * t3139 * t5582
    t5604 = sin(t2778)
    t5605 = t3162 * muM
    t5607 = t2061 * t728
    t5608 = t5607 * t5605 * t5150
    t5611 = t5018 * t5150
    t5612 = t5545 * t266
    t5616 = t1234 * t266
    t5617 = t5616 * t5611
    t5620 = t5556 * t266
    t5621 = t5620 * t5611
    t5630 = t5037 * t3243
    contr[196] = (3/8 * t2266 * t5608 - 3/4 * t5549 * t5612 * t5611 - 3/8 * t1949 * t5617 + 3/4 * t5560 * t5621 + 3/16 * t5563 * t5621) * t5604 - 3/8 * t5579 * t5630 * IMz * t179 * t5604
    t5634 = sin(t2805)
    t5635 = t179 * t731
    t5637 = t5607 * t5605 * t5635
    t5640 = t5018 * t5635
    t5644 = t5616 * t5640
    t5647 = t5620 * t5640
    contr[197] = (-3/8 * t2266 * t5637 + 3/4 * t5549 * t5612 * t5640 + 3/8 * t1949 * t5644 - 3/4 * t5560 * t5647 - 3/16 * t5563 * t5647) * t5634 + 3/8 * t5578 * t5574 * t117 * t5634 * t5605 * t1884 * cdelta * t403
    t5662 = sin(t2828)
    t5663 = t5539 * t1711
    t5666 = t2270 * t5543
    t5667 = t5666 * t1711
    t5670 = t5552 * t1711
    t5674 = t1271 * t5543
    t5678 = t522 * t2848
    t5679 = t118 * t373
    t5680 = t5679 * t3123
    t5683 = t332 * t1648 * t1412
    t5691 = t243 * t5573
    t5694 = t98 * t1613 * t1609 * t166
    t5695 = t5694 * t5691
    contr[198] = (-3/8 * t2834 * t5663 + 3/8 * t1623 * t5667 + 3/8 * t1627 * t5670 - 3/8 * t1641 * t5674 * t1231 * t2848 - 3/16 * t5683 * t5680 * t5678) * t5662 - 3/8 * t5695 * t4807 * q * t3139 * t5662
    t5698 = sin(t2863)
    t5699 = q * t731
    t5701 = t5607 * t5605 * t5699
    t5704 = t5018 * t5699
    t5705 = t2270 * t266
    t5706 = t5705 * t5704
    t5709 = t5616 * t5704
    t5713 = t1271 * t266
    t5718 = t5679 * t265 * t3178
    t5724 = cdelta * t559
    contr[199] = (-3/8 * t2834 * t5701 + 3/8 * t1623 * t5706 + 3/8 * t1627 * t5709 - 3/8 * t1641 * t5713 * t5018 * t2879 - 3/16 * t5683 * t5718 * t4700) * t5698 + 3/8 * t5695 * t3162 * t5698 * t1884 * t5724
    t5730 = sin(t2891)
    t5731 = t5539 * t1668
    t5734 = t5666 * t1668
    t5737 = t5552 * t1668
    t5749 = IMz * q * t3139
    contr[200] = (3/8 * t2834 * t5731 - 3/8 * t1623 * t5734 - 3/8 * t1627 * t5737 + 3/8 * t1641 * t5674 * t4695 + 3/16 * t5683 * t5680 * t4700) * t5730 + 3/8 * t5694 * t243 * t117 * t5730 * t3244 * t5749
    t5756 = sin(t2916)
    t5757 = q * t764
    t5759 = t5607 * t5605 * t5757
    t5762 = t5018 * t5757
    t5763 = t5705 * t5762
    t5766 = t5616 * t5762
    contr[201] = (3/8 * t2834 * t5759 - 3/8 * t1623 * t5763 - 3/8 * t1627 * t5766 + 3/8 * t1641 * t5713 * t5018 * t2848 + 3/16 * t5683 * t5718 * t5678) * t5756 - 3/8 * t5695 * t5630 * IMz * t5756 * q
    t5783 = sin(t2941)
    t5804 = t98 * t1562 * t1557 * t166 * t5691
    contr[202] = (3/8 * t2236 * t5663 + 3/8 * t1573 * t5667 - 3/8 * t1578 * t5670 + 3/8 * t1593 * t5674 * t5134 - 3/16 * t4636 * t5680 * t5138) * t5783 + 3/8 * t5804 * t5783 * pi * t3243 * t5749
    t5807 = sin(t2962)
    contr[203] = (-3/8 * t2236 * t5731 - 3/8 * t1573 * t5734 + 3/8 * t1578 * t5737 - 3/8 * t1593 * t5674 * t1902 + 3/16 * t4636 * t5680 * t4908) * t5807 - 3/8 * t5804 * pi * t5807 * t3243 * t5749
    t5827 = sin(t2986)
    contr[204] = (3/8 * t2236 * t5701 + 3/8 * t1573 * t5706 - 3/8 * t1578 * t5709 + 3/8 * t1593 * t5713 * t5018 * t1901 - 3/16 * t4636 * t5718 * t4908) * t5827 - 3/8 * t5804 * t3162 * t5827 * t1884 * t5724
    t5848 = sin(t3007)
    contr[205] = (-3/8 * t2236 * t5759 - 3/8 * t1573 * t5763 + 3/8 * t1578 * t5766 - 3/8 * t1593 * t5713 * t5018 * t2247 + 3/16 * t4636 * t5718 * t5138) * t5848 + 3/8 * t5804 * t5630 * IMz * q * t5848
    t5869 = sin(t3028)
    t5877 = t1268 * t313
    t5878 = t5877 * t266
    t5879 = t5878 * t5640
    t5891 = t98 * t1244 * t1239 * t166
    t5892 = t5891 * t5691
    contr[206] = (3/8 * t2066 * t5637 + 3/4 * t1257 * t5705 * t5640 - 3/8 * t1265 * t5644 + 3/4 * t4441 * t5879 - 3/16 * t4444 * t5879) * t5869 - 3/8 * t5892 * t5630 * IMz * t179 * t5869
    t5895 = sin(t3050)
    t5903 = t5878 * t5611
    contr[207] = (-3/8 * t2066 * t5608 - 3/4 * t1257 * t5705 * t5611 + 3/8 * t1265 * t5617 - 3/4 * t4441 * t5903 + 3/16 * t4444 * t5903) * t5895 + 3/8 * t5892 * t5630 * IMz * t179 * t5895
    t5915 = sin(t3070)
    t5924 = t5877 * t5543 * t5151
    contr[208] = (3/8 * t2066 * t5583 + 3/4 * t1257 * t5666 * t5151 - 3/8 * t1265 * t5589 + 3/4 * t4441 * t5924 - 3/16 * t4444 * t5924) * t5915 + 3/8 * t5892 * t4807 * t179 * t3139 * t5915
    t5936 = sin(t3092)
    t5937 = t1744 * IMy
    t5938 = t5175 * t5937
    t5939 = t5938 * t3254
    t5942 = t106 * t1744
    t5943 = t1050 * t5942
    t5944 = t5943 * t3260
    t5947 = t1061 * t5937
    t5948 = t5947 * t3254
    t5951 = t5212 * t5942
    t5952 = t5951 * t3268
    t5962 = pi * t1744 * t1048
    contr[209] = (3/8 * t1198 * t5939 + 9/16 * t1205 * t5944 - 3/8 * t1210 * t5948 + 9/16 * t1222 * t5952 - 3/16 * t1225 * t5952) * t5936 - 3/8 * t2053 * t5962 * t14 * muM * t5936
    t5966 = sin(t3152)
    t5969 = t2110 * t175 * t9 * t12
    t5970 = t5969 * t2004
    t5975 = t109 * t80 * t2110 * t679
    t5976 = t5975 * t1998
    t5979 = t2110 * t175
    t5981 = t16 * t5979 * t12
    t5982 = t5981 * t2004
    t5986 = t15 * t5979
    t5987 = t5986 * t1213 * t106
    t5988 = t5987 * t3192
    t5997 = t1002 * t1048
    t6000 = t1696 * t16 * t2110
    t6001 = t2052 * t6000
    contr[210] = (-3/8 * t1198 * t5970 - 9/16 * t1205 * t5976 + 3/8 * t1210 * t5982 - 9/16 * t1222 * t5988 + 3/16 * t1225 * t5988) * t5966 + 3/8 * t6001 * t5997 * t14 * muM * t5966
    t6004 = sin(t3212)
    t6005 = t5938 * t2004
    t6008 = t5943 * t1998
    t6011 = t5947 * t2004
    t6014 = t1075 * t5937
    t6015 = t6014 * t2012
    contr[211] = (3/8 * t1045 * t6005 - 9/16 * t1057 * t6008 - 3/8 * t1068 * t6011 + 9/16 * t1083 * t6015 + 3/16 * t1088 * t6015) * t6004 - 3/8 * t2028 * t5962 * t14 * muM * t6004
    t6027 = sin(t3252)
    t6028 = t5969 * t3254
    t6031 = t5975 * t3260
    t6034 = t5981 * t3254
    t6037 = t5986 * t138
    t6038 = t6037 * t5191
    t6048 = t2027 * t6000
    contr[212] = (-3/8 * t1045 * t6028 + 9/16 * t1057 * t6031 + 3/8 * t1068 * t6034 - 9/16 * t1083 * t6038 - 3/16 * t1088 * t6038) * t6027 + 3/8 * t6048 * t5997 * t14 * muM * t6027
    t6051 = sin(t3287)
    t6052 = t1362 * t5318
    t6054 = IMx * t1147 * t2452
    t6055 = t6052 - t6054
    t6056 = t6055 * t2
    t6065 = t1747 * t1231
    t6071 = t14 * t2465
    t6072 = t6071 * t1405
    t6074 = t1407 * IMx * t2452
    t6078 = t1412 * t2 * (t6072 - t6074) * t3448
    t6085 = t3328 * t3345
    t6092 = t80 * t3243
    t6093 = t3338 * t6092
    contr[213] = (3/8 * t1378 * t6056 * t2164 * t4490 + 3/16 * t1387 * t1382 * t6056 * t3448 - 3/8 * t1396 * t80 * t6055 * t571 * t6065 + 3/16 * t1420 * t6078 - 3/16 * t1423 * t6078) * t6051 - 3/8 * t6093 * muM * t2 * t6051 * pi * t16 * (t6052 + t6085)
    t6096 = sin(t3342)
    t6097 = t2515 * IMy
    t6098 = t1362 * t6097
    t6100 = IMx * t2503 * t1147
    t6101 = t6098 - t6100
    t6102 = t731 * t6101
    t6111 = t6101 * t16
    t6116 = t5427 * t1405
    t6117 = t1407 * t5350
    t6121 = t1412 * (t6116 - t6117) * t2 * t1821
    contr[214] = (-3/8 * t1378 * t571 * t6102 * t4490 - 3/16 * t1387 * t1863 * t6102 * t1231 + 3/8 * t1396 * t3359 * t6111 * t1231 - 3/16 * t1420 * t6121 + 3/16 * t1423 * t6121) * t6096 + 3/8 * t3381 * pi * t6111 * t265 * muM * t6096
    t6134 = sin(t3384)
    t6135 = t6071 * t1429
    t6137 = IMx * t1097 * t2452
    t6138 = t6135 - t6137
    t6139 = t6138 * t2
    t6153 = t4541 * t5318
    t6155 = IMx * t1472 * t2452
    t6159 = t80 * (t6153 - t6155) * t1171 * t1821
    t6167 = t3328 * t3432
    contr[215] = (3/8 * t1444 * t6139 * t3350 * t4490 - 3/16 * t1454 * t1449 * t6139 * t1821 - 3/8 * t1462 * t80 * t6138 * t571 * t1797 + 3/16 * t1485 * t6159 + 3/16 * t1488 * t6159) * t6134 - 3/8 * t3425 * t6092 * (t6135 + t6167) * t591 * t6134 * t253
    t6174 = sin(t3429)
    t6175 = t5427 * t1429
    t6177 = IMx * t2503 * t1097
    t6178 = t6175 - t6177
    t6179 = t6178 * t2
    t6188 = t80 * t6178
    t6193 = t4541 * t6097
    t6195 = IMx * t2503 * t1472
    t6199 = t1512 * t1710 * (t6193 - t6195) * muM
    contr[216] = (-3/8 * t1444 * t6179 * t2164 * t4490 + 3/16 * t1454 * t1449 * t6179 * t3448 + 3/8 * t1462 * t6188 * t571 * t6065 - 3/16 * t1485 * t6199 - 3/16 * t1488 * t6199) * t6174 + 3/8 * t1840 * t166 * t6188 * t1118 * t265 * muM * t6174
    t6213 = sin(t3468)
    t6215 = muM * (t6135 + t6137)
    t6232 = t80 * (t6153 + t6155) * t1171 * t3448
    contr[217] = (3/8 * t1444 * t571 * t1747 * t728 * t6215 - 3/16 * t1454 * t1450 * t1710 * t6215 - 3/8 * t1462 * t3303 * t1496 * t6215 + 3/16 * t1485 * t6232 + 3/16 * t1488 * t6232) * t6213 - 3/8 * t3425 * t80 * t265 * (t6135 - t6167) * t3421 * t6213 * t253
    t6247 = sin(t3501)
    t6248 = t6175 + t6177
    t6249 = t731 * t6248
    t6258 = t6248 * t16
    t6266 = t1512 * t737 * (t6193 + t6195) * muM
    contr[218] = (-3/8 * t1444 * t571 * t6249 * t4490 + 3/16 * t1454 * t1450 * t6249 * t1231 + 3/8 * t1462 * t3359 * t6258 * t1231 - 3/16 * t1485 * t6266 - 3/16 * t1488 * t6266) * t6247 + 3/8 * t3465 * pi * t6258 * t265 * muM * t6247
    t6279 = sin(t3535)
    t6280 = t6052 + t6054
    t6281 = t731 * t6280
    t6298 = t1512 * t731 * (t6072 + t6074) * t1231
    contr[219] = (3/8 * t1378 * t571 * t6281 * t4490 + 3/16 * t1387 * t1863 * t6281 * t1231 - 3/8 * t1396 * t3359 * t6280 * t16 * t1231 + 3/16 * t1420 * t6298 - 3/16 * t1423 * t6298) * t6279 - 3/8 * t6093 * muM * t2 * t6279 * (t6052 - t6085) * t253
    t6312 = sin(t3568)
    t6313 = t6098 + t6100
    t6314 = t2 * t6313
    t6331 = t1512 * t1710 * (t6116 + t6117) * muM
    contr[220] = (-3/8 * t1378 * t6314 * t2164 * t4490 - 3/16 * t1387 * t1382 * t6314 * t3448 + 3/8 * t1396 * t1107 * t6313 * pi * t6065 - 3/16 * t1420 * t6331 + 3/16 * t1423 * t6331) * t6312 + 3/8 * t3381 * t6313 * t253 * t265 * muM * t6312
    t6344 = sin(t3598)
    t6351 = t6014 * t5191
    contr[221] = (3/8 * t1045 * t5939 - 9/16 * t1057 * t5944 - 3/8 * t1068 * t5948 + 9/16 * t1083 * t6351 + 3/16 * t1088 * t6351) * t6344 - 3/8 * t2028 * t5962 * t14 * muM * t6344
    t6363 = sin(t3618)
    t6370 = t6037 * t2012
    contr[222] = (-3/8 * t1045 * t5970 + 9/16 * t1057 * t5976 + 3/8 * t1068 * t5982 - 9/16 * t1083 * t6370 - 3/16 * t1088 * t6370) * t6363 + 3/8 * t6048 * t5997 * t14 * muM * t6363
    t6382 = sin(t3638)
    t6389 = t5951 * t3192
    contr[223] = (3/8 * t1198 * t6005 + 9/16 * t1205 * t6008 - 3/8 * t1210 * t6011 + 9/16 * t1222 * t6389 - 3/16 * t1225 * t6389) * t6382 - 3/8 * t2053 * t5962 * t14 * muM * t6382
    t6401 = sin(t3658)
    t6408 = t5987 * t3268
    contr[224] = (-3/8 * t1198 * t6028 - 9/16 * t1205 * t6031 + 3/8 * t1210 * t6034 - 9/16 * t1222 * t6408 + 3/16 * t1225 * t6408) * t6401 + 3/8 * t6001 * t5997 * t14 * muM * t6401
    t6420 = sin(t3678)
    t6429 = t5680 * t344 * t2073
    contr[225] = (-3/8 * t2066 * t5540 - 3/4 * t1257 * t5666 * t1938 + 3/8 * t1265 * t5553 - 3/4 * t4441 * t6429 + 3/16 * t4444 * t6429) * t6420 - 3/8 * t5891 * t243 * t117 * t6420 * t3244 * t5569
       
    der_Jg = sum(contr);
    return der_Jg;
end

function derivativechiM2_JgP2(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)

    contr = zeros(95);
    t1 = 2 * TL
    t2 = t1 - psig
    t3 = cos(t2)
    t4 = sqrt(k)
    t8 = sqrt(k + m)
    t9 = 0.1e1 / t8
    t12 = Q1 * cpa2EQ - Q2 * cpa1EQ
    t14 = Q1 ^ 2
    t15 = Q2 ^ 2
    t17 = 1 / (t14 + t15 + 1)
    t19 = muM * t17 * t12 * t9
    t21 = exp(sigma)
    t23 = cdelta ^ 2
    t24 = rc ^ 2
    t26 = 0.1e1 / t24 / rc
    t27 = t26 * t23
    t30 = exp(2 * sigma)
    t33 = 0.1e1 / KK
    t36 = 0.1e1 / Jg
    t38 = t36 / npsig * t33 / (-1 + t30)
    t39 = t38 * t27 * t21 * IMz
    contr[1] = 3/2 * t39 * t19 * pi * t4 * t3
    t41 = t1 + psig
    t42 = cos(t41)
    contr[2] = -3/2 * t39 * t19 * pi * t4 * t42
    t48 = 4 * psil
    t49 = psih - t48
    t50 = cos(t49)
    t52 = q ^ 2
    t54 = cpa1EQ * t14
    t55 = Q1 * Q2
    t57 = 2 * cpa2EQ * t55
    t58 = cpa1EQ * t15
    t63 = IMz * t17
    t64 = t63 * (4 * Q1 * cpa3EQ - cpa1EQ + t54 - t57 - t58) * muM
    t66 = t9 * pi
    t67 = t27 * t66
    t68 = t52 ^ 2
    t72 = 0.1e1 / npsil
    t73 = t36 * t72
    t74 = t73 / (t68 + 1) * t33
    t75 = t74 * t67
    contr[3] = -t75 * t64 * t52 * t4 * t50 / 8
    t78 = t23 * muM
    t79 = sqrt(q)
    t80 = t79 * q
    t81 = t80 * t78
    t82 = 3 * psil
    t83 = psih - t82
    t84 = cos(t83)
    t86 = cpa1EQ * t55
    t87 = cpa2EQ * t14
    t88 = t87 / 2
    t89 = cpa2EQ * t15
    t90 = t89 / 2
    t91 = Q2 * cpa3EQ
    t94 = t86 + t88 - t90 + 2 * t91 + cpa2EQ / 2
    t95 = t52 - q + 1
    t97 = 1 + q
    t98 = t97 * IMy
    t100 = sqrt(1 + k)
    t102 = t100 * t98 * t95 * t94
    t103 = t52 + q + 1
    t104 = q - 1
    t105 = t104 * t103
    t106 = Q2 * cpa2EQ
    t111 = t54 + Q1 * (-2 * t106 + 4 * cpa3EQ) - t58 - cpa1EQ
    t114 = t111 * IMx * t105 / 2
    t118 = t17 * t9
    t119 = t26 * t118
    t120 = t72 * t33
    t125 = t36 / (t68 * t52 - 1) * t120
    t126 = t125 * t119
    contr[4] = t126 * (t102 - t114) * pi * t84 * t81 / 3
    t128 = 2 * psil
    t129 = psih - t128
    t130 = cos(t129)
    t137 = t73 / (t52 + 1) * t33
    t138 = t137 * t67
    contr[5] = -t138 * t64 * q * t4 * t130 / 4
    t141 = t79 * t78
    t142 = psih - psil
    t143 = cos(t142)
    t146 = t100 * t97
    t147 = t146 * IMy * t94
    t148 = IMx * t104
    t150 = t111 * t148 / 2
    t157 = t36 / (t52 - 1) * t120
    t158 = t157 * t119
    contr[6] = t158 * (t147 - t150) * pi * t143 * t141
    t159 = psih + psil
    t160 = cos(t159)
    contr[7] = t157 * t26 * t17 * (t147 + t150) * t9 * pi * t160 * t141
    t168 = psih + t128
    t169 = cos(t168)
    contr[8] = t138 * t64 * q * t4 * t169 / 4
    t175 = psih + t82
    t176 = cos(t175)
    contr[9] = t126 * pi * t176 * (t102 + t114) * t81 / 3
    t181 = psih + t48
    t182 = cos(t181)
    contr[10] = t75 * t64 * t52 * t4 * t182 / 8
    t188 = cos(-t82 + psig)
    t190 = t21 * t100
    t194 = Q1 * cpa1EQ
    t198 = pi * t17 * (cpa3EQ * t14 + cpa3EQ * t15 - cpa3EQ + t106 - t194) * IMy
    t201 = t27 * t9 * t80
    t202 = t52 * q
    t206 = 3 * npsil
    t210 = t36 / (-t206 + npsig) / (t202 + t30) * t33
    contr[11] = t210 * t201 * t198 * t190 * muM * t188
    t212 = -psil + psig
    t213 = cos(t212)
    t218 = t27 * t9 * t79
    t219 = q + t30
    t223 = 0.1e1 / (-npsil + npsig)
    t224 = t36 * t223
    contr[12] = t224 / t219 * t33 * t218 * t198 * t190 * muM * t213
    t227 = psil + psig
    t228 = cos(t227)
    t232 = q * t30
    t233 = 1 + t232
    t237 = 0.1e1 / (npsil + npsig)
    t238 = t36 * t237
    contr[13] = t238 / t233 * t33 * t218 * t198 * t190 * muM * t228
    t242 = cos(t82 + psig)
    t253 = t36 / (t206 + npsig) / (t202 * t30 + 1) * t33
    contr[14] = t253 * t201 * t198 * t190 * muM * t242
    t255 = t1 - t48 - psig
    t256 = cos(t255)
    t258 = IMz * t9
    t261 = pi * t21
    t262 = t261 * t17 * t12
    t265 = t26 * t4 * t78
    t270 = 4 * npsil
    t274 = t36 / (t270 + npsig) / (t68 * t30 - 1) * t33
    t275 = t274 * t265
    contr[15] = 3/2 * t275 * t262 * t258 * t256 * t52
    t277 = t1 - t82 - psig
    t278 = cos(t277)
    t280 = muM * pi
    t282 = t194 + t106
    t284 = t282 * t80 * t190
    t286 = t27 * t118
    t287 = t253 * t286
    contr[16] = -3/2 * t287 * t284 * t280 * IMy * t278
    t290 = t1 - t82 + psig
    t291 = cos(t290)
    t293 = t80 * t17
    t295 = t280 * t190
    t299 = t210 * t27 * t9 * IMy
    contr[17] = -3/2 * t299 * t295 * t293 * t282 * t291
    t303 = pi * t21 * t23
    t304 = t232 - 1
    t305 = t304 * IMy
    t306 = t100 * t282
    t307 = t306 * t305
    t308 = t233 * IMx
    t309 = -t12
    t310 = t309 * t308
    t313 = t79 * muM
    t316 = t1 - psil - psig
    t317 = cos(t316)
    t322 = exp(4 * sigma)
    t327 = t36 / (t52 * t322 - 1) * t237 * t33
    contr[18] = -3/2 * t327 * t26 * t17 * t317 * t313 * (t307 + t310) * t9 * t303
    t331 = q - t30
    t332 = t331 * IMy
    t333 = t306 * t332
    t334 = t219 * IMx
    t335 = t309 * t334
    t339 = t313 * t66
    t341 = t1 - psil + psig
    t342 = cos(t341)
    t349 = t36 / (t52 - t322) * t223 * t33
    contr[19] = -3/2 * t349 * t26 * t17 * t342 * t339 * t21 * (t333 + t335) * t23
    t353 = t9 * muM
    t354 = t1 + psil - psig
    t355 = cos(t354)
    contr[20] = 3/2 * t349 * t26 * t17 * (-t333 + t335) * t355 * t79 * t353 * t303
    t368 = t1 + psil + psig
    t369 = cos(t368)
    contr[21] = 3/2 * t327 * t26 * t17 * t369 * t339 * t21 * (-t307 + t310) * t23
    t374 = t1 + t82 - psig
    t375 = cos(t374)
    contr[22] = -3/2 * t299 * t295 * t293 * t282 * t375
    t381 = t1 + t82 + psig
    t382 = cos(t381)
    contr[23] = -3/2 * t287 * t284 * t280 * IMy * t382
    t388 = t1 + t48 + psig
    t389 = cos(t388)
    contr[24] = -3/2 * t275 * t262 * t258 * t389 * t52
    t395 = -psig - t128 + t1
    t396 = cos(t395)
    t404 = 2 * npsil
    t408 = t36 / (t404 + npsig) / (t52 * t30 - 1) * t33
    t409 = t408 * t265
    contr[25] = 3/2 * t409 * t262 * t258 * t396 * q
    t411 = -psig + t128 + t1
    t412 = cos(t411)
    t414 = t12 * IMz
    t416 = t78 * t261
    t419 = t26 * t17
    t420 = t419 * t9 * t4
    t421 = t30 - t52
    t426 = t36 / (-t404 + npsig)
    t427 = t426 / t421 * t33
    t428 = t427 * t420
    contr[26] = 3/2 * t428 * t416 * t414 * t412 * q
    t430 = psig - t128 + t1
    t431 = cos(t430)
    contr[27] = -3/2 * t428 * t416 * t414 * t431 * q
    t437 = psig + t128 + t1
    t438 = cos(t437)
    contr[28] = -3/2 * t409 * t262 * t258 * t438 * q
    t444 = -t48 + t1 - psih
    t445 = cos(t444)
    t449 = IMz * muM
    t450 = t449 * t52 * t4
    contr[29] = -3/8 * t75 * t450 * t17 * cpa1EQ * t445
    t454 = -t48 + t1 + psih
    t455 = cos(t454)
    t458 = t54 + t57 - t58
    t460 = t63 * t458 * muM
    contr[30] = -3/8 * t75 * t460 * t52 * t4 * t455
    t464 = -t48 + psig + t1
    t465 = cos(t464)
    t469 = -t68 + t30
    t474 = t36 / (-t270 + npsig)
    t475 = t474 / t469 * t33
    t476 = t475 * t420
    contr[31] = -3/2 * t476 * t416 * t414 * t465 * t52
    t479 = IMy * cpa2EQ
    t480 = t202 + 1
    t481 = t100 * t480
    t483 = IMx * cpa1EQ
    t484 = t202 - 1
    t485 = t484 * t483
    t489 = -t82 + t1 - psih
    t490 = cos(t489)
    contr[32] = -t126 * muM * pi * t490 * t80 * (t481 * t479 + t485) * t23 / 2
    t496 = t86 - t88 + t90
    t497 = t496 * IMy
    t501 = 2 * t100 * t97 * t95 * t497
    t504 = t104 * t458 * IMx * t103
    t508 = -t82 + t1 + psih
    t509 = cos(t508)
    contr[33] = -t126 * muM * pi * t509 * t80 * t23 * (-t501 + t504) / 2
    t515 = -t128 + t1 - psih
    t516 = cos(t515)
    t520 = t449 * q * t4
    contr[34] = -3/4 * t138 * t520 * t17 * cpa1EQ * t516
    t524 = -t128 + t1 + psih
    t525 = cos(t524)
    contr[35] = -3/4 * t138 * t460 * q * t4 * t525
    t531 = t79 * t23
    t532 = -psil + t1 - psih
    t533 = cos(t532)
    t535 = t146 * t479
    t536 = t104 * t483
    contr[36] = -3/2 * t158 * (t535 + t536) * t280 * t533 * t531
    t542 = -psil + t1 + psih
    t543 = cos(t542)
    t546 = 2 * t146 * t497
    t548 = t104 * t458 * IMx
    contr[37] = -3/2 * t158 * (-t546 + t548) * t280 * t543 * t531
    t554 = psil + t1 - psih
    t555 = cos(t554)
    contr[38] = 3/2 * t158 * muM * (-t535 + t536) * pi * t555 * t531
    t565 = psil + t1 + psih
    t566 = cos(t565)
    contr[39] = 3/2 * t158 * muM * pi * t566 * t79 * t23 * (t546 + t548)
    t571 = t128 + t1 - psih
    t572 = cos(t571)
    contr[40] = 3/4 * t138 * t520 * t17 * cpa1EQ * t572
    t577 = t128 + t1 + psih
    t578 = cos(t577)
    contr[41] = 3/4 * t138 * t460 * q * t4 * t578
    t583 = t80 * t23
    t584 = t82 + t1 - psih
    t585 = cos(t584)
    t587 = t9 * t280
    t590 = -IMy * t480
    contr[42] = t125 * t26 * t17 * (t100 * cpa2EQ * t590 + t485) * t587 * t585 * t583 / 2
    t601 = t82 + t1 + psih
    t602 = cos(t601)
    contr[43] = t126 * muM * pi * t602 * t80 * t23 * (t501 + t504) / 2
    t607 = t48 + t1 - psih
    t608 = cos(t607)
    contr[44] = 3/8 * t75 * t450 * t17 * cpa1EQ * t608
    t613 = t48 + t1 + psih
    t614 = cos(t613)
    contr[45] = 3/8 * t75 * t460 * t52 * t4 * t614
    t619 = t48 - psig + t1
    t620 = cos(t619)
    contr[46] = 3/2 * t476 * t416 * t414 * t620 * t52
    t625 = sin(psig)
    t631 = cpa3EQ * (-t14 - t15 + 1) + t194 - t106
    contr[47] = t38 * t419 * t631 * t9 * t416 * IMz * t625 * t4
    t635 = sin(t2)
    t639 = t282 * t4 * t261
    t641 = t38 * t286
    contr[48] = -3/2 * t641 * t639 * muM * IMz * t635
    t644 = sin(t41)
    contr[49] = 3/2 * t641 * t639 * muM * IMz * t644
    t650 = t353 * q * t23
    t651 = pi * t4
    t653 = sin(psig - t128)
    t658 = t419 * t631 * t21
    contr[50] = t426 / t421 * t33 * t658 * t653 * IMz * t651 * t650
    t666 = sin(psig + t128)
    contr[51] = t408 * t658 * t666 * IMz * t651 * t650
    t671 = sin(t49)
    t673 = 2 * t86
    t675 = t87 + t673 - t89 + 4 * t91 + cpa2EQ
    t678 = t449 * t52 * t17
    contr[52] = t75 * t678 * t675 * t4 * t671 / 8
    t684 = t100 * t111 * t97 * IMy * t95
    t687 = 2 * t148 * t94 * t103
    t689 = sin(t83)
    contr[53] = t126 * pi * t689 * (t684 + t687) * t81 / 6
    t694 = sin(t129)
    t698 = t449 * q * t17
    contr[54] = t138 * t698 * t675 * t4 * t694 / 4
    t701 = sin(t142)
    t703 = t100 * t111 * t98
    t706 = 2 * IMx * t104 * t94
    contr[55] = t158 * pi * (t703 + t706) * t701 * t141 / 2
    t715 = sin(t159)
    contr[56] = t158 * pi * t715 * t79 * t23 * (t703 - t706) * muM / 2
    t720 = sin(t168)
    contr[57] = -t138 * t698 * t675 * t4 * t720 / 4
    t729 = sin(t175)
    contr[58] = t126 * pi * t729 * t80 * t23 * (t684 - t687) * muM / 6
    t734 = sin(t181)
    contr[59] = -t75 * t678 * t675 * t4 * t734 / 8
    t741 = t353 * t52 * t23
    t743 = sin(-t48 + psig)
    contr[60] = t474 / t469 * t33 * t658 * t743 * IMz * t651 * t741
    t753 = t9 * t78
    t754 = pi * t79
    t755 = sin(t212)
    contr[61] = -t224 / t331 * t33 * t658 * t755 * IMx * t754 * t753
    t764 = sin(t227)
    contr[62] = t238 / t304 * t33 * t658 * t764 * IMx * t754 * t753
    t773 = sin(t48 + psig)
    contr[63] = t274 * t658 * t773 * IMz * t651 * t741
    t778 = sin(t255)
    t781 = t4 * t21
    t783 = t282 * t52 * t781
    t785 = t274 * t286
    contr[64] = -3/2 * t785 * t783 * t280 * IMz * t778
    t789 = t118 * t12 * IMy
    t790 = sin(t277)
    t792 = t23 * pi
    t797 = t26 * t100 * t80 * muM
    t798 = t253 * t797
    contr[65] = -3/2 * t798 * t792 * t790 * t21 * t789
    t801 = sin(t290)
    t805 = t210 * t797
    contr[66] = -3/2 * t805 * t792 * t801 * t21 * t789
    t808 = t100 * t309
    t809 = t808 * t305
    t810 = t282 * t308
    t815 = sin(t316)
    contr[67] = -3/2 * t327 * t26 * t17 * t815 * t339 * t21 * (-t809 + t810) * t23
    t821 = t808 * t332
    t822 = t282 * t334
    t827 = sin(t341)
    contr[68] = -3/2 * t349 * t26 * t17 * t827 * t339 * t21 * (-t821 + t822) * t23
    t837 = sin(t354)
    contr[69] = 3/2 * t349 * t26 * t17 * t837 * (t821 + t822) * t79 * t353 * t303
    t842 = sin(t368)
    contr[70] = 3/2 * t327 * t26 * t17 * (t809 + t810) * t842 * t79 * t353 * t303
    t851 = sin(t374)
    contr[71] = -3/2 * t805 * t792 * t851 * t21 * t789
    t857 = sin(t381)
    contr[72] = -3/2 * t798 * t792 * t857 * t21 * t789
    t863 = sin(t388)
    contr[73] = 3/2 * t785 * t783 * t280 * IMz * t863
    t868 = sin(t395)
    t872 = t282 * q * t781
    t874 = t408 * t286
    contr[74] = -3/2 * t874 * t872 * t280 * IMz * t868
    t877 = sin(t411)
    t881 = t427 * t286
    contr[75] = -3/2 * t881 * t872 * t280 * IMz * t877
    t884 = sin(t430)
    contr[76] = 3/2 * t881 * t872 * t280 * IMz * t884
    t889 = sin(t437)
    contr[77] = 3/2 * t874 * t872 * t280 * IMz * t889
    t894 = t17 * cpa2EQ
    t895 = t52 * t894
    t896 = sin(t444)
    t900 = t26 * t9
    t901 = t900 * t78
    t902 = t74 * t901
    contr[78] = -3/8 * t902 * t651 * IMz * t896 * t895
    t905 = t87 - t673 - t89
    t906 = t17 * t905
    t908 = sin(t454)
    contr[79] = -3/8 * t902 * t651 * IMz * t908 * t52 * t906
    t914 = sin(t464)
    t918 = t475 * t286
    contr[80] = 3/2 * t918 * t783 * t280 * IMz * t914
    t920 = sin(t489)
    t925 = t484 * IMx * cpa2EQ
    contr[81] = -t126 * muM * (t100 * cpa1EQ * t590 + t925) * pi * t920 * t583 / 2
    t932 = sin(t508)
    t937 = t100 * t458 * t95 * t98 / 2
    t939 = t496 * IMx * t105
    contr[82] = t126 * muM * pi * (t937 + t939) * t932 * t583
    t945 = t4 * IMz
    t946 = t280 * t945
    t947 = t946 * q * t894
    t948 = sin(t515)
    contr[83] = -3/4 * t137 * t900 * t948 * t23 * t947
    t954 = sin(t524)
    t960 = t137 * t901
    contr[84] = -3/4 * t960 * t651 * q * IMz * t17 * t905 * t954
    t963 = IMy * cpa1EQ
    t964 = t146 * t963
    t966 = IMx * t104 * cpa2EQ
    t970 = sin(t532)
    contr[85] = -3/2 * t158 * muM * pi * t970 * t79 * t23 * (-t964 + t966)
    t976 = sin(t542)
    t981 = t100 * t458 * t98 / 2
    t982 = t496 * t148
    contr[86] = 3 * t157 * t26 * t17 * (t981 + t982) * t587 * t976 * t531
    t988 = sin(t554)
    contr[87] = 3/2 * t157 * t26 * t17 * (t964 + t966) * t587 * t988 * t531
    t996 = sin(t565)
    contr[88] = -3 * t158 * (-t981 + t982) * t280 * t996 * t531
    t1003 = sin(t571)
    contr[89] = 3/4 * t137 * t900 * t23 * t1003 * t947
    t1009 = sin(t577)
    contr[90] = 3/4 * t960 * pi * t1009 * t945 * q * t906
    t1017 = sin(t584)
    contr[91] = t126 * muM * pi * t1017 * (t481 * t963 + t925) * t583 / 2
    t1024 = sin(t601)
    contr[92] = -t126 * muM * pi * t1024 * (-t937 + t939) * t583
    t1030 = sin(t607)
    contr[93] = 3/8 * t74 * t900 * t23 * t1030 * t946 * t895
    t1035 = sin(t613)
    contr[94] = 3/8 * t902 * t651 * IMz * t52 * t17 * t905 * t1035
    t1042 = sin(t619)
    contr[95] = -3/2 * t918 * t783 * t280 * IMz * t1042
      

    
    der_Jg = sum(contr);
    return der_Jg;
end

function derivativechiM2_JhP1(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)

    contr = zeros(130);
    t2 = sqrt(1 + k)
    t3 = Q1 ^ 2
    t4 = Q2 ^ 2
    t7 = Q1 * cpa1EQ
    t8 = Q2 * cpa2EQ
    t9 = cpa3EQ * (-t3 - t4 + 1) + t7 - t8
    t11 = muM * t9 * t2
    t13 = sqrt(k + m)
    t14 = 0.1e1 / t13
    t15 = pi * t14
    t16 = sqrt(q)
    t20 = cos(psil)
    t22 = 1 / (t3 + t4 + 1)
    t24 = rc ^ 2
    t26 = 0.1e1 / t24 / rc
    t28 = 0.1e1 / KK
    t29 = q - 1
    t32 = 0.1e1 / npsil
    t33 = 0.1e1 / Jg
    t34 = t33 * t32
    contr[1] = 2 * t34 / t29 * t28 * t26 * t22 * t20 * IMy * t16 * t15 * t11
    t38 = t16 * q
    t42 = 3 * psil
    t43 = cos(t42)
    t46 = q ^ 2
    t47 = t46 * q
    contr[2] = 2/3 * t34 / (t47 - 1) * t28 * t26 * t22 * t43 * IMy * t38 * t15 * t11
    t54 = IMz * t46
    t55 = 2 * TL
    t56 = 4 * psil
    t57 = t55 - t56
    t58 = cos(t57)
    t62 = Q1 * cpa2EQ - Q2 * cpa1EQ
    t64 = t22 * t62 * t15
    t66 = sqrt(k)
    t67 = t66 * muM
    t68 = t26 * t67
    t69 = t46 ^ 2
    t73 = t34 / (t69 + 1) * t28
    t74 = t73 * t68
    contr[3] = -3/4 * t74 * t64 * t58 * t54
    t77 = t14 * t38
    t78 = pi * t77
    t79 = t55 - t42
    t80 = cos(t79)
    t82 = 1 + q
    t83 = t82 * IMy
    t84 = t46 - q + 1
    t85 = t7 + t8
    t88 = t2 * t85 * t84 * t83
    t89 = t29 * IMx
    t90 = t46 + q + 1
    t91 = -t62
    t93 = t91 * t90 * t89
    t97 = t26 * t22
    t98 = t28 * t97
    t104 = t33 / (t69 * t46 - 1) * t32 * t98
    contr[4] = t104 * (t88 + t93) * t80 * muM * t78
    t105 = IMz * q
    t107 = 2 * TL - 2 * psil
    t108 = cos(t107)
    t114 = t34 / (t46 + 1) * t28
    t115 = t114 * t68
    contr[5] = -3/2 * t115 * t64 * t108 * t105
    t118 = t14 * t16
    t119 = pi * t118
    t120 = t55 - psil
    t121 = cos(t120)
    t124 = t2 * t85 * t83
    t125 = t91 * t89
    t133 = t33 / (t46 - 1) * t32 * t98
    contr[6] = 3 * t133 * (t124 + t125) * t121 * muM * t119
    t135 = t55 + psil
    t136 = cos(t135)
    contr[7] = -3 * t133 * (-t124 + t125) * t136 * muM * t119
    t144 = 2 * TL + 2 * psil
    t145 = cos(t144)
    contr[8] = 3/2 * t115 * t64 * t145 * t105
    t151 = t55 + t42
    t152 = cos(t151)
    contr[9] = -t104 * t152 * (-t88 + t93) * muM * t78
    t156 = t55 + t56
    t157 = cos(t156)
    contr[10] = 3/4 * t74 * t64 * t157 * t54
    t161 = cpa1EQ * t3
    t162 = Q1 * Q2
    t164 = 2 * cpa2EQ * t162
    t165 = cpa1EQ * t4
    t168 = 4 * Q1 * cpa3EQ - cpa1EQ + t161 - t164 - t165
    t169 = t22 * t168
    t171 = IMz * muM
    t172 = t171 * t15
    t173 = t172 * t66 * t169
    t174 = exp(sigma)
    t175 = -psih + psig
    t176 = cos(t175)
    t180 = exp(2 * sigma)
    t186 = t33 / npsig * t28 / (-1 + t180)
    contr[11] = -t186 * t26 * t176 * t174 * t173 / 4
    t190 = psih + psig
    t191 = cos(t190)
    contr[12] = t186 * t26 * t191 * t174 * t173 / 4
    t196 = muM * q
    t197 = t174 * t196
    t198 = IMz * pi
    t200 = t168 * t66 * t198
    t201 = t200 * t197
    t202 = 2 * psil
    t203 = psig - t202 - psih
    t204 = cos(t203)
    t206 = t26 * t14
    t211 = 2 * npsil
    t215 = t33 / (-t211 + npsig) / (t180 - t46) * t28
    contr[13] = -t215 * t206 * t22 * t204 * t201 / 4
    t219 = psig - t202 + psih
    t220 = cos(t219)
    contr[14] = t215 * t206 * t22 * t220 * t201 / 4
    t225 = pi * t66
    t227 = t14 * t22
    t229 = t171 * t227 * cpa1EQ * t225
    t230 = -psih + t55 - psig
    t231 = cos(t230)
    contr[15] = -3/4 * t186 * t26 * t231 * t174 * t229
    t237 = -psih + t55 + psig
    t238 = cos(t237)
    contr[16] = 3/4 * t186 * t26 * t238 * t174 * t229
    t243 = t174 * muM
    t244 = pi * t243
    t245 = cpa1EQ * t162
    t246 = cpa2EQ * t3
    t247 = t246 / 2
    t248 = cpa2EQ * t4
    t249 = t248 / 2
    t250 = Q2 * cpa3EQ
    t253 = t245 + t247 - t249 + 2 * t250 + cpa2EQ / 2
    t254 = IMy * t253
    t255 = q - t180
    t256 = t2 * t255
    t257 = t256 * t254
    t258 = q + t180
    t259 = IMx * t258
    t264 = t161 + Q1 * (-2 * t8 + 4 * cpa3EQ) - t165 - cpa1EQ
    t266 = t264 * t259 / 2
    t271 = -psih + psig - psil
    t272 = cos(t271)
    t279 = exp(4 * sigma)
    t283 = t33 / (t46 - t279) / (-npsil + npsig) * t28
    contr[17] = t283 * t26 * t22 * t272 * t16 * t14 * (t257 + t266) * t244 / 2
    t286 = q * t180
    t287 = t286 - 1
    t288 = t2 * t287
    t289 = t288 * t254
    t291 = 1 + t286
    t293 = t291 * t264 * IMx / 2
    t297 = -psih + psig + psil
    t298 = cos(t297)
    t308 = t33 / (t46 * t279 - 1) / (npsil + npsig) * t28
    contr[18] = t308 * t26 * t22 * t298 * (t289 - t293) * t118 * t244 / 2
    t311 = t66 * t14
    t313 = t311 * t198 * t197
    t314 = -psih + psig + t202
    t315 = cos(t314)
    t325 = t33 / (t211 + npsig) / (t46 * t180 - 1) * t28
    contr[19] = -t325 * t26 * t315 * t169 * t313 / 4
    t329 = muM * t46
    t330 = t174 * t329
    t331 = t200 * t330
    t332 = -psih - t56 + psig
    t333 = cos(t332)
    t339 = 4 * npsil
    t343 = t33 / (-t339 + npsig) / (-t69 + t180) * t28
    contr[20] = -t343 * t206 * t22 * t333 * t331 / 4
    t348 = t174 * t2 * muM
    t349 = 2 * t245
    t351 = t246 + t349 - t248 + 4 * t250 + cpa2EQ
    t353 = pi * t22
    t355 = t353 * t351 * IMy * t348
    t356 = -psih - t42 + psig
    t357 = cos(t356)
    t363 = 3 * npsil
    t367 = t33 / (-t363 + npsig) / (t47 + t180) * t28
    contr[21] = t367 * t26 * t357 * t77 * t355 / 4
    t370 = -psih + t42 + psig
    t371 = cos(t370)
    t381 = t33 / (t363 + npsig) / (t47 * t180 + 1) * t28
    contr[22] = t381 * t26 * t371 * t77 * t355 / 4
    t386 = t198 * t174 * t22
    t387 = t386 * t168 * t329
    t388 = -psih + t56 + psig
    t389 = cos(t388)
    t399 = t33 / (t339 + npsig) / (t69 * t180 - 1) * t28
    contr[23] = -t399 * t26 * t389 * t311 * t387 / 4
    t404 = t161 + t164 - t165
    t408 = IMz * t22 * t404 * muM * t14 * t225
    t409 = psih + t55 - psig
    t410 = cos(t409)
    contr[24] = -3/4 * t186 * t26 * t410 * t174 * t408
    t416 = psih + t55 + psig
    t417 = cos(t416)
    contr[25] = 3/4 * t186 * t26 * t417 * t174 * t408
    t425 = psih + psig - psil
    t426 = cos(t425)
    contr[26] = t283 * t26 * t22 * t426 * (t257 - t266) * t118 * t244 / 2
    t435 = psih + psig + psil
    t436 = cos(t435)
    contr[27] = t308 * t26 * t22 * t436 * t119 * t174 * (t289 + t293) * muM / 2
    t441 = psih + psig + t202
    t442 = cos(t441)
    contr[28] = t325 * t26 * t442 * t169 * t313 / 4
    t447 = psih - t56 + psig
    t448 = cos(t447)
    contr[29] = t343 * t97 * t14 * t448 * t331 / 4
    t453 = psih - t42 + psig
    t454 = cos(t453)
    contr[30] = t367 * t26 * t454 * t77 * t355 / 4
    t459 = psih + t42 + psig
    t460 = cos(t459)
    contr[31] = t381 * t26 * t460 * t77 * t355 / 4
    t465 = psih + t56 + psig
    t466 = cos(t465)
    contr[32] = t399 * t26 * t466 * t311 * t387 / 4
    t473 = IMz * t174
    t474 = t225 * t473
    t475 = t474 * muM * t46 * cpa1EQ
    t476 = t55 - psih - t56 + psig
    t477 = cos(t476)
    contr[33] = 3/4 * t343 * t97 * t14 * t477 * t475
    t482 = t55 - psih + t56 - psig
    t483 = cos(t482)
    contr[34] = -3/4 * t343 * t97 * t14 * t483 * t475
    t489 = t404 * t329
    t490 = t474 * t489
    t491 = t55 + psih - t56 + psig
    t492 = cos(t491)
    contr[35] = 3/4 * t343 * t97 * t14 * t492 * t490
    t497 = t55 + psih + t56 - psig
    t498 = cos(t497)
    contr[36] = -3/4 * t343 * t97 * t14 * t498 * t490
    t506 = t474 * cpa1EQ * q * muM
    t507 = -psig + t202 + t55 - psih
    t508 = cos(t507)
    contr[37] = -3/4 * t215 * t206 * t22 * t508 * t506
    t514 = t404 * t196
    t515 = t474 * t514
    t516 = -psig + t202 + t55 + psih
    t517 = cos(t516)
    contr[38] = -3/4 * t215 * t206 * t22 * t517 * t515
    t523 = psig - t202 + t55 - psih
    t524 = cos(t523)
    contr[39] = 3/4 * t215 * t206 * t22 * t524 * t506
    t529 = psig - t202 + t55 + psih
    t530 = cos(t529)
    contr[40] = 3/4 * t215 * t206 * t22 * t530 * t515
    t535 = t22 * cpa1EQ
    t537 = t198 * t243
    t538 = t537 * q * t535
    t539 = -psih + t55 - psig - t202
    t540 = cos(t539)
    contr[41] = -3/4 * t325 * t26 * t540 * t311 * t538
    t546 = -psih + t55 + psig + t202
    t547 = cos(t546)
    contr[42] = 3/4 * t325 * t26 * t547 * t311 * t538
    t552 = t386 * t514
    t553 = psih + t55 - psig - t202
    t554 = cos(t553)
    contr[43] = -3/4 * t325 * t26 * t554 * t311 * t552
    t560 = psih + t55 + psig + t202
    t561 = cos(t560)
    contr[44] = 3/4 * t325 * t26 * t561 * t311 * t552
    t566 = t386 * t489
    t567 = psih + t55 - t56 - psig
    t568 = cos(t567)
    contr[45] = -3/4 * t399 * t26 * t568 * t311 * t566
    t574 = psih + t55 + t56 + psig
    t575 = cos(t574)
    contr[46] = 3/4 * t399 * t26 * t575 * t311 * t566
    t581 = t537 * t46 * t535
    t582 = -t56 - psig + t55 - psih
    t583 = cos(t582)
    contr[47] = -3/4 * t399 * t26 * t583 * t311 * t581
    t589 = t22 * cpa2EQ
    t590 = IMy * t589
    t593 = t243 * pi * t2 * t590
    t594 = -t42 - psig + t55 - psih
    t595 = cos(t594)
    contr[48] = -3/4 * t381 * t206 * t595 * t38 * t593
    t601 = -t42 - psig + t55 + psih
    t602 = cos(t601)
    t605 = t174 * pi
    t606 = t38 * muM
    t607 = t606 * t605
    t609 = t246 - t349 - t248
    t610 = t22 * t609
    t611 = t206 * t610
    t612 = t381 * t611
    contr[49] = -3/4 * t612 * t607 * t2 * IMy * t602
    t615 = -t42 + psig + t55 - psih
    t616 = cos(t615)
    t619 = t2 * IMy
    t620 = t605 * t619
    t623 = t367 * t206 * t606
    contr[50] = -3/4 * t623 * t620 * t22 * cpa2EQ * t616
    t626 = -t42 + psig + t55 + psih
    t627 = cos(t626)
    t630 = t367 * t611
    contr[51] = -3/4 * t630 * t607 * t627 * t619
    t633 = t14 * t605
    t634 = t16 * muM
    t635 = IMy * cpa2EQ
    t636 = t288 * t635
    t637 = IMx * cpa1EQ
    t638 = t291 * t637
    t642 = -psil - psig + t55 - psih
    t643 = cos(t642)
    contr[52] = -3/4 * t308 * t26 * t22 * t643 * (t636 + t638) * t634 * t633
    t649 = t245 - t247 + t249
    t650 = IMy * t649
    t652 = 2 * t288 * t650
    t654 = t404 * t291 * IMx
    t659 = t16 * muM * t14
    t661 = -psil - psig + t55 + psih
    t662 = cos(t661)
    contr[53] = -3/4 * t308 * t26 * t22 * t662 * t659 * pi * (-t652 + t654) * t174
    t668 = t256 * t635
    t669 = t258 * t637
    t673 = -psil + psig + t55 - psih
    t674 = cos(t673)
    contr[54] = -3/4 * t283 * t26 * t22 * t674 * (t668 + t669) * t634 * t633
    t680 = -psil + psig + t55 + psih
    t681 = cos(t680)
    t685 = 2 * t256 * t650
    t686 = t404 * t259
    contr[55] = -3/4 * t283 * t26 * t22 * (-t685 + t686) * t681 * t634 * t633
    t696 = psil - psig + t55 - psih
    t697 = cos(t696)
    contr[56] = 3/4 * t283 * t26 * t22 * t697 * t659 * (-t668 + t669) * t605
    t705 = psil - psig + t55 + psih
    t706 = cos(t705)
    contr[57] = 3/4 * t283 * t26 * t22 * t706 * (t685 + t686) * t634 * t633
    t714 = psil + psig + t55 - psih
    t715 = cos(t714)
    contr[58] = 3/4 * t308 * t26 * t22 * t715 * t659 * (-t636 + t638) * t605
    t724 = psil + psig + t55 + psih
    t725 = cos(t724)
    contr[59] = 3/4 * t308 * t26 * t22 * t725 * t16 * muM * (t652 + t654) * t633
    t730 = t42 - psig + t55 - psih
    t731 = cos(t730)
    contr[60] = -3/4 * t623 * t605 * t731 * t2 * t590
    t738 = t42 - psig + t55 + psih
    t739 = cos(t738)
    contr[61] = -3/4 * t630 * t739 * t38 * t243 * pi * t619
    t745 = t42 + psig + t55 - psih
    t746 = cos(t745)
    contr[62] = -3/4 * t381 * t206 * t746 * t38 * t593
    t752 = t42 + psig + t55 + psih
    t753 = cos(t752)
    contr[63] = -3/4 * t612 * t607 * t2 * t753 * IMy
    t759 = t56 + psig + t55 - psih
    t760 = cos(t759)
    contr[64] = 3/4 * t399 * t26 * t760 * t311 * t581
    t765 = t9 * t14
    t766 = muM * t765
    t770 = sin(psil)
    contr[65] = -2 * t34 / t82 * t28 * t26 * t22 * t770 * IMx * t16 * pi * t766
    t779 = q * t66
    t787 = sin(t202)
    contr[66] = t114 * t26 * t787 * t14 * t198 * t22 * (cpa3EQ * t3 + cpa3EQ * t4 - cpa3EQ - t7 + t8) * muM * t779
    t794 = sin(t42)
    contr[67] = -2/3 * t34 / (t47 + 1) * t28 * t26 * t22 * t794 * IMx * t38 * pi * t766
    t805 = muM * pi
    t809 = sin(t56)
    contr[68] = -t73 * t26 * t22 * t809 * IMz * t66 * t805 * t46 * t765 / 2
    t815 = pi * t171
    t817 = t22 * t85
    t819 = t817 * t46 * t66 * t815
    t820 = sin(t57)
    contr[69] = 3/4 * t73 * t26 * t820 * t14 * t819
    t827 = t2 * t91 * t84 * t83
    t830 = t85 * t29 * IMx * t90
    t833 = sin(t79)
    contr[70] = t104 * t833 * muM * (-t827 + t830) * t78
    t837 = t817 * t779 * t815
    t838 = sin(t107)
    contr[71] = 3/2 * t114 * t26 * t838 * t14 * t837
    t844 = t2 * t91 * t83
    t845 = t85 * t89
    t849 = sin(t120)
    contr[72] = 3 * t133 * t849 * t805 * t14 * (-t844 + t845) * t16
    t853 = sin(t135)
    contr[73] = -3 * t133 * (t844 + t845) * t853 * muM * t119
    t860 = sin(t144)
    contr[74] = -3/2 * t114 * t26 * t860 * t14 * t837
    t869 = sin(t151)
    contr[75] = -t104 * t869 * t805 * t14 * (t827 + t830) * t38
    t873 = sin(t156)
    contr[76] = -3/4 * t73 * t26 * t873 * t14 * t819
    t879 = t22 * t351
    t881 = t172 * t66 * t879
    t882 = sin(t175)
    contr[77] = -t186 * t26 * t882 * t174 * t881 / 4
    t888 = sin(t190)
    contr[78] = -t186 * t26 * t888 * t174 * t881 / 4
    t895 = t225 * IMz * t351
    t896 = t895 * t197
    t897 = sin(t203)
    contr[79] = -t215 * t206 * t22 * t897 * t896 / 4
    t903 = sin(t219)
    contr[80] = -t215 * t206 * t22 * t903 * t896 / 4
    t910 = t22 * cpa2EQ * muM
    t911 = sin(t230)
    contr[81] = -3/4 * t186 * t26 * t311 * t198 * t174 * t911 * t910
    t920 = sin(t237)
    contr[82] = 3/4 * t186 * t26 * t14 * t920 * t474 * t910
    t925 = IMy * t264
    t926 = t256 * t925
    t928 = 2 * t253 * t259
    t932 = sin(t271)
    contr[83] = -t283 * t26 * t22 * t932 * (t926 - t928) * t118 * t244 / 4
    t938 = t288 * t925
    t941 = 2 * t291 * t253 * IMx
    t945 = sin(t297)
    contr[84] = -t308 * t26 * t22 * t945 * (t938 + t941) * t118 * t244 / 4
    t951 = t198 * t879
    t952 = t951 * t197
    t953 = sin(t314)
    contr[85] = -t325 * t26 * t953 * t311 * t952 / 4
    t959 = t895 * t330
    t960 = sin(t332)
    contr[86] = -t343 * t97 * t14 * t960 * t959 / 4
    t968 = t620 * t22 * t168 * muM
    t969 = sin(t356)
    contr[87] = -t367 * t26 * t969 * t77 * t968 / 4
    t975 = sin(t370)
    contr[88] = -t381 * t26 * t975 * t77 * t968 / 4
    t981 = t951 * t330
    t982 = sin(t388)
    contr[89] = -t399 * t26 * t982 * t311 * t981 / 4
    t991 = t473 * muM * t22 * t609 * t225
    t992 = sin(t409)
    contr[90] = -3/4 * t186 * t26 * t992 * t14 * t991
    t998 = sin(t416)
    contr[91] = 3/4 * t186 * t26 * t998 * t14 * t991
    t1006 = sin(t425)
    contr[92] = t283 * t26 * t22 * t1006 * (t926 + t928) * t118 * t244 / 4
    t1015 = sin(t435)
    contr[93] = t308 * t26 * t22 * t1015 * t16 * t14 * (t938 - t941) * t244 / 4
    t1020 = sin(t441)
    contr[94] = -t325 * t26 * t1020 * t311 * t952 / 4
    t1026 = sin(t447)
    contr[95] = -t343 * t97 * t14 * t1026 * t959 / 4
    t1032 = sin(t453)
    contr[96] = t367 * t26 * t1032 * t77 * t968 / 4
    t1037 = sin(t459)
    contr[97] = t381 * t26 * t1037 * t77 * t968 / 4
    t1042 = sin(t465)
    contr[98] = -t399 * t26 * t1042 * t311 * t981 / 4
    t1050 = sin(t476)
    t1054 = t97 * t311
    t1055 = t343 * t1054
    contr[99] = 3/4 * t1055 * muM * t1050 * t605 * IMz * t46 * cpa2EQ
    t1057 = sin(t482)
    contr[100] = -3/4 * t1055 * t537 * t46 * cpa2EQ * t1057
    t1063 = sin(t491)
    t1066 = muM * t609
    t1067 = t1066 * t605
    contr[101] = 3/4 * t1055 * t1067 * IMz * t46 * t1063
    t1074 = sin(t497)
    contr[102] = -3/4 * t343 * t97 * t14 * t1074 * t67 * t609 * t174 * pi * t54
    t1080 = sin(t507)
    t1084 = t215 * t1054
    contr[103] = -3/4 * t1084 * t537 * q * cpa2EQ * t1080
    t1087 = pi * t105
    t1088 = sin(t516)
    contr[104] = -3/4 * t1084 * t1066 * t1088 * t174 * t1087
    t1098 = sin(t523)
    contr[105] = 3/4 * t215 * t206 * t22 * t1098 * t67 * t605 * cpa2EQ * q * IMz
    t1103 = sin(t529)
    contr[106] = 3/4 * t1084 * t1067 * IMz * t1103 * q
    t1108 = q * t589
    t1109 = sin(t539)
    t1113 = t206 * t67
    t1114 = t325 * t1113
    contr[107] = -3/4 * t1114 * t1109 * t174 * t198 * t1108
    t1117 = sin(t546)
    contr[108] = 3/4 * t1114 * t605 * t1117 * IMz * t1108
    t1122 = sin(t553)
    contr[109] = -3/4 * t1114 * t610 * t174 * t1122 * t1087
    t1128 = sin(t560)
    t1131 = t610 * t605
    contr[110] = 3/4 * t1114 * t1131 * IMz * q * t1128
    t1134 = sin(t567)
    t1138 = t399 * t1113
    contr[111] = -3/4 * t1138 * t1131 * IMz * t46 * t1134
    t1141 = sin(t574)
    contr[112] = 3/4 * t1138 * t1131 * IMz * t46 * t1141
    t1146 = sin(t582)
    contr[113] = -3/4 * t1138 * t605 * t54 * t22 * cpa2EQ * t1146
    t1153 = IMy * cpa1EQ
    t1155 = t353 * t1153 * t348
    t1156 = sin(t594)
    contr[114] = 3/4 * t381 * t26 * t1156 * t77 * t1155
    t1164 = t404 * t38 * IMy * pi * t348
    t1165 = sin(t601)
    contr[115] = 3/4 * t381 * t26 * t1165 * t227 * t1164
    t1170 = sin(t615)
    contr[116] = 3/4 * t367 * t26 * t1170 * t77 * t1155
    t1175 = sin(t626)
    contr[117] = 3/4 * t367 * t26 * t1175 * t227 * t1164
    t1180 = t288 * t1153
    t1181 = IMx * cpa2EQ
    t1182 = t291 * t1181
    t1187 = sin(t642)
    contr[118] = -3/4 * t308 * t26 * t22 * t1187 * t16 * muM * (-t1180 + t1182) * t633
    t1194 = t2 * t404
    t1196 = t1194 * t287 * IMy / 2
    t1198 = t291 * t649 * IMx
    t1203 = sin(t661)
    contr[119] = 3/2 * t308 * t26 * t22 * t1203 * t659 * pi * t174 * (t1196 + t1198)
    t1208 = t256 * t1153
    t1209 = t258 * t1181
    t1213 = sin(t673)
    contr[120] = -3/4 * t283 * t26 * t22 * t1213 * t659 * (-t1208 + t1209) * t605
    t1221 = t1194 * t255 * IMy / 2
    t1222 = t649 * t259
    t1226 = sin(t680)
    contr[121] = 3/2 * t283 * t26 * t22 * t1226 * (t1221 + t1222) * t634 * t633
    t1235 = sin(t696)
    contr[122] = 3/4 * t283 * t26 * t22 * t1235 * t16 * muM * (t1208 + t1209) * t633
    t1244 = sin(t705)
    contr[123] = -3/2 * t283 * t26 * t22 * t1244 * t659 * pi * t174 * (-t1221 + t1222)
    t1253 = sin(t714)
    contr[124] = 3/4 * t308 * t26 * t22 * t1253 * (t1180 + t1182) * t634 * t633
    t1262 = sin(t724)
    contr[125] = -3/2 * t308 * t26 * t22 * t1262 * t659 * pi * (-t1196 + t1198) * t174
    t1268 = sin(t730)
    contr[126] = 3/4 * t367 * t26 * t1268 * t77 * t1155
    t1273 = sin(t738)
    contr[127] = 3/4 * t367 * t26 * t1273 * t227 * t1164
    t1278 = sin(t745)
    contr[128] = 3/4 * t381 * t26 * t1278 * t77 * t1155
    t1283 = sin(t752)
    contr[129] = 3/4 * t381 * t26 * t1283 * t227 * t1164
    t1290 = sin(t759)
    contr[130] = 3/4 * t399 * t206 * t1290 * t66 * t537 * t46 * t589
       
    der_Jh = sum(contr);
    return der_Jh;
end

function derivativechiM2_JhP2(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)
    contr = zeros(95);
    t1 = sqrt(k)
    t2 = pi * t1
    t4 = sqrt(k + m)
    t5 = 0.1e1 / t4
    t9 = Q1 * cpa2EQ - Q2 * cpa1EQ
    t10 = Q1 ^ 2
    t11 = Q2 ^ 2
    t13 = 1 / (t10 + t11 + 1)
    t14 = t13 * t9
    t15 = IMz * muM
    t17 = t15 * t14 * t5 * t2
    t18 = exp(sigma)
    t19 = cdelta * t18
    t20 = 2 * TL
    t21 = t20 - psig
    t22 = cos(t21)
    t23 = rc ^ 2
    t25 = 0.1e1 / t23 / rc
    t29 = exp(2 * sigma)
    t32 = 0.1e1 / KK
    t35 = 0.1e1 / Jg
    t37 = t35 / npsig * t32 / (-1 + t29)
    contr[1] = -3/2 * t37 * t25 * t22 * t19 * t17
    t41 = t20 + psig
    t42 = cos(t41)
    contr[2] = 3/2 * t37 * t25 * t42 * t19 * t17
    t47 = q ^ 2
    t48 = t47 * t1
    t49 = muM * t48
    t50 = cpa1EQ * t10
    t51 = Q1 * Q2
    t53 = 2 * cpa2EQ * t51
    t54 = cpa1EQ * t11
    t59 = IMz * pi
    t60 = t59 * t13 * (4 * Q1 * cpa3EQ - cpa1EQ + t50 - t53 - t54)
    t61 = t60 * t49
    t62 = cdelta * t5
    t63 = 4 * psil
    t64 = psih - t63
    t65 = cos(t64)
    t68 = t47 ^ 2
    t72 = 0.1e1 / npsil
    t73 = t35 * t72
    t74 = t73 / (t68 + 1) * t32
    contr[3] = t74 * t25 * t65 * t62 * t61 / 8
    t77 = cdelta * muM
    t78 = sqrt(q)
    t79 = t78 * q
    t80 = t79 * t77
    t81 = 3 * psil
    t82 = psih - t81
    t83 = cos(t82)
    t84 = cpa1EQ * t51
    t85 = cpa2EQ * t10
    t86 = t85 / 2
    t87 = cpa2EQ * t11
    t88 = t87 / 2
    t89 = Q2 * cpa3EQ
    t92 = t84 + t86 - t88 + 2 * t89 + cpa2EQ / 2
    t93 = t47 - q + 1
    t95 = 1 + q
    t96 = t95 * IMy
    t98 = sqrt(1 + k)
    t100 = t98 * t96 * t93 * t92
    t101 = t47 + q + 1
    t102 = q - 1
    t103 = t102 * t101
    t104 = Q2 * cpa2EQ
    t109 = t50 + Q1 * (-2 * t104 + 4 * cpa3EQ) - t54 - cpa1EQ
    t112 = t109 * IMx * t103 / 2
    t118 = t25 * t13 * t5
    t119 = t72 * t32
    t124 = t35 / (t68 * t47 - 1) * t119
    t125 = t124 * t118
    contr[4] = -t125 * pi * (t100 - t112) * t83 * t80 / 3
    t128 = q * t1
    t129 = muM * t128
    t130 = t60 * t129
    t131 = 2 * psil
    t132 = psih - t131
    t133 = cos(t132)
    t139 = t73 / (t47 + 1) * t32
    contr[5] = t139 * t25 * t133 * t62 * t130 / 4
    t142 = t78 * t77
    t144 = t98 * t95
    t145 = t144 * IMy * t92
    t146 = IMx * t102
    t148 = t109 * t146 / 2
    t150 = psih - psil
    t151 = cos(t150)
    t158 = t35 / (t47 - 1) * t119
    t159 = t158 * t118
    contr[6] = -t159 * pi * t151 * (t145 - t148) * t142
    t161 = psih + psil
    t162 = cos(t161)
    contr[7] = -t158 * t25 * t13 * (t145 + t148) * t5 * pi * t162 * t142
    t171 = psih + t131
    t172 = cos(t171)
    contr[8] = -t139 * t25 * t172 * t62 * t130 / 4
    t178 = psih + t81
    t179 = cos(t178)
    contr[9] = -t125 * pi * (t100 + t112) * t179 * t80 / 3
    t186 = psih + t63
    t187 = cos(t186)
    contr[10] = -t74 * t25 * t187 * t62 * t61 / 8
    t193 = t79 * t98
    t196 = t18 * t5
    t197 = t196 * pi * IMy
    t198 = t197 * t193 * t77
    t200 = cos(-t81 + psig)
    t203 = Q1 * cpa1EQ
    t204 = cpa3EQ * (-t10 - t11 + 1) + t203 - t104
    t206 = t25 * t13
    t208 = t47 * q
    t212 = 3 * npsil
    t216 = t35 / (-t212 + npsig) / (t208 + t29) * t32
    contr[11] = t216 * t206 * t204 * t200 * t198
    t220 = t197 * t78 * t98 * t77
    t221 = -psil + psig
    t222 = cos(t221)
    t225 = q + t29
    t229 = 0.1e1 / (-npsil + npsig)
    t230 = t35 * t229
    contr[12] = t230 / t225 * t32 * t206 * t204 * t222 * t220
    t233 = psil + psig
    t234 = cos(t233)
    t237 = q * t29
    t238 = 1 + t237
    t242 = 0.1e1 / (npsil + npsig)
    t243 = t35 * t242
    contr[13] = t243 / t238 * t32 * t206 * t204 * t234 * t220
    t247 = cos(t81 + psig)
    t257 = t35 / (t212 + npsig) / (t208 * t29 + 1) * t32
    contr[14] = t257 * t206 * t204 * t247 * t198
    t259 = t20 - t63 - psig
    t260 = cos(t259)
    t262 = t5 * IMz
    t264 = pi * t18
    t265 = t264 * t14
    t268 = t25 * t1 * t77
    t273 = 4 * npsil
    t277 = t35 / (t273 + npsig) / (t68 * t29 - 1) * t32
    t278 = t277 * t268
    contr[15] = -3/2 * t278 * t265 * t262 * t260 * t47
    t283 = t203 + t104
    t284 = t13 * t283
    t286 = t284 * t193 * t264 * IMy * muM
    t287 = t20 - t81 - psig
    t288 = cos(t287)
    contr[16] = 3/2 * t257 * t25 * t288 * t62 * t286
    t293 = t20 - t81 + psig
    t294 = cos(t293)
    contr[17] = 3/2 * t216 * t25 * t294 * t62 * t286
    t299 = t237 - 1
    t300 = t299 * IMy
    t301 = t98 * t283
    t302 = t301 * t300
    t303 = t238 * IMx
    t304 = -t9
    t305 = t304 * t303
    t309 = t5 * pi
    t310 = t78 * muM
    t311 = t310 * t309
    t313 = t20 - psil - psig
    t314 = cos(t313)
    t319 = exp(4 * sigma)
    t324 = t35 / (t47 * t319 - 1) * t242 * t32
    contr[18] = 3/2 * t324 * t25 * t13 * t314 * t311 * t18 * (t302 + t305) * cdelta
    t327 = pi * t19
    t328 = q - t29
    t329 = t328 * IMy
    t330 = t301 * t329
    t331 = t225 * IMx
    t332 = t304 * t331
    t337 = t20 - psil + psig
    t338 = cos(t337)
    t345 = t35 / (t47 - t319) * t229 * t32
    contr[19] = 3/2 * t345 * t25 * t13 * t338 * t310 * t5 * (t330 + t332) * t327
    t352 = t20 + psil - psig
    t353 = cos(t352)
    contr[20] = -3/2 * t345 * t25 * t13 * t353 * t311 * t18 * cdelta * (-t330 + t332)
    t359 = muM * t5
    t364 = t20 + psil + psig
    t365 = cos(t364)
    contr[21] = -3/2 * t324 * t25 * t13 * t365 * (-t302 + t305) * t78 * t359 * t327
    t371 = t20 + t81 - psig
    t372 = cos(t371)
    contr[22] = 3/2 * t216 * t25 * t372 * t62 * t286
    t377 = t20 + t81 + psig
    t378 = cos(t377)
    contr[23] = 3/2 * t257 * t25 * t378 * t62 * t286
    t383 = t20 + t63 + psig
    t384 = cos(t383)
    contr[24] = 3/2 * t278 * t265 * t262 * t384 * t47
    t389 = -psig - t131 + t20
    t390 = cos(t389)
    t398 = 2 * npsil
    t402 = t35 / (t398 + npsig) / (t47 * t29 - 1) * t32
    t403 = t402 * t268
    contr[25] = -3/2 * t403 * t265 * t262 * t390 * q
    t406 = -psig + t131 + t20
    t407 = cos(t406)
    t409 = t9 * IMz
    t411 = t77 * t264
    t414 = t206 * t5 * t1
    t415 = t29 - t47
    t420 = t35 / (-t398 + npsig)
    t421 = t420 / t415 * t32
    t422 = t421 * t414
    contr[26] = -3/2 * t422 * t411 * t409 * t407 * q
    t425 = psig - t131 + t20
    t426 = cos(t425)
    contr[27] = 3/2 * t422 * t411 * t409 * t426 * q
    t431 = psig + t131 + t20
    t432 = cos(t431)
    contr[28] = 3/2 * t403 * t265 * t262 * t432 * q
    t438 = t1 * t13 * cpa1EQ
    t439 = muM * t47
    t440 = t59 * t439
    t441 = t440 * t438
    t442 = -t63 + t20 - psih
    t443 = cos(t442)
    contr[29] = 3/8 * t74 * t25 * t443 * t62 * t441
    t448 = t50 + t53 - t54
    t450 = t59 * t13 * t448
    t451 = t450 * t49
    t452 = -t63 + t20 + psih
    t453 = cos(t452)
    contr[30] = 3/8 * t74 * t25 * t453 * t62 * t451
    t458 = -t63 + psig + t20
    t459 = cos(t458)
    t463 = -t68 + t29
    t468 = t35 / (-t273 + npsig)
    t469 = t468 / t463 * t32
    t470 = t469 * t414
    contr[31] = 3/2 * t470 * t411 * t409 * t459 * t47
    t472 = t79 * cdelta
    t473 = -t81 + t20 - psih
    t474 = cos(t473)
    t476 = muM * pi
    t477 = IMy * cpa2EQ
    t478 = t208 + 1
    t479 = t98 * t478
    t481 = IMx * cpa1EQ
    t482 = t208 - 1
    t483 = t482 * t481
    contr[32] = t125 * (t479 * t477 + t483) * t476 * t474 * t472 / 2
    t488 = -t81 + t20 + psih
    t489 = cos(t488)
    t491 = t84 - t86 + t88
    t492 = t491 * IMy
    t496 = 2 * t98 * t95 * t93 * t492
    t499 = t102 * t448 * IMx * t101
    contr[33] = t125 * (-t496 + t499) * t476 * t489 * t472 / 2
    t504 = muM * q
    t505 = t59 * t504
    t506 = t505 * t438
    t507 = -t131 + t20 - psih
    t508 = cos(t507)
    contr[34] = 3/4 * t139 * t25 * t508 * t62 * t506
    t513 = t450 * t129
    t514 = -t131 + t20 + psih
    t515 = cos(t514)
    contr[35] = 3/4 * t139 * t25 * t515 * t62 * t513
    t520 = t78 * cdelta
    t521 = -psil + t20 - psih
    t522 = cos(t521)
    t524 = t144 * t477
    t525 = t102 * t481
    contr[36] = 3/2 * t159 * muM * (t524 + t525) * pi * t522 * t520
    t531 = -psil + t20 + psih
    t532 = cos(t531)
    t535 = 2 * t144 * t492
    t537 = t102 * t448 * IMx
    contr[37] = 3/2 * t159 * (-t535 + t537) * t476 * t532 * t520
    t544 = psil + t20 - psih
    t545 = cos(t544)
    contr[38] = -3/2 * t159 * muM * pi * t545 * (-t524 + t525) * t520
    t551 = psil + t20 + psih
    t552 = cos(t551)
    t554 = t5 * t476
    contr[39] = -3/2 * t158 * t25 * t13 * (t535 + t537) * t554 * t552 * t520
    t562 = t131 + t20 - psih
    t563 = cos(t562)
    contr[40] = -3/4 * t139 * t25 * t563 * t62 * t506
    t569 = t131 + t20 + psih
    t570 = cos(t569)
    contr[41] = -3/4 * t139 * t25 * t570 * t62 * t513
    t576 = t81 + t20 - psih
    t577 = cos(t576)
    t580 = -IMy * t478
    contr[42] = -t125 * muM * (t98 * cpa2EQ * t580 + t483) * pi * t577 * t472 / 2
    t592 = t81 + t20 + psih
    t593 = cos(t592)
    contr[43] = -t125 * muM * pi * t593 * t79 * (t496 + t499) * cdelta / 2
    t599 = t63 + t20 - psih
    t600 = cos(t599)
    contr[44] = -3/8 * t74 * t25 * t600 * t62 * t441
    t606 = t63 + t20 + psih
    t607 = cos(t606)
    contr[45] = -3/8 * t74 * t25 * t607 * t62 * t451
    t613 = t63 - psig + t20
    t614 = cos(t613)
    contr[46] = -3/2 * t470 * t411 * t409 * t614 * t47
    t623 = t13 * (cpa3EQ * t10 + cpa3EQ * t11 - cpa3EQ + t104 - t203)
    t627 = sin(psig)
    contr[47] = t37 * t25 * t627 * t19 * t15 * t309 * t1 * t623
    t634 = t284 * t1 * t18 * pi * t15
    t635 = sin(t21)
    contr[48] = 3/2 * t37 * t25 * t635 * t62 * t634
    t640 = sin(t41)
    contr[49] = -3/2 * t37 * t25 * t640 * t62 * t634
    t649 = sin(psig - t131)
    t654 = t206 * t204 * t18
    contr[50] = -t420 / t415 * t32 * t654 * t649 * IMz * t2 * t359 * cdelta * q
    t660 = IMz * t18
    t662 = t309 * t623
    t664 = cdelta * t1
    t666 = sin(psig + t131)
    contr[51] = t402 * t25 * t666 * t664 * t662 * t660 * t504
    t670 = 2 * t84
    t674 = t13 * (t85 + t670 - t87 + 4 * t89 + cpa2EQ) * t1
    t675 = t440 * t674
    t676 = sin(t64)
    contr[52] = -t74 * t25 * t676 * t62 * t675 / 8
    t682 = sin(t82)
    t689 = t98 * t109 * t95 * IMy * t93
    t692 = 2 * t146 * t92 * t101
    contr[53] = -t124 * t25 * t13 * (t689 + t692) * t5 * pi * t682 * t80 / 6
    t699 = t505 * t674
    t700 = sin(t132)
    contr[54] = -t139 * t25 * t700 * t62 * t699 / 4
    t706 = sin(t150)
    t711 = t98 * t109 * t96
    t714 = 2 * IMx * t102 * t92
    contr[55] = -t158 * t25 * t13 * (t711 + t714) * t5 * pi * t706 * t142 / 2
    t724 = sin(t161)
    contr[56] = -t159 * pi * t724 * t78 * cdelta * (t711 - t714) * muM / 2
    t730 = sin(t171)
    contr[57] = t139 * t25 * t730 * t62 * t699 / 4
    t735 = sin(t178)
    contr[58] = -t125 * (t689 - t692) * pi * t735 * t80 / 6
    t742 = sin(t186)
    contr[59] = t74 * t25 * t742 * t62 * t675 / 8
    t750 = sin(-t63 + psig)
    contr[60] = -t468 / t463 * t32 * t654 * t750 * IMz * t2 * t359 * t47 * cdelta
    t761 = sin(t221)
    contr[61] = t230 / t328 * t32 * t654 * t761 * IMx * pi * t78 * t5 * t77
    t772 = sin(t233)
    contr[62] = t243 / t299 * t32 * t25 * t772 * t520 * t662 * IMx * t18 * muM
    t782 = sin(t63 + psig)
    contr[63] = t277 * t25 * t782 * t664 * t662 * t660 * t439
    t786 = t264 * t15
    t788 = t284 * t48 * t786
    t789 = sin(t259)
    contr[64] = 3/2 * t277 * t25 * t789 * t62 * t788
    t794 = sin(t287)
    t798 = pi * cdelta * t196
    t802 = t25 * t98 * t79 * muM
    t803 = t257 * t802
    contr[65] = 3/2 * t803 * t798 * t14 * IMy * t794
    t805 = sin(t293)
    t809 = t216 * t802
    contr[66] = 3/2 * t809 * t798 * t14 * IMy * t805
    t811 = t98 * t304
    t812 = t811 * t300
    t813 = t283 * t303
    t818 = sin(t313)
    contr[67] = 3/2 * t324 * t25 * t13 * t818 * (-t812 + t813) * t78 * t359 * t327
    t823 = t811 * t329
    t824 = t283 * t331
    t829 = sin(t337)
    contr[68] = 3/2 * t345 * t25 * t13 * t829 * t311 * t18 * (-t823 + t824) * cdelta
    t838 = sin(t352)
    contr[69] = -3/2 * t345 * t25 * t13 * t838 * t78 * (t823 + t824) * t359 * t327
    t848 = sin(t364)
    contr[70] = -3/2 * t324 * t25 * t13 * t848 * t310 * (t812 + t813) * t5 * t327
    t854 = sin(t371)
    contr[71] = 3/2 * t809 * t798 * t14 * IMy * t854
    t859 = sin(t377)
    contr[72] = 3/2 * t803 * t798 * t14 * IMy * t859
    t864 = sin(t383)
    contr[73] = -3/2 * t277 * t25 * t864 * t62 * t788
    t871 = t284 * t128 * t786
    t872 = sin(t389)
    contr[74] = 3/2 * t402 * t25 * t872 * t62 * t871
    t877 = sin(t406)
    contr[75] = 3/2 * t421 * t25 * t877 * t62 * t871
    t882 = sin(t425)
    contr[76] = -3/2 * t421 * t25 * t882 * t62 * t871
    t888 = sin(t431)
    contr[77] = -3/2 * t402 * t25 * t888 * t62 * t871
    t894 = sin(t442)
    t897 = t13 * cpa2EQ
    t898 = t897 * t2
    t900 = t25 * t5
    t901 = t900 * t77
    t902 = t74 * t901
    contr[78] = 3/8 * t902 * t898 * IMz * t47 * t894
    t905 = t13 * (t85 - t670 - t87)
    t906 = t47 * t905
    t907 = t1 * IMz
    t908 = sin(t452)
    contr[79] = 3/8 * t902 * t908 * pi * t907 * t906
    t913 = sin(t458)
    contr[80] = -3/2 * t469 * t25 * t913 * t62 * t788
    t919 = sin(t473)
    t925 = t482 * IMx * cpa2EQ
    contr[81] = t124 * t25 * t13 * (t98 * cpa1EQ * t580 + t925) * t554 * t919 * t472 / 2
    t931 = sin(t488)
    t936 = t98 * t448 * t93 * t96 / 2
    t938 = t491 * IMx * t103
    contr[82] = -t125 * muM * pi * (t936 + t938) * t931 * t472
    t946 = sin(t507)
    t950 = t139 * t901
    contr[83] = 3/4 * t950 * t897 * pi * t946 * t1 * IMz * q
    t952 = q * t905
    t953 = sin(t514)
    contr[84] = 3/4 * t950 * t953 * pi * t907 * t952
    t958 = sin(t521)
    t960 = IMy * cpa1EQ
    t961 = t144 * t960
    t963 = IMx * t102 * cpa2EQ
    contr[85] = 3/2 * t159 * muM * (-t961 + t963) * pi * t958 * t520
    t969 = sin(t531)
    t973 = t98 * t448 * t96 / 2
    t974 = t491 * t146
    contr[86] = -3 * t159 * muM * (t973 + t974) * pi * t969 * t520
    t981 = sin(t544)
    contr[87] = -3/2 * t158 * t25 * t13 * (t961 + t963) * t554 * t981 * t520
    t990 = sin(t551)
    contr[88] = 3 * t159 * muM * pi * (-t973 + t974) * t990 * t520
    t997 = sin(t562)
    contr[89] = -3/4 * t950 * t898 * IMz * q * t997
    t1005 = sin(t569)
    contr[90] = -3/4 * t139 * t900 * t1005 * cdelta * t476 * t907 * t952
    t1011 = sin(t576)
    contr[91] = -t124 * t25 * t13 * (t479 * t960 + t925) * t554 * t1011 * t472 / 2
    t1021 = sin(t592)
    contr[92] = t125 * (-t936 + t938) * t476 * t1021 * t472
    t1026 = sin(t599)
    contr[93] = -3/8 * t902 * t898 * IMz * t47 * t1026
    t1032 = sin(t606)
    contr[94] = -3/8 * t902 * t1032 * pi * t907 * t906
    t1038 = sin(t613)
    contr[95] = 3/2 * t469 * t25 * t1038 * t62 * t788
        
    
    der_Jh = sum(contr);
    return der_Jh;
end

function derivativechiM2_psil(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)

    contr = zeros(208)
    t2 = sqrt(1 + k)
    t4 = Q1 ^ 2
    t5 = Q2 ^ 2
    t8 = Q1 * cpa1EQ
    t9 = Q2 * cpa2EQ
    t10 = cpa3EQ * (-t4 - t5 + 1) + t8 - t9
    t11 = t10 * IMy * t2
    t13 = sqrt(k + m)
    t14 = 0.1e1 / t13
    t15 = sqrt(q)
    t17 = muM * cdelta
    t20 = sin(psil)
    t23 = 1 / (t4 + t5 + 1)
    t25 = rc ^ 2
    t27 = 0.1e1 / t25 / rc
    t28 = 0.1e1 / KK
    t29 = t28 * t27
    t30 = q - 1
    t32 = 0.1e1 / npsil
    contr[1] = -2 * t32 / t30 * t29 * t23 * t20 * pi * t17 * t15 * t14 * t11
    t38 = t15 * q
    t42 = 3 * psil
    t43 = sin(t42)
    t46 = q ^ 2
    t47 = t46 * q
    t48 = t47 - 1
    contr[2] = -2 * t32 / t48 * t29 * t23 * t43 * pi * t17 * t38 * t14 * t11
    t55 = sqrt(k)
    t56 = t55 * cdelta
    t58 = muM * IMz
    t59 = t14 * pi
    t60 = t59 * t58
    t61 = t60 * t46 * t56
    t64 = Q1 * cpa2EQ - Q2 * cpa1EQ
    t65 = t23 * t64
    t66 = 2 * TL
    t67 = 4 * psil
    t68 = t66 - t67
    t69 = sin(t68)
    t71 = t46 ^ 2
    t75 = t32 / (t71 + 1) * t29
    contr[3] = -3 * t75 * t69 * t65 * t61
    t80 = cdelta * t38 * muM
    t81 = 1 + q
    t82 = t81 * IMy
    t83 = t46 - q + 1
    t84 = t8 + t9
    t87 = t2 * t84 * t83 * t82
    t88 = t30 * IMx
    t89 = t46 + q + 1
    t90 = -t64
    t92 = t90 * t89 * t88
    t96 = t66 - t42
    t97 = sin(t96)
    t100 = t32 * t28
    t104 = 0.1e1 / (t71 * t46 - 1) * t100
    contr[4] = 3 * t104 * t27 * t23 * t97 * (t87 + t92) * t59 * t80
    t108 = t60 * q * t56
    t110 = 2 * TL - 2 * psil
    t111 = sin(t110)
    t116 = t32 / (t46 + 1) * t29
    contr[5] = -3 * t116 * t111 * t65 * t108
    t121 = cdelta * t15 * muM
    t122 = t2 * t84
    t123 = t122 * t82
    t124 = t90 * t88
    t129 = t66 - psil
    t130 = sin(t129)
    t135 = 0.1e1 / (t46 - 1) * t100
    contr[6] = 3 * t135 * t27 * t23 * t130 * pi * (t123 + t124) * t14 * t121
    t142 = t66 + psil
    t143 = sin(t142)
    contr[7] = -3 * t135 * t27 * t23 * t143 * pi * (t123 - t124) * t14 * t121
    t150 = 2 * TL + 2 * psil
    t151 = sin(t150)
    contr[8] = -3 * t116 * t151 * t65 * t108
    t160 = t66 + t42
    t161 = sin(t160)
    contr[9] = -3 * t104 * t27 * t23 * t161 * pi * (t87 - t92) * t14 * t80
    t167 = t66 + t67
    t168 = sin(t167)
    contr[10] = -3 * t75 * t168 * t65 * t61
    t173 = t55 * sdelta
    t174 = t46 * t173
    t175 = cpa1EQ * t4
    t176 = Q1 * Q2
    t178 = 2 * cpa2EQ * t176
    t179 = cpa1EQ * t5
    t182 = 4 * Q1 * cpa3EQ - cpa1EQ + t175 - t178 - t179
    t184 = IMz * t23
    t185 = t184 * t182 * muM
    t187 = psih - t67
    t188 = sin(t187)
    contr[11] = -t75 * t188 * t59 * t185 * t174 / 2
    t193 = sdelta * muM
    t194 = cpa1EQ * t176
    t195 = cpa2EQ * t4
    t196 = t195 / 2
    t197 = cpa2EQ * t5
    t198 = t197 / 2
    t199 = Q2 * cpa3EQ
    t202 = t194 + t196 - t198 + 2 * t199 + cpa2EQ / 2
    t205 = t2 * t82 * t83 * t202
    t206 = t30 * t89
    t211 = t175 + Q1 * (-2 * t9 + 4 * cpa3EQ) - t179 - cpa1EQ
    t212 = t211 * IMx
    t214 = t212 * t206 / 2
    t217 = psih - t42
    t218 = sin(t217)
    t223 = t104 * t27 * t23 * t38
    contr[12] = t223 * t218 * t59 * (t205 - t214) * t193
    t224 = q * t173
    t226 = 2 * psil
    t227 = psih - t226
    t228 = sin(t227)
    contr[13] = -t116 * t228 * t59 * t185 * t224 / 2
    t233 = IMy * t202
    t234 = t2 * t81
    t235 = t234 * t233
    t237 = t211 * t88 / 2
    t241 = psih - psil
    t242 = sin(t241)
    t247 = t135 * t27 * t23 * t15
    contr[14] = t247 * t242 * t59 * sdelta * muM * (t235 - t237)
    t248 = pi * t193
    t249 = psih + psil
    t250 = sin(t249)
    contr[15] = -t247 * (t235 + t237) * t250 * t14 * t248
    t257 = t23 * t182
    t258 = psih + t226
    t259 = sin(t258)
    contr[16] = -t116 * t259 * t257 * t60 * t224 / 2
    t266 = psih + t42
    t267 = sin(t266)
    contr[17] = -t223 * t267 * t59 * (t205 + t214) * t193
    t272 = psih + t67
    t273 = sin(t272)
    contr[18] = -t75 * t273 * t257 * t60 * t174 / 2
    t278 = t10 * sdelta
    t281 = muM * pi
    t282 = t281 * t14 * IMy
    t283 = t282 * t38 * t278
    t285 = sin(-t42 + psig)
    t286 = exp(sigma)
    t288 = t23 * t2
    t291 = exp(2 * sigma)
    t294 = 3 * npsil
    t298 = 1 / (-t294 + npsig) / (t47 + t291) * t29
    contr[19] = -3 * t298 * t288 * t286 * t285 * t283
    t303 = IMy * t286
    t310 = t15 * pi
    t311 = -psil + psig
    t312 = sin(t311)
    t315 = q + t291
    t318 = 1 / (-npsil + npsig)
    contr[20] = t318 / t315 * t29 * t312 * t14 * t310 * t23 * (cpa3EQ * t4 + cpa3EQ * t5 - cpa3EQ - t8 + t9) * t303 * t2 * t193
    t322 = t15 * t278
    t324 = psil + psig
    t325 = sin(t324)
    t328 = q * t291
    t329 = 1 + t328
    t332 = 1 / (npsil + npsig)
    contr[21] = t332 / t329 * t29 * t288 * t286 * t325 * t282 * t322
    t337 = sin(t42 + psig)
    t346 = 1 / (t294 + npsig) / (t47 * t291 + 1) * t29
    contr[22] = 3 * t346 * t288 * t286 * t337 * t283
    t349 = t46 * sdelta
    t350 = muM * t349
    t351 = IMz * t286
    t352 = t59 * t351
    t353 = t352 * t350
    t354 = t64 * t55
    t355 = t66 - t67 - psig
    t356 = sin(t355)
    t362 = 4 * npsil
    t366 = 1 / (t362 + npsig) / (t71 * t291 - 1) * t29
    contr[23] = 6 * t366 * t356 * t23 * t354 * t353
    t369 = muM * IMy
    t371 = t286 * pi
    t374 = t38 * t2 * t371 * sdelta * t369
    t375 = t23 * t84
    t376 = t66 - t42 - psig
    t377 = sin(t376)
    contr[24] = -9/2 * t346 * t377 * t14 * t375 * t374
    t384 = t286 * t2
    t385 = pi * sdelta
    t387 = t385 * t384 * t38 * t375
    t388 = t66 - t42 + psig
    t389 = sin(t388)
    contr[25] = -9/2 * t298 * t389 * t14 * t369 * t387
    t395 = t66 - psil - psig
    t396 = sin(t395)
    t399 = t328 - 1
    t400 = t399 * IMy
    t401 = t122 * t400
    t402 = t329 * IMx
    t403 = t90 * t402
    t409 = t23 * t14 * sdelta
    t411 = exp(4 * sigma)
    t416 = 0.1e1 / (t46 * t411 - 1) * t332 * t29
    t417 = t416 * t409
    contr[26] = -3/2 * t417 * t286 * pi * (t401 + t403) * t15 * t396 * muM
    t420 = t66 - psil + psig
    t421 = sin(t420)
    t424 = q - t291
    t425 = t424 * IMy
    t426 = t122 * t425
    t427 = t315 * IMx
    t428 = t90 * t427
    t435 = 0.1e1 / (t46 - t411) * t318 * t29
    t436 = t435 * t409
    contr[27] = -3/2 * t436 * (t426 + t428) * t371 * t15 * t421 * muM
    t441 = t66 + psil - psig
    t442 = sin(t441)
    t444 = t286 * t310
    contr[28] = 3/2 * t436 * t444 * t442 * (t426 - t428) * muM
    t447 = t66 + psil + psig
    t448 = sin(t447)
    t451 = sdelta * t371
    contr[29] = 3/2 * t416 * t23 * (t401 - t403) * t14 * t451 * t15 * t448 * muM
    t458 = t66 + t42 - psig
    t459 = sin(t458)
    contr[30] = 9/2 * t298 * t459 * t14 * t369 * t387
    t464 = t66 + t42 + psig
    t465 = sin(t464)
    contr[31] = 9/2 * t346 * t465 * t14 * t375 * t374
    t470 = t66 + t67 + psig
    t471 = sin(t470)
    contr[32] = 6 * t366 * t471 * t23 * t354 * t353
    t477 = sdelta * q * muM
    t478 = t352 * t477
    t479 = -psig - t226 + t66
    t480 = sin(t479)
    t486 = 2 * npsil
    t490 = 1 / (t486 + npsig) / (t46 * t291 - 1) * t29
    contr[33] = 3 * t490 * t480 * t23 * t354 * t478
    t493 = t55 * pi
    t494 = t493 * t351
    t495 = t494 * t477
    t496 = -psig + t226 + t66
    t497 = sin(t496)
    t500 = t291 - t46
    t503 = 1 / (-t486 + npsig)
    t505 = t503 / t500 * t29
    contr[34] = -3 * t505 * t14 * t497 * t65 * t495
    t509 = psig - t226 + t66
    t510 = sin(t509)
    contr[35] = -3 * t505 * t14 * t510 * t65 * t495
    t516 = muM * q
    t517 = t286 * t516
    t518 = cdelta - 1
    t519 = IMz * t518
    t522 = psig - t226 - psih
    t523 = sin(t522)
    t525 = t14 * t23
    contr[36] = -t505 * t525 * t523 * t182 * t493 * t519 * t517 / 2
    t530 = cdelta + 1
    t531 = IMz * t530
    t534 = psig - t226 + psih
    t535 = sin(t534)
    contr[37] = t505 * t525 * t535 * t182 * t493 * t531 * t517 / 2
    t540 = psig + t226 + t66
    t541 = sin(t540)
    contr[38] = 3 * t490 * t541 * t23 * t354 * t478
    t546 = t2 * t424
    t547 = t546 * t233
    t549 = t211 * t427 / 2
    t553 = t518 * t14
    t554 = pi * t553
    t556 = -psih + psig - psil
    t557 = sin(t556)
    contr[39] = t435 * t23 * t557 * t15 * t554 * t286 * muM * (t547 + t549) / 2
    t562 = t2 * t399
    t563 = t562 * t233
    t565 = t329 * t212 / 2
    t570 = -psih + psig + psil
    t571 = sin(t570)
    contr[40] = -t416 * t23 * t571 * t15 * t554 * t286 * (t563 - t565) * muM / 2
    t580 = -psih + psig + t226
    t581 = sin(t580)
    contr[41] = t490 * t581 * t23 * t182 * t55 * t59 * t519 * t517 / 2
    t586 = t46 * t518
    t588 = -psih - t67 + psig
    t589 = sin(t588)
    t602 = t71 - t291
    t605 = 1 / (-t362 + npsig)
    t607 = t605 / t602 * t29
    contr[42] = t607 * t525 * t371 * (cpa1EQ * (t4 - t5 - 1) - 2 * (t9 - 2 * cpa3EQ) * Q1) * muM * t55 * t589 * IMz * t586
    t610 = t286 * t2 * muM
    t611 = IMy * t518
    t612 = 2 * t194
    t614 = t195 + t612 - t197 + 4 * t199 + cpa2EQ
    t615 = t23 * t614
    t617 = t615 * t611 * t610
    t618 = t38 * pi
    t619 = -psih - t42 + psig
    t620 = sin(t619)
    contr[43] = 3/4 * t298 * t620 * t14 * t618 * t617
    t625 = -psih + t42 + psig
    t626 = sin(t625)
    contr[44] = -3/4 * t346 * t626 * t14 * t618 * t617
    t632 = muM * t46
    t633 = t182 * t632
    t634 = t286 * t23
    t635 = t519 * t634
    t637 = -psih + t67 + psig
    t638 = sin(t637)
    contr[45] = t366 * t638 * t55 * t59 * t635 * t633
    t646 = pi * t14 * t286
    t648 = psih + psig - psil
    t649 = sin(t648)
    contr[46] = t435 * t23 * t649 * t15 * t646 * muM * t530 * (t547 - t549) / 2
    t654 = muM * t530
    t655 = t286 * t654
    t660 = psih + psig + psil
    t661 = sin(t660)
    contr[47] = -t416 * t23 * t661 * t15 * pi * (t563 + t565) * t14 * t655 / 2
    t668 = t531 * t634
    t670 = psih + psig + t226
    t671 = sin(t670)
    contr[48] = -t490 * t671 * t55 * t59 * t668 * t182 * t516 / 2
    t678 = IMz * pi
    t679 = t678 * t530 * t286
    t681 = psih - t67 + psig
    t682 = sin(t681)
    t688 = -t605 / t602 * t29
    contr[49] = t688 * t525 * t682 * t55 * t679 * t633
    t691 = IMy * t530
    t693 = t691 * t384 * muM * t615
    t694 = psih - t42 + psig
    t695 = sin(t694)
    contr[50] = 3/4 * t298 * t695 * t14 * t618 * t693
    t700 = psih + t42 + psig
    t701 = sin(t700)
    contr[51] = -3/4 * t346 * t701 * t14 * t618 * t693
    t708 = psih + t67 + psig
    t709 = sin(t708)
    contr[52] = -t366 * t709 * t55 * t59 * t668 * t633
    t715 = t23 * cpa1EQ * sdelta
    t716 = t46 * t55
    t718 = t58 * t716 * t715
    t719 = -t67 + t66 - psih
    t720 = sin(t719)
    contr[53] = -3/2 * t75 * t720 * t59 * t718
    t725 = t175 + t178 - t179
    t727 = t184 * t725 * muM
    t728 = t727 * t174
    t729 = -t67 + t66 + psih
    t730 = sin(t729)
    contr[54] = -3/2 * t75 * t730 * t59 * t728
    t736 = t65 * t351 * t350
    t737 = -t67 + psig + t66
    t738 = sin(t737)
    contr[55] = -6 * t688 * t14 * t738 * t493 * t736
    t744 = IMy * cpa2EQ
    t745 = t47 + 1
    t746 = t2 * t745
    t747 = t746 * t744
    t748 = IMx * cpa1EQ
    t752 = -t42 + t66 - psih
    t753 = sin(t752)
    t755 = t14 * t385
    contr[56] = -3/2 * t223 * t755 * t753 * (t48 * t748 + t747) * muM
    t759 = t194 - t196 + t198
    t760 = t759 * IMy
    t763 = t2 * t81 * t83 * t760
    t764 = IMx * t89
    t767 = t30 * t725 * t764 / 2
    t770 = -t42 + t66 + psih
    t771 = sin(t770)
    contr[57] = 3 * t223 * t755 * t771 * (t763 - t767) * muM
    t777 = t58 * q * t55 * t715
    t778 = -t226 + t66 - psih
    t779 = sin(t778)
    contr[58] = -3/2 * t116 * t779 * t59 * t777
    t784 = t727 * t224
    t785 = -t226 + t66 + psih
    t786 = sin(t785)
    contr[59] = -3/2 * t116 * t786 * t59 * t784
    t791 = -psil + t66 - psih
    t792 = sin(t791)
    t795 = t234 * t744
    t796 = t30 * t748
    contr[60] = -3/2 * t247 * (t795 + t796) * t59 * sdelta * t792 * muM
    t802 = -psil + t66 + psih
    t803 = sin(t802)
    t806 = t15 * t59
    t808 = t234 * t760
    t811 = t30 * t725 * IMx / 2
    contr[61] = 3 * t135 * t27 * t23 * (t808 - t811) * t806 * sdelta * t803 * muM
    t817 = psil + t66 - psih
    t818 = sin(t817)
    contr[62] = 3/2 * t135 * t27 * t23 * (t795 - t796) * t806 * sdelta * t818 * muM
    t827 = psil + t66 + psih
    t828 = sin(t827)
    contr[63] = -3 * t247 * t14 * (t808 + t811) * pi * sdelta * t828 * muM
    t837 = t226 + t66 - psih
    t838 = sin(t837)
    contr[64] = -3/2 * t116 * t838 * t59 * t777
    t843 = t226 + t66 + psih
    t844 = sin(t843)
    contr[65] = -3/2 * t116 * t844 * t59 * t784
    t850 = -IMx * t48
    t854 = t42 + t66 - psih
    t855 = sin(t854)
    contr[66] = 3/2 * t223 * t755 * t855 * (cpa1EQ * t850 + t747) * muM
    t859 = t42 + t66 + psih
    t860 = sin(t859)
    t863 = t38 * t59
    contr[67] = -3 * t104 * t27 * t23 * (t763 + t767) * t863 * sdelta * t860 * muM
    t871 = t67 + t66 - psih
    t872 = sin(t871)
    contr[68] = -3/2 * t75 * t872 * t59 * t718
    t877 = t67 + t66 + psih
    t878 = sin(t877)
    contr[69] = -3/2 * t75 * t878 * t59 * t728
    t883 = t67 - psig + t66
    t884 = sin(t883)
    contr[70] = -6 * t688 * t14 * t884 * t493 * t736
    t891 = muM * t46 * cpa1EQ
    t893 = t678 * t518 * t286
    t895 = t66 - psih - t67 + psig
    t896 = sin(t895)
    contr[71] = 3 * t688 * t525 * t896 * t55 * t893 * t891
    t902 = t66 - psih + t67 - psig
    t903 = sin(t902)
    contr[72] = 3 * t688 * t525 * t903 * t55 * t679 * t891
    t908 = t725 * t632
    t910 = t66 + psih - t67 + psig
    t911 = sin(t910)
    contr[73] = 3 * t688 * t525 * t911 * t55 * t679 * t908
    t917 = t66 + psih + t67 - psig
    t918 = sin(t917)
    contr[74] = 3 * t688 * t525 * t918 * t55 * t893 * t908
    t924 = cpa1EQ * q * muM
    t926 = -psig + t226 + t66 - psih
    t927 = sin(t926)
    contr[75] = 3/2 * t505 * t525 * t927 * t55 * t679 * t924
    t932 = t725 * t516
    t934 = -psig + t226 + t66 + psih
    t935 = sin(t934)
    contr[76] = 3/2 * t505 * t525 * t935 * t55 * t893 * t932
    t941 = psig - t226 + t66 - psih
    t942 = sin(t941)
    contr[77] = 3/2 * t505 * t525 * t942 * t55 * t893 * t924
    t948 = psig - t226 + t66 + psih
    t949 = sin(t948)
    contr[78] = 3/2 * t505 * t525 * t949 * t55 * t679 * t932
    t954 = t23 * cpa1EQ
    t955 = q * t954
    t956 = t286 * muM
    t957 = t531 * t956
    t959 = -psih + t66 - psig - t226
    t960 = sin(t959)
    contr[79] = -3/2 * t490 * t960 * t55 * t59 * t957 * t955
    t966 = t519 * t956
    t968 = -psih + t66 + psig + t226
    t969 = sin(t968)
    contr[80] = -3/2 * t490 * t969 * t55 * t59 * t966 * t955
    t976 = psih + t66 - psig - t226
    t977 = sin(t976)
    contr[81] = -3/2 * t490 * t977 * t55 * t59 * t635 * t932
    t984 = psih + t66 + psig + t226
    t985 = sin(t984)
    contr[82] = -3/2 * t490 * t985 * t55 * t59 * t668 * t932
    t992 = psih + t66 - t67 - psig
    t993 = sin(t992)
    contr[83] = -3 * t366 * t993 * t55 * t59 * t635 * t908
    t1000 = psih + t66 + t67 + psig
    t1001 = sin(t1000)
    contr[84] = -3 * t366 * t1001 * t55 * t59 * t668 * t908
    t1007 = t46 * t954
    t1009 = -t67 - psig + t66 - psih
    t1010 = sin(t1009)
    contr[85] = -3 * t366 * t1010 * t55 * t59 * t957 * t1007
    t1016 = cpa2EQ * muM
    t1017 = t23 * t1016
    t1019 = t618 * t303 * t1017
    t1020 = -t42 - psig + t66 - psih
    t1021 = sin(t1020)
    t1023 = t14 * t2
    contr[86] = -9/4 * t346 * t1023 * t1021 * t530 * t1019
    t1029 = t618 * t611 * t610
    t1030 = t195 - t612 - t197
    t1031 = t23 * t1030
    t1032 = -t42 - psig + t66 + psih
    t1033 = sin(t1032)
    contr[87] = -9/4 * t346 * t1033 * t14 * t1031 * t1029
    t1039 = -t42 + psig + t66 - psih
    t1040 = sin(t1039)
    contr[88] = -9/4 * t298 * t1023 * t518 * t38 * IMy * pi * t1040 * t286 * t1017
    t1051 = t618 * t691 * t610
    t1052 = -t42 + psig + t66 + psih
    t1053 = sin(t1052)
    contr[89] = -9/4 * t298 * t1053 * t14 * t1031 * t1051
    t1059 = t14 * t956
    t1060 = t562 * t744
    t1061 = t329 * t748
    t1066 = -psil - psig + t66 - psih
    t1067 = sin(t1066)
    contr[90] = -3/4 * t416 * t23 * t1067 * t530 * t15 * pi * (t1060 + t1061) * t1059
    t1073 = t518 * muM
    t1074 = t562 * t760
    t1076 = t725 * t402 / 2
    t1080 = -psil - psig + t66 + psih
    t1081 = sin(t1080)
    contr[91] = 3/2 * t416 * t23 * t1081 * t15 * t646 * (t1074 - t1076) * t1073
    t1087 = t806 * t286 * t1073
    t1088 = -psil + psig + t66 - psih
    t1089 = sin(t1088)
    t1090 = t546 * t744
    t1091 = t315 * t748
    contr[92] = -3/4 * t435 * t23 * (t1090 + t1091) * t1089 * t1087
    t1098 = t546 * t760
    t1100 = t725 * t427 / 2
    t1105 = -psil + psig + t66 + psih
    t1106 = sin(t1105)
    contr[93] = 3/2 * t435 * t23 * t1106 * t530 * t806 * t286 * (t1098 - t1100) * muM
    t1115 = psil - psig + t66 - psih
    t1116 = sin(t1115)
    contr[94] = 3/4 * t435 * t23 * t1116 * t530 * t806 * t286 * (t1090 - t1091) * muM
    t1124 = psil - psig + t66 + psih
    t1125 = sin(t1124)
    contr[95] = -3/2 * t435 * t23 * t1125 * t15 * t646 * (t1098 + t1100) * t1073
    t1134 = psil + psig + t66 - psih
    t1135 = sin(t1134)
    contr[96] = 3/4 * t416 * t23 * t1135 * t15 * t646 * (t1060 - t1061) * t1073
    t1144 = psil + psig + t66 + psih
    t1145 = sin(t1144)
    contr[97] = -3/2 * t416 * t23 * t1145 * t530 * t806 * t286 * (t1074 + t1076) * muM
    t1151 = t42 - psig + t66 - psih
    t1152 = sin(t1151)
    contr[98] = 9/4 * t298 * t1023 * t530 * t38 * pi * t1152 * t303 * t1017
    t1160 = t42 - psig + t66 + psih
    t1161 = sin(t1160)
    contr[99] = 9/4 * t298 * t1161 * t14 * t1031 * t1029
    t1166 = t42 + psig + t66 - psih
    t1167 = sin(t1166)
    contr[100] = 9/4 * t346 * t1023 * t1167 * t518 * t1019
    t1172 = t42 + psig + t66 + psih
    t1173 = sin(t1172)
    contr[101] = 9/4 * t346 * t1173 * t14 * t1031 * t1051
    t1179 = t67 + psig + t66 - psih
    t1180 = sin(t1179)
    contr[102] = -3 * t366 * t1180 * t55 * t59 * t966 * t1007
    t1187 = t10 * IMx * t14
    t1189 = cos(psil)
    contr[103] = -2 * t32 / t81 * t29 * t23 * t1189 * pi * t121 * t1187
    t1201 = t17 * t55 * t10
    t1203 = cos(t226)
    contr[104] = -2 * t116 * t23 * t1203 * pi * t1201 * IMz * q * t14
    t1210 = cos(t42)
    contr[105] = -2 * t32 / t745 * t29 * t23 * t1210 * pi * t80 * t1187
    t1222 = cos(t67)
    contr[106] = -2 * t75 * t23 * t1222 * pi * t1201 * IMz * t46 * t14
    t1228 = cdelta * t58
    t1231 = t84 * t46 * t493 * t1228
    t1232 = cos(t68)
    contr[107] = -3 * t75 * t1232 * t525 * t1231
    t1239 = t2 * t90 * t83 * t82
    t1241 = t84 * t30 * t764
    t1246 = cos(t96)
    contr[108] = 3 * t104 * t27 * t23 * t1246 * pi * t14 * (t1239 - t1241) * t80
    t1253 = t84 * q * t493 * t1228
    t1254 = cos(t110)
    contr[109] = -3 * t116 * t1254 * t525 * t1253
    t1259 = t2 * t90
    t1260 = t1259 * t82
    t1261 = t84 * t88
    t1266 = cos(t129)
    contr[110] = 3 * t135 * t27 * t23 * t1266 * pi * t14 * (t1260 - t1261) * t121
    t1271 = cos(t142)
    contr[111] = -3 * t135 * t27 * t23 * (t1260 + t1261) * t1271 * t59 * t121
    t1280 = cos(t150)
    contr[112] = -3 * t116 * t1280 * t525 * t1253
    t1289 = cos(t160)
    contr[113] = -3 * t104 * t27 * t23 * t1289 * pi * (t1239 + t1241) * t14 * t80
    t1295 = cos(t167)
    contr[114] = -3 * t75 * t1295 * t525 * t1231
    t1300 = t55 * t278
    t1301 = q * IMz
    t1303 = cos(psig - t226)
    t1307 = t634 * t281
    contr[115] = -2 * t503 / t500 * t29 * t1307 * t14 * t1303 * t1301 * t1300
    t1315 = cos(psig + t226)
    contr[116] = 2 * t490 * t1307 * t14 * t1315 * t1301 * t1300
    t1321 = t614 * t173
    t1324 = t58 * t46 * t23 * t1321
    t1325 = cos(t187)
    contr[117] = -t75 * t1325 * t59 * t1324 / 2
    t1333 = t2 * t211 * t81 * IMy * t83
    t1336 = 2 * t88 * t202 * t89
    t1339 = cos(t217)
    contr[118] = -t223 * t1339 * t59 * (t1333 + t1336) * t193 / 2
    t1346 = t58 * q * t23 * t1321
    t1347 = cos(t227)
    contr[119] = -t116 * t1347 * t59 * t1346 / 2
    t1353 = t2 * t211 * t82
    t1356 = 2 * IMx * t30 * t202
    t1360 = cos(t241)
    contr[120] = -t247 * t1360 * t59 * sdelta * muM * (t1353 + t1356) / 2
    t1365 = cos(t249)
    contr[121] = t135 * t27 * t23 * (t1353 - t1356) * t15 * t1365 * t14 * t248 / 2
    t1374 = cos(t258)
    contr[122] = -t116 * t1374 * t59 * t1346 / 2
    t1382 = cos(t266)
    contr[123] = t223 * t1382 * t59 * sdelta * (t1333 - t1336) * muM / 2
    t1386 = cos(t272)
    contr[124] = -t75 * t1386 * t59 * t1324 / 2
    t1391 = IMz * t46
    t1393 = cos(-t67 + psig)
    contr[125] = 4 * t607 * t1307 * t14 * t1393 * t1391 * t1300
    t1399 = cos(t311)
    t1401 = muM * t14
    t1404 = t23 * t371
    contr[126] = t318 / t424 * t29 * t1404 * t1401 * t1399 * IMx * t322
    t1409 = cos(t324)
    contr[127] = t332 / t399 * t29 * t1404 * t1401 * t1409 * IMx * t322
    t1418 = cos(t67 + psig)
    contr[128] = 4 * t366 * t1307 * t14 * t1418 * t1391 * t1300
    t1426 = t716 * t371 * sdelta * t58
    t1427 = cos(t355)
    contr[129] = 6 * t366 * t1427 * t14 * t375 * t1426
    t1433 = t303 * t288
    t1434 = t1433 * t64 * t193
    t1435 = cos(t376)
    contr[130] = 9/2 * t346 * t1435 * t14 * t618 * t1434
    t1440 = cos(t388)
    contr[131] = 9/2 * t298 * t1440 * t14 * t618 * t1434
    t1445 = cos(t395)
    t1448 = t1259 * t400
    t1449 = t84 * t402
    contr[132] = -3/2 * t417 * t286 * pi * (t1448 - t1449) * t15 * t1445 * muM
    t1456 = cos(t420)
    t1460 = t1259 * t425
    t1461 = t84 * t427
    contr[133] = -3/2 * t435 * t23 * t14 * (t1460 - t1461) * t451 * t15 * t1456 * muM
    t1468 = cos(t441)
    contr[134] = 3/2 * t435 * t23 * t14 * (t1460 + t1461) * t451 * t15 * t1468 * muM
    t1479 = cos(t447)
    contr[135] = 3/2 * t417 * t444 * t1479 * (t1448 + t1449) * muM
    t1483 = cos(t458)
    contr[136] = -9/2 * t298 * t1483 * t14 * t618 * t1434
    t1489 = cos(t464)
    contr[137] = -9/2 * t346 * t1489 * t14 * t618 * t1434
    t1495 = cos(t470)
    contr[138] = 6 * t366 * t1495 * t14 * t375 * t1426
    t1500 = cos(t479)
    contr[139] = 3 * t490 * t1500 * t14 * t375 * t495
    t1505 = cos(t496)
    contr[140] = -3 * t505 * t1505 * t14 * t375 * t495
    t1511 = cos(t509)
    contr[141] = -3 * t505 * t1511 * t14 * t375 * t495
    t1518 = muM * q * t518
    t1519 = t614 * t286
    t1520 = t678 * t1519
    t1522 = cos(t522)
    contr[142] = t505 * t525 * t1522 * t55 * t1520 * t1518 / 2
    t1530 = cos(t534)
    contr[143] = t505 * t525 * t1530 * t55 * t678 * t530 * t614 * t517 / 2
    t1535 = cos(t540)
    contr[144] = 3 * t490 * t1535 * t14 * t375 * t495
    t1540 = IMy * t211
    t1541 = t546 * t1540
    t1543 = 2 * t202 * t427
    t1548 = cos(t556)
    contr[145] = t435 * t23 * t1548 * t15 * t554 * t286 * muM * (t1541 - t1543) / 4
    t1553 = t562 * t1540
    t1556 = 2 * t329 * t202 * IMx
    t1561 = cos(t570)
    contr[146] = -t416 * t23 * t1561 * t15 * pi * (t1553 + t1556) * t518 * t1059 / 4
    t1567 = t184 * t1519
    t1569 = cos(t580)
    contr[147] = -t490 * t1569 * t55 * t59 * t1567 * t1518 / 2
    t1575 = muM * t586
    t1577 = cos(t588)
    contr[148] = t688 * t525 * t1577 * t55 * t1520 * t1575
    t1582 = t1433 * t182 * t1073
    t1583 = cos(t619)
    contr[149] = 3/4 * t298 * t1583 * t14 * t618 * t1582
    t1588 = cos(t625)
    contr[150] = -3/4 * t346 * t1588 * t14 * t618 * t1582
    t1595 = cos(t637)
    contr[151] = -t366 * t1595 * t55 * t59 * t1567 * t1575
    t1600 = t806 * t655
    t1602 = cos(t648)
    contr[152] = -t435 * t23 * t1602 * (t1541 + t1543) * t1600 / 4
    t1609 = cos(t660)
    contr[153] = t416 * t23 * t1609 * (t1553 - t1556) * t1600 / 4
    t1615 = muM * q * t530
    t1617 = cos(t670)
    contr[154] = -t490 * t1617 * t55 * t59 * t1567 * t1615 / 2
    t1624 = muM * t46 * t530
    t1626 = cos(t681)
    contr[155] = t688 * t525 * t1626 * t55 * t1520 * t1624
    t1630 = t2 * t654
    t1632 = t257 * t303 * t1630
    t1633 = cos(t694)
    contr[156] = -3/4 * t298 * t1633 * t14 * t618 * t1632
    t1639 = cos(t700)
    contr[157] = 3/4 * t346 * t1639 * t14 * t618 * t1632
    t1645 = cos(t708)
    contr[158] = -t366 * t1645 * t55 * t59 * t1567 * t1624
    t1652 = cos(t719)
    contr[159] = 3/2 * t75 * t14 * t1652 * t55 * t678 * t349 * t1017
    t1658 = t184 * t1030 * muM
    t1659 = t1658 * t174
    t1660 = cos(t729)
    contr[160] = 3/2 * t75 * t1660 * t59 * t1659
    t1664 = cos(t737)
    contr[161] = -6 * t688 * t1664 * t14 * t375 * t1426
    t1670 = IMy * cpa1EQ
    t1671 = t746 * t1670
    t1675 = cos(t752)
    contr[162] = -3/2 * t223 * t755 * t1675 * (cpa2EQ * t850 + t1671) * muM
    t1680 = cos(t770)
    t1685 = t2 * t725 * t83 * t82
    t1686 = t759 * IMx
    t1688 = 2 * t1686 * t206
    contr[163] = -3/2 * t223 * (t1685 + t1688) * t59 * sdelta * t1680 * muM
    t1694 = cos(t778)
    t1696 = sdelta * IMz
    t1699 = t14 * t493
    t1700 = t116 * t1699
    contr[164] = 3/2 * t1700 * t1696 * t1694 * q * t1017
    t1702 = t1658 * t224
    t1703 = cos(t785)
    contr[165] = 3/2 * t116 * t1703 * t59 * t1702
    t1707 = cos(t791)
    t1709 = t234 * t1670
    t1711 = IMx * t30 * cpa2EQ
    contr[166] = -3/2 * t247 * t755 * (t1709 - t1711) * t1707 * muM
    t1717 = cos(t802)
    t1720 = t2 * t725
    t1721 = t1720 * t82
    t1723 = 2 * t759 * t88
    contr[167] = -3/2 * t247 * t14 * pi * (t1721 + t1723) * sdelta * t1717 * muM
    t1730 = cos(t817)
    contr[168] = 3/2 * t247 * (t1709 + t1711) * t59 * sdelta * t1730 * muM
    t1739 = cos(t827)
    contr[169] = 3/2 * t247 * t755 * t1739 * (t1721 - t1723) * muM
    t1743 = cos(t837)
    contr[170] = 3/2 * t1700 * t1696 * q * t1743 * t1017
    t1748 = cos(t843)
    contr[171] = 3/2 * t116 * t1748 * t59 * t1702
    t1752 = cos(t854)
    t1756 = IMx * cpa2EQ
    contr[172] = 3/2 * t104 * t27 * t23 * (t48 * t1756 + t1671) * t863 * sdelta * t1752 * muM
    t1763 = cos(t859)
    contr[173] = 3/2 * t223 * t14 * pi * (t1685 - t1688) * sdelta * t1763 * muM
    t1771 = cos(t871)
    contr[174] = 3/2 * t75 * t1699 * t1771 * IMz * t349 * t1017
    t1777 = cos(t877)
    contr[175] = 3/2 * t75 * t1777 * t59 * t1659
    t1781 = cos(t883)
    contr[176] = -6 * t688 * t1781 * t14 * t375 * t1426
    t1787 = t46 * t1016
    t1788 = cos(t895)
    t1792 = t518 * t55
    contr[177] = -3 * t688 * t525 * t1792 * t678 * t286 * t1788 * t1787
    t1797 = cos(t902)
    contr[178] = -3 * t688 * t525 * t530 * t55 * pi * t1797 * t351 * t1787
    t1807 = t678 * t286 * t1030
    t1809 = cos(t910)
    contr[179] = -3 * t688 * t525 * t1809 * t55 * t1807 * t1624
    t1816 = cos(t917)
    contr[180] = -3 * t688 * t525 * t1816 * t55 * t1807 * t1575
    t1823 = t494 * q * t1016
    t1824 = cos(t926)
    contr[181] = -3/2 * t505 * t525 * t530 * t1824 * t1823
    t1831 = cos(t934)
    contr[182] = -3/2 * t505 * t525 * t1831 * t55 * t1807 * t1518
    t1837 = cos(t941)
    contr[183] = -3/2 * t505 * t525 * t1837 * t518 * t1823
    t1844 = cos(t948)
    contr[184] = -3/2 * t505 * t525 * t1844 * t55 * t1807 * t1615
    t1850 = t286 * q
    t1853 = cos(t959)
    t1855 = t14 * t530
    contr[185] = 3/2 * t490 * t1855 * t1853 * t55 * t678 * t1850 * t1017
    t1859 = cos(t968)
    contr[186] = 3/2 * t490 * t553 * t493 * IMz * t1859 * t1850 * t1017
    t1866 = t351 * t1031
    t1868 = cos(t976)
    contr[187] = 3/2 * t490 * t1868 * t14 * t493 * t1866 * t1518
    t1874 = cos(t984)
    contr[188] = 3/2 * t490 * t1874 * t14 * t493 * t1866 * t1615
    t1880 = cos(t992)
    contr[189] = 3 * t366 * t1880 * t14 * t493 * t1866 * t1575
    t1886 = cos(t1000)
    contr[190] = 3 * t366 * t1886 * t14 * t493 * t1866 * t1624
    t1891 = t286 * t46
    t1892 = cos(t1009)
    contr[191] = 3 * t366 * t1855 * t493 * IMz * t1892 * t1891 * t1017
    t1899 = t954 * t303
    t1900 = t1899 * t1630
    t1901 = cos(t1020)
    contr[192] = -9/4 * t346 * t1901 * t14 * t618 * t1900
    t1907 = t23 * t725
    t1908 = cos(t1032)
    contr[193] = -9/4 * t346 * t1908 * t14 * t1907 * t1029
    t1915 = t1899 * t2 * t1073
    t1916 = cos(t1039)
    contr[194] = -9/4 * t298 * t1916 * t14 * t618 * t1915
    t1922 = cos(t1052)
    contr[195] = -9/4 * t298 * t1922 * t14 * t1907 * t1051
    t1928 = t562 * t1670
    t1929 = t329 * t1756
    t1934 = cos(t1066)
    contr[196] = -3/4 * t416 * t23 * t1934 * t15 * pi * (t1928 - t1929) * t530 * t1059
    t1940 = t1720 * t400
    t1942 = 2 * t329 * t1686
    t1944 = cos(t1080)
    contr[197] = -3/4 * t416 * t23 * t1944 * (t1940 + t1942) * t1087
    t1950 = t546 * t1670
    t1951 = t315 * t1756
    t1953 = cos(t1088)
    contr[198] = -3/4 * t435 * t23 * t1953 * (t1950 - t1951) * t1087
    t1959 = t1720 * t425
    t1961 = 2 * t759 * t427
    t1964 = pi * t1855
    t1966 = cos(t1105)
    contr[199] = -3/4 * t435 * t23 * t1966 * t15 * t1964 * (t1959 + t1961) * t956
    t1976 = cos(t1115)
    contr[200] = 3/4 * t435 * t23 * t1976 * t15 * (t1950 + t1951) * pi * t530 * t1059
    t1985 = cos(t1124)
    contr[201] = 3/4 * t435 * t23 * t1985 * t15 * (t1959 - t1961) * pi * t518 * t1059
    t1991 = cos(t1134)
    contr[202] = 3/4 * t416 * t23 * t1991 * (t1928 + t1929) * t1087
    t1999 = cos(t1144)
    contr[203] = 3/4 * t416 * t23 * t1999 * t15 * t1964 * (t1940 - t1942) * t956
    t2004 = cos(t1151)
    contr[204] = 9/4 * t298 * t2004 * t14 * t618 * t1900
    t2009 = cos(t1160)
    contr[205] = 9/4 * t298 * t2009 * t14 * t1907 * t1029
    t2014 = cos(t1166)
    contr[206] = 9/4 * t346 * t2014 * t14 * t618 * t1915
    t2019 = cos(t1172)
    contr[207] = 9/4 * t346 * t2019 * t14 * t1907 * t1051
    t2026 = cos(t1179)
    contr[208] = 3 * t366 * t14 * t2026 * t1792 * t678 * t1891 * t1017
       
   
    der_psil = sum(contr);
    return der_psil;
end

function derivativechiM2_psig(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)

    
    contr = zeros(155)
    t1 = sqrt(k)
    t5 = sqrt(k + m)
    t6 = 0.1e1 / t5
    t9 = Q1 * cpa2EQ - Q2 * cpa1EQ
    t11 = Q1 ^ 2
    t12 = Q2 ^ 2
    t14 = 1 / (t11 + t12 + 1)
    t15 = muM * t14
    t17 = t15 * t9 * t6 * pi * t1 * sdelta
    t18 = exp(sigma)
    t19 = t18 * IMz
    t20 = 2 * TL
    t21 = t20 - psig
    t22 = sin(t21)
    t24 = rc ^ 2
    t26 = 0.1e1 / t24 / rc
    t28 = exp(2 * sigma)
    t32 = 0.1e1 / KK
    t35 = 0.1e1 / npsig * t32 / (-1 + t28) * t26
    contr[1] = 3/2 * t35 * t22 * t19 * t17
    t38 = t20 + psig
    t39 = sin(t38)
    contr[2] = 3/2 * t35 * t39 * t19 * t17
    t43 = cpa1EQ * t11
    t44 = Q1 * Q2
    t46 = 2 * cpa2EQ * t44
    t47 = cpa1EQ * t12
    t50 = 4 * Q1 * cpa3EQ - cpa1EQ + t43 - t46 - t47
    t51 = t14 * t50
    t52 = t1 * t51
    t53 = t6 * pi
    t54 = muM * IMz
    t57 = cdelta - 1
    t58 = t57 * t18
    t59 = -psih + psig
    t60 = sin(t59)
    contr[3] = t35 * t60 * t58 * t54 * t53 * t52 / 4
    t64 = cdelta + 1
    t65 = muM * t64
    t68 = psih + psig
    t69 = sin(t68)
    contr[4] = -t35 * t69 * t19 * t65 * t53 * t52 / 4
    t76 = Q1 * cpa1EQ
    t77 = Q2 * cpa2EQ
    t79 = (cpa3EQ * (-t11 - t12 + 1) + t76 - t77) * sdelta
    t80 = sqrt(q)
    t81 = t80 * q
    t84 = muM * pi
    t85 = t84 * t6 * IMy
    t86 = t85 * t81 * t79
    t87 = 3 * psil
    t89 = sin(-t87 + psig)
    t92 = sqrt(1 + k)
    t93 = t14 * t92
    t95 = t32 * t26
    t96 = q ^ 2
    t97 = t96 * q
    t100 = 3 * npsil
    t104 = 0.1e1 / (-t100 + npsig) / (t97 + t28) * t95
    contr[5] = t104 * t93 * t18 * t89 * t86
    t106 = t80 * t79
    t107 = t85 * t106
    t108 = -psil + psig
    t109 = sin(t108)
    t112 = q + t28
    t115 = 0.1e1 / (-npsil + npsig)
    contr[6] = t115 / t112 * t95 * t93 * t18 * t109 * t107
    t119 = psil + psig
    t120 = sin(t119)
    t123 = q * t28
    t124 = 1 + t123
    t127 = 0.1e1 / (npsil + npsig)
    contr[7] = t127 / t124 * t95 * t93 * t18 * t120 * t107
    t132 = sin(t87 + psig)
    t141 = 0.1e1 / (t100 + npsig) / (t97 * t28 + 1) * t95
    contr[8] = t141 * t93 * t18 * t132 * t86
    t144 = muM * t96 * sdelta
    t145 = t53 * t19
    t146 = t145 * t144
    t147 = t9 * t1
    t148 = 4 * psil
    t149 = t20 - t148 - psig
    t150 = sin(t149)
    t153 = t96 ^ 2
    t157 = 4 * npsil
    t161 = 0.1e1 / (t157 + npsig) / (t153 * t28 - 1) * t95
    contr[9] = 3/2 * t161 * t150 * t14 * t147 * t146
    t164 = muM * IMy
    t166 = t18 * pi
    t169 = t81 * t92 * t166 * sdelta * t164
    t170 = t76 + t77
    t171 = t14 * t170
    t172 = t20 - t87 - psig
    t173 = sin(t172)
    contr[10] = -3/2 * t141 * t173 * t6 * t171 * t169
    t180 = t18 * t92
    t183 = pi * sdelta * t180 * t81 * t171
    t184 = t20 - t87 + psig
    t185 = sin(t184)
    contr[11] = 3/2 * t104 * t185 * t6 * t164 * t183
    t190 = t20 - psil - psig
    t191 = sin(t190)
    t194 = t123 - 1
    t195 = t194 * IMy
    t196 = t92 * t170
    t197 = t196 * t195
    t198 = t124 * IMx
    t199 = -t9
    t200 = t199 * t198
    t206 = t14 * t6 * sdelta
    t208 = exp(4 * sigma)
    t213 = 0.1e1 / (t96 * t208 - 1) * t127 * t95
    t214 = t213 * t206
    contr[12] = -3/2 * t214 * t18 * pi * (t197 + t200) * t80 * t191 * muM
    t217 = t20 - psil + psig
    t218 = sin(t217)
    t221 = q - t28
    t222 = t221 * IMy
    t223 = t196 * t222
    t224 = t112 * IMx
    t225 = t199 * t224
    t232 = 0.1e1 / (t96 - t208) * t115 * t95
    t233 = t232 * t206
    contr[13] = 3/2 * t233 * (t223 + t225) * t166 * t80 * t218 * muM
    t237 = t20 + psil - psig
    t238 = sin(t237)
    t241 = t18 * pi * t80
    contr[14] = -3/2 * t233 * t241 * t238 * (t223 - t225) * muM
    t245 = t20 + psil + psig
    t246 = sin(t245)
    t249 = sdelta * t166
    contr[15] = 3/2 * t213 * t14 * (t197 - t200) * t6 * t249 * t80 * t246 * muM
    t256 = t20 + t87 - psig
    t257 = sin(t256)
    contr[16] = -3/2 * t104 * t257 * t6 * t164 * t183
    t263 = t20 + t87 + psig
    t264 = sin(t263)
    contr[17] = 3/2 * t141 * t264 * t6 * t171 * t169
    t269 = t20 + t148 + psig
    t270 = sin(t269)
    contr[18] = 3/2 * t161 * t270 * t14 * t147 * t146
    t276 = sdelta * q * muM
    t277 = t145 * t276
    t278 = 2 * psil
    t279 = -psig - t278 + t20
    t280 = sin(t279)
    t286 = 2 * npsil
    t290 = 0.1e1 / (t286 + npsig) / (t96 * t28 - 1) * t95
    contr[19] = 3/2 * t290 * t280 * t14 * t147 * t277
    t293 = t1 * pi
    t294 = t293 * t19
    t295 = t294 * t276
    t296 = t14 * t9
    t297 = -psig + t278 + t20
    t298 = sin(t297)
    t301 = t28 - t96
    t304 = 0.1e1 / (-t286 + npsig)
    t306 = t304 / t301 * t95
    contr[20] = 3/2 * t306 * t6 * t298 * t296 * t295
    t309 = psig - t278 + t20
    t310 = sin(t309)
    contr[21] = 3/2 * t306 * t6 * t310 * t296 * t295
    t315 = muM * q
    t316 = t18 * t315
    t317 = IMz * t57
    t318 = t293 * t317
    t320 = psig - t278 - psih
    t321 = sin(t320)
    t323 = t6 * t14
    contr[22] = t306 * t323 * t321 * t50 * t318 * t316 / 4
    t327 = IMz * t64
    t330 = psig - t278 + psih
    t331 = sin(t330)
    contr[23] = -t306 * t323 * t331 * t50 * t293 * t327 * t316 / 4
    t337 = psig + t278 + t20
    t338 = sin(t337)
    contr[24] = 3/2 * t290 * t338 * t14 * t147 * t277
    t343 = cpa1EQ * t293
    t346 = -psih + t20 - psig
    t347 = sin(t346)
    contr[25] = -3/4 * t35 * t347 * t19 * t65 * t323 * t343
    t352 = t57 * muM
    t355 = -psih + t20 + psig
    t356 = sin(t355)
    contr[26] = -3/4 * t35 * t356 * t19 * t352 * t323 * t343
    t361 = cpa1EQ * t44
    t362 = cpa2EQ * t11
    t363 = t362 / 2
    t364 = cpa2EQ * t12
    t365 = t364 / 2
    t366 = Q2 * cpa3EQ
    t369 = t361 + t363 - t365 + 2 * t366 + cpa2EQ / 2
    t370 = IMy * t369
    t371 = t92 * t221
    t372 = t371 * t370
    t377 = t43 + Q1 * (-2 * t77 + 4 * cpa3EQ) - t47 - cpa1EQ
    t379 = t377 * t224 / 2
    t383 = t57 * t6
    t384 = pi * t383
    t386 = -psih + psig - psil
    t387 = sin(t386)
    contr[27] = -t232 * t14 * t387 * t80 * t384 * t18 * muM * (t372 + t379) / 2
    t393 = t92 * t194
    t394 = t393 * t370
    t397 = t124 * t377 * IMx / 2
    t402 = -psih + psig + psil
    t403 = sin(t402)
    contr[28] = -t213 * t14 * t403 * t80 * t384 * t18 * (t394 - t397) * muM / 2
    t412 = -psih + psig + t278
    t413 = sin(t412)
    contr[29] = t290 * t413 * t14 * t50 * t1 * t53 * t317 * t316 / 4
    t418 = muM * t96
    t421 = -psih - t148 + psig
    t422 = sin(t421)
    t425 = -t153 + t28
    t428 = 0.1e1 / (-t157 + npsig)
    t430 = t428 / t425 * t95
    contr[30] = t430 * t323 * t422 * t50 * t318 * t18 * t418 / 4
    t434 = t18 * t92 * muM
    t435 = IMy * t57
    t436 = 2 * t361
    t438 = t362 + t436 - t364 + 4 * t366 + cpa2EQ
    t439 = t14 * t438
    t441 = t439 * t435 * t434
    t442 = t81 * pi
    t443 = -psih - t87 + psig
    t444 = sin(t443)
    contr[31] = -t104 * t444 * t6 * t442 * t441 / 4
    t450 = -psih + t87 + psig
    t451 = sin(t450)
    contr[32] = -t141 * t451 * t6 * t442 * t441 / 4
    t457 = t50 * t418
    t458 = t18 * t14
    t459 = t317 * t458
    t461 = -psih + t148 + psig
    t462 = sin(t461)
    contr[33] = t161 * t462 * t1 * t53 * t459 * t457 / 4
    t467 = t6 * t293
    t468 = t43 + t46 - t47
    t473 = psih + t20 - psig
    t474 = sin(t473)
    contr[34] = -3/4 * t35 * t474 * t19 * t57 * t14 * t468 * muM * t467
    t479 = t14 * t468
    t482 = psih + t20 + psig
    t483 = sin(t482)
    contr[35] = -3/4 * t35 * t483 * t19 * t479 * t65 * t467
    t491 = t6 * t18
    t492 = pi * t491
    t494 = psih + psig - psil
    t495 = sin(t494)
    contr[36] = -t232 * t14 * t495 * t80 * t492 * muM * t64 * (t372 - t379) / 2
    t501 = t18 * t65
    t506 = psih + psig + psil
    t507 = sin(t506)
    contr[37] = -t213 * t14 * t507 * t80 * pi * (t394 + t397) * t6 * t501 / 2
    t514 = t327 * t458
    t516 = psih + psig + t278
    t517 = sin(t516)
    contr[38] = -t290 * t517 * t1 * t53 * t514 * t50 * t315 / 4
    t524 = IMz * pi
    t525 = t524 * t64 * t18
    t527 = psih - t148 + psig
    t528 = sin(t527)
    contr[39] = -t430 * t323 * t528 * t1 * t525 * t457 / 4
    t535 = IMy * t64
    t537 = t535 * t180 * muM * t439
    t538 = psih - t87 + psig
    t539 = sin(t538)
    contr[40] = -t104 * t539 * t6 * t442 * t537 / 4
    t545 = psih + t87 + psig
    t546 = sin(t545)
    contr[41] = -t141 * t546 * t6 * t442 * t537 / 4
    t553 = psih + t148 + psig
    t554 = sin(t553)
    contr[42] = -t161 * t554 * t1 * t53 * t514 * t457 / 4
    t561 = t296 * t19 * t144
    t562 = -t148 + psig + t20
    t563 = sin(t562)
    contr[43] = 3/2 * t430 * t6 * t563 * t293 * t561
    t568 = t148 - psig + t20
    t569 = sin(t568)
    contr[44] = 3/2 * t430 * t6 * t569 * t293 * t561
    t575 = muM * t96 * cpa1EQ
    t576 = t524 * t58
    t578 = t20 - psih - t148 + psig
    t579 = sin(t578)
    contr[45] = -3/4 * t430 * t323 * t579 * t1 * t576 * t575
    t586 = t20 - psih + t148 - psig
    t587 = sin(t586)
    contr[46] = -3/4 * t430 * t323 * t587 * t1 * t525 * t575
    t593 = t468 * t418
    t595 = t20 + psih - t148 + psig
    t596 = sin(t595)
    contr[47] = -3/4 * t430 * t323 * t596 * t1 * t525 * t593
    t603 = t20 + psih + t148 - psig
    t604 = sin(t603)
    contr[48] = -3/4 * t430 * t323 * t604 * t1 * t576 * t593
    t611 = cpa1EQ * q * muM
    t613 = -psig + t278 + t20 - psih
    t614 = sin(t613)
    contr[49] = -3/4 * t306 * t323 * t614 * t1 * t525 * t611
    t620 = t468 * t315
    t622 = -psig + t278 + t20 + psih
    t623 = sin(t622)
    contr[50] = -3/4 * t306 * t323 * t623 * t1 * t576 * t620
    t630 = psig - t278 + t20 - psih
    t631 = sin(t630)
    contr[51] = -3/4 * t306 * t323 * t631 * t1 * t576 * t611
    t638 = psig - t278 + t20 + psih
    t639 = sin(t638)
    contr[52] = -3/4 * t306 * t323 * t639 * t1 * t525 * t620
    t645 = t14 * cpa1EQ
    t646 = q * t645
    t647 = t18 * muM
    t648 = t327 * t647
    t650 = -psih + t20 - psig - t278
    t651 = sin(t650)
    contr[53] = -3/4 * t290 * t651 * t1 * t53 * t648 * t646
    t657 = t317 * t647
    t659 = -psih + t20 + psig + t278
    t660 = sin(t659)
    contr[54] = -3/4 * t290 * t660 * t1 * t53 * t657 * t646
    t667 = psih + t20 - psig - t278
    t668 = sin(t667)
    contr[55] = -3/4 * t290 * t668 * t1 * t53 * t459 * t620
    t675 = psih + t20 + psig + t278
    t676 = sin(t675)
    contr[56] = -3/4 * t290 * t676 * t1 * t53 * t514 * t620
    t683 = psih + t20 - t148 - psig
    t684 = sin(t683)
    contr[57] = -3/4 * t161 * t684 * t1 * t53 * t459 * t593
    t691 = psih + t20 + t148 + psig
    t692 = sin(t691)
    contr[58] = -3/4 * t161 * t692 * t1 * t53 * t514 * t593
    t698 = t96 * t645
    t700 = -t148 - psig + t20 - psih
    t701 = sin(t700)
    contr[59] = -3/4 * t161 * t701 * t1 * t53 * t648 * t698
    t707 = cpa2EQ * muM
    t708 = t14 * t707
    t709 = IMy * t18
    t711 = t442 * t709 * t708
    t712 = -t87 - psig + t20 - psih
    t713 = sin(t712)
    t715 = t6 * t92
    contr[60] = -3/4 * t141 * t715 * t713 * t64 * t711
    t721 = t442 * t435 * t434
    t722 = t362 - t436 - t364
    t723 = t14 * t722
    t724 = -t87 - psig + t20 + psih
    t725 = sin(t724)
    contr[61] = -3/4 * t141 * t725 * t6 * t723 * t721
    t731 = -t87 + psig + t20 - psih
    t732 = sin(t731)
    contr[62] = 3/4 * t104 * t715 * t57 * t81 * IMy * pi * t732 * t18 * t708
    t742 = t442 * t535 * t434
    t743 = -t87 + psig + t20 + psih
    t744 = sin(t743)
    contr[63] = 3/4 * t104 * t744 * t6 * t723 * t742
    t749 = t6 * t647
    t750 = IMy * cpa2EQ
    t751 = t393 * t750
    t752 = IMx * cpa1EQ
    t753 = t124 * t752
    t758 = -psil - psig + t20 - psih
    t759 = sin(t758)
    contr[64] = -3/4 * t213 * t14 * t759 * t64 * t80 * pi * (t751 + t753) * t749
    t765 = t361 - t363 + t365
    t766 = IMy * t765
    t767 = t393 * t766
    t769 = t468 * t198 / 2
    t773 = -psil - psig + t20 + psih
    t774 = sin(t773)
    contr[65] = 3/2 * t213 * t14 * t774 * t80 * t492 * (t767 - t769) * t352
    t780 = t80 * t53
    t781 = t780 * t18 * t352
    t782 = -psil + psig + t20 - psih
    t783 = sin(t782)
    t784 = t371 * t750
    t785 = t112 * t752
    contr[66] = 3/4 * t232 * t14 * (t784 + t785) * t783 * t781
    t791 = t371 * t766
    t793 = t468 * t224 / 2
    t798 = -psil + psig + t20 + psih
    t799 = sin(t798)
    contr[67] = -3/2 * t232 * t14 * t799 * t64 * t780 * t18 * (t791 - t793) * muM
    t809 = psil - psig + t20 - psih
    t810 = sin(t809)
    contr[68] = -3/4 * t232 * t14 * t810 * t64 * t780 * t18 * (t784 - t785) * muM
    t819 = psil - psig + t20 + psih
    t820 = sin(t819)
    contr[69] = 3/2 * t232 * t14 * t820 * t80 * t492 * (t791 + t793) * t352
    t828 = psil + psig + t20 - psih
    t829 = sin(t828)
    contr[70] = 3/4 * t213 * t14 * t829 * t80 * t492 * (t751 - t753) * t352
    t838 = psil + psig + t20 + psih
    t839 = sin(t838)
    contr[71] = -3/2 * t213 * t14 * t839 * t64 * t780 * t18 * (t767 + t769) * muM
    t845 = t87 - psig + t20 - psih
    t846 = sin(t845)
    contr[72] = -3/4 * t104 * t715 * t64 * t81 * pi * t846 * t709 * t708
    t855 = t87 - psig + t20 + psih
    t856 = sin(t855)
    contr[73] = -3/4 * t104 * t856 * t6 * t723 * t721
    t862 = t87 + psig + t20 - psih
    t863 = sin(t862)
    contr[74] = 3/4 * t141 * t715 * t863 * t57 * t711
    t868 = t87 + psig + t20 + psih
    t869 = sin(t868)
    contr[75] = 3/4 * t141 * t869 * t6 * t723 * t742
    t875 = t148 + psig + t20 - psih
    t876 = sin(t875)
    contr[76] = -3/4 * t161 * t876 * t1 * t53 * t657 * t698
    t884 = t1 * IMz * t84
    t886 = cos(psig)
    contr[77] = t35 * t14 * t886 * t6 * t884 * t18 * t79
    t890 = sdelta * t54
    t893 = t170 * t1 * t166 * t890
    t894 = cos(t21)
    contr[78] = 3/2 * t35 * t894 * t323 * t893
    t898 = cos(t38)
    contr[79] = 3/2 * t35 * t898 * t323 * t893
    t902 = t1 * t79
    t903 = q * IMz
    t905 = cos(psig - t278)
    t909 = t458 * t84
    contr[80] = t304 / t301 * t95 * t909 * t6 * t905 * t903 * t902
    t917 = cos(psig + t278)
    contr[81] = t290 * t909 * t6 * t917 * t903 * t902
    t923 = muM * t6
    t924 = t923 * t293
    t926 = cos(t59)
    contr[82] = -t35 * t926 * t19 * t924 * t57 * t439 / 4
    t933 = cos(t68)
    contr[83] = -t35 * t933 * t19 * t924 * t64 * t439 / 4
    t938 = IMz * t96
    t940 = cos(-t148 + psig)
    contr[84] = t428 / t425 * t95 * t909 * t6 * t940 * t938 * t902
    t950 = cos(t108)
    t954 = t14 * t166
    contr[85] = -t115 / t221 * t95 * t954 * t923 * t950 * IMx * t106
    t960 = cos(t119)
    contr[86] = t127 / t194 * t95 * t954 * t923 * t960 * IMx * t106
    t969 = cos(t148 + psig)
    contr[87] = t161 * t909 * t6 * t969 * t938 * t902
    t976 = t96 * t1 * t166 * t890
    t977 = cos(t149)
    contr[88] = 3/2 * t161 * t977 * t6 * t171 * t976
    t984 = t709 * t93
    t985 = t984 * t9 * muM * sdelta
    t986 = cos(t172)
    contr[89] = 3/2 * t141 * t986 * t6 * t442 * t985
    t991 = cos(t184)
    contr[90] = -3/2 * t104 * t991 * t6 * t442 * t985
    t997 = cos(t190)
    t1000 = t92 * t199
    t1001 = t1000 * t195
    t1002 = t170 * t198
    contr[91] = -3/2 * t214 * t18 * pi * (t1001 - t1002) * t80 * t997 * muM
    t1009 = cos(t217)
    t1013 = t1000 * t222
    t1014 = t170 * t224
    contr[92] = 3/2 * t232 * t14 * t6 * (t1013 - t1014) * t249 * t80 * t1009 * muM
    t1020 = cos(t237)
    contr[93] = -3/2 * t232 * t14 * t6 * (t1013 + t1014) * t249 * t80 * t1020 * muM
    t1032 = cos(t245)
    contr[94] = 3/2 * t214 * t241 * t1032 * (t1001 + t1002) * muM
    t1036 = cos(t256)
    contr[95] = 3/2 * t104 * t1036 * t6 * t442 * t985
    t1041 = cos(t263)
    contr[96] = -3/2 * t141 * t1041 * t6 * t442 * t985
    t1047 = cos(t269)
    contr[97] = 3/2 * t161 * t1047 * t6 * t171 * t976
    t1052 = cos(t279)
    contr[98] = 3/2 * t290 * t1052 * t6 * t171 * t295
    t1057 = cos(t297)
    contr[99] = 3/2 * t306 * t1057 * t6 * t171 * t295
    t1062 = cos(t309)
    contr[100] = 3/2 * t306 * t1062 * t6 * t171 * t295
    t1068 = muM * q * t57
    t1069 = t438 * t18
    t1070 = t524 * t1069
    t1072 = cos(t320)
    contr[101] = -t306 * t323 * t1072 * t1 * t1070 * t1068 / 4
    t1081 = cos(t330)
    contr[102] = -t306 * t323 * t1081 * t1 * t524 * t64 * t438 * t316 / 4
    t1087 = cos(t337)
    contr[103] = 3/2 * t290 * t1087 * t6 * t171 * t295
    t1092 = t14 * cpa2EQ
    t1095 = cos(t346)
    contr[104] = 3/4 * t35 * t1095 * t491 * t884 * t64 * t1092
    t1102 = cos(t355)
    contr[105] = 3/4 * t35 * t1102 * t491 * t317 * t84 * t1 * t1092
    t1106 = IMy * t377
    t1107 = t371 * t1106
    t1109 = 2 * t369 * t224
    t1114 = cos(t386)
    contr[106] = -t232 * t14 * t1114 * t80 * t384 * t18 * muM * (t1107 - t1109) / 4
    t1120 = t393 * t1106
    t1123 = 2 * t124 * t369 * IMx
    t1128 = cos(t402)
    contr[107] = -t213 * t14 * t1128 * t80 * pi * (t1120 + t1123) * t57 * t749 / 4
    t1135 = IMz * t14 * t1069
    t1137 = cos(t412)
    contr[108] = -t290 * t1137 * t1 * t53 * t1135 * t1068 / 4
    t1144 = muM * t96 * t57
    t1146 = cos(t421)
    contr[109] = -t430 * t323 * t1146 * t1 * t1070 * t1144 / 4
    t1153 = t984 * t50 * t352
    t1154 = cos(t443)
    contr[110] = -t104 * t1154 * t6 * t442 * t1153 / 4
    t1160 = cos(t450)
    contr[111] = -t141 * t1160 * t6 * t442 * t1153 / 4
    t1167 = cos(t461)
    contr[112] = -t161 * t1167 * t1 * t53 * t1135 * t1144 / 4
    t1176 = cos(t473)
    contr[113] = 3/4 * t35 * t1176 * t491 * t317 * t15 * t722 * t293
    t1180 = t1 * t64
    t1184 = cos(t482)
    contr[114] = 3/4 * t35 * t1184 * t491 * t54 * t723 * pi * t1180
    t1188 = t780 * t501
    t1190 = cos(t494)
    contr[115] = t232 * t14 * t1190 * (t1107 + t1109) * t1188 / 4
    t1196 = cos(t506)
    contr[116] = t213 * t14 * t1196 * (t1120 - t1123) * t1188 / 4
    t1202 = muM * q * t64
    t1204 = cos(t516)
    contr[117] = -t290 * t1204 * t1 * t53 * t1135 * t1202 / 4
    t1211 = muM * t96 * t64
    t1213 = cos(t527)
    contr[118] = -t430 * t323 * t1213 * t1 * t1070 * t1211 / 4
    t1219 = t92 * t65
    t1221 = t51 * t709 * t1219
    t1222 = cos(t538)
    contr[119] = t104 * t1222 * t6 * t442 * t1221 / 4
    t1227 = cos(t545)
    contr[120] = t141 * t1227 * t6 * t442 * t1221 / 4
    t1233 = cos(t553)
    contr[121] = -t161 * t1233 * t1 * t53 * t1135 * t1211 / 4
    t1239 = cos(t562)
    contr[122] = 3/2 * t430 * t1239 * t6 * t171 * t976
    t1244 = cos(t568)
    contr[123] = 3/2 * t430 * t1244 * t6 * t171 * t976
    t1249 = t96 * t707
    t1250 = cos(t578)
    t1254 = t57 * t1
    contr[124] = 3/4 * t430 * t323 * t1254 * t524 * t18 * t1250 * t1249
    t1258 = cos(t586)
    contr[125] = 3/4 * t430 * t323 * t1180 * pi * t1258 * t19 * t1249
    t1266 = t524 * t18 * t722
    t1268 = cos(t595)
    contr[126] = 3/4 * t430 * t323 * t1268 * t1 * t1266 * t1211
    t1274 = cos(t603)
    contr[127] = 3/4 * t430 * t323 * t1274 * t1 * t1266 * t1144
    t1280 = t294 * q * t707
    t1281 = cos(t613)
    contr[128] = 3/4 * t306 * t323 * t64 * t1281 * t1280
    t1287 = cos(t622)
    contr[129] = 3/4 * t306 * t323 * t1287 * t1 * t1266 * t1068
    t1292 = cos(t630)
    contr[130] = 3/4 * t306 * t323 * t1292 * t57 * t1280
    t1298 = cos(t638)
    contr[131] = 3/4 * t306 * t323 * t1298 * t1 * t1266 * t1202
    t1303 = t18 * q
    t1306 = cos(t650)
    t1308 = t6 * t64
    contr[132] = 3/4 * t290 * t1308 * t1306 * t1 * t524 * t1303 * t708
    t1312 = cos(t659)
    contr[133] = 3/4 * t290 * t383 * t293 * IMz * t1312 * t1303 * t708
    t1319 = t19 * t723
    t1321 = cos(t667)
    contr[134] = 3/4 * t290 * t1321 * t6 * t293 * t1319 * t1068
    t1327 = cos(t675)
    contr[135] = 3/4 * t290 * t1327 * t6 * t293 * t1319 * t1202
    t1333 = cos(t683)
    contr[136] = 3/4 * t161 * t1333 * t6 * t293 * t1319 * t1144
    t1339 = cos(t691)
    contr[137] = 3/4 * t161 * t1339 * t6 * t293 * t1319 * t1211
    t1344 = t18 * t96
    t1345 = cos(t700)
    contr[138] = 3/4 * t161 * t1308 * t293 * IMz * t1345 * t1344 * t708
    t1352 = t645 * t709
    t1353 = t1352 * t1219
    t1354 = cos(t712)
    contr[139] = -3/4 * t141 * t1354 * t6 * t442 * t1353
    t1360 = cos(t724)
    contr[140] = -3/4 * t141 * t1360 * t6 * t479 * t721
    t1367 = t1352 * t92 * t352
    t1368 = cos(t731)
    contr[141] = 3/4 * t104 * t1368 * t6 * t442 * t1367
    t1373 = cos(t743)
    contr[142] = 3/4 * t104 * t1373 * t6 * t479 * t742
    t1378 = IMy * cpa1EQ
    t1379 = t393 * t1378
    t1380 = IMx * cpa2EQ
    t1381 = t124 * t1380
    t1386 = cos(t758)
    contr[143] = -3/4 * t213 * t14 * t1386 * t80 * pi * (t1379 - t1381) * t64 * t749
    t1392 = t92 * t468
    t1393 = t1392 * t195
    t1396 = 2 * t124 * t765 * IMx
    t1398 = cos(t773)
    contr[144] = -3/4 * t213 * t14 * t1398 * (t1393 + t1396) * t781
    t1404 = t371 * t1378
    t1405 = t112 * t1380
    t1407 = cos(t782)
    contr[145] = 3/4 * t232 * t14 * t1407 * (t1404 - t1405) * t781
    t1412 = t1392 * t222
    t1414 = 2 * t765 * t224
    t1417 = pi * t1308
    t1419 = cos(t798)
    contr[146] = 3/4 * t232 * t14 * t1419 * t80 * t1417 * (t1412 + t1414) * t647
    t1428 = cos(t809)
    contr[147] = -3/4 * t232 * t14 * t1428 * t80 * (t1404 + t1405) * pi * t64 * t749
    t1438 = cos(t819)
    contr[148] = -3/4 * t232 * t14 * t1438 * t80 * (t1412 - t1414) * pi * t57 * t749
    t1445 = cos(t828)
    contr[149] = 3/4 * t213 * t14 * t1445 * (t1379 + t1381) * t781
    t1453 = cos(t838)
    contr[150] = 3/4 * t213 * t14 * t1453 * t80 * t1417 * (t1393 - t1396) * t647
    t1458 = cos(t845)
    contr[151] = -3/4 * t104 * t1458 * t6 * t442 * t1353
    t1464 = cos(t855)
    contr[152] = -3/4 * t104 * t1464 * t6 * t479 * t721
    t1470 = cos(t862)
    contr[153] = 3/4 * t141 * t1470 * t6 * t442 * t1367
    t1475 = cos(t868)
    contr[154] = 3/4 * t141 * t1475 * t6 * t479 * t742
    t1482 = cos(t875)
    contr[155] = 3/4 * t161 * t6 * t1482 * t1254 * t524 * t1344 * t708
      
   
    der_psig = sum(contr);
    return der_psig;

end

function derivativechiM2_psih(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)

    contr = zeros(156);
    t1 = Q1 ^ 2
    t2 = cpa1EQ * t1
    t3 = Q2 * Q1
    t5 = 2 * cpa2EQ * t3
    t6 = Q2 ^ 2
    t7 = cpa1EQ * t6
    t10 = 4 * Q1 * cpa3EQ - cpa1EQ + t2 - t5 - t7
    t12 = 1 / (t1 + t6 + 1)
    t13 = t12 * t10
    t14 = sqrt(k)
    t15 = t14 * t13
    t17 = sqrt(k + m)
    t18 = 0.1e1 / t17
    t19 = t18 * pi
    t20 = muM * IMz
    t21 = t20 * t19
    t23 = exp(sigma)
    t24 = cdelta - 1
    t25 = t24 * t23
    t26 = -psih + psig
    t27 = sin(t26)
    t29 = rc ^ 2
    t31 = 0.1e1 / t29 / rc
    t33 = exp(2 * sigma)
    t37 = 0.1e1 / KK
    t40 = 0.1e1 / npsig * t37 / (-1 + t33) * t31
    contr[1] = -t40 * t27 * t25 * t21 * t15 / 4
    t44 = cdelta + 1
    t45 = muM * t44
    t48 = t23 * IMz
    t49 = psih + psig
    t50 = sin(t49)
    contr[2] = -t40 * t50 * t48 * t45 * t19 * t15 / 4
    t55 = t14 * sdelta
    t56 = q ^ 2
    t57 = t56 * t55
    t59 = IMz * t12
    t60 = t59 * t10 * muM
    t62 = 4 * psil
    t63 = psih - t62
    t64 = sin(t63)
    t66 = t37 * t31
    t67 = t56 ^ 2
    t70 = 0.1e1 / npsil
    t72 = t70 / (t67 + 1) * t66
    contr[3] = t72 * t64 * t19 * t60 * t57 / 8
    t75 = sdelta * muM
    t76 = cpa1EQ * t3
    t77 = cpa2EQ * t1
    t78 = t77 / 2
    t79 = cpa2EQ * t6
    t80 = t79 / 2
    t81 = Q2 * cpa3EQ
    t84 = t76 + t78 - t80 + 2 * t81 + cpa2EQ / 2
    t85 = t56 - q + 1
    t87 = 1 + q
    t88 = t87 * IMy
    t90 = sqrt(1 + k)
    t92 = t90 * t88 * t85 * t84
    t93 = t56 + q + 1
    t94 = q - 1
    t95 = t94 * t93
    t101 = t2 + (-2 * Q2 * cpa2EQ + 4 * cpa3EQ) * Q1 - t7 - cpa1EQ
    t102 = t101 * IMx
    t104 = t102 * t95 / 2
    t107 = 3 * psil
    t108 = psih - t107
    t109 = sin(t108)
    t112 = sqrt(q)
    t113 = t112 * q
    t116 = t70 * t37
    t120 = 0.1e1 / (t67 * t56 - 1) * t116
    t121 = t120 * t31 * t12 * t113
    contr[4] = -t121 * t109 * t19 * (t92 - t104) * t75 / 3
    t124 = q * t55
    t126 = 2 * psil
    t127 = psih - t126
    t128 = sin(t127)
    t133 = t70 / (t56 + 1) * t66
    contr[5] = t133 * t128 * t19 * t60 * t124 / 4
    t136 = IMy * t84
    t137 = t90 * t87
    t138 = t137 * t136
    t139 = IMx * t94
    t141 = t101 * t139 / 2
    t145 = psih - psil
    t146 = sin(t145)
    t153 = 0.1e1 / (t56 - 1) * t116
    t154 = t153 * t31 * t12 * t112
    contr[6] = -t154 * t146 * t19 * sdelta * muM * (t138 - t141)
    t156 = pi * t75
    t157 = psih + psil
    t158 = sin(t157)
    contr[7] = -t154 * (t138 + t141) * t158 * t18 * t156
    t165 = psih + t126
    t166 = sin(t165)
    contr[8] = -t133 * t166 * t13 * t21 * t124 / 4
    t173 = psih + t107
    t174 = sin(t173)
    contr[9] = -t121 * t174 * t19 * (t92 + t104) * t75 / 3
    t180 = psih + t62
    t181 = sin(t180)
    contr[10] = -t72 * t181 * t13 * t21 * t57 / 8
    t186 = muM * q
    t187 = t23 * t186
    t188 = IMz * t24
    t189 = t14 * pi
    t190 = t189 * t188
    t192 = psig - t126 - psih
    t193 = sin(t192)
    t195 = t18 * t12
    t199 = 2 * npsil
    t203 = 0.1e1 / (-t199 + npsig) / (t33 - t56) * t66
    contr[11] = -t203 * t195 * t193 * t10 * t190 * t187 / 4
    t207 = IMz * t44
    t210 = psig - t126 + psih
    t211 = sin(t210)
    contr[12] = -t203 * t195 * t211 * t10 * t189 * t207 * t187 / 4
    t217 = cpa1EQ * t189
    t220 = 2 * TL
    t221 = -psih + t220 - psig
    t222 = sin(t221)
    contr[13] = -3/4 * t40 * t222 * t48 * t45 * t195 * t217
    t227 = t24 * muM
    t230 = -psih + t220 + psig
    t231 = sin(t230)
    contr[14] = 3/4 * t40 * t231 * t48 * t227 * t195 * t217
    t235 = q - t33
    t236 = t90 * t235
    t237 = t236 * t136
    t238 = q + t33
    t239 = IMx * t238
    t241 = t101 * t239 / 2
    t245 = t24 * t18
    t246 = pi * t245
    t248 = -psih + psig - psil
    t249 = sin(t248)
    t255 = exp(4 * sigma)
    t259 = 0.1e1 / (t56 - t255) / (-npsil + npsig) * t66
    contr[15] = t259 * t12 * t249 * t112 * t246 * t23 * muM * (t237 + t241) / 2
    t262 = q * t33
    t263 = t262 - 1
    t264 = t90 * t263
    t265 = t264 * t136
    t266 = 1 + t262
    t268 = t266 * t102 / 2
    t273 = -psih + psig + psil
    t274 = sin(t273)
    t283 = 0.1e1 / (t56 * t255 - 1) / (npsil + npsig) * t66
    contr[16] = t283 * t12 * t274 * t112 * t246 * t23 * (t265 - t268) * muM / 2
    t289 = -psih + psig + t126
    t290 = sin(t289)
    t299 = 0.1e1 / (t199 + npsig) / (t56 * t33 - 1) * t66
    contr[17] = -t299 * t290 * t12 * t10 * t14 * t19 * t188 * t187 / 4
    t303 = muM * t56
    t306 = -psih - t62 + psig
    t307 = sin(t306)
    t312 = 4 * npsil
    t316 = 0.1e1 / (-t312 + npsig) / (-t67 + t33) * t66
    contr[18] = -t316 * t195 * t307 * t10 * t190 * t23 * t303 / 4
    t321 = t23 * t90 * muM
    t322 = IMy * t24
    t323 = 2 * t76
    t325 = t77 + t323 - t79 + 4 * t81 + cpa2EQ
    t326 = t12 * t325
    t328 = t326 * t322 * t321
    t329 = t113 * pi
    t330 = -psih - t107 + psig
    t331 = sin(t330)
    t334 = t56 * q
    t337 = 3 * npsil
    t341 = 0.1e1 / (-t337 + npsig) / (t334 + t33) * t66
    contr[19] = t341 * t331 * t18 * t329 * t328 / 4
    t344 = -psih + t107 + psig
    t345 = sin(t344)
    t354 = 0.1e1 / (t337 + npsig) / (t334 * t33 + 1) * t66
    contr[20] = t354 * t345 * t18 * t329 * t328 / 4
    t357 = t10 * t303
    t358 = t23 * t12
    t359 = t188 * t358
    t361 = -psih + t62 + psig
    t362 = sin(t361)
    t371 = 0.1e1 / (t312 + npsig) / (t67 * t33 - 1) * t66
    contr[21] = -t371 * t362 * t14 * t19 * t359 * t357 / 4
    t375 = t18 * t189
    t376 = t2 + t5 - t7
    t377 = t376 * muM
    t381 = psih + t220 - psig
    t382 = sin(t381)
    contr[22] = 3/4 * t40 * t382 * t48 * t24 * t12 * t377 * t375
    t386 = t12 * t376
    t389 = psih + t220 + psig
    t390 = sin(t389)
    contr[23] = -3/4 * t40 * t390 * t48 * t386 * t45 * t375
    t398 = t18 * t23
    t399 = pi * t398
    t401 = psih + psig - psil
    t402 = sin(t401)
    contr[24] = -t259 * t12 * t402 * t112 * t399 * muM * t44 * (t237 - t241) / 2
    t408 = t23 * t45
    t413 = psih + psig + psil
    t414 = sin(t413)
    contr[25] = -t283 * t12 * t414 * t112 * pi * (t265 + t268) * t18 * t408 / 2
    t421 = t207 * t358
    t423 = psih + psig + t126
    t424 = sin(t423)
    contr[26] = -t299 * t424 * t14 * t19 * t421 * t10 * t186 / 4
    t431 = IMz * pi
    t432 = t431 * t44 * t23
    t434 = psih - t62 + psig
    t435 = sin(t434)
    contr[27] = -t316 * t195 * t435 * t14 * t432 * t357 / 4
    t443 = IMy * t44
    t445 = t443 * t23 * t90 * muM * t326
    t446 = psih - t107 + psig
    t447 = sin(t446)
    contr[28] = -t341 * t447 * t18 * t329 * t445 / 4
    t453 = psih + t107 + psig
    t454 = sin(t453)
    contr[29] = -t354 * t454 * t18 * t329 * t445 / 4
    t461 = psih + t62 + psig
    t462 = sin(t461)
    contr[30] = -t371 * t462 * t14 * t19 * t421 * t357 / 4
    t469 = t12 * cpa1EQ * sdelta
    t472 = t20 * t56 * t14 * t469
    t473 = -t62 + t220 - psih
    t474 = sin(t473)
    contr[31] = -3/8 * t72 * t474 * t19 * t472
    t479 = t59 * t377
    t480 = t479 * t57
    t481 = -t62 + t220 + psih
    t482 = sin(t481)
    contr[32] = 3/8 * t72 * t482 * t19 * t480
    t486 = IMy * cpa2EQ
    t488 = t90 * (t334 + 1)
    t489 = t488 * t486
    t490 = IMx * cpa1EQ
    t491 = t334 - 1
    t495 = -t107 + t220 - psih
    t496 = sin(t495)
    t499 = t18 * pi * sdelta
    contr[33] = -t121 * t499 * t496 * (t491 * t490 + t489) * muM / 2
    t503 = t76 - t78 + t80
    t504 = t503 * IMy
    t507 = t90 * t87 * t85 * t504
    t511 = t94 * t376 * IMx * t93 / 2
    t514 = -t107 + t220 + psih
    t515 = sin(t514)
    contr[34] = -t121 * t499 * t515 * (t507 - t511) * muM
    t521 = t20 * q * t14 * t469
    t522 = -t126 + t220 - psih
    t523 = sin(t522)
    contr[35] = -3/4 * t133 * t523 * t19 * t521
    t528 = t479 * t124
    t529 = -t126 + t220 + psih
    t530 = sin(t529)
    contr[36] = 3/4 * t133 * t530 * t19 * t528
    t534 = -psil + t220 - psih
    t535 = sin(t534)
    t538 = t137 * t486
    t539 = t94 * t490
    contr[37] = -3/2 * t154 * (t538 + t539) * t19 * sdelta * t535 * muM
    t545 = -psil + t220 + psih
    t546 = sin(t545)
    t549 = t112 * t19
    t551 = t137 * t504
    t554 = t94 * t376 * IMx / 2
    contr[38] = -3 * t153 * t31 * t12 * (t551 - t554) * t549 * sdelta * t546 * muM
    t561 = psil + t220 - psih
    t562 = sin(t561)
    contr[39] = -3/2 * t153 * t31 * t12 * (t538 - t539) * t549 * sdelta * t562 * muM
    t572 = psil + t220 + psih
    t573 = sin(t572)
    contr[40] = -3 * t154 * t18 * (t551 + t554) * pi * sdelta * t573 * muM
    t582 = t126 + t220 - psih
    t583 = sin(t582)
    contr[41] = 3/4 * t133 * t583 * t19 * t521
    t587 = t126 + t220 + psih
    t588 = sin(t587)
    contr[42] = -3/4 * t133 * t588 * t19 * t528
    t594 = -IMx * t491
    t598 = t107 + t220 - psih
    t599 = sin(t598)
    contr[43] = -t121 * t499 * t599 * (cpa1EQ * t594 + t489) * muM / 2
    t604 = t107 + t220 + psih
    t605 = sin(t604)
    t608 = t113 * t19
    contr[44] = -t120 * t31 * t12 * (t507 + t511) * t608 * sdelta * t605 * muM
    t615 = t62 + t220 - psih
    t616 = sin(t615)
    contr[45] = 3/8 * t72 * t616 * t19 * t472
    t620 = t62 + t220 + psih
    t621 = sin(t620)
    contr[46] = -3/8 * t72 * t621 * t19 * t480
    t627 = muM * t56 * cpa1EQ
    t628 = t431 * t25
    t630 = t220 - psih - t62 + psig
    t631 = sin(t630)
    contr[47] = 3/4 * t316 * t195 * t631 * t14 * t628 * t627
    t637 = t220 - psih + t62 - psig
    t638 = sin(t637)
    contr[48] = -3/4 * t316 * t195 * t638 * t14 * t432 * t627
    t644 = t376 * t303
    t646 = t220 + psih - t62 + psig
    t647 = sin(t646)
    contr[49] = -3/4 * t316 * t195 * t647 * t14 * t432 * t644
    t654 = t220 + psih + t62 - psig
    t655 = sin(t654)
    contr[50] = 3/4 * t316 * t195 * t655 * t14 * t628 * t644
    t661 = cpa1EQ * q * muM
    t663 = -psig + t126 + t220 - psih
    t664 = sin(t663)
    contr[51] = -3/4 * t203 * t195 * t664 * t14 * t432 * t661
    t670 = t376 * t186
    t672 = -psig + t126 + t220 + psih
    t673 = sin(t672)
    contr[52] = 3/4 * t203 * t195 * t673 * t14 * t628 * t670
    t679 = psig - t126 + t220 - psih
    t680 = sin(t679)
    contr[53] = 3/4 * t203 * t195 * t680 * t14 * t628 * t661
    t686 = psig - t126 + t220 + psih
    t687 = sin(t686)
    contr[54] = -3/4 * t203 * t195 * t687 * t14 * t432 * t670
    t693 = t12 * cpa1EQ
    t694 = q * t693
    t695 = t23 * muM
    t696 = t207 * t695
    t698 = -psih + t220 - psig - t126
    t699 = sin(t698)
    contr[55] = -3/4 * t299 * t699 * t14 * t19 * t696 * t694
    t705 = t188 * t695
    t707 = -psih + t220 + psig + t126
    t708 = sin(t707)
    contr[56] = 3/4 * t299 * t708 * t14 * t19 * t705 * t694
    t714 = psih + t220 - psig - t126
    t715 = sin(t714)
    contr[57] = 3/4 * t299 * t715 * t14 * t19 * t359 * t670
    t721 = psih + t220 + psig + t126
    t722 = sin(t721)
    contr[58] = -3/4 * t299 * t722 * t14 * t19 * t421 * t670
    t729 = psih + t220 - t62 - psig
    t730 = sin(t729)
    contr[59] = 3/4 * t371 * t730 * t14 * t19 * t359 * t644
    t736 = psih + t220 + t62 + psig
    t737 = sin(t736)
    contr[60] = -3/4 * t371 * t737 * t14 * t19 * t421 * t644
    t743 = t56 * t693
    t745 = -t62 - psig + t220 - psih
    t746 = sin(t745)
    contr[61] = -3/4 * t371 * t746 * t14 * t19 * t696 * t743
    t752 = cpa2EQ * muM
    t753 = t12 * t752
    t754 = IMy * t23
    t756 = t329 * t754 * t753
    t757 = -t107 - psig + t220 - psih
    t758 = sin(t757)
    t760 = t18 * t90
    contr[62] = -3/4 * t354 * t760 * t758 * t44 * t756
    t766 = t329 * t322 * t321
    t767 = t77 - t323 - t79
    t768 = t12 * t767
    t769 = -t107 - psig + t220 + psih
    t770 = sin(t769)
    contr[63] = 3/4 * t354 * t770 * t18 * t768 * t766
    t775 = -t107 + psig + t220 - psih
    t776 = sin(t775)
    contr[64] = -3/4 * t341 * t760 * t24 * t113 * IMy * pi * t776 * t23 * t753
    t787 = t329 * t443 * t321
    t788 = -t107 + psig + t220 + psih
    t789 = sin(t788)
    contr[65] = 3/4 * t341 * t789 * t18 * t768 * t787
    t794 = t18 * t695
    t795 = t264 * t486
    t796 = t266 * t490
    t801 = -psil - psig + t220 - psih
    t802 = sin(t801)
    contr[66] = -3/4 * t283 * t12 * t802 * t44 * t112 * pi * (t795 + t796) * t794
    t808 = t264 * t504
    t811 = t376 * t266 * IMx / 2
    t815 = -psil - psig + t220 + psih
    t816 = sin(t815)
    contr[67] = -3/2 * t283 * t12 * t816 * t112 * t399 * (t808 - t811) * t227
    t823 = t549 * t23 * t227
    t824 = -psil + psig + t220 - psih
    t825 = sin(t824)
    t826 = t236 * t486
    t827 = t238 * t490
    contr[68] = -3/4 * t259 * t12 * (t826 + t827) * t825 * t823
    t834 = t236 * t504
    t836 = t376 * t239 / 2
    t841 = -psil + psig + t220 + psih
    t842 = sin(t841)
    contr[69] = -3/2 * t259 * t12 * t842 * t44 * t549 * t23 * (t834 - t836) * muM
    t852 = psil - psig + t220 - psih
    t853 = sin(t852)
    contr[70] = -3/4 * t259 * t12 * t853 * t44 * t549 * t23 * (t826 - t827) * muM
    t862 = psil - psig + t220 + psih
    t863 = sin(t862)
    contr[71] = -3/2 * t259 * t12 * t863 * t112 * t399 * (t834 + t836) * t227
    t872 = psil + psig + t220 - psih
    t873 = sin(t872)
    contr[72] = -3/4 * t283 * t12 * t873 * t112 * t399 * (t795 - t796) * t227
    t883 = psil + psig + t220 + psih
    t884 = sin(t883)
    contr[73] = -3/2 * t283 * t12 * t884 * t44 * t549 * t23 * (t808 + t811) * muM
    t890 = t107 - psig + t220 - psih
    t891 = sin(t890)
    contr[74] = -3/4 * t341 * t760 * t44 * t113 * pi * t891 * t754 * t753
    t900 = t107 - psig + t220 + psih
    t901 = sin(t900)
    contr[75] = 3/4 * t341 * t901 * t18 * t768 * t766
    t906 = t107 + psig + t220 - psih
    t907 = sin(t906)
    contr[76] = -3/4 * t354 * t760 * t907 * t24 * t756
    t913 = t107 + psig + t220 + psih
    t914 = sin(t913)
    contr[77] = 3/4 * t354 * t914 * t18 * t768 * t787
    t920 = t62 + psig + t220 - psih
    t921 = sin(t920)
    contr[78] = 3/4 * t371 * t921 * t14 * t19 * t705 * t743
    t928 = muM * t18 * t189
    t930 = cos(t26)
    contr[79] = t40 * t930 * t48 * t928 * t24 * t326 / 4
    t936 = cos(t49)
    contr[80] = -t40 * t936 * t48 * t928 * t44 * t326 / 4
    t941 = t325 * t55
    t944 = t20 * t56 * t12 * t941
    t945 = cos(t63)
    contr[81] = t72 * t945 * t19 * t944 / 8
    t952 = t90 * t101 * t87 * IMy * t85
    t955 = 2 * t139 * t84 * t93
    t958 = cos(t108)
    contr[82] = t121 * t958 * t19 * (t952 + t955) * t75 / 6
    t964 = t20 * q * t12 * t941
    t965 = cos(t127)
    contr[83] = t133 * t965 * t19 * t964 / 4
    t970 = t90 * t101 * t88
    t973 = 2 * IMx * t94 * t84
    t977 = cos(t145)
    contr[84] = t154 * t977 * t19 * sdelta * muM * (t970 + t973) / 2
    t981 = cos(t157)
    contr[85] = t153 * t31 * t12 * (t970 - t973) * t112 * t981 * t18 * t156 / 2
    t990 = cos(t165)
    contr[86] = -t133 * t990 * t19 * t964 / 4
    t998 = cos(t173)
    contr[87] = t121 * t998 * t19 * sdelta * (t952 - t955) * muM / 6
    t1002 = cos(t180)
    contr[88] = -t72 * t1002 * t19 * t944 / 8
    t1008 = muM * q * t24
    t1009 = t325 * t23
    t1010 = t431 * t1009
    t1012 = cos(t192)
    contr[89] = t203 * t195 * t1012 * t14 * t1010 * t1008 / 4
    t1020 = cos(t210)
    contr[90] = -t203 * t195 * t1020 * t14 * t431 * t44 * t325 * t187 / 4
    t1026 = t12 * cpa2EQ
    t1030 = cos(t221)
    contr[91] = 3/4 * t40 * t1030 * t398 * t20 * t189 * t44 * t1026
    t1038 = cos(t230)
    contr[92] = -3/4 * t40 * t1038 * t398 * t188 * pi * muM * t14 * t1026
    t1043 = IMy * t101
    t1044 = t236 * t1043
    t1046 = 2 * t84 * t239
    t1051 = cos(t248)
    contr[93] = t259 * t12 * t1051 * t112 * t246 * t23 * muM * (t1044 - t1046) / 4
    t1056 = t264 * t1043
    t1059 = 2 * t266 * t84 * IMx
    t1064 = cos(t273)
    contr[94] = t283 * t12 * t1064 * t112 * pi * (t1056 + t1059) * t24 * t794 / 4
    t1069 = t59 * t1009
    t1071 = cos(t289)
    contr[95] = t299 * t1071 * t14 * t19 * t1069 * t1008 / 4
    t1077 = muM * t56 * t24
    t1079 = cos(t306)
    contr[96] = t316 * t195 * t1079 * t14 * t1010 * t1077 / 4
    t1087 = t754 * t90 * t12 * t10 * t227
    t1088 = cos(t330)
    contr[97] = t341 * t1088 * t18 * t329 * t1087 / 4
    t1093 = cos(t344)
    contr[98] = t354 * t1093 * t18 * t329 * t1087 / 4
    t1099 = cos(t361)
    contr[99] = t371 * t1099 * t14 * t19 * t1069 * t1077 / 4
    t1108 = cos(t381)
    contr[100] = -3/4 * t40 * t1108 * t398 * t188 * muM * t12 * t767 * t189
    t1113 = t14 * t44
    t1115 = t20 * t768
    t1117 = cos(t389)
    contr[101] = 3/4 * t40 * t1117 * t398 * t1115 * pi * t1113
    t1121 = t549 * t408
    t1123 = cos(t401)
    contr[102] = t259 * t12 * t1123 * (t1044 + t1046) * t1121 / 4
    t1129 = cos(t413)
    contr[103] = t283 * t12 * t1129 * (t1056 - t1059) * t1121 / 4
    t1135 = muM * q * t44
    t1137 = cos(t423)
    contr[104] = -t299 * t1137 * t14 * t19 * t1069 * t1135 / 4
    t1144 = muM * t56 * t44
    t1146 = cos(t434)
    contr[105] = -t316 * t195 * t1146 * t14 * t1010 * t1144 / 4
    t1152 = t90 * t45
    t1154 = t13 * t754 * t1152
    t1155 = cos(t446)
    contr[106] = t341 * t1155 * t18 * t329 * t1154 / 4
    t1160 = cos(t453)
    contr[107] = t354 * t1160 * t18 * t329 * t1154 / 4
    t1166 = cos(t461)
    contr[108] = -t371 * t1166 * t14 * t19 * t1069 * t1144 / 4
    t1172 = sdelta * t56
    t1175 = cos(t473)
    contr[109] = 3/8 * t72 * t18 * t1175 * t14 * t431 * t1172 * t753
    t1180 = t1115 * t57
    t1181 = cos(t481)
    contr[110] = -3/8 * t72 * t1181 * t19 * t1180
    t1186 = IMy * cpa1EQ
    t1187 = t488 * t1186
    t1191 = cos(t495)
    contr[111] = -t121 * t499 * t1191 * (cpa2EQ * t594 + t1187) * muM / 2
    t1196 = cos(t514)
    t1201 = t90 * t376 * t85 * t88
    t1202 = t503 * IMx
    t1204 = 2 * t1202 * t95
    contr[112] = t121 * (t1201 + t1204) * t19 * sdelta * t1196 * muM / 2
    t1209 = cos(t522)
    t1211 = sdelta * IMz
    t1214 = t133 * t375
    contr[113] = 3/4 * t1214 * t1211 * t1209 * q * t753
    t1216 = t1115 * t124
    t1217 = cos(t529)
    contr[114] = -3/4 * t133 * t1217 * t19 * t1216
    t1222 = cos(t534)
    t1224 = t137 * t1186
    t1226 = IMx * t94 * cpa2EQ
    contr[115] = -3/2 * t154 * t499 * (t1224 - t1226) * t1222 * muM
    t1232 = cos(t545)
    t1235 = t90 * t376
    t1236 = t1235 * t88
    t1238 = 2 * t503 * t139
    contr[116] = 3/2 * t154 * t18 * pi * (t1236 + t1238) * sdelta * t1232 * muM
    t1244 = cos(t561)
    contr[117] = -3/2 * t154 * (t1224 + t1226) * t19 * sdelta * t1244 * muM
    t1254 = cos(t572)
    contr[118] = 3/2 * t154 * t499 * t1254 * (t1236 - t1238) * muM
    t1258 = cos(t582)
    contr[119] = -3/4 * t1214 * t1211 * q * t1258 * t753
    t1264 = cos(t587)
    contr[120] = 3/4 * t133 * t1264 * t19 * t1216
    t1268 = cos(t598)
    t1272 = IMx * cpa2EQ
    contr[121] = -t120 * t31 * t12 * (t491 * t1272 + t1187) * t608 * sdelta * t1268 * muM / 2
    t1280 = cos(t604)
    contr[122] = t121 * t18 * pi * (t1201 - t1204) * sdelta * t1280 * muM / 2
    t1288 = cos(t615)
    contr[123] = -3/8 * t72 * t375 * t1288 * IMz * t1172 * t753
    t1295 = cos(t620)
    contr[124] = 3/8 * t72 * t1295 * t19 * t1180
    t1299 = t56 * t752
    t1300 = cos(t630)
    t1304 = t24 * t14
    contr[125] = -3/4 * t316 * t195 * t1304 * t431 * t23 * t1300 * t1299
    t1309 = cos(t637)
    contr[126] = 3/4 * t316 * t195 * t1113 * pi * t1309 * t48 * t1299
    t1317 = t431 * t23 * t767
    t1319 = cos(t646)
    contr[127] = 3/4 * t316 * t195 * t1319 * t14 * t1317 * t1144
    t1325 = cos(t654)
    contr[128] = -3/4 * t316 * t195 * t1325 * t14 * t1317 * t1077
    t1333 = t189 * t48 * q * t752
    t1334 = cos(t663)
    contr[129] = 3/4 * t203 * t195 * t44 * t1334 * t1333
    t1340 = cos(t672)
    contr[130] = -3/4 * t203 * t195 * t1340 * t14 * t1317 * t1008
    t1346 = cos(t679)
    contr[131] = -3/4 * t203 * t195 * t1346 * t24 * t1333
    t1353 = cos(t686)
    contr[132] = 3/4 * t203 * t195 * t1353 * t14 * t1317 * t1135
    t1358 = t23 * q
    t1361 = cos(t698)
    t1363 = t18 * t44
    contr[133] = 3/4 * t299 * t1363 * t1361 * t14 * t431 * t1358 * t753
    t1367 = cos(t707)
    contr[134] = -3/4 * t299 * t245 * t189 * IMz * t1367 * t1358 * t753
    t1375 = t48 * t768
    t1377 = cos(t714)
    contr[135] = -3/4 * t299 * t1377 * t18 * t189 * t1375 * t1008
    t1384 = cos(t721)
    contr[136] = 3/4 * t299 * t1384 * t18 * t189 * t1375 * t1135
    t1390 = cos(t729)
    contr[137] = -3/4 * t371 * t1390 * t18 * t189 * t1375 * t1077
    t1397 = cos(t736)
    contr[138] = 3/4 * t371 * t1397 * t18 * t189 * t1375 * t1144
    t1402 = t23 * t56
    t1403 = cos(t745)
    contr[139] = 3/4 * t371 * t1363 * t189 * IMz * t1403 * t1402 * t753
    t1410 = t693 * t754
    t1411 = t1410 * t1152
    t1412 = cos(t757)
    contr[140] = -3/4 * t354 * t1412 * t18 * t329 * t1411
    t1418 = cos(t769)
    contr[141] = 3/4 * t354 * t1418 * t18 * t386 * t766
    t1424 = t1410 * t90 * t227
    t1425 = cos(t775)
    contr[142] = -3/4 * t341 * t1425 * t18 * t329 * t1424
    t1431 = cos(t788)
    contr[143] = 3/4 * t341 * t1431 * t18 * t386 * t787
    t1436 = t264 * t1186
    t1437 = t266 * t1272
    t1442 = cos(t801)
    contr[144] = -3/4 * t283 * t12 * t1442 * t112 * pi * (t1436 - t1437) * t44 * t794
    t1449 = t1235 * t263 * IMy
    t1451 = 2 * t266 * t1202
    t1453 = cos(t815)
    contr[145] = 3/4 * t283 * t12 * t1453 * (t1449 + t1451) * t823
    t1458 = t236 * t1186
    t1459 = t238 * t1272
    t1461 = cos(t824)
    contr[146] = -3/4 * t259 * t12 * t1461 * (t1458 - t1459) * t823
    t1468 = t1235 * t235 * IMy
    t1470 = 2 * t503 * t239
    t1473 = pi * t1363
    t1475 = cos(t841)
    contr[147] = 3/4 * t259 * t12 * t1475 * t112 * t1473 * (t1468 + t1470) * t695
    t1484 = cos(t852)
    contr[148] = -3/4 * t259 * t12 * t1484 * t112 * (t1458 + t1459) * pi * t44 * t794
    t1494 = cos(t862)
    contr[149] = 3/4 * t259 * t12 * t1494 * t112 * (t1468 - t1470) * pi * t24 * t794
    t1500 = cos(t872)
    contr[150] = -3/4 * t283 * t12 * t1500 * (t1436 + t1437) * t823
    t1509 = cos(t883)
    contr[151] = 3/4 * t283 * t12 * t1509 * t112 * t1473 * (t1449 - t1451) * t695
    t1514 = cos(t890)
    contr[152] = -3/4 * t341 * t1514 * t18 * t329 * t1411
    t1520 = cos(t900)
    contr[153] = 3/4 * t341 * t1520 * t18 * t386 * t766
    t1525 = cos(t906)
    contr[154] = -3/4 * t354 * t1525 * t18 * t329 * t1424
    t1531 = cos(t913)
    contr[155] = 3/4 * t354 * t1531 * t18 * t386 * t787
    t1538 = cos(t920)
    contr[156] = -3/4 * t371 * t18 * t1538 * t1304 * t431 * t1402 * t753
       


    der_psih = sum(contr);
    return der_psih;
end

function derivativechiM2_cdeltapsigMpsihOsdelta(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)
    
    contr = zeros(203);
    t1 = sqrt(k)
    t5 = sqrt(k + m)
    t6 = 0.1e1 / t5
    t9 = Q1 * cpa2EQ - Q2 * cpa1EQ
    t11 = Q1 ^ 2
    t12 = Q2 ^ 2
    t14 = 1 / (t11 + t12 + 1)
    t17 = muM * t14 * t9 * t6 * pi * t1 * cdelta
    t18 = exp(sigma)
    t19 = t18 * IMz
    t20 = 2 * TL
    t21 = t20 - psig
    t22 = sin(t21)
    t24 = rc ^ 2
    t26 = 0.1e1 / t24 / rc
    t28 = exp(2 * sigma)
    t32 = 0.1e1 / KK
    t35 = 0.1e1 / npsig * t32 / (-1 + t28) * t26
    contr[1] = 3/2 * t35 * t22 * t19 * t17
    t38 = t20 + psig
    t39 = sin(t38)
    contr[2] = 3/2 * t35 * t39 * t19 * t17
    t43 = cpa1EQ * t11
    t44 = Q1 * Q2
    t46 = 2 * cpa2EQ * t44
    t47 = cpa1EQ * t12
    t50 = 4 * Q1 * cpa3EQ - cpa1EQ + t43 - t46 - t47
    t51 = t14 * t50
    t52 = pi * t51
    t53 = t18 * sdelta
    t54 = -psih + psig
    t55 = sin(t54)
    t59 = t1 * IMz
    t61 = t35 * t6 * t59
    contr[3] = -t61 * t55 * muM * t53 * t52 / 4
    t64 = psih + psig
    t65 = sin(t64)
    contr[4] = t61 * t65 * muM * t53 * t52 / 4
    t70 = q ^ 2
    t71 = t70 * t1
    t72 = muM * t71
    t73 = IMz * t51
    t75 = t6 * pi
    t76 = 4 * psil
    t77 = psih - t76
    t78 = sin(t77)
    t80 = t32 * t26
    t81 = t70 ^ 2
    t84 = 0.1e1 / npsil
    t86 = t84 / (t81 + 1) * t80
    contr[5] = -t86 * t78 * t75 * t73 * t72 / 8
    t90 = sqrt(q)
    t91 = t90 * q
    t92 = muM * t91
    t93 = cpa1EQ * t44
    t94 = cpa2EQ * t11
    t95 = t94 / 2
    t96 = cpa2EQ * t12
    t97 = t96 / 2
    t98 = Q2 * cpa3EQ
    t101 = t93 + t95 - t97 + 2 * t98 + cpa2EQ / 2
    t102 = t70 - q + 1
    t104 = 1 + q
    t105 = t104 * IMy
    t107 = sqrt(1 + k)
    t109 = t107 * t105 * t102 * t101
    t110 = t70 + q + 1
    t111 = q - 1
    t112 = t111 * t110
    t113 = Q2 * cpa2EQ
    t118 = t43 + Q1 * (-2 * t113 + 4 * cpa3EQ) - t47 - cpa1EQ
    t119 = t118 * IMx
    t121 = t119 * t112 / 2
    t126 = 3 * psil
    t127 = psih - t126
    t128 = sin(t127)
    t131 = t84 * t32
    t135 = 0.1e1 / (t81 * t70 - 1) * t131
    contr[6] = t135 * t26 * t14 * t128 * pi * (t109 - t121) * t6 * t92 / 3
    t139 = muM * q * t1
    t141 = 2 * psil
    t142 = psih - t141
    t143 = sin(t142)
    t148 = t84 / (t70 + 1) * t80
    contr[7] = -t148 * t143 * t75 * t73 * t139 / 4
    t152 = IMy * t101
    t153 = t107 * t104
    t154 = t153 * t152
    t155 = IMx * t111
    t157 = t118 * t155 / 2
    t160 = t6 * muM
    t161 = pi * t160
    t163 = psih - psil
    t164 = sin(t163)
    t169 = 0.1e1 / (t70 - 1) * t131
    contr[8] = t169 * t26 * t14 * t164 * t161 * (t154 - t157) * t90
    t171 = muM * t90
    t176 = psih + psil
    t177 = sin(t176)
    contr[9] = t169 * t26 * t14 * t177 * pi * (t154 + t157) * t6 * t171
    t181 = pi * IMz
    t182 = t6 * t181
    t184 = psih + t141
    t185 = sin(t184)
    contr[10] = t148 * t185 * t51 * t182 * t139 / 4
    t193 = psih + t126
    t194 = sin(t193)
    contr[11] = t135 * t26 * t14 * t194 * pi * (t109 + t121) * t6 * t92 / 3
    t200 = psih + t76
    t201 = sin(t200)
    contr[12] = t86 * t201 * t51 * t182 * t72 / 8
    t207 = Q1 * cpa1EQ
    t209 = cdelta * (cpa3EQ * (-t11 - t12 + 1) + t207 - t113)
    t212 = muM * pi
    t213 = t212 * t6 * IMy
    t214 = t213 * t91 * t209
    t216 = sin(-t126 + psig)
    t218 = t14 * t107
    t220 = t70 * q
    t223 = 3 * npsil
    t227 = 0.1e1 / (-t223 + npsig) / (t220 + t28) * t80
    contr[13] = t227 * t218 * t18 * t216 * t214
    t229 = t90 * t209
    t230 = t213 * t229
    t231 = -psil + psig
    t232 = sin(t231)
    t235 = q + t28
    t238 = 0.1e1 / (-npsil + npsig)
    contr[14] = t238 / t235 * t80 * t218 * t18 * t232 * t230
    t242 = psil + psig
    t243 = sin(t242)
    t246 = q * t28
    t247 = 1 + t246
    t250 = 0.1e1 / (npsil + npsig)
    contr[15] = t250 / t247 * t80 * t218 * t18 * t243 * t230
    t255 = sin(t126 + psig)
    t264 = 0.1e1 / (t223 + npsig) / (t220 * t28 + 1) * t80
    contr[16] = t264 * t218 * t18 * t255 * t214
    t267 = muM * t70 * cdelta
    t268 = t75 * t19
    t269 = t268 * t267
    t270 = t9 * t1
    t271 = t20 - t76 - psig
    t272 = sin(t271)
    t278 = 4 * npsil
    t282 = 0.1e1 / (t278 + npsig) / (t81 * t28 - 1) * t80
    contr[17] = 3/2 * t282 * t272 * t14 * t270 * t269
    t287 = t18 * pi
    t288 = t91 * t107
    t289 = t288 * t287
    t290 = t289 * cdelta * IMy * muM
    t291 = t207 + t113
    t292 = t14 * t291
    t293 = t20 - t126 - psig
    t294 = sin(t293)
    contr[18] = -3/2 * t264 * t294 * t6 * t292 * t290
    t302 = t289 * t14 * t291 * cdelta
    t303 = muM * IMy
    t304 = t20 - t126 + psig
    t305 = sin(t304)
    contr[19] = 3/2 * t227 * t305 * t6 * t303 * t302
    t310 = t246 - 1
    t311 = t310 * IMy
    t312 = t107 * t291
    t313 = t312 * t311
    t314 = t247 * IMx
    t315 = -t9
    t316 = t315 * t314
    t319 = t20 - psil - psig
    t320 = sin(t319)
    t323 = pi * cdelta * t90
    t325 = t6 * t18
    t326 = t14 * t325
    t328 = exp(4 * sigma)
    t333 = 0.1e1 / (t70 * t328 - 1) * t250 * t80
    t334 = t333 * t326
    contr[20] = -3/2 * t334 * t323 * t320 * (t313 + t316) * muM
    t337 = q - t28
    t338 = t337 * IMy
    t339 = t312 * t338
    t340 = t235 * IMx
    t341 = t315 * t340
    t344 = t20 - psil + psig
    t345 = sin(t344)
    t351 = 0.1e1 / (t70 - t328) * t238 * t80
    t352 = t351 * t326
    contr[21] = 3/2 * t352 * t323 * t345 * (t339 + t341) * muM
    t354 = t20 + psil - psig
    t355 = sin(t354)
    contr[22] = -3/2 * t352 * pi * (t339 - t341) * cdelta * t90 * t355 * muM
    t364 = t20 + psil + psig
    t365 = sin(t364)
    contr[23] = 3/2 * t334 * pi * cdelta * (t313 - t316) * t90 * t365 * muM
    t373 = t20 + t126 - psig
    t374 = sin(t373)
    contr[24] = -3/2 * t227 * t374 * t6 * t303 * t302
    t380 = t20 + t126 + psig
    t381 = sin(t380)
    contr[25] = 3/2 * t264 * t381 * t6 * t292 * t290
    t386 = t20 + t76 + psig
    t387 = sin(t386)
    contr[26] = 3/2 * t282 * t387 * t14 * t270 * t269
    t393 = cdelta * q * muM
    t394 = t268 * t393
    t395 = -psig - t141 + t20
    t396 = sin(t395)
    t402 = 2 * npsil
    t406 = 0.1e1 / (t402 + npsig) / (t70 * t28 - 1) * t80
    contr[27] = 3/2 * t406 * t396 * t14 * t270 * t394
    t409 = t1 * pi
    t411 = t409 * t19 * t393
    t412 = t14 * t9
    t413 = -psig + t141 + t20
    t414 = sin(t413)
    t417 = t28 - t70
    t420 = 0.1e1 / (-t402 + npsig)
    t422 = t420 / t417 * t80
    contr[28] = 3/2 * t422 * t6 * t414 * t412 * t411
    t425 = psig - t141 + t20
    t426 = sin(t425)
    contr[29] = 3/2 * t422 * t6 * t426 * t412 * t411
    t431 = muM * q
    t432 = psig - t141 - psih
    t433 = sin(t432)
    t435 = sdelta * t1
    t437 = t50 * IMz * t435
    t439 = t6 * t14
    t440 = t439 * t287
    t441 = t422 * t440
    contr[30] = -t441 * t437 * t433 * t431 / 4
    t444 = psig - t141 + psih
    t445 = sin(t444)
    contr[31] = t441 * t437 * t445 * t431 / 4
    t449 = psig + t141 + t20
    t450 = sin(t449)
    contr[32] = 3/2 * t406 * t450 * t14 * t270 * t394
    t455 = t14 * cpa1EQ
    t457 = t18 * muM
    t460 = IMz * t6 * t457 * pi * t455
    t461 = -psih + t20 - psig
    t462 = sin(t461)
    contr[33] = 3/4 * t35 * t462 * t435 * t460
    t466 = -psih + t20 + psig
    t467 = sin(t466)
    contr[34] = 3/4 * t35 * t467 * t435 * t460
    t471 = muM * sdelta
    t472 = t18 * t471
    t473 = t90 * t75
    t474 = t473 * t472
    t475 = t107 * t337
    t476 = t475 * t152
    t478 = t118 * t340 / 2
    t480 = -psih + psig - psil
    t481 = sin(t480)
    contr[35] = t351 * t14 * t481 * (t476 + t478) * t474 / 2
    t486 = t107 * t310
    t487 = t486 * t152
    t489 = t247 * t119 / 2
    t493 = pi * t325
    t495 = -psih + psig + psil
    t496 = sin(t495)
    contr[36] = t333 * t14 * t496 * t90 * t493 * muM * (t487 - t489) * sdelta / 2
    t501 = -psih + psig + t141
    t502 = sin(t501)
    t505 = t406 * t440
    contr[37] = -t505 * t437 * t502 * t431 / 4
    t508 = muM * t70
    t509 = -psih - t76 + psig
    t510 = sin(t509)
    t513 = -t81 + t28
    t516 = 0.1e1 / (-t278 + npsig)
    t518 = t516 / t513 * t80
    t519 = t518 * t440
    contr[38] = -t519 * t437 * t510 * t508 / 4
    t522 = -psih - t126 + psig
    t523 = sin(t522)
    t526 = sdelta * IMy
    t527 = t526 * t288
    t529 = 2 * t93
    t531 = t94 + t529 - t96 + 4 * t98 + cpa2EQ
    t533 = t18 * t14
    t534 = t533 * t531 * pi
    t535 = t227 * t534
    contr[39] = t535 * t527 * t6 * t523 * muM / 4
    t537 = -psih + t126 + psig
    t538 = sin(t537)
    t542 = t264 * t534
    contr[40] = t542 * t527 * t6 * t538 * muM / 4
    t544 = -psih + t76 + psig
    t545 = sin(t544)
    t548 = t282 * t440
    contr[41] = -t548 * t437 * t545 * t508 / 4
    t551 = t18 * t212
    t552 = t43 + t46 - t47
    t556 = IMz * t14 * t552 * t6 * t551
    t557 = psih + t20 - psig
    t558 = sin(t557)
    contr[42] = 3/4 * t35 * t558 * t435 * t556
    t562 = psih + t20 + psig
    t563 = sin(t562)
    contr[43] = 3/4 * t35 * t563 * t435 * t556
    t571 = psih + psig - psil
    t572 = sin(t571)
    contr[44] = t351 * t14 * t572 * t90 * t493 * muM * sdelta * (t476 - t478) / 2
    t581 = psih + psig + psil
    t582 = sin(t581)
    contr[45] = t333 * t14 * t582 * t90 * pi * (t487 + t489) * t6 * t472 / 2
    t587 = psih + psig + t141
    t588 = sin(t587)
    contr[46] = t505 * t437 * t588 * t431 / 4
    t592 = psih - t76 + psig
    t593 = sin(t592)
    contr[47] = t519 * t437 * t593 * t508 / 4
    t597 = psih - t126 + psig
    t598 = sin(t597)
    contr[48] = t535 * t527 * t6 * t598 * muM / 4
    t603 = psih + t126 + psig
    t604 = sin(t603)
    contr[49] = t542 * t527 * t6 * t604 * muM / 4
    t609 = psih + t76 + psig
    t610 = sin(t609)
    contr[50] = t548 * t437 * t610 * t508 / 4
    t614 = t1 * t455
    t615 = IMz * t508
    t616 = t615 * t614
    t617 = -t76 + t20 - psih
    t618 = sin(t617)
    contr[51] = 3/8 * t86 * t618 * t75 * t616
    t622 = t14 * t552
    t623 = IMz * t622
    t624 = t623 * t72
    t625 = -t76 + t20 + psih
    t626 = sin(t625)
    contr[52] = -3/8 * t86 * t626 * t75 * t624
    t632 = t412 * t19 * t267
    t633 = -t76 + psig + t20
    t634 = sin(t633)
    contr[53] = 3/2 * t518 * t6 * t634 * t409 * t632
    t639 = IMy * cpa2EQ
    t641 = t107 * (t220 + 1)
    t642 = t641 * t639
    t643 = IMx * cpa1EQ
    t644 = t220 - 1
    t650 = -t126 + t20 - psih
    t651 = sin(t650)
    contr[54] = t135 * t26 * t14 * t651 * pi * t6 * (t644 * t643 + t642) * t92 / 2
    t656 = t93 - t95 + t97
    t657 = t656 * IMy
    t660 = t107 * t104 * t102 * t657
    t664 = t111 * t552 * IMx * t110 / 2
    t668 = -t126 + t20 + psih
    t669 = sin(t668)
    contr[55] = t135 * t26 * t14 * t669 * (t660 - t664) * t75 * t92
    t673 = IMz * t431
    t674 = t673 * t614
    t675 = -t141 + t20 - psih
    t676 = sin(t675)
    contr[56] = 3/4 * t148 * t676 * t75 * t674
    t680 = t623 * t139
    t681 = -t141 + t20 + psih
    t682 = sin(t681)
    contr[57] = -3/4 * t148 * t682 * t75 * t680
    t687 = -psil + t20 - psih
    t688 = sin(t687)
    t691 = t153 * t639
    t692 = t111 * t643
    contr[58] = 3/2 * t169 * t26 * t14 * (t691 + t692) * t688 * t75 * t171
    t698 = t153 * t657
    t701 = t111 * t552 * IMx / 2
    t706 = -psil + t20 + psih
    t707 = sin(t706)
    contr[59] = 3 * t169 * t26 * t14 * t707 * pi * t6 * (t698 - t701) * t171
    t712 = psil + t20 - psih
    t713 = sin(t712)
    contr[60] = 3/2 * t169 * t26 * t14 * (t691 - t692) * t713 * t75 * t171
    t721 = psil + t20 + psih
    t722 = sin(t721)
    contr[61] = 3 * t169 * t26 * t14 * (t698 + t701) * t722 * t75 * t171
    t730 = t141 + t20 - psih
    t731 = sin(t730)
    contr[62] = -3/4 * t148 * t731 * t75 * t674
    t736 = t141 + t20 + psih
    t737 = sin(t736)
    contr[63] = 3/4 * t148 * t737 * t75 * t680
    t742 = -IMx * t644
    t748 = t126 + t20 - psih
    t749 = sin(t748)
    contr[64] = t135 * t26 * t14 * t749 * pi * t6 * (cpa1EQ * t742 + t642) * t92 / 2
    t759 = t126 + t20 + psih
    t760 = sin(t759)
    contr[65] = t135 * t26 * t14 * t760 * pi * t6 * t91 * (t660 + t664) * muM
    t764 = t76 + t20 - psih
    t765 = sin(t764)
    contr[66] = -3/8 * t86 * t765 * t75 * t616
    t770 = t76 + t20 + psih
    t771 = sin(t770)
    contr[67] = 3/8 * t86 * t771 * t75 * t624
    t775 = t76 - psig + t20
    t776 = sin(t775)
    contr[68] = 3/2 * t518 * t6 * t776 * t409 * t632
    t781 = t20 - psih - t76 + psig
    t782 = sin(t781)
    t784 = sdelta * IMz
    t786 = t18 * cpa1EQ * t784
    t788 = t439 * t409
    t789 = t518 * t788
    contr[69] = 3/4 * t789 * t786 * t782 * t508
    t791 = t20 - psih + t76 - psig
    t792 = sin(t791)
    contr[70] = 3/4 * t789 * t786 * t792 * t508
    t796 = t20 + psih - t76 + psig
    t797 = sin(t796)
    t799 = t552 * t18
    t800 = t799 * t784
    contr[71] = 3/4 * t789 * t800 * t797 * t508
    t803 = t20 + psih + t76 - psig
    t804 = sin(t803)
    contr[72] = 3/4 * t789 * t800 * t804 * t508
    t808 = -psig + t141 + t20 - psih
    t809 = sin(t808)
    t812 = t422 * t788
    contr[73] = 3/4 * t812 * t786 * t809 * t431
    t814 = -psig + t141 + t20 + psih
    t815 = sin(t814)
    contr[74] = 3/4 * t812 * t800 * t815 * t431
    t819 = psig - t141 + t20 - psih
    t820 = sin(t819)
    contr[75] = 3/4 * t812 * t786 * t820 * t431
    t824 = psig - t141 + t20 + psih
    t825 = sin(t824)
    contr[76] = 3/4 * t812 * t800 * t825 * t431
    t829 = -psih + t20 - psig - t141
    t830 = sin(t829)
    t832 = sdelta * t6
    t834 = IMz * cpa1EQ * t832
    t836 = t409 * t533
    t837 = t406 * t836
    contr[77] = 3/4 * t837 * t834 * t830 * t431
    t839 = -psih + t20 + psig + t141
    t840 = sin(t839)
    contr[78] = 3/4 * t837 * t834 * t840 * t431
    t844 = psih + t20 - psig - t141
    t845 = sin(t844)
    t847 = t19 * t832
    t849 = t409 * t622
    t850 = t406 * t849
    contr[79] = 3/4 * t850 * t847 * t845 * t431
    t852 = psih + t20 + psig + t141
    t853 = sin(t852)
    contr[80] = 3/4 * t850 * t847 * t853 * t431
    t857 = psih + t20 - t76 - psig
    t858 = sin(t857)
    t861 = t282 * t849
    contr[81] = 3/4 * t861 * t847 * t858 * t508
    t863 = psih + t20 + t76 + psig
    t864 = sin(t863)
    contr[82] = 3/4 * t861 * t847 * t864 * t508
    t868 = -t76 - psig + t20 - psih
    t869 = sin(t868)
    t872 = t282 * t836
    contr[83] = 3/4 * t872 * t834 * t869 * t508
    t874 = -t126 - psig + t20 - psih
    t875 = sin(t874)
    t878 = t533 * t639
    t880 = t91 * pi
    t881 = t6 * t107
    t882 = t881 * t880
    t883 = t264 * t882
    contr[84] = 3/4 * t883 * t878 * sdelta * muM * t875
    t885 = t94 - t529 - t96
    t887 = t14 * t885 * muM
    t888 = t287 * t526
    t890 = -t126 - psig + t20 + psih
    t891 = sin(t890)
    contr[85] = 3/4 * t264 * t881 * t891 * t91 * t888 * t887
    t896 = -t126 + psig + t20 - psih
    t897 = sin(t896)
    t901 = t227 * t882
    contr[86] = -3/4 * t901 * t878 * sdelta * t897 * muM
    t904 = -t126 + psig + t20 + psih
    t905 = sin(t904)
    contr[87] = -3/4 * t901 * t905 * t18 * t526 * t887
    t911 = t486 * t639
    t912 = t247 * t643
    t917 = -psil - psig + t20 - psih
    t918 = sin(t917)
    contr[88] = 3/4 * t333 * t14 * t918 * t90 * pi * t6 * (t911 + t912) * t472
    t923 = t486 * t657
    t925 = t552 * t314 / 2
    t927 = -psil - psig + t20 + psih
    t928 = sin(t927)
    contr[89] = -3/2 * t333 * t14 * t928 * (t923 - t925) * t474
    t934 = t475 * t639
    t935 = t235 * t643
    t940 = -psil + psig + t20 - psih
    t941 = sin(t940)
    contr[90] = -3/4 * t351 * t14 * t941 * t90 * t493 * sdelta * muM * (t934 + t935)
    t947 = t475 * t657
    t949 = t552 * t340 / 2
    t954 = -psil + psig + t20 + psih
    t955 = sin(t954)
    contr[91] = 3/2 * t351 * t14 * t955 * t90 * t493 * sdelta * (t947 - t949) * muM
    t961 = psil - psig + t20 - psih
    t962 = sin(t961)
    contr[92] = 3/4 * t351 * t14 * t962 * (t934 - t935) * t474
    t971 = psil - psig + t20 + psih
    t972 = sin(t971)
    contr[93] = -3/2 * t351 * t14 * t972 * t90 * t493 * sdelta * (t947 + t949) * muM
    t979 = psil + psig + t20 - psih
    t980 = sin(t979)
    contr[94] = -3/4 * t333 * t14 * t980 * (t911 - t912) * t474
    t990 = psil + psig + t20 + psih
    t991 = sin(t990)
    contr[95] = 3/2 * t333 * t14 * t991 * t90 * pi * (t923 + t925) * t6 * t472
    t997 = t14 * cpa2EQ
    t998 = t126 - psig + t20 - psih
    t999 = sin(t998)
    contr[96] = 3/4 * t901 * t18 * t999 * t997 * IMy * t471
    t1004 = t126 - psig + t20 + psih
    t1005 = sin(t1004)
    contr[97] = 3/4 * t901 * t18 * t1005 * t526 * t887
    t1010 = t126 + psig + t20 - psih
    t1011 = sin(t1010)
    contr[98] = -3/4 * t883 * t878 * sdelta * muM * t1011
    t1017 = t126 + psig + t20 + psih
    t1018 = sin(t1017)
    t1021 = sdelta * t14
    t1022 = t18 * IMy
    contr[99] = -3/4 * t883 * t1022 * t1021 * t885 * t1018 * muM
    t1027 = t76 + psig + t20 - psih
    t1028 = sin(t1027)
    contr[100] = 3/4 * t872 * t834 * t1028 * t508
    t1034 = cos(psig)
    contr[101] = t35 * t14 * t1034 * t6 * t209 * t59 * t551
    t1039 = cdelta * IMz * muM
    t1042 = t291 * t1 * t287 * t1039
    t1043 = cos(t21)
    contr[102] = 3/2 * t35 * t1043 * t439 * t1042
    t1047 = cos(t38)
    contr[103] = 3/2 * t35 * t1047 * t439 * t1042
    t1051 = t1 * t209
    t1052 = q * IMz
    t1054 = cos(psig - t141)
    t1058 = t533 * t212
    contr[104] = t420 / t417 * t80 * t1058 * t6 * t1054 * t1052 * t1051
    t1066 = cos(psig + t141)
    contr[105] = t406 * t1058 * t6 * t1066 * t1052 * t1051
    t1072 = t18 * sdelta * pi
    t1073 = cos(t54)
    t1075 = t14 * t531
    contr[106] = t61 * t1075 * t1073 * muM * t1072 / 4
    t1079 = cos(t64)
    contr[107] = t61 * t1075 * t1079 * muM * t1072 / 4
    t1085 = t14 * t531 * t1
    t1086 = t615 * t1085
    t1087 = cos(t77)
    contr[108] = -t86 * t1087 * t75 * t1086 / 8
    t1095 = t107 * t118 * t104 * IMy * t102
    t1098 = 2 * t155 * t101 * t110
    t1102 = cos(t127)
    contr[109] = -t135 * t26 * t14 * t1102 * t161 * t91 * (t1095 + t1098) / 6
    t1108 = t673 * t1085
    t1109 = cos(t142)
    contr[110] = -t148 * t1109 * t75 * t1108 / 4
    t1114 = cos(t163)
    t1118 = t107 * t118 * t105
    t1121 = 2 * IMx * t111 * t101
    contr[111] = -t169 * t26 * t14 * (t1118 + t1121) * t1114 * t75 * t171 / 2
    t1132 = cos(t176)
    contr[112] = -t169 * t26 * t14 * t1132 * pi * (t1118 - t1121) * t6 * t171 / 2
    t1138 = cos(t184)
    contr[113] = t148 * t1138 * t75 * t1108 / 4
    t1146 = cos(t193)
    contr[114] = -t135 * t26 * t14 * t1146 * pi * (t1095 - t1098) * t6 * t92 / 6
    t1152 = cos(t200)
    contr[115] = t86 * t1152 * t75 * t1086 / 8
    t1156 = IMz * t70
    t1158 = cos(-t76 + psig)
    contr[116] = t516 / t513 * t80 * t1058 * t6 * t1158 * t1156 * t1051
    t1168 = cos(t231)
    t1172 = t14 * t287
    contr[117] = -t238 / t337 * t80 * t1172 * t160 * t1168 * IMx * t229
    t1178 = cos(t242)
    contr[118] = t250 / t310 * t80 * t1172 * t160 * t1178 * IMx * t229
    t1187 = cos(t76 + psig)
    contr[119] = t282 * t1058 * t6 * t1187 * t1156 * t1051
    t1193 = t71 * t287 * t1039
    t1194 = cos(t271)
    contr[120] = 3/2 * t282 * t1194 * t6 * t292 * t1193
    t1202 = t1022 * t218 * t9 * muM * cdelta
    t1203 = cos(t293)
    contr[121] = 3/2 * t264 * t1203 * t6 * t880 * t1202
    t1208 = cos(t304)
    contr[122] = -3/2 * t227 * t1208 * t6 * t880 * t1202
    t1214 = cos(t319)
    t1217 = t107 * t315
    t1218 = t1217 * t311
    t1219 = t291 * t314
    contr[123] = -3/2 * t334 * pi * (t1218 - t1219) * cdelta * t90 * t1214 * muM
    t1226 = t1217 * t338
    t1227 = t291 * t340
    t1230 = cos(t344)
    contr[124] = 3/2 * t352 * t323 * t1230 * (t1226 - t1227) * muM
    t1234 = cos(t354)
    t1237 = pi * cdelta
    contr[125] = -3/2 * t352 * (t1226 + t1227) * t1237 * t90 * t1234 * muM
    t1243 = cos(t364)
    contr[126] = 3/2 * t334 * (t1218 + t1219) * t1237 * t90 * t1243 * muM
    t1250 = cos(t373)
    contr[127] = 3/2 * t227 * t1250 * t6 * t880 * t1202
    t1255 = cos(t380)
    contr[128] = -3/2 * t264 * t1255 * t6 * t880 * t1202
    t1261 = cos(t386)
    contr[129] = 3/2 * t282 * t1261 * t6 * t292 * t1193
    t1266 = cos(t395)
    contr[130] = 3/2 * t406 * t1266 * t6 * t292 * t411
    t1271 = cos(t413)
    contr[131] = 3/2 * t422 * t1271 * t6 * t292 * t411
    t1276 = cos(t425)
    contr[132] = 3/2 * t422 * t1276 * t6 * t292 * t411
    t1281 = cos(t432)
    t1283 = t181 * t435
    t1286 = t439 * t18 * t531
    t1287 = t422 * t1286
    contr[133] = t1287 * t1283 * t1281 * t431 / 4
    t1289 = cos(t444)
    contr[134] = t1287 * t1283 * t1289 * t431 / 4
    t1293 = cos(t449)
    contr[135] = 3/2 * t406 * t1293 * t6 * t292 * t411
    t1298 = pi * t997
    t1299 = cos(t461)
    t1304 = t35 * t6 * t435
    contr[136] = -3/4 * t1304 * IMz * t1299 * t457 * t1298
    t1307 = cos(t466)
    contr[137] = -3/4 * t1304 * t1307 * IMz * t457 * t1298
    t1313 = IMy * t118
    t1314 = t475 * t1313
    t1316 = 2 * t101 * t340
    t1321 = cos(t480)
    contr[138] = t351 * t14 * t1321 * t90 * pi * (t1314 - t1316) * t6 * t472 / 4
    t1326 = t486 * t1313
    t1329 = 2 * t247 * t101 * IMx
    t1334 = cos(t495)
    contr[139] = t333 * t14 * t1334 * t90 * t493 * muM * sdelta * (t1326 + t1329) / 4
    t1339 = cos(t501)
    t1342 = t406 * t1286
    contr[140] = t1342 * t1283 * t1339 * t431 / 4
    t1344 = cos(t509)
    t1347 = t518 * t1286
    contr[141] = t1347 * t1283 * t1344 * t508 / 4
    t1349 = cos(t522)
    t1352 = t51 * t288
    t1354 = t227 * t888
    contr[142] = t1354 * t1352 * t6 * t1349 * muM / 4
    t1356 = cos(t537)
    t1360 = t264 * t888
    contr[143] = t1360 * t1352 * t6 * t1356 * muM / 4
    t1362 = cos(t544)
    t1365 = t282 * t1286
    contr[144] = t1365 * t1283 * t1362 * t508 / 4
    t1368 = cos(t557)
    contr[145] = -3/4 * t1304 * IMz * t1368 * t533 * t885 * t212
    t1374 = cos(t562)
    t1377 = t14 * t885
    contr[146] = -3/4 * t1304 * t19 * t1377 * muM * pi * t1374
    t1385 = cos(t571)
    contr[147] = -t351 * t14 * t1385 * t90 * t493 * (t1314 + t1316) * t471 / 4
    t1395 = cos(t581)
    contr[148] = -t333 * t14 * t1395 * t90 * t493 * muM * sdelta * (t1326 - t1329) / 4
    t1401 = cos(t587)
    contr[149] = t1342 * t1283 * t1401 * t431 / 4
    t1405 = cos(t592)
    contr[150] = t1347 * t1283 * t1405 * t508 / 4
    t1409 = cos(t597)
    contr[151] = -t1354 * t1352 * t6 * t1409 * muM / 4
    t1415 = cos(t603)
    contr[152] = -t1360 * t1352 * t6 * t1415 * muM / 4
    t1421 = cos(t609)
    contr[153] = t1365 * t1283 * t1421 * t508 / 4
    t1425 = cos(t617)
    t1428 = t6 * t409
    t1429 = t86 * t1428
    contr[154] = -3/8 * t1429 * t1425 * t997 * t615
    t1432 = IMz * t1377
    t1433 = t1432 * t72
    t1434 = cos(t625)
    contr[155] = 3/8 * t86 * t1434 * t75 * t1433
    t1438 = cos(t633)
    contr[156] = 3/2 * t518 * t1438 * t6 * t292 * t1193
    t1443 = cos(t650)
    t1446 = IMy * cpa1EQ
    t1447 = t641 * t1446
    contr[157] = t135 * t26 * t14 * (cpa2EQ * t742 + t1447) * t1443 * t75 * t92 / 2
    t1456 = t107 * t552 * t102 * t105
    t1457 = t656 * IMx
    t1459 = 2 * t1457 * t112
    t1464 = cos(t668)
    contr[158] = -t135 * t26 * t14 * t1464 * pi * t6 * (t1456 + t1459) * t92 / 2
    t1471 = cos(t675)
    contr[159] = -3/4 * t148 * t6 * t1471 * t1 * t1298 * t673
    t1477 = t1432 * t139
    t1478 = cos(t681)
    contr[160] = 3/4 * t148 * t1478 * t75 * t1477
    t1482 = cos(t687)
    t1485 = t153 * t1446
    t1487 = IMx * t111 * cpa2EQ
    contr[161] = 3/2 * t169 * t26 * t14 * (t1485 - t1487) * t1482 * t75 * t171
    t1493 = t107 * t552
    t1494 = t1493 * t105
    t1496 = 2 * t656 * t155
    t1501 = cos(t706)
    contr[162] = -3/2 * t169 * t26 * t14 * t1501 * pi * t6 * (t1494 + t1496) * t171
    t1510 = cos(t712)
    contr[163] = 3/2 * t169 * t26 * t14 * t1510 * t473 * muM * (t1485 + t1487)
    t1519 = cos(t721)
    contr[164] = -3/2 * t169 * t26 * t14 * t1519 * pi * t6 * (t1494 - t1496) * t171
    t1525 = cos(t730)
    contr[165] = 3/4 * t148 * t1428 * t1525 * t997 * t673
    t1530 = cos(t736)
    contr[166] = -3/4 * t148 * t1530 * t75 * t1477
    t1535 = IMx * cpa2EQ
    t1540 = cos(t748)
    contr[167] = t135 * t26 * t14 * t1540 * (t644 * t1535 + t1447) * t75 * t92 / 2
    t1545 = cos(t759)
    contr[168] = -t135 * t26 * t14 * (t1456 - t1459) * t1545 * t75 * t92 / 2
    t1554 = cos(t764)
    t1556 = cpa2EQ * IMz
    contr[169] = 3/8 * t1429 * t14 * t1556 * t1554 * t508
    t1560 = cos(t770)
    contr[170] = -3/8 * t86 * t1560 * t75 * t1433
    t1565 = cos(t775)
    contr[171] = 3/2 * t518 * t1565 * t6 * t292 * t1193
    t1570 = sdelta * t508
    t1571 = cos(t781)
    contr[172] = -3/4 * t789 * t1571 * t18 * t1556 * t1570
    t1577 = cos(t791)
    contr[173] = -3/4 * t789 * t18 * t1577 * t1556 * t1570
    t1583 = cos(t796)
    t1587 = t19 * sdelta * t885
    contr[174] = -3/4 * t789 * t1587 * t70 * t1583 * muM
    t1591 = cos(t803)
    contr[175] = -3/4 * t789 * t1587 * t70 * t1591 * muM
    t1597 = sdelta * t431
    t1598 = cos(t808)
    contr[176] = -3/4 * t812 * t18 * t1598 * t1556 * t1597
    t1604 = t885 * t431
    t1607 = cos(t814)
    contr[177] = -3/4 * t422 * t439 * t1 * t1607 * t287 * t784 * t1604
    t1613 = cos(t819)
    contr[178] = -3/4 * t812 * t1613 * t18 * t1556 * t1597
    t1619 = cos(t824)
    contr[179] = -3/4 * t812 * t1587 * t1619 * t431
    t1624 = cos(t829)
    t1627 = t997 * t784
    t1629 = t6 * t1
    t1630 = t1629 * t287
    t1631 = t406 * t1630
    contr[180] = -3/4 * t1631 * t1627 * q * t1624 * muM
    t1634 = cos(t839)
    contr[181] = -3/4 * t1631 * t1627 * q * t1634 * muM
    t1642 = cos(t844)
    contr[182] = -3/4 * t406 * t1629 * pi * t1642 * t19 * t1021 * t1604
    t1648 = cos(t852)
    t1650 = t784 * t1377
    contr[183] = -3/4 * t1631 * t1650 * t1648 * t431
    t1654 = cos(t857)
    t1658 = t282 * t1630
    contr[184] = -3/4 * t1658 * t1650 * t70 * t1654 * muM
    t1662 = cos(t863)
    contr[185] = -3/4 * t1658 * IMz * t1662 * t1021 * t885 * t508
    t1668 = cos(t868)
    contr[186] = -3/4 * t1658 * t1627 * t70 * t1668 * muM
    t1674 = cos(t874)
    t1679 = IMy * t14 * sdelta * cpa1EQ
    t1681 = t264 * t289
    contr[187] = 3/4 * t1681 * t1679 * t6 * t1674 * muM
    t1683 = cos(t890)
    t1686 = t799 * t526
    t1689 = t288 * pi * t14
    t1690 = t264 * t1689
    contr[188] = 3/4 * t1690 * t1686 * t6 * t1683 * muM
    t1692 = cos(t896)
    t1696 = t227 * t289
    contr[189] = -3/4 * t1696 * t1679 * t6 * t1692 * muM
    t1699 = cos(t904)
    t1703 = t227 * t1689
    contr[190] = -3/4 * t1703 * t1686 * t6 * t1699 * muM
    t1706 = t486 * t1446
    t1707 = t247 * t1535
    t1712 = cos(t917)
    contr[191] = 3/4 * t333 * t14 * t1712 * t90 * pi * t6 * (t1706 - t1707) * t472
    t1717 = t1493 * t311
    t1719 = 2 * t247 * t1457
    t1721 = cos(t927)
    contr[192] = 3/4 * t333 * t14 * t1721 * (t1717 + t1719) * t474
    t1726 = t475 * t1446
    t1727 = t235 * t1535
    t1732 = cos(t940)
    contr[193] = -3/4 * t351 * t14 * t1732 * t90 * t493 * sdelta * muM * (t1726 - t1727)
    t1738 = t1493 * t338
    t1740 = 2 * t656 * t340
    t1744 = cos(t954)
    contr[194] = -3/4 * t351 * t14 * t1744 * t90 * t493 * (t1738 + t1740) * t471
    t1754 = cos(t961)
    contr[195] = 3/4 * t351 * t14 * t1754 * t90 * pi * t6 * (t1726 + t1727) * t472
    t1762 = cos(t971)
    contr[196] = 3/4 * t351 * t14 * t1762 * t90 * t493 * (t1738 - t1740) * t471
    t1768 = cos(t979)
    contr[197] = -3/4 * t333 * t14 * t1768 * (t1706 + t1707) * t474
    t1778 = cos(t990)
    contr[198] = -3/4 * t333 * t14 * t1778 * t90 * pi * t6 * (t1717 - t1719) * t472
    t1784 = cos(t998)
    contr[199] = 3/4 * t1696 * t1679 * t6 * t1784 * muM
    t1789 = cos(t1004)
    contr[200] = 3/4 * t1703 * t1686 * t6 * t1789 * muM
    t1794 = cos(t1010)
    contr[201] = -3/4 * t1681 * t1679 * t6 * t1794 * muM
    t1800 = cos(t1017)
    contr[202] = -3/4 * t1690 * t1686 * t6 * t1800 * muM
    t1806 = cos(t1027)
    contr[203] = -3/4 * t1658 * t1627 * t70 * t1806 * muM
    

    der = sum(contr);
    return der;
end

function derivativechiM3_Jl(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)

    contr = zeros(21)
    t1 = cos(TL)
    t3 = -1 + m
    t8 = KK * t3 * k + EE * (k + m)
    t10 = Q1 ^ 2
    t11 = Q2 ^ 2
    t12 = t10 + t11 + 1
    t13 = 1 / t12
    t14 = Q1 * t13
    t15 = cpa1EQ * t14
    t17 = Q2 * t13
    t18 = cpa2EQ * t17
    t22 = cpa3EQ * (-t10 - t11 + 1) * t13
    t23 = -2 * t15 + 2 * t18 + t22
    t24 = t12 ^ 2
    t25 = 1 / t24
    t26 = t25 * t23
    t28 = 4 * t10 * t26
    t29 = -t10 + t11 + 1
    t30 = t29 * t13
    t37 = 2 * Q2 * cpa2EQ * t14 + cpa1EQ * t30 + 2 * cpa3EQ * t14
    t38 = t13 * t37
    t43 = t10 - t11 + 1
    t44 = t43 * t13
    t48 = 2 * Q2 * cpa1EQ * t14 + cpa2EQ * t44 - 2 * cpa3EQ * t17
    t49 = t13 * t48
    t50 = Q2 * Q1
    t52 = 2 * t50 * t49
    t53 = t29 * t38 + t52
    t56 = 2 * Q1 * t13 * t53
    t57 = t11 * t26
    t59 = t50 * t38
    t60 = 6 * t59
    t61 = t43 * t49
    t72 = 2 * t59
    t74 = Q2 * t13 * t23
    t81 = -2 * Q1 * t13 * (t72 + t61 + 4 * t74) + 2 * t53 * t17
    t85 = pi ^ 2
    t86 = t85 * muM
    t89 = KK ^ 2
    t91 = 1 / t89 / KK
    t92 = sma ^ 2
    t94 = 0.1e1 / t92 / sma
    t95 = t94 * t91
    t96 = eta ^ 2
    t98 = 0.1e1 / t96 / eta
    t99 = 0.1e1 / n
    t100 = t99 * t98
    t102 = 1 / m
    t103 = 1 / t3
    t106 = sqrt(1 + k)
    t109 = 0.1e1 / Jg / t106
    t111 = t109 * t103 * t102 * t100 * t95
    contr[1] = 3/16 * t111 * t86 * (P1 * (t28 - t56 + 12 * t57 + 2 * Q2 * t13 * (t60 + 3 * t61) + 8/3 * t15 - 8/3 * t18 - 4/3 * t22) + t81 * P2) * IMz * t8 * cdelta * t1
    t113 = cos(psih)
    t114 = eta + 1/3
    t115 = P1 ^ 2
    t117 = P2 ^ 2
    t118 = t117 * t114
    t119 = 1 + eta
    t120 = t119 * t96
    t121 = t115 * t114 + t118 + t120
    t122 = P1 + P2
    t123 = t122 * t121
    t124 = P1 - P2
    t125 = t13 * t124
    t131 = t115 * P1 * P2 * t114
    t134 = P1 * (t118 + t120) * P2
    t135 = t119 ^ 2
    t136 = t135 * t119
    t137 = t136 * phiTA
    t138 = -t131 - t134 + t137
    t143 = t13 * (t29 * t125 * t123 / 2 + 2 * t138 * Q2 * t14)
    t145 = t131 + t134 + t137
    t146 = t13 * t145
    t150 = t122 * Q2
    t151 = t124 * t150
    t152 = t151 * Q1 * t13 * t121
    t154 = t13 * (t29 * t146 + t152)
    t164 = t13 * (-Q1 * t125 * t123 + 2 * t138 * t17)
    t170 = Q2 * t125 * t123 - 2 * Q1 * t146
    t176 = t25 * t138
    t177 = t43 ^ 2
    t180 = Q1 * t25 * t121
    t185 = t25 * t145
    t186 = t11 * t10
    t189 = 2/3 * t137
    t201 = (KK * k + EE) * m + (EE - KK) * k
    t206 = 0.1e1 / t136
    t211 = t109 * t98 * t102 * t91 * t206 * t103 * t99
    contr[2] = 3/8 * t211 * t94 * t201 * t86 * IMz * sdelta * (t37 * (t43 * t143 + 2 * t50 * t154) + t23 * (2 * t170 * Q2 * t14 + t43 * t164) + (2 * t43 * t124 * t150 * t180 + t177 * t176 + 4 * t186 * t185 - t189) * t48) * t113
    t213 = 2 * TL
    t214 = cos(t213)
    t218 = IMz * t8
    contr[3] = 3/16 * t111 * t218 * t85 * t81 * cdelta * muM * t214
    t222 = 3 * TL
    t223 = cos(t222)
    t226 = t23 * P1
    t227 = t10 * t25
    t230 = P2 * t23
    t231 = t17 * t230
    t233 = P1 * t53
    t234 = t72 + t61
    t235 = t234 * P2
    t240 = t17 * t226
    t242 = -t234
    t244 = t53 * P2
    contr[4] = t111 * t86 * (4 * t227 * t226 - 2 * Q1 * t13 * (4 * t231 + t233 + t235) + 2 * Q2 * t13 * (P1 * t242 - 2 * t240 + t244)) * IMz * t8 * cdelta * t223 / 16
    t254 = t213 - psih
    t255 = cos(t254)
    t258 = t8 * t85
    t259 = t29 ^ 2
    t260 = t259 * t25
    t261 = t29 * t25
    t262 = t43 * t261
    t265 = Q1 * t261
    t266 = Q1 * t25
    t267 = t43 * t266
    t270 = t23 * (-2 * t265 - 2 * t267)
    t271 = t50 * t261
    t273 = t43 * Q2 * t266
    t275 = 2 * t271 + 2 * t273
    t276 = t275 * t48
    contr[5] = -3/32 * t111 * IMz * (t37 * (t260 + t262) + t270 + t276) * t258 * sdelta * muM * t255
    t283 = t213 + psih
    t284 = cos(t283)
    t287 = t11 * t227
    t288 = 8 * t287
    t291 = 2 * t265
    t292 = t11 * t266
    t293 = 8 * t292
    t294 = 2 * t267
    t296 = t23 * (-t291 - t293 + t294)
    t297 = 2 * t271
    contr[6] = 3/32 * t111 * t218 * t85 * (t37 * (t260 - t262 - t288) + t296 + (t297 - 6 * t273) * t48) * sdelta * muM * t284
    t306 = t222 - psih
    t307 = cos(t306)
    t310 = IMz * muM
    t311 = Q2 * t261
    t313 = Q2 * t43 * t25
    t315 = -2 * t311 - 2 * t313
    t316 = t23 * t315
    t319 = t25 * t37
    t320 = t43 * t50
    t322 = 2 * t320 * t319
    t323 = t25 * t48
    t324 = t177 * t323
    t327 = t259 * t319
    t328 = t43 * t38
    t333 = 2 * t59 + 2 * t61
    t338 = 4 * t186 * t319
    t340 = 2 * t320 * t323
    t341 = t270 + t327 + t29 * t13 * (t328 + t52) + 2 * t50 * t13 * t333 - t338 - t340
    contr[7] = -t111 * (P1 * (t29 * t13 * t242 + t316 - t322 - t324) + P2 * t341) * t85 * t310 * t8 * sdelta * t307 / 32
    t349 = t222 + psih
    t350 = cos(t349)
    t353 = 2 * t311
    t354 = Q2 * t227
    t355 = 8 * t354
    t356 = 2 * t313
    t357 = -t353 + t355 + t356
    t359 = -t60 - t61
    t363 = 8 * t186 * t323
    t364 = t234 * t44
    t374 = t296 + t327 + t29 * t13 * (-t328 + t52) - 2 * t50 * t13 * t333 - t338 - t340
    contr[8] = t111 * (P1 * (t29 * t13 * t359 + t23 * t357 - t363 + t364) + P2 * t374) * t85 * t310 * t8 * sdelta * t350 / 32
    t381 = -psih + TL
    t382 = cos(t381)
    t386 = t262 / 3
    t387 = 8/3 * t287
    t388 = t177 * t25
    t391 = 6 * t313
    t400 = 2/3 * t267
    contr[9] = -9/32 * t111 * (P1 * (t37 * t275 + t48 * (t386 + t387 + t388 - 4/9) + (t353 - t355 + t391) * t23 / 3) + P2 * (t37 * (t260 + t386 + t387 - 4/9) + t276 + (-t291 + 8/3 * t292 - t400) * t23)) * t85 * t310 * t8 * sdelta * t382
    t411 = psih + TL
    t412 = cos(t411)
    t415 = 2 * t273
    t436 = t86 * t218
    contr[10] = 9/32 * t111 * t436 * (P1 * (t37 * (2/3 * t271 - t415) + t48 * (t386 - t388 + 4/9) + (t353 - t391) * t23 / 3) + P2 * (t37 * (t260 - t386 - 4/9) + t48 * (t297 - 2/3 * t273) + (-t291 + t400) * t23)) * sdelta * t412
    t439 = sin(TL)
    contr[11] = -9/16 * t111 * t436 * cdelta * (P2 * (t28 - t56 + 4/3 * t57 + 2 * Q2 * t13 * (t61 / 3 + 2/3 * t59) + 8/9 * t15 - 8/9 * t18 - 4/9 * t22) + t81 * P1 / 3) * t439
    t460 = sin(psih)
    t464 = t13 * (t138 * t44 + t152)
    t472 = 2 * t50 * t146 + t124 * t123 * t44 / 2
    contr[12] = -3/8 * t211 * t94 * t85 * sdelta * muM * t201 * (t48 * (t472 * t30 + 2 * t50 * t464) + t23 * (2 * t50 * t164 + t170 * t30) + t37 * (2 * t50 * t124 * t121 * t122 * t261 + 4 * t186 * t176 + t259 * t185 - t189)) * IMz * t460
    t500 = sin(t213)
    contr[13] = -3/16 * t111 * (t28 - t56 - 2 * (t72 + t61 + 2 * t74) * t17) * IMz * t258 * cdelta * muM * t500
    t513 = sin(t222)
    contr[14] = -t111 * (4 * t227 * t230 - 2 * Q1 * t13 * (-t234 * P1 - 4 * t240 + t244) - 2 * Q2 * t13 * (2 * t231 + t235 + t233)) * t85 * t310 * t8 * cdelta * t513 / 16
    t535 = sin(t254)
    t541 = -t37 * t275
    contr[15] = 3/32 * t111 * (t48 * (-t262 - t388) + t316 + t541) * IMz * t258 * sdelta * muM * t535
    t547 = sin(t283)
    t553 = -t23 * t357
    contr[16] = 3/32 * t111 * (t48 * (t262 + t288 - t388) + t553 + (6 * t271 - t415) * t37) * IMz * t258 * sdelta * muM * t547
    t562 = sin(t306)
    contr[17] = -t111 * t436 * sdelta * (P1 * t341 + (t29 * t13 * t234 - t23 * t315 + t364) * P2) * t562 / 32
    t576 = sin(t349)
    contr[18] = t111 * t436 * sdelta * (P1 * t374 + (-t29 * t13 * t359 - t322 - t324 + t363 + t553) * P2) * t576 / 32
    t588 = sin(t381)
    contr[19] = -3/32 * t111 * (P1 * (t37 * (t260 - t262 + t288 - 4/3) + t276 + (-t291 + t293 + t294) * t23) + P2 * (t541 + t48 * (t262 - t288 - t388 + 4/3) + (t353 + t355 - t356) * t23)) * t85 * t310 * t8 * sdelta * t588
    t609 = sin(t411)
    t611 = 16 * t287
    contr[20] = 3/32 * t111 * t436 * (P1 * (t37 * (t260 + t262 + t611 - 4/3) + t48 * (t297 + 10 * t273) + (-t291 + 16 * t292 - t294) * t23) + P2 * (t37 * (10 * t271 + t415) + t48 * (t262 + t611 + t388 - 4/3) + (t353 - 16 * t354 + t356) * t23)) * sdelta * t609
    contr[21] = -3/8 * t109 * t95 * t100 * t206 * t102 * t103 * t201 * t86 * cdelta * IMz * (t37 * (-2 * Q1 * t154 + 2 * Q2 * t143) + t48 * (2 * Q2 * t464 - 2 * t472 * t14) + (4 * t10 * t185 + 4 * t11 * t176 - 4 * t151 * t180 - t189) * t23)
       
    contr = sum(contr);
end

function derivativechiM3_JgP1(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)

    contr = zeros(21)
    t1 = cos(TL)
    t3 = -1 + m
    t6 = k + m
    t8 = KK * t3 * k + t6 * EE
    t9 = IMz * t8
    t11 = sqrt(t6)
    t12 = 0.1e1 / t11
    t13 = Q1 ^ 2
    t14 = Q2 ^ 2
    t15 = t13 + t14 + 1
    t16 = 1 / t15
    t17 = Q1 * t16
    t18 = cpa1EQ * t17
    t20 = Q2 * t16
    t21 = cpa2EQ * t20
    t25 = cpa3EQ * (-t13 - t14 + 1) * t16
    t26 = -2 * t18 + 2 * t21 + t25
    t27 = t15 ^ 2
    t28 = 1 / t27
    t29 = t28 * t26
    t31 = 4 * t29 * t13
    t32 = -t13 + t14 + 1
    t33 = t32 * t16
    t40 = 2 * Q2 * cpa2EQ * t17 + cpa1EQ * t33 + 2 * cpa3EQ * t17
    t41 = t16 * t40
    t46 = t13 - t14 + 1
    t47 = t46 * t16
    t51 = 2 * Q2 * cpa1EQ * t17 + cpa2EQ * t47 - 2 * cpa3EQ * t20
    t52 = t16 * t51
    t53 = Q1 * Q2
    t55 = 2 * t53 * t52
    t56 = t32 * t41 + t55
    t59 = 2 * Q1 * t16 * t56
    t60 = t14 * t29
    t62 = t53 * t41
    t63 = 6 * t62
    t64 = t46 * t52
    t75 = 2 * t62
    t77 = Q2 * t16 * t26
    t84 = -2 * Q1 * t16 * (t75 + t64 + 4 * t77) + 2 * t56 * t20
    t86 = P1 * (t31 - t59 + 12 * t60 + 2 * Q2 * t16 * (t63 + 3 * t64) + 8/3 * t18 - 8/3 * t21 - 4/3 * t25) + t84 * P2
    t88 = muM * pi
    t91 = sqrt(k)
    t92 = 0.1e1 / t91
    t93 = KK ^ 2
    t95 = 1 / t93 / KK
    t97 = sma ^ 2
    t99 = 0.1e1 / t97 / sma
    t100 = eta ^ 2
    t102 = 0.1e1 / t100 / eta
    t103 = t102 * t99
    t105 = 0.1e1 / n
    t106 = 1 / m
    t108 = 1 / t3
    t111 = -m * KK + PP * t6
    t113 = 0.1e1 / Jg
    t115 = t113 * t111 * t108 * t106 * t105
    t116 = t115 * t103 * t95 * t92
    t125 = 1 / KK
    t127 = t113 * cdelta
    t128 = t127 * t125 * t99
    t129 = t128 * t102 * t105 * t91
    contr[1] = 3/8 * t129 * pi * muM * t86 * t12 * IMz * t1 - 3/8 * t116 * t88 * t86 * t12 * t9 * cdelta * t1
    t132 = cos(psih)
    t133 = eta + 1/3
    t134 = P1 ^ 2
    t136 = P2 ^ 2
    t137 = t136 * t133
    t138 = 1 + eta
    t139 = t138 * t100
    t140 = t134 * t133 + t137 + t139
    t141 = P1 + P2
    t142 = t141 * t140
    t143 = P1 - P2
    t144 = t16 * t143
    t150 = t134 * P1 * P2 * t133
    t153 = P1 * (t137 + t139) * P2
    t154 = t138 ^ 2
    t155 = t154 * t138
    t156 = t155 * phiTA
    t157 = -t150 - t153 + t156
    t162 = t16 * (t32 * t144 * t142 / 2 + 2 * t157 * Q2 * t17)
    t164 = t150 + t153 + t156
    t165 = t16 * t164
    t169 = t141 * Q2
    t170 = t143 * t169
    t171 = t170 * Q1 * t16 * t140
    t173 = t16 * (t32 * t165 + t171)
    t183 = t16 * (-Q1 * t144 * t142 + 2 * t157 * t20)
    t189 = Q2 * t144 * t142 - 2 * Q1 * t165
    t195 = t28 * t157
    t196 = t46 ^ 2
    t199 = Q1 * t28 * t140
    t204 = t28 * t164
    t205 = t14 * t13
    t208 = 2/3 * t156
    t220 = (KK * k + EE) * m + (EE - KK) * k
    t226 = 0.1e1 / t155
    t233 = t113 * t111 * t102 * t106 * t95 * t226 * t108 * t105 * t99
    contr[2] = -3/4 * t233 * t12 * t92 * t220 * t88 * IMz * sdelta * (t40 * (t46 * t162 + 2 * t53 * t173) + t26 * (2 * t189 * Q2 * t17 + t46 * t183) + (2 * t46 * t143 * t169 * t199 + t196 * t195 + 4 * t205 * t204 - t208) * t51) * t132
    t236 = 2 * TL
    t237 = cos(t236)
    t238 = muM * t237
    t239 = t92 * cdelta
    t246 = t115 * t103 * t95 * t12
    contr[3] = 3/8 * t113 * t125 * t103 * t105 * t84 * t91 * pi * t238 * t12 * IMz * cdelta - 3/8 * t246 * t9 * pi * t84 * t239 * t238
    t259 = 3 * TL
    t260 = cos(t259)
    t263 = t26 * P1
    t264 = t13 * t28
    t267 = P2 * t26
    t268 = t20 * t267
    t270 = P1 * t56
    t271 = t75 + t64
    t272 = t271 * P2
    t277 = t20 * t263
    t279 = -t271
    t281 = t56 * P2
    t286 = 4 * t264 * t263 - 2 * Q1 * t16 * (4 * t268 + t270 + t272) + 2 * Q2 * t16 * (P1 * t279 - 2 * t277 + t281)
    t293 = muM * t12
    t294 = pi * t293
    contr[4] = -t116 * t88 * t12 * t286 * t9 * cdelta * t260 / 8 + t129 * t294 * t286 * IMz * t260 / 8
    t298 = t236 - psih
    t299 = cos(t298)
    t301 = t92 * sdelta
    t303 = t8 * pi
    t304 = t32 ^ 2
    t305 = t304 * t28
    t306 = t32 * t28
    t307 = t46 * t306
    t310 = Q1 * t306
    t311 = Q1 * t28
    t312 = t46 * t311
    t315 = t26 * (-2 * t310 - 2 * t312)
    t316 = t53 * t306
    t317 = t46 * Q2
    t318 = t317 * t311
    t320 = 2 * t316 + 2 * t318
    t321 = t320 * t51
    contr[5] = 3/16 * t246 * IMz * (t40 * (t305 + t307) + t315 + t321) * t303 * t301 * muM * t299
    t327 = t236 + psih
    t328 = cos(t327)
    t331 = t14 * t264
    t332 = 8 * t331
    t335 = 2 * t310
    t336 = t14 * t311
    t337 = 8 * t336
    t338 = 2 * t312
    t340 = t26 * (-t335 - t337 + t338)
    t341 = 2 * t316
    contr[6] = -3/16 * t246 * t9 * pi * (t40 * (t305 - t307 - t332) + t340 + (t341 - 6 * t318) * t51) * t301 * muM * t328
    t351 = t259 - psih
    t352 = cos(t351)
    t355 = t92 * pi
    t356 = t355 * t293
    t358 = Q2 * t306
    t360 = Q2 * t46 * t28
    t362 = -2 * t358 - 2 * t360
    t363 = t26 * t362
    t366 = t28 * t40
    t367 = t46 * t53
    t369 = 2 * t367 * t366
    t370 = t28 * t51
    t371 = t196 * t370
    t374 = t304 * t366
    t375 = t46 * t41
    t380 = 2 * t62 + 2 * t64
    t385 = 4 * t205 * t366
    t387 = 2 * t367 * t370
    t388 = t315 + t374 + t32 * t16 * (t375 + t55) + 2 * t53 * t16 * t380 - t385 - t387
    contr[7] = t115 * t103 * t95 * (P1 * (t32 * t16 * t279 + t363 - t369 - t371) + P2 * t388) * t356 * t9 * sdelta * t352 / 16
    t395 = t259 + psih
    t396 = cos(t395)
    t400 = 2 * t358
    t401 = Q2 * t264
    t402 = 8 * t401
    t403 = 2 * t360
    t404 = -t400 + t402 + t403
    t406 = -t63 - t64
    t410 = 8 * t205 * t370
    t411 = t271 * t47
    t421 = t340 + t374 + t32 * t16 * (-t375 + t55) - 2 * t53 * t16 * t380 - t385 - t387
    contr[8] = -t115 * t103 * t95 * (P1 * (t32 * t16 * t406 + t26 * t404 - t410 + t411) + P2 * t421) * t356 * t9 * sdelta * t396 / 16
    t429 = -psih + TL
    t430 = cos(t429)
    t434 = t307 / 3
    t435 = 8/3 * t331
    t436 = t196 * t28
    t439 = 6 * t360
    t448 = 2/3 * t312
    contr[9] = 9/16 * t116 * (P1 * (t40 * t320 + t51 * (t434 + t435 + t436 - 4/9) + (t400 - t402 + t439) * t26 / 3) + P2 * (t40 * (t305 + t434 + t435 - 4/9) + t321 + (-t335 + 8/3 * t336 - t448) * t26)) * pi * t293 * t9 * sdelta * t430
    t458 = psih + TL
    t459 = cos(t458)
    t462 = 2 * t318
    t484 = t12 * IMz
    t485 = t88 * t484
    contr[10] = -9/16 * t116 * t485 * t8 * (P1 * (t40 * (2/3 * t316 - t462) + t51 * (t434 - t436 + 4/9) + (t400 - t439) * t26 / 3) + P2 * (t40 * (t305 - t434 - 4/9) + t51 * (t341 - 2/3 * t318) + (-t335 + t448) * t26)) * sdelta * t459
    t489 = sin(TL)
    t505 = (P2 * (t31 - t59 + 4/3 * t60 + 2 * Q2 * t16 * (t64 / 3 + 2/3 * t62) + 8/9 * t18 - 8/9 * t21 - 4/9 * t25) + t84 * P1 / 3) * t489
    contr[11] = 9/8 * t116 * t485 * t8 * cdelta * t505 - 9/8 * t129 * t294 * IMz * t505
    t514 = sin(psih)
    t518 = t16 * (t157 * t47 + t171)
    t526 = 2 * t53 * t165 + t143 * t142 * t47 / 2
    contr[12] = 3/4 * t233 * t12 * t355 * sdelta * muM * t220 * (t51 * (t526 * t33 + 2 * t53 * t518) + t26 * (2 * t53 * t183 + t189 * t33) + t40 * (2 * t53 * t143 * t140 * t141 * t306 + 4 * t205 * t195 + t304 * t204 - t208)) * IMz * t514
    t553 = sin(t236)
    t556 = t484 * t303
    contr[13] = 3/8 * t115 * t103 * t95 * (t31 - t59 - 2 * (t75 + t64 + 2 * t77) * t20) * t556 * t239 * muM * t553 - 3/8 * t127 * t12 * t125 * t99 * t102 * t105 * IMz * t91 * pi * muM * (-4 * t14 * Q1 * t366 - 2 * Q1 * t32 * t366 - 4 * Q2 * t13 * t370 - 2 * t317 * t370 + t31 - 4 * t60) * t553
    t592 = sin(t259)
    t609 = 4 * t264 * t267 - 2 * Q1 * t16 * (-t271 * P1 - 4 * t277 + t281) - 2 * Q2 * t16 * (2 * t268 + t272 + t270)
    contr[14] = -t128 * t102 * t105 * t609 * t91 * t88 * t12 * IMz * t592 / 8 + t115 * t103 * t95 * t609 * t356 * t9 * cdelta * t592 / 8
    t623 = sin(t298)
    t630 = -t40 * t320
    contr[15] = -3/16 * t115 * t103 * t95 * (t51 * (-t307 - t436) + t363 + t630) * t556 * t301 * muM * t623
    t637 = sin(t327)
    t644 = -t26 * t404
    contr[16] = -3/16 * t115 * t103 * t95 * (t51 * (t307 + t332 - t436) + t644 + (6 * t316 - t462) * t40) * t556 * t301 * muM * t637
    t654 = sin(t351)
    t664 = t8 * sdelta
    contr[17] = t116 * t485 * t664 * (P1 * t388 + (t32 * t16 * t271 - t26 * t362 + t411) * P2) * t654 / 16
    t668 = sin(t395)
    contr[18] = -t116 * t485 * t664 * (P1 * t421 + (-t32 * t16 * t406 - t369 - t371 + t410 + t644) * P2) * t668 / 16
    t681 = sin(t429)
    contr[19] = 3/16 * t116 * (P1 * (t40 * (t305 - t307 + t332 - 4/3) + t321 + (-t335 + t337 + t338) * t26) + P2 * (t630 + t51 * (t307 - t332 - t436 + 4/3) + (t400 + t402 - t403) * t26)) * pi * t293 * t9 * sdelta * t681
    t701 = sin(t458)
    t703 = 16 * t331
    contr[20] = -3/16 * t116 * t485 * t8 * (P1 * (t40 * (t305 + t307 + t703 - 4/3) + t51 * (t341 + 10 * t318) + (-t335 + 16 * t336 - t338) * t26) + P2 * (t40 * (10 * t316 + t462) + t51 * (t307 + t703 + t436 - 4/3) + (t400 - 16 * t401 + t403) * t26)) * sdelta * t701
    t748 = t40 * (-2 * Q1 * t173 + 2 * Q2 * t162) + t51 * (2 * Q2 * t518 - 2 * t526 * t17) + (4 * t13 * t204 + 4 * t14 * t195 - 4 * t170 * t199 - t208) * t26
    contr[21] = -3/4 * t128 * t102 * t105 * t226 * t12 * t91 * t88 * IMz * t748 * t701 + 3/4 * t233 * t12 * t92 * t220 * pi * cdelta * muM * IMz * t748
      
    contr = sum(contr);
    return contr;
end

function derivativechiM3_JgP2(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)

    contr = zeros(14)
    t1 = cdelta ^ 2
    t2 = t1 * IMz
    t3 = eta + 1/3
    t4 = Q1 * Q2
    t6 = 2 * cpa2EQ * t4
    t7 = Q1 ^ 2
    t8 = Q2 ^ 2
    t9 = t7 - t8 + 1
    t11 = t9 * cpa1EQ + t6
    t12 = t11 * t3
    t13 = P1 ^ 2
    t14 = t13 ^ 2
    t18 = -t9 / 2
    t20 = cpa1EQ * t4
    t21 = cpa2EQ * t18 + t20
    t24 = t13 * P1 * P2
    t27 = eta ^ 2
    t28 = t11 * t27
    t29 = 1 + eta
    t30 = t29 * t13
    t33 = P2 ^ 2
    t36 = t29 * t27 + t33 * t3
    t38 = P1 * P2
    t41 = t33 ^ 2
    t44 = t33 * t29
    t47 = t29 ^ 2
    t48 = t47 * t29
    t49 = t48 * phiTA
    t53 = 2 * cpa3EQ
    t60 = sqrt(k)
    t61 = t60 * pi
    t62 = cos(psih)
    t67 = sqrt(k + m)
    t68 = 0.1e1 / t67
    t70 = 1 / (t7 + t8 + 1)
    t71 = t70 * t68
    t73 = 0.1e1 / n
    t78 = sma ^ 2
    t85 = 0.1e1 / KK / Jg / t78 / sma / t27 / eta
    t86 = t85 * t73 / t48 * t71
    contr[1] = -t86 * t62 * muM * t61 * (3/4 * t14 * t12 + 3 * t24 * t3 * t21 + 3/4 * t30 * t28 + 3 * t38 * t36 * t21 - 3/4 * t41 * t12 - 3/4 * t44 * t28 + (-cpa2EQ * t18 + (Q1 * cpa1EQ + t53) * Q2) * t49) * t2 / 2
    t89 = 2 * TL
    t90 = t89 - psih
    t91 = cos(t90)
    t100 = t85 * t73 * t1 * t68
    contr[2] = 3/8 * t100 * IMz * t70 * pi * cpa1EQ * t60 * muM * t91
    t102 = t89 + psih
    t103 = cos(t102)
    t106 = cpa1EQ * t7
    t107 = cpa1EQ * t8
    contr[3] = 3/8 * t100 * pi * IMz * t70 * (t106 + t6 - t107) * t60 * muM * t103
    t114 = 3 * TL
    t115 = t114 - psih
    t116 = cos(t115)
    t119 = muM * pi
    t128 = t85 * t73 * t1 * t70
    contr[4] = -t128 * (cpa2EQ * P1 - cpa1EQ * P2) * t60 * t119 * t68 * IMz * t116 / 8
    t131 = t114 + psih
    t132 = cos(t131)
    t135 = t7 * P1
    t137 = P1 * Q1
    t138 = Q2 * cpa1EQ
    t141 = t8 * P1
    t143 = t7 * P2
    t145 = P2 * Q1
    t146 = Q2 * cpa2EQ
    t149 = t8 * P2
    contr[5] = -t128 * (-cpa1EQ * t143 + cpa1EQ * t149 + cpa2EQ * t135 - cpa2EQ * t141 - 2 * t138 * t137 - 2 * t146 * t145) * t60 * t119 * t68 * IMz * t132 / 8
    t157 = muM * t1
    t158 = cpa2EQ * t7
    t159 = t158 / 2
    t160 = cpa2EQ * t8
    t161 = t160 / 2
    t162 = Q2 * cpa3EQ
    t163 = 2 * t162
    t170 = Q1 * (-2 * t146 + 4 * cpa3EQ)
    t177 = -psih + TL
    t178 = cos(t177)
    t180 = IMz * t60
    t184 = t85 * t73 * t71
    contr[6] = t184 * t180 * pi * t178 * (P1 * (t20 + t159 - t161 + t163 + 2 * cpa2EQ) - (t106 + t170 - t107 - 4 * cpa1EQ) * P2 / 2) * t157 / 4
    t197 = psih + TL
    t198 = cos(t197)
    contr[7] = -t184 * t180 * pi * t198 * muM * t1 * (P1 * (t20 - t158 + t160 - t162 - cpa2EQ / 4) - P2 * (t106 + Q1 * (t146 + cpa3EQ) - t107 - cpa1EQ / 4)) / 2
    t204 = t7 - t8 - 1
    t207 = t20 - t204 * cpa2EQ / 2
    t208 = t3 * t207
    t211 = cpa1EQ * t204
    t212 = t211 + t6
    t216 = t207 * t27
    t234 = sin(psih)
    contr[8] = -t86 * t234 * muM * t61 * t1 * (-3 * t14 * t208 + 3 * t24 * t3 * t212 - 3 * t30 * t216 + 3 * t38 * t36 * t212 + 3 * t41 * t208 + 3 * t44 * t216 + (t211 - 2 * (t146 - t53) * Q1) * t49) * IMz / 4
    t241 = sin(t90)
    contr[9] = 3/8 * t184 * cpa2EQ * t60 * pi * t241 * muM * t2
    t250 = sin(t102)
    contr[10] = 3/8 * t85 * t73 * t68 * t60 * t119 * t2 * t250 * t70 * (t158 - 2 * t20 - t160)
    t258 = sin(t115)
    contr[11] = t85 * t73 * t180 * pi * t1 * muM * t70 * (cpa1EQ * P1 + cpa2EQ * P2) * t68 * t258 / 8
    t271 = sin(t131)
    t283 = t68 * IMz
    contr[12] = t85 * t73 * t1 * t60 * t119 * t283 * t70 * (cpa1EQ * t135 - cpa1EQ * t141 + cpa2EQ * t143 - cpa2EQ * t149 + 2 * t146 * t137 - 2 * t138 * t145) * t271 / 8
    t290 = sin(t177)
    contr[13] = -t85 * t73 * t70 * (P1 * (t106 + t170 - t107 + 2 * cpa1EQ) + 2 * P2 * (t20 + t159 - t161 + t163 - cpa2EQ)) * t283 * t61 * t290 * t157 / 8
    t306 = sin(t197)
    contr[14] = -t184 * IMz * (P1 * (t106 + Q1 * (4 * t146 - t53) - t107 + cpa1EQ / 2) + 4 * P2 * (t20 - t158 / 4 + t160 / 4 + t162 / 2 + cpa2EQ / 8)) * t61 * t306 * t157 / 4  
    contr = sum(contr);
    return contr;
end

function derivativechiM3_JhP1(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)
    contr = zeros(7)
    t1 = Q1 ^ 2
    t4 = Q2 ^ 2
    t7 = Q1 * cpa1EQ
    t8 = Q2 * cpa2EQ
    t15 = -Q1 * cpa2EQ + Q2 * cpa1EQ
    t21 = cos(TL)
    t24 = sqrt(k + m)
    t25 = 0.1e1 / t24
    t28 = sqrt(k)
    t30 = 1 / (t1 + t4 + 1)
    t32 = 0.1e1 / n
    t34 = eta ^ 2
    t37 = sma ^ 2
    t44 = 0.1e1 / KK / Jg / t37 / sma / t34 / eta
    contr[1] = -t44 * t32 * t30 * t28 * t25 * IMz * t21 * pi * (P1 * (2 * cpa3EQ * t1 + 2 * cpa3EQ * t4 - 2 * cpa3EQ + t7 + 5 * t8) + 3 * t15 * P2) * muM / 4
    t48 = t25 * IMz
    t51 = 2 * TL
    t52 = cos(t51)
    contr[2] = -3/4 * t44 * t32 * t30 * t15 * t52 * pi * muM * t28 * t48
    t60 = P1 * Q1
    t62 = Q2 * P1
    t64 = P2 * Q1
    t66 = Q2 * P2
    t72 = pi * muM * t25
    t74 = 3 * TL
    t75 = cos(t74)
    contr[3] = t44 * t32 * t75 * t28 * t72 * t30 * (cpa1EQ * t60 - cpa1EQ * t66 + cpa2EQ * t62 + cpa2EQ * t64) * IMz / 4
    t86 = cpa2EQ * t60
    t88 = cpa1EQ * t62
    t90 = cpa1EQ * t64
    t92 = cpa2EQ * t66
    t99 = sin(TL)
    contr[4] = -t44 * t32 * t99 * t28 * t72 * IMz * t30 * (-2 * cpa3EQ * t1 * P2 - 2 * cpa3EQ * t4 * P2 + 2 * P2 * cpa3EQ + 3 * t86 - 3 * t88 + 5 * t90 + t92) / 4
    t105 = t7 + t8
    t108 = t28 * pi
    t111 = sin(t51)
    contr[5] = -3/4 * t44 * t32 * t111 * t25 * IMz * t108 * muM * t30 * t105
    t121 = sin(t74)
    contr[6] = t44 * t32 * t121 * t30 * (t86 - t88 - t90 - t92) * t108 * muM * t48 / 4
    t129 = 1 + eta
    t130 = t129 ^ 2
    t131 = t130 * t129
    t134 = eta + 1/3
    t135 = P1 ^ 2
    t137 = P2 ^ 2
    contr[7] = -t44 * t32 / t131 * t30 * t25 * t28 * muM * pi * (phiTA * t131 * (t7 - t8 - cpa3EQ * (t1 + t4 - 1)) - 3/2 * (-2 * P1 * t105 * P2 + t135 * t15 - t15 * t137) * (t129 * t34 + t135 * t134 + t137 * t134)) * IMz / 2
      
    contr = sum(contr);
    return contr;
end

function derivativechiM3_JhP2(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)    
    contr = zeros(14)
    t1 = cdelta * IMz
    t2 = eta + 1/3
    t3 = Q2 * Q1
    t5 = 2 * cpa2EQ * t3
    t6 = Q1 ^ 2
    t7 = Q2 ^ 2
    t8 = t6 - t7 + 1
    t10 = t8 * cpa1EQ + t5
    t11 = t10 * t2
    t12 = P1 ^ 2
    t13 = t12 ^ 2
    t17 = -t8 / 2
    t19 = cpa1EQ * t3
    t20 = cpa2EQ * t17 + t19
    t23 = t12 * P1 * P2
    t26 = eta ^ 2
    t27 = t10 * t26
    t28 = 1 + eta
    t29 = t12 * t28
    t32 = P2 ^ 2
    t35 = t32 * t2 + t28 * t26
    t37 = P1 * P2
    t40 = t32 ^ 2
    t43 = t32 * t28
    t46 = t28 ^ 2
    t47 = t46 * t28
    t48 = t47 * phiTA
    t52 = 2 * cpa3EQ
    t59 = sqrt(k)
    t60 = t59 * pi
    t61 = cos(psih)
    t66 = sqrt(k + m)
    t67 = 0.1e1 / t66
    t69 = 1 / (t6 + t7 + 1)
    t70 = t69 * t67
    t72 = 0.1e1 / n
    t77 = sma ^ 2
    t84 = 0.1e1 / KK / Jg / t77 / sma / t26 / eta
    t85 = t84 * t72 / t47 * t70
    contr[1] = t85 * t61 * muM * t60 * (3/4 * t13 * t11 + 3 * t23 * t2 * t20 + 3/4 * t29 * t27 + 3 * t37 * t35 * t20 - 3/4 * t40 * t11 - 3/4 * t43 * t27 + (-cpa2EQ * t17 + (Q1 * cpa1EQ + t52) * Q2) * t48) * t1 / 2
    t87 = t59 * muM
    t90 = t67 * IMz
    t93 = 2 * TL
    t94 = t93 - psih
    t95 = cos(t94)
    contr[2] = -3/8 * t84 * t72 * t95 * cdelta * t90 * t69 * cpa1EQ * pi * t87
    t101 = cpa1EQ * t6
    t102 = cpa1EQ * t7
    t108 = t93 + psih
    t109 = cos(t108)
    contr[3] = -3/8 * t84 * t72 * t109 * cdelta * t90 * pi * t69 * (t101 + t5 - t102) * t87
    t115 = muM * t90
    t122 = 3 * TL
    t123 = t122 - psih
    t124 = cos(t123)
    contr[4] = t84 * t72 * t124 * cdelta * t69 * (cpa2EQ * P1 - cpa1EQ * P2) * t60 * t115 / 8
    t129 = t6 * P1
    t131 = Q1 * P1
    t132 = Q2 * cpa1EQ
    t135 = t7 * P1
    t137 = t6 * P2
    t139 = Q1 * P2
    t140 = Q2 * cpa2EQ
    t143 = t7 * P2
    t149 = t122 + psih
    t150 = cos(t149)
    contr[5] = t84 * t72 * t150 * cdelta * t69 * (-cpa1EQ * t137 + cpa1EQ * t143 + cpa2EQ * t129 - cpa2EQ * t135 - 2 * t132 * t131 - 2 * t140 * t139) * t60 * t115 / 8
    t155 = muM * cdelta
    t156 = cpa2EQ * t6
    t157 = t156 / 2
    t158 = cpa2EQ * t7
    t159 = t158 / 2
    t160 = Q2 * cpa3EQ
    t161 = 2 * t160
    t168 = Q1 * (-2 * t140 + 4 * cpa3EQ)
    t175 = -psih + TL
    t176 = cos(t175)
    t178 = IMz * t59
    t182 = t84 * t72 * t70
    contr[6] = -t182 * t178 * pi * t176 * (P1 * (t19 + t157 - t159 + t161 + 2 * cpa2EQ) - (t101 + t168 - t102 - 4 * cpa1EQ) * P2 / 2) * t155 / 4
    t196 = psih + TL
    t197 = cos(t196)
    contr[7] = t182 * t178 * pi * t197 * muM * cdelta * (P1 * (t19 - t156 + t158 - t160 - cpa2EQ / 4) - P2 * (t101 + Q1 * (t140 + cpa3EQ) - t102 - cpa1EQ / 4)) / 2
    t202 = t6 - t7 - 1
    t205 = t19 - t202 * cpa2EQ / 2
    t206 = t2 * t205
    t209 = cpa1EQ * t202
    t210 = t209 + t5
    t214 = t205 * t26
    t232 = sin(psih)
    contr[8] = t85 * t232 * muM * t60 * cdelta * (-3 * t13 * t206 + 3 * t23 * t2 * t210 - 3 * t29 * t214 + 3 * t37 * t35 * t210 + 3 * t40 * t206 + 3 * t43 * t214 + (t209 - 2 * (t140 - t52) * Q1) * t48) * IMz / 4
    t238 = sin(t94)
    contr[9] = -3/8 * t182 * cpa2EQ * t59 * pi * t238 * muM * t1
    t248 = sin(t108)
    t251 = muM * pi * t1
    contr[10] = -3/8 * t84 * t72 * t67 * t59 * t251 * t248 * t69 * (t156 - 2 * t19 - t158)
    t264 = sin(t123)
    contr[11] = -t84 * t72 * t264 * t59 * t251 * t69 * (cpa1EQ * P1 + cpa2EQ * P2) * t67 / 8
    t284 = sin(t149)
    contr[12] = -t84 * t72 * t284 * cdelta * t60 * muM * t67 * IMz * t69 * (cpa1EQ * t129 - cpa1EQ * t135 + cpa2EQ * t137 - cpa2EQ * t143 + 2 * t140 * t131 - 2 * t132 * t139) / 8
    t290 = sin(t175)
    contr[13] = t84 * t72 * t69 * (P1 * (t101 + t168 - t102 + 2 * cpa1EQ) + 2 * P2 * (t19 + t157 - t159 + t161 - cpa2EQ)) * t90 * t60 * t290 * t155 / 8
    t305 = sin(t196)
    contr[14] = t182 * IMz * (P1 * (t101 + Q1 * (4 * t140 - t52) - t102 + cpa1EQ / 2) + 4 * P2 * (t19 - t156 / 4 + t158 / 4 + t160 / 2 + cpa2EQ / 8)) * t60 * t305 * t155 / 4  
    contr = sum(contr)
    return contr
end

function derivativechiM3_psil(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)

   return 0.0;
end

function derivativechiM3_psig(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)
    return 0.0;
end

function derivativechiM3_psih(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)
    contr = zeros(14)
    t1 = eta + 1/3
    t2 = Q2 * Q1
    t4 = 2 * cpa2EQ * t2
    t5 = Q1 ^ 2
    t6 = Q2 ^ 2
    t7 = t5 - t6 + 1
    t9 = t7 * cpa1EQ + t4
    t10 = t9 * t1
    t11 = P1 ^ 2
    t12 = t11 ^ 2
    t16 = -t7 / 2
    t18 = cpa1EQ * t2
    t19 = cpa2EQ * t16 + t18
    t22 = t11 * P1 * P2
    t25 = eta ^ 2
    t26 = t9 * t25
    t27 = 1 + eta
    t28 = t11 * t27
    t31 = P2 ^ 2
    t34 = t31 * t1 + t27 * t25
    t36 = P1 * P2
    t39 = t31 ^ 2
    t42 = t31 * t27
    t45 = t27 ^ 2
    t46 = t45 * t27
    t47 = t46 * phiTA
    t51 = 2 * cpa3EQ
    t58 = sqrt(k)
    t60 = IMz * pi
    t61 = sin(psih)
    t66 = sqrt(k + m)
    t67 = 0.1e1 / t66
    t69 = 1 / (t5 + t6 + 1)
    t70 = t69 * t67
    t71 = 0.1e1 / KK
    t73 = sma ^ 2
    t75 = 0.1e1 / t73 / sma
    t77 = 0.1e1 / t25 / eta
    t79 = 0.1e1 / n
    t83 = 0.1e1 / t46 * t79 * t77 * t75 * t71 * t70
    contr[1] = t83 * t61 * muM * t60 * t58 * sdelta * (3/4 * t12 * t10 + 3 * t22 * t1 * t19 + 3/4 * t28 * t26 + 3 * t36 * t34 * t19 - 3/4 * t39 * t10 - 3/4 * t42 * t26 + (-cpa2EQ * t16 + (Q1 * cpa1EQ + t51) * Q2) * t47) / 2
    t86 = t58 * sdelta * muM
    t90 = t67 * IMz
    t91 = 2 * TL
    t92 = t91 - psih
    t93 = sin(t92)
    t97 = t79 * t77 * t75 * t71
    contr[2] = 3/8 * t97 * t93 * t90 * t69 * cpa1EQ * pi * t86
    t100 = cpa1EQ * t5
    t101 = cpa1EQ * t6
    t106 = t91 + psih
    t107 = sin(t106)
    contr[3] = -3/8 * t97 * t107 * t90 * pi * t69 * (t100 + t4 - t101) * t86
    t112 = IMz * sdelta
    t114 = pi * muM
    t115 = t58 * t114
    t116 = t115 * t67 * t112
    t121 = 3 * TL
    t122 = t121 - psih
    t123 = sin(t122)
    contr[4] = -t97 * t123 * t69 * (cpa2EQ * P1 - cpa1EQ * P2) * t116 / 8
    t128 = t5 * P1
    t130 = P1 * Q1
    t131 = Q2 * cpa1EQ
    t134 = t6 * P1
    t136 = t5 * P2
    t138 = P2 * Q1
    t139 = Q2 * cpa2EQ
    t142 = t6 * P2
    t146 = t121 + psih
    t147 = sin(t146)
    contr[5] = t97 * t147 * t69 * (-cpa1EQ * t136 + cpa1EQ * t142 + cpa2EQ * t128 - cpa2EQ * t134 - 2 * t131 * t130 - 2 * t139 * t138) * t116 / 8
    t151 = cpa2EQ * t5
    t152 = t151 / 2
    t153 = cpa2EQ * t6
    t154 = t153 / 2
    t155 = Q2 * cpa3EQ
    t156 = 2 * t155
    t163 = Q1 * (-2 * t139 + 4 * cpa3EQ)
    t172 = -psih + TL
    t173 = sin(t172)
    contr[6] = t97 * t69 * t173 * t67 * t115 * sdelta * IMz * (P1 * (t18 + t152 - t154 + t156 + 2 * cpa2EQ) - (t100 + t163 - t101 - 4 * cpa1EQ) * P2 / 2) / 4
    t190 = psih + TL
    t191 = sin(t190)
    contr[7] = t97 * t69 * t191 * t67 * t115 * sdelta * (P1 * (t18 - t151 + t153 - t155 - cpa2EQ / 4) - P2 * (t100 + Q1 * (t139 + cpa3EQ) - t101 - cpa1EQ / 4)) * IMz / 2
    t197 = IMz * t58 * sdelta
    t198 = t5 - t6 - 1
    t201 = t18 - t198 * cpa2EQ / 2
    t202 = t1 * t201
    t205 = cpa1EQ * t198
    t206 = t205 + t4
    t210 = t201 * t25
    t227 = cos(psih)
    contr[8] = -t83 * t227 * muM * pi * (-3 * t12 * t202 + 3 * t22 * t1 * t206 - 3 * t28 * t210 + 3 * t36 * t34 * t206 + 3 * t39 * t202 + 3 * t42 * t210 + (t205 - 2 * (t139 - t51) * Q1) * t47) * t197 / 4
    t237 = cos(t92)
    contr[9] = -3/8 * t97 * t67 * t58 * t237 * muM * t69 * cpa2EQ * pi * t112
    t247 = cos(t106)
    contr[10] = 3/8 * t97 * t247 * t70 * (t151 - 2 * t18 - t153) * t60 * t86
    t253 = cos(t122)
    contr[11] = -t97 * t69 * (cpa1EQ * P1 + cpa2EQ * P2) * pi * IMz * sdelta * t253 * t58 * muM * t67 / 8
    t279 = cos(t146)
    contr[12] = t97 * t279 * t58 * pi * muM * t90 * sdelta * t69 * (cpa1EQ * t128 - cpa1EQ * t134 + cpa2EQ * t136 - cpa2EQ * t142 + 2 * t139 * t130 - 2 * t131 * t138) / 8
    t283 = cos(t172)
    contr[13] = t97 * t69 * (P1 * (t100 + t163 - t101 + 2 * cpa1EQ) + 2 * P2 * (t18 + t152 - t154 + t156 - cpa2EQ)) * t283 * t116 / 8
    t311 = cos(t190)
    contr[14] = -t97 * t69 * t311 * t67 * (P1 * (t100 + Q1 * (4 * t139 - t51) - t101 + cpa1EQ / 2) + 4 * P2 * (t18 - t151 / 4 + t153 / 4 + t155 / 2 + cpa2EQ / 8)) * t114 * t197 / 4   
    contr = sum(contr)
    return contr
end

function derivativechiM3_cdeltapsigMpsihOsdelta(k,m,KK,EE,KP,EP,PP,q,FA,EA,sigma,M4,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,B,C)
    
    contr = zeros(14);
    t1 = sin(psih)
    t4 = eta + 1/3
    t5 = Q1 * Q2
    t7 = 2 * cpa2EQ * t5
    t8 = Q1 ^ 2
    t9 = Q2 ^ 2
    t10 = t8 - t9 + 1
    t12 = t10 * cpa1EQ + t7
    t13 = t12 * t4
    t14 = P1 ^ 2
    t15 = t14 ^ 2
    t19 = -t10 / 2
    t21 = cpa1EQ * t5
    t22 = cpa2EQ * t19 + t21
    t25 = t14 * P1 * P2
    t28 = eta ^ 2
    t29 = t12 * t28
    t30 = 1 + eta
    t31 = t14 * t30
    t34 = P2 ^ 2
    t37 = t30 * t28 + t34 * t4
    t39 = P1 * P2
    t42 = t34 ^ 2
    t45 = t34 * t30
    t48 = t30 ^ 2
    t49 = t48 * t30
    t50 = t49 * phiTA
    t54 = 2 * cpa3EQ
    t61 = sqrt(k)
    t65 = sqrt(k + m)
    t66 = 0.1e1 / t65
    t68 = 1 / (t8 + t9 + 1)
    t72 = 0.1e1 / n
    t74 = 0.1e1 / t28 / eta
    t76 = sma ^ 2
    t78 = 0.1e1 / t76 / sma
    t79 = 0.1e1 / KK
    t82 = t79 * t78 * t74 * t72 / t49 * t68 * t66
    contr[1] = -t82 * t61 * (3/4 * t15 * t13 + 3 * t25 * t4 * t22 + 3/4 * t31 * t29 + 3 * t39 * t37 * t22 - 3/4 * t42 * t13 - 3/4 * t45 * t29 + (-cpa2EQ * t19 + (Q1 * cpa1EQ + t54) * Q2) * t50) * muM * pi * t1 * IMz / 2
    t85 = t61 * muM
    t86 = pi * t85
    t90 = 2 * TL
    t91 = t90 - psih
    t92 = sin(t91)
    t96 = t79 * t78 * t74
    contr[2] = -3/8 * t96 * t72 * t92 * t66 * IMz * t68 * cpa1EQ * t86
    t100 = cpa1EQ * t8
    t101 = cpa1EQ * t9
    t104 = pi * t68
    t107 = t90 + psih
    t108 = sin(t107)
    contr[3] = 3/8 * t96 * t72 * t108 * t66 * IMz * t104 * (t100 + t7 - t101) * t85
    t114 = muM * t66 * IMz
    t115 = t61 * pi
    t121 = 3 * TL
    t122 = t121 - psih
    t123 = sin(t122)
    contr[4] = t96 * t72 * t123 * t68 * (cpa2EQ * P1 - cpa1EQ * P2) * t115 * t114 / 8
    t128 = t8 * P1
    t130 = P1 * Q1
    t131 = Q2 * cpa1EQ
    t134 = t9 * P1
    t136 = t8 * P2
    t138 = P2 * Q1
    t139 = Q2 * cpa2EQ
    t142 = t9 * P2
    t147 = t121 + psih
    t148 = sin(t147)
    contr[5] = -t96 * t72 * t148 * t68 * (-cpa1EQ * t136 + cpa1EQ * t142 + cpa2EQ * t128 - cpa2EQ * t134 - 2 * t131 * t130 - 2 * t139 * t138) * t115 * t114 / 8
    t154 = cpa2EQ * t8
    t155 = t154 / 2
    t156 = cpa2EQ * t9
    t157 = t156 / 2
    t158 = Q2 * cpa3EQ
    t159 = 2 * t158
    t166 = Q1 * (-2 * t139 + 4 * cpa3EQ)
    t174 = pi * muM
    t175 = -psih + TL
    t176 = sin(t175)
    t181 = t96 * t72 * t68 * t61
    contr[6] = -t181 * t176 * t174 * t66 * (P1 * (t21 + t155 - t157 + t159 + 2 * cpa2EQ) - (t100 + t166 - t101 - 4 * cpa1EQ) * P2 / 2) * IMz / 4
    t184 = psih + TL
    t185 = sin(t184)
    contr[7] = -t181 * (P1 * (t21 - t154 + t156 - t158 - cpa2EQ / 4) - P2 * (t100 + Q1 * (t139 + cpa3EQ) - t101 - cpa1EQ / 4)) * t185 * pi * t114 / 2
    t200 = t8 - t9 - 1
    t203 = t21 - t200 * cpa2EQ / 2
    t204 = t4 * t203
    t207 = cpa1EQ * t200
    t208 = t207 + t7
    t212 = t203 * t28
    t229 = cos(psih)
    contr[8] = t82 * t86 * t229 * (-3 * t15 * t204 + 3 * t25 * t4 * t208 - 3 * t31 * t212 + 3 * t39 * t37 * t208 + 3 * t42 * t204 + 3 * t45 * t212 + (t207 - 2 * (t139 - t54) * Q1) * t50) * IMz / 4
    t233 = cos(t91)
    contr[9] = 3/8 * t96 * t72 * t66 * t61 * muM * t104 * cpa2EQ * IMz * t233
    t247 = cos(t107)
    contr[10] = -3/8 * t96 * t72 * t247 * t66 * t68 * (t154 - 2 * t21 - t156) * IMz * t86
    t253 = cos(t122)
    contr[11] = t96 * t72 * pi * IMz * t66 * t68 * (cpa1EQ * P1 + cpa2EQ * P2) * t61 * muM * t253 / 8
    t280 = cos(t147)
    contr[12] = -t96 * t72 * t280 * t61 * pi * muM * t66 * IMz * t68 * (cpa1EQ * t128 - cpa1EQ * t134 + cpa2EQ * t136 - cpa2EQ * t142 + 2 * t139 * t130 - 2 * t131 * t138) / 8
    t294 = cos(t175)
    contr[13] = -t181 * t294 * pi * (P1 * (t100 + t166 - t101 + 2 * cpa1EQ) + 2 * P2 * (t21 + t155 - t157 + t159 - cpa2EQ)) * t114 / 8
    t315 = cos(t184)
    contr[14] = t181 * t315 * t174 * t66 * IMz * (P1 * (t100 + Q1 * (4 * t139 - t54) - t101 + cpa1EQ / 2) + 4 * P2 * (t21 - t154 / 4 + t156 / 4 + t158 / 2 + cpa2EQ / 8)) / 4   
    contr = sum(contr);
    return contr;
end

###############################################################################################################################################################################################
# case k=0 smk!=0

function derivativechiM2_psil_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    contr = zeros(54)
    t1 = sqrt(smk)
    t3 = cos(psil)
    t6 = Q1 ^ 2
    t7 = Q2 ^ 2
    t11 = Q2 * cpa2EQ
    t13 = muM * (cpa3EQ * (t6 + t7 - 1) - Q1 * cpa1EQ + t11)
    t15 = 1 / (t6 + t7 + 1)
    t16 = rc ^ 2
    t18 = 0.1e1 / t16 / rc
    t19 = t18 * t15
    t20 = 0.1e1 / npsil
    t22 = t20 * t19 * t13
    contr[1] = t22 * cdelta * t3 * IMx * t1
    t23 = psig - psil
    t24 = cos(t23)
    t26 = sqrt(skm)
    t27 = t26 - 1
    t28 = t27 * sdelta
    t30 = npsil - npsig
    t33 = 1 / t30 * t19 * t13
    contr[2] = t33 * t28 * IMx * t24 / 2
    t35 = t26 + 1
    t36 = psig + psil
    t37 = cos(t36)
    t42 = 0.1e1 / (npsil + npsig)
    t44 = t42 * t19 * t13
    contr[3] = t44 * IMx * sdelta * t37 * t35 / 2
    t46 = t1 * cdelta
    t47 = Q1 * IMx
    t48 = cpa1EQ * t47
    t49 = Q2 * IMx
    t50 = cpa2EQ * t49
    t51 = Q1 * IMy
    t52 = cpa2EQ * t51
    t53 = Q2 * IMy
    t54 = cpa1EQ * t53
    t55 = t48 + t50 - t52 + t54
    t56 = t55 * muM
    t58 = 2 * TL
    t59 = -psil + t58
    t60 = cos(t59)
    t62 = t20 * t18
    contr[4] = -3/2 * t62 * t60 * t15 * t56 * t46
    t66 = -psil + psih
    t67 = cos(t66)
    t76 = -2 * Q1 * Q2 * cpa1EQ - 4 * Q2 * cpa3EQ - cpa2EQ * t6 + cpa2EQ * t7 - cpa2EQ
    t84 = cpa1EQ * t6 + Q1 * (-2 * t11 + 4 * cpa3EQ) - cpa1EQ * t7 - cpa1EQ
    t85 = t84 * IMy
    t87 = (IMx * t76 + t85) * muM
    t89 = t15 * sdelta
    t90 = t62 * t89
    contr[5] = t90 * t87 * t67 * t1 / 4
    t92 = t48 + t50 + t52 - t54
    t93 = t92 * muM
    t95 = psil + t58
    t96 = cos(t95)
    contr[6] = -3/2 * t62 * t96 * t15 * t93 * t46
    t101 = psil + psih
    t102 = cos(t101)
    t104 = muM * sdelta
    t106 = -t76
    t108 = IMx * t106 + t85
    contr[7] = -t62 * t15 * t108 * t104 * t102 * t1 / 4
    t115 = t58 - psig - psil
    t116 = cos(t115)
    t118 = t42 * t18
    contr[8] = -3/4 * t118 * t116 * t15 * t55 * t35 * t104
    t123 = t58 - psig + psil
    t124 = cos(t123)
    t128 = -1 / t30 * t18
    contr[9] = 3/4 * t128 * t124 * t15 * t93 * t28
    t132 = t58 + psig - psil
    t133 = cos(t132)
    contr[10] = 3/4 * t128 * t133 * t15 * t56 * t28
    t139 = t58 + psig + psil
    t140 = cos(t139)
    contr[11] = -3/4 * t118 * t140 * t15 * t92 * t35 * t104
    t146 = -psih + psig - psil
    t147 = cos(t146)
    t150 = cdelta - 1
    t151 = t15 * t150
    t152 = t128 * t151
    contr[12] = -t152 * t147 * muM * t27 * t108 / 8
    t155 = -psih + psig + psil
    t156 = cos(t155)
    t159 = t118 * t151
    contr[13] = -t159 * t35 * t156 * t87 / 8
    t162 = t1 * sdelta
    t163 = IMx * cpa2EQ
    t164 = IMy * cpa1EQ
    t165 = t163 + t164
    t166 = t165 * muM
    t168 = -psih - psil + t58
    t169 = cos(t168)
    contr[14] = 3/4 * t62 * t169 * t15 * t166 * t162
    t174 = t15 * (t163 - t164)
    t176 = -psih + psil + t58
    t177 = cos(t176)
    contr[15] = 3/4 * t62 * t177 * muM * t174 * t162
    t181 = cdelta + 1
    t182 = t27 * t181
    t184 = psih + psig - psil
    t185 = cos(t184)
    contr[16] = t128 * t15 * t185 * t87 * t182 / 8
    t190 = psih + psig + psil
    t191 = cos(t190)
    t194 = t15 * t35
    t195 = t118 * t194
    contr[17] = t195 * t191 * muM * t108 * t181 / 8
    t197 = t6 * IMx
    t198 = cpa2EQ * t197
    t199 = Q2 * cpa1EQ
    t201 = 2 * t199 * t47
    t202 = t7 * IMx
    t203 = cpa2EQ * t202
    t204 = t6 * IMy
    t205 = cpa1EQ * t204
    t207 = 2 * t11 * t51
    t208 = t7 * IMy
    t209 = cpa1EQ * t208
    t210 = t198 - t201 - t203 + t205 + t207 - t209
    t213 = psih - psil + t58
    t214 = cos(t213)
    contr[18] = 3/4 * t62 * t214 * t15 * t210 * muM * t162
    t219 = t15 * (t198 - t201 - t203 - t205 - t207 + t209)
    t221 = psih + psil + t58
    t222 = cos(t221)
    contr[19] = 3/4 * t62 * t222 * muM * t162 * t219
    t226 = muM * t35
    t229 = -psig - psil + t58 - psih
    t230 = cos(t229)
    contr[20] = -3/8 * t118 * t230 * t15 * t165 * t181 * t226
    t235 = -psig - psil + t58 + psih
    t236 = cos(t235)
    t238 = t150 * t35
    t240 = t15 * t210
    contr[21] = -3/8 * t118 * t240 * t238 * muM * t236
    t244 = -psig + psil + t58 - psih
    t245 = cos(t244)
    contr[22] = 3/8 * t128 * t174 * t182 * muM * t245
    t250 = -psig + psil + t58 + psih
    t251 = cos(t250)
    t254 = t150 * t27
    t255 = t128 * t254
    contr[23] = 3/8 * t255 * t219 * muM * t251
    t258 = psig - psil + t58 - psih
    t259 = cos(t258)
    contr[24] = 3/8 * t128 * t259 * t15 * t166 * t254
    t263 = psig - psil + t58 + psih
    t264 = cos(t263)
    contr[25] = 3/8 * t128 * t240 * t182 * muM * t264
    t269 = psig + psil + t58 - psih
    t270 = cos(t269)
    contr[26] = -3/8 * t118 * t174 * t238 * muM * t270
    t276 = psig + psil + t58 + psih
    t277 = cos(t276)
    contr[27] = -3/8 * t118 * t181 * t35 * t219 * muM * t277
    t285 = sin(psil)
    contr[28] = -t22 * cdelta * t285 * IMy * t1
    t289 = sin(t23)
    t291 = IMy * sdelta
    contr[29] = t33 * t291 * t289 * t27 / 2
    t294 = sin(t36)
    contr[30] = -t44 * t291 * t294 * t35 / 2
    t299 = cpa2EQ * t47
    t300 = cpa1EQ * t49
    t301 = cpa1EQ * t51
    t302 = cpa2EQ * t53
    t303 = t299 - t300 + t301 + t302
    t304 = t303 * muM
    t306 = sin(t59)
    contr[31] = -3/2 * t62 * t306 * t15 * t304 * t46
    t311 = sin(t66)
    t314 = IMx * t84
    t315 = t106 * IMy
    t316 = t314 + t315
    contr[32] = -t62 * t15 * t316 * t104 * t311 * t1 / 4
    t321 = t299 - t300 - t301 - t302
    t322 = t15 * t321
    t324 = sin(t95)
    contr[33] = -3/2 * t62 * t324 * muM * t322 * t46
    t329 = t314 - t315
    t331 = sin(t101)
    contr[34] = -t90 * muM * t331 * t329 * t1 / 4
    t338 = sin(t115)
    contr[35] = -3/4 * t118 * t338 * t15 * t303 * t35 * t104
    t344 = sin(t123)
    contr[36] = 3/4 * t128 * t344 * muM * t322 * t28
    t349 = sin(t132)
    contr[37] = 3/4 * t128 * t349 * t15 * t304 * t28
    t354 = muM * t15
    t356 = sin(t139)
    contr[38] = -3/4 * t118 * t356 * t35 * t354 * t321 * sdelta
    t362 = sin(t146)
    contr[39] = t152 * t362 * muM * t329 * t27 / 8
    t366 = muM * t316
    t367 = sin(t155)
    contr[40] = -t159 * t35 * t367 * t366 / 8
    t372 = IMx * cpa1EQ
    t373 = IMy * cpa2EQ
    t374 = t372 - t373
    t377 = sin(t168)
    contr[41] = -3/4 * t62 * t377 * t15 * t374 * muM * t162
    t382 = t372 + t373
    t385 = sin(t176)
    contr[42] = -3/4 * t62 * t385 * muM * t89 * t382 * t1
    t391 = sin(t184)
    contr[43] = -t128 * t15 * t391 * t366 * t182 / 8
    t397 = sin(t190)
    contr[44] = t195 * t397 * muM * t329 * t181 / 8
    t401 = cpa1EQ * t197
    t403 = 2 * t11 * t47
    t404 = cpa1EQ * t202
    t405 = cpa2EQ * t204
    t407 = 2 * t199 * t51
    t408 = cpa2EQ * t208
    t409 = t401 + t403 - t404 - t405 + t407 + t408
    t412 = sin(t213)
    contr[45] = -3/4 * t62 * t412 * t15 * t409 * muM * t162
    t418 = t15 * (t401 + t403 - t404 + t405 - t407 - t408)
    t420 = sin(t221)
    contr[46] = -3/4 * t62 * t420 * muM * t418 * t162
    t425 = sin(t229)
    t429 = t181 * t15
    contr[47] = 3/8 * t118 * t429 * t374 * t35 * muM * t425
    t432 = sin(t235)
    contr[48] = 3/8 * t118 * t15 * t409 * t238 * muM * t432
    t440 = sin(t244)
    contr[49] = -3/8 * t128 * t440 * t181 * t354 * t382 * t27
    t446 = sin(t250)
    contr[50] = -3/8 * t128 * t446 * muM * t418 * t254
    t451 = sin(t258)
    contr[51] = -3/8 * t255 * t15 * t374 * muM * t451
    t457 = sin(t263)
    contr[52] = -3/8 * t128 * t429 * t409 * t27 * muM * t457
    t466 = sin(t269)
    contr[53] = 3/8 * t118 * t466 * muM * t194 * t382 * t150
    t471 = sin(t276)
    contr[54] = 3/8 * t118 * t471 * t181 * t226 * t418
    contr = sum(contr)
    return contr;
end

function derivativechiM2_psig_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    contr = zeros(53)
    t1 = sqrt(smk)
    t2 = IMz * t1
    t4 = Q2 * cpa1EQ
    t6 = Q1 ^ 2
    t7 = Q2 ^ 2
    t9 = 1 / (t6 + t7 + 1)
    t11 = t9 * (Q1 * cpa2EQ - t4) * t2
    t12 = muM * sdelta
    t13 = 2 * TL
    t14 = -psig + t13
    t15 = sin(t14)
    t16 = rc ^ 2
    t18 = 0.1e1 / t16 / rc
    t20 = 0.1e1 / npsig
    contr[1] = 3/2 * t20 * t18 * t15 * t12 * t11
    t24 = psig + t13
    t25 = sin(t24)
    contr[2] = 3/2 * t20 * t18 * t25 * t12 * t11
    t30 = cpa1EQ * t6
    t31 = Q1 * Q2
    t33 = 2 * cpa2EQ * t31
    t34 = cpa1EQ * t7
    t37 = 4 * Q1 * cpa3EQ - cpa1EQ + t30 - t33 - t34
    t40 = cdelta - 1
    t41 = t40 * t9
    t42 = psig - psih
    t43 = sin(t42)
    contr[3] = t20 * t18 * t43 * t41 * t37 * muM * t2 / 4
    t48 = cdelta + 1
    t49 = t48 * t1
    t50 = IMz * muM
    t53 = psig + psih
    t54 = sin(t53)
    contr[4] = -t20 * t18 * t54 * t9 * t37 * t50 * t49 / 4
    t60 = psig - psil
    t61 = cos(t60)
    t63 = sqrt(skm)
    t64 = t63 - 1
    t65 = t64 * sdelta
    t69 = Q1 * cpa1EQ
    t70 = Q2 * cpa2EQ
    t71 = cpa3EQ * (t6 + t7 - 1) - t69 + t70
    t72 = muM * t71
    t73 = t18 * t9
    t74 = npsil - npsig
    t77 = 0.1e1 / t74 * t73 * t72
    contr[5] = -t77 * t65 * IMx * t61 / 2
    t80 = t63 + 1
    t81 = psig + psil
    t82 = cos(t81)
    t87 = 0.1e1 / (npsil + npsig)
    t89 = t87 * t73 * t72
    contr[6] = t89 * IMx * sdelta * t82 * t80 / 2
    t91 = Q1 * IMx
    t92 = cpa1EQ * t91
    t93 = Q2 * IMx
    t94 = cpa2EQ * t93
    t95 = Q1 * IMy
    t96 = cpa2EQ * t95
    t97 = Q2 * IMy
    t98 = cpa1EQ * t97
    t99 = t92 + t94 - t96 + t98
    t102 = t13 - psig - psil
    t103 = cos(t102)
    t105 = t87 * t18
    contr[7] = -3/4 * t105 * t103 * t9 * t99 * t80 * t12
    t109 = t92 + t94 + t96 - t98
    t112 = t13 - psig + psil
    t113 = cos(t112)
    t117 = -0.1e1 / t74 * t18
    contr[8] = -3/4 * t117 * t113 * t9 * t109 * muM * t65
    t123 = t13 + psig - psil
    t124 = cos(t123)
    contr[9] = -3/4 * t117 * t124 * t9 * t99 * muM * t65
    t131 = t13 + psig + psil
    t132 = cos(t131)
    contr[10] = -3/4 * t105 * t132 * t9 * t109 * t80 * t12
    t140 = -psih - psig + t13
    t141 = sin(t140)
    t144 = t20 * t18 * IMz
    contr[11] = -3/4 * t144 * muM * t141 * t1 * t9 * cpa1EQ * t48
    t149 = -psih + psig + t13
    t150 = sin(t149)
    t153 = t40 * muM
    t154 = t144 * t153
    contr[12] = -3/4 * t154 * t150 * t1 * t9 * cpa1EQ
    t157 = cpa2EQ * t6
    t159 = 2 * cpa1EQ * t31
    t160 = cpa2EQ * t7
    t163 = 4 * Q2 * cpa3EQ + cpa2EQ + t157 + t159 - t160
    t169 = t30 + Q1 * (-2 * t70 + 4 * cpa3EQ) - t34 - cpa1EQ
    t170 = t169 * IMy
    t171 = IMx * t163 + t170
    t173 = -psih + psig - psil
    t174 = cos(t173)
    t177 = t117 * t41
    contr[13] = t177 * t174 * muM * t64 * t171 / 8
    t182 = muM * (-IMx * t163 + t170)
    t183 = -psih + psig + psil
    t184 = cos(t183)
    t187 = t105 * t41
    contr[14] = -t187 * t80 * t184 * t182 / 8
    t191 = t9 * (t30 + t33 - t34)
    t192 = psih - psig + t13
    t193 = sin(t192)
    contr[15] = -3/4 * t154 * t193 * t1 * t191
    t199 = psih + psig + t13
    t200 = sin(t199)
    contr[16] = -3/4 * t144 * muM * t200 * t49 * t191
    t205 = t64 * t48
    t207 = psih + psig - psil
    t208 = cos(t207)
    contr[17] = -t117 * t9 * t208 * t182 * t205 / 8
    t214 = psih + psig + psil
    t215 = cos(t214)
    t218 = t9 * t80
    t219 = t105 * t218
    contr[18] = t219 * t215 * muM * t171 * t48 / 8
    t221 = muM * t80
    t222 = IMx * cpa2EQ
    t223 = IMy * cpa1EQ
    t224 = t222 + t223
    t227 = -psig - psil + t13 - psih
    t228 = cos(t227)
    contr[19] = -3/8 * t105 * t228 * t9 * t224 * t48 * t221
    t233 = -psig - psil + t13 + psih
    t234 = cos(t233)
    t236 = t40 * t80
    t238 = t6 * IMx
    t239 = cpa2EQ * t238
    t241 = 2 * t4 * t91
    t242 = t7 * IMx
    t243 = cpa2EQ * t242
    t244 = t6 * IMy
    t245 = cpa1EQ * t244
    t247 = 2 * t70 * t95
    t248 = t7 * IMy
    t249 = cpa1EQ * t248
    t251 = t9 * (t239 - t241 - t243 + t245 + t247 - t249)
    contr[20] = -3/8 * t105 * t251 * t236 * muM * t234
    t255 = -psig + psil + t13 - psih
    t256 = cos(t255)
    t260 = t9 * (t222 - t223)
    contr[21] = -3/8 * t117 * t260 * t205 * muM * t256
    t264 = -psig + psil + t13 + psih
    t265 = cos(t264)
    t268 = t9 * (t239 - t241 - t243 - t245 - t247 + t249)
    t270 = t40 * t64
    t271 = t117 * t270
    contr[22] = -3/8 * t271 * t268 * muM * t265
    t276 = psig - psil + t13 - psih
    t277 = cos(t276)
    contr[23] = -3/8 * t117 * t277 * t9 * t224 * muM * t270
    t282 = psig - psil + t13 + psih
    t283 = cos(t282)
    contr[24] = -3/8 * t117 * t251 * t205 * muM * t283
    t289 = psig + psil + t13 - psih
    t290 = cos(t289)
    contr[25] = -3/8 * t105 * t260 * t236 * muM * t290
    t296 = psig + psil + t13 + psih
    t297 = cos(t296)
    contr[26] = -3/8 * t105 * t48 * t80 * t268 * muM * t297
    t305 = cos(psig)
    contr[27] = -t20 * t73 * t2 * t305 * muM * sdelta * t71
    t311 = t12 * t2
    t313 = t9 * (t69 + t70)
    t314 = cos(t14)
    contr[28] = 3/2 * t20 * t18 * t314 * t313 * t311
    t319 = cos(t24)
    contr[29] = 3/2 * t20 * t18 * t319 * t313 * t311
    t327 = cos(t42)
    contr[30] = -t20 * t18 * t327 * t153 * IMz * t9 * t163 * t1 / 4
    t335 = cos(t53)
    contr[31] = -t20 * t18 * t335 * t50 * t9 * t163 * t49 / 4
    t341 = sin(t60)
    t343 = IMy * sdelta
    contr[32] = -t77 * t343 * t341 * t64 / 2
    t347 = sin(t81)
    contr[33] = -t89 * t343 * t347 * t80 / 2
    t352 = cpa2EQ * t91
    t353 = cpa1EQ * t93
    t354 = cpa1EQ * t95
    t355 = cpa2EQ * t97
    t356 = t352 - t353 + t354 + t355
    t359 = sin(t102)
    contr[34] = -3/4 * t105 * t359 * t9 * t356 * t80 * t12
    t364 = t352 - t353 - t354 - t355
    t367 = sin(t112)
    contr[35] = -3/4 * t117 * t367 * muM * t9 * t364 * t65
    t374 = sin(t123)
    contr[36] = -3/4 * t117 * t374 * t9 * t356 * muM * t65
    t380 = muM * t9
    t382 = sin(t131)
    contr[37] = -3/4 * t105 * t382 * t80 * t380 * t364 * sdelta
    t387 = t9 * cpa2EQ
    t389 = cos(t140)
    contr[38] = 3/4 * t144 * muM * t389 * t49 * t387
    t393 = cos(t149)
    contr[39] = 3/4 * t154 * t393 * t1 * t387
    t397 = IMx * t169
    t398 = t163 * IMy
    t399 = t397 - t398
    t401 = sin(t173)
    contr[40] = -t177 * t401 * muM * t399 * t64 / 8
    t407 = muM * (t397 + t398)
    t408 = sin(t183)
    contr[41] = -t187 * t80 * t408 * t407 / 8
    t413 = cos(t192)
    t415 = t157 - t159 - t160
    contr[42] = 3/4 * t154 * t9 * t415 * t413 * t1
    t419 = cos(t199)
    contr[43] = 3/4 * t144 * t380 * t415 * t419 * t49
    t425 = sin(t207)
    contr[44] = t117 * t9 * t425 * t407 * t205 / 8
    t430 = sin(t214)
    contr[45] = t219 * t430 * muM * t399 * t48 / 8
    t434 = sin(t227)
    t436 = IMx * cpa1EQ
    t437 = IMy * cpa2EQ
    t438 = t436 - t437
    t441 = t48 * t9
    contr[46] = 3/8 * t105 * t441 * t438 * t80 * muM * t434
    t444 = sin(t233)
    t447 = cpa1EQ * t238
    t449 = 2 * t70 * t91
    t450 = cpa1EQ * t242
    t451 = cpa2EQ * t244
    t453 = 2 * t4 * t95
    t454 = cpa2EQ * t248
    t455 = t447 + t449 - t450 - t451 + t453 + t454
    contr[47] = 3/8 * t105 * t9 * t455 * t236 * muM * t444
    t459 = t436 + t437
    t462 = sin(t255)
    contr[48] = 3/8 * t117 * t462 * t48 * t380 * t459 * t64
    t467 = t9 * (t447 + t449 - t450 + t451 - t453 - t454)
    t469 = sin(t264)
    contr[49] = 3/8 * t117 * t469 * muM * t467 * t270
    t473 = sin(t276)
    contr[50] = 3/8 * t271 * t9 * t438 * muM * t473
    t478 = sin(t282)
    contr[51] = 3/8 * t117 * t441 * t455 * t64 * muM * t478
    t486 = sin(t289)
    contr[52] = 3/8 * t105 * t486 * muM * t218 * t459 * t40
    t491 = sin(t296)
    contr[53] = 3/8 * t105 * t491 * t48 * t221 * t467
    contr = sum(contr)
    return contr
end

function derivativechiM2_psih_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    contr = zeros(48)
    t1 = sqrt(smk)
    t3 = Q1 ^ 2
    t4 = cpa1EQ * t3
    t5 = Q1 * Q2
    t7 = 2 * cpa2EQ * t5
    t8 = Q2 ^ 2
    t9 = cpa1EQ * t8
    t12 = 4 * Q1 * cpa3EQ - cpa1EQ + t4 - t7 - t9
    t16 = 1 / (t3 + t8 + 1)
    t17 = cdelta - 1
    t18 = t17 * t16
    t19 = psig - psih
    t20 = sin(t19)
    t21 = rc ^ 2
    t23 = 0.1e1 / t21 / rc
    t25 = 0.1e1 / npsig
    contr[1] = -t25 * t23 * t20 * t18 * t12 * muM * IMz * t1 / 4
    t30 = cdelta + 1
    t31 = t30 * t1
    t32 = IMz * muM
    t35 = psig + psih
    t36 = sin(t35)
    contr[2] = -t25 * t23 * t36 * t16 * t12 * t32 * t31 / 4
    t42 = -psil + psih
    t43 = cos(t42)
    t45 = cpa2EQ * t3
    t47 = 2 * cpa1EQ * t5
    t48 = cpa2EQ * t8
    t51 = -4 * Q2 * cpa3EQ - cpa2EQ - t45 - t47 + t48
    t53 = Q2 * cpa2EQ
    t58 = t4 + Q1 * (-2 * t53 + 4 * cpa3EQ) - t9 - cpa1EQ
    t59 = t58 * IMy
    t61 = (IMx * t51 + t59) * muM
    t63 = t16 * sdelta
    t65 = 0.1e1 / npsil * t23
    t66 = t65 * t63
    contr[3] = -t66 * t61 * t43 * t1 / 4
    t69 = psil + psih
    t70 = cos(t69)
    t72 = muM * sdelta
    t74 = -t51
    t76 = IMx * t74 + t59
    contr[4] = -t65 * t16 * t76 * t72 * t70 * t1 / 4
    t84 = 2 * TL
    t85 = -psih - psig + t84
    t86 = sin(t85)
    t89 = t25 * t23 * IMz
    contr[5] = -3/4 * t89 * muM * t86 * t1 * t16 * cpa1EQ * t30
    t94 = -psih + psig + t84
    t95 = sin(t94)
    t98 = t17 * muM
    t99 = t89 * t98
    contr[6] = 3/4 * t99 * t95 * t1 * t16 * cpa1EQ
    t101 = sqrt(skm)
    t102 = t101 - 1
    t104 = -psih + psig - psil
    t105 = cos(t104)
    t110 = 0.1e1 / (-npsil + npsig) * t23
    t111 = t110 * t18
    contr[7] = -t111 * t105 * muM * t102 * t76 / 8
    t114 = -psih + psig + psil
    t115 = cos(t114)
    t116 = t101 + 1
    t121 = 0.1e1 / (npsil + npsig) * t23
    t122 = t121 * t18
    contr[8] = t122 * t116 * t115 * t61 / 8
    t124 = t1 * sdelta
    t125 = IMx * cpa2EQ
    t126 = IMy * cpa1EQ
    t127 = t125 + t126
    t128 = t127 * muM
    t130 = -psih - psil + t84
    t131 = cos(t130)
    contr[9] = 3/4 * t65 * t131 * t16 * t128 * t124
    t136 = t16 * (t125 - t126)
    t138 = -psih + psil + t84
    t139 = cos(t138)
    contr[10] = -3/4 * t65 * t139 * muM * t136 * t124
    t145 = t16 * (t4 + t7 - t9)
    t146 = psih - psig + t84
    t147 = sin(t146)
    contr[11] = 3/4 * t99 * t147 * t1 * t145
    t152 = psih + psig + t84
    t153 = sin(t152)
    contr[12] = -3/4 * t89 * muM * t153 * t31 * t145
    t158 = t102 * t30
    t160 = psih + psig - psil
    t161 = cos(t160)
    contr[13] = -t110 * t16 * t161 * t61 * t158 / 8
    t167 = psih + psig + psil
    t168 = cos(t167)
    t171 = t16 * t116
    t172 = t121 * t171
    contr[14] = t172 * t168 * muM * t76 * t30 / 8
    t174 = t3 * IMx
    t175 = cpa2EQ * t174
    t176 = Q1 * IMx
    t177 = Q2 * cpa1EQ
    t179 = 2 * t177 * t176
    t180 = t8 * IMx
    t181 = cpa2EQ * t180
    t182 = t3 * IMy
    t183 = cpa1EQ * t182
    t184 = Q1 * IMy
    t186 = 2 * t53 * t184
    t187 = t8 * IMy
    t188 = cpa1EQ * t187
    t189 = t175 - t179 - t181 + t183 + t186 - t188
    t192 = psih - psil + t84
    t193 = cos(t192)
    contr[15] = -3/4 * t65 * t193 * t16 * t189 * muM * t124
    t199 = t16 * (t175 - t179 - t181 - t183 - t186 + t188)
    t201 = psih + psil + t84
    t202 = cos(t201)
    contr[16] = 3/4 * t65 * t202 * muM * t124 * t199
    t206 = muM * t116
    t209 = -psig - psil + t84 - psih
    t210 = cos(t209)
    contr[17] = -3/8 * t121 * t210 * t16 * t127 * t30 * t206
    t215 = -psig - psil + t84 + psih
    t216 = cos(t215)
    t218 = t17 * t116
    t220 = t16 * t189
    contr[18] = 3/8 * t121 * t220 * t218 * muM * t216
    t223 = -psig + psil + t84 - psih
    t224 = cos(t223)
    contr[19] = -3/8 * t110 * t136 * t158 * muM * t224
    t230 = -psig + psil + t84 + psih
    t231 = cos(t230)
    t234 = t17 * t102
    t235 = t110 * t234
    contr[20] = 3/8 * t235 * t199 * muM * t231
    t238 = psig - psil + t84 - psih
    t239 = cos(t238)
    contr[21] = 3/8 * t110 * t239 * t16 * t128 * t234
    t243 = psig - psil + t84 + psih
    t244 = cos(t243)
    contr[22] = -3/8 * t110 * t220 * t158 * muM * t244
    t250 = psig + psil + t84 - psih
    t251 = cos(t250)
    contr[23] = 3/8 * t121 * t136 * t218 * muM * t251
    t256 = psig + psil + t84 + psih
    t257 = cos(t256)
    contr[24] = -3/8 * t121 * t30 * t116 * t199 * muM * t257
    t267 = cos(t19)
    contr[25] = t25 * t23 * t267 * t98 * IMz * t16 * t74 * t1 / 4
    t274 = cos(t35)
    contr[26] = -t25 * t23 * t274 * t32 * t16 * t74 * t31 / 4
    t280 = sin(t42)
    t283 = IMx * t58
    t284 = t74 * IMy
    t285 = t283 + t284
    contr[27] = t65 * t16 * t285 * t72 * t280 * t1 / 4
    t289 = t283 - t284
    t291 = sin(t69)
    contr[28] = -t66 * muM * t291 * t289 * t1 / 4
    t296 = t16 * cpa2EQ
    t298 = cos(t85)
    contr[29] = 3/4 * t89 * muM * t298 * t31 * t296
    t302 = cos(t94)
    contr[30] = -3/4 * t99 * t302 * t1 * t296
    t308 = sin(t104)
    contr[31] = t111 * t308 * muM * t289 * t102 / 8
    t312 = muM * t285
    t313 = sin(t114)
    contr[32] = t122 * t116 * t313 * t312 / 8
    t317 = IMx * cpa1EQ
    t318 = IMy * cpa2EQ
    t319 = t317 - t318
    t322 = sin(t130)
    contr[33] = -3/4 * t65 * t322 * t16 * t319 * muM * t124
    t327 = t317 + t318
    t330 = sin(t138)
    contr[34] = 3/4 * t65 * t330 * muM * t63 * t327 * t1
    t334 = cos(t146)
    t336 = t45 - t47 - t48
    contr[35] = -3/4 * t99 * t16 * t336 * t334 * t1
    t341 = cos(t152)
    t344 = muM * t16
    contr[36] = 3/4 * t89 * t344 * t336 * t341 * t31
    t348 = sin(t160)
    contr[37] = t110 * t16 * t348 * t312 * t158 / 8
    t353 = sin(t167)
    contr[38] = t172 * t353 * muM * t289 * t30 / 8
    t357 = cpa1EQ * t174
    t359 = 2 * t53 * t176
    t360 = cpa1EQ * t180
    t361 = cpa2EQ * t182
    t363 = 2 * t177 * t184
    t364 = cpa2EQ * t187
    t365 = t357 + t359 - t360 - t361 + t363 + t364
    t368 = sin(t192)
    contr[39] = 3/4 * t65 * t368 * t16 * t365 * muM * t124
    t373 = t16 * (t357 + t359 - t360 + t361 - t363 - t364)
    t375 = sin(t201)
    contr[40] = -3/4 * t65 * t375 * muM * t373 * t124
    t380 = sin(t209)
    t384 = t30 * t16
    contr[41] = 3/8 * t121 * t384 * t319 * t116 * muM * t380
    t387 = sin(t215)
    contr[42] = -3/8 * t121 * t16 * t365 * t218 * muM * t387
    t396 = sin(t223)
    contr[43] = 3/8 * t110 * t396 * t30 * t344 * t327 * t102
    t401 = sin(t230)
    contr[44] = -3/8 * t110 * t401 * muM * t373 * t234
    t406 = sin(t238)
    contr[45] = -3/8 * t235 * t16 * t319 * muM * t406
    t412 = sin(t243)
    contr[46] = 3/8 * t110 * t384 * t365 * t102 * muM * t412
    t420 = sin(t250)
    contr[47] = -3/8 * t121 * t420 * muM * t171 * t327 * t17
    t426 = sin(t256)
    contr[48] = 3/8 * t121 * t426 * t30 * t206 * t373
    contr = sum(contr)
    return contr
end

function derivativechiM2_Jl1_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    contr = zeros(54)
    t1 = sqrt(smk)
    t2 = Q1 ^ 2
    t3 = Q2 ^ 2
    t7 = Q2 * cpa2EQ
    t8 = cpa3EQ * (-t2 - t3 + 1) + Q1 * cpa1EQ - t7
    t10 = muM * t8 * t1
    t11 = A - C
    t12 = t11 * IMx
    t15 = sin(psil)
    t17 = 1 / (t2 + t3 + 1)
    t19 = 0.1e1 / C
    t22 = rc ^ 2
    t25 = 0.1e1 / t22 / rc / A
    t26 = npsil ^ 2
    t28 = 0.1e1 / t26 * t25
    contr[1] = t28 * t19 * t17 * t15 * cdelta * t12 * t10
    t30 = psig - psil
    t31 = sin(t30)
    t33 = sqrt(skm)
    t34 = t33 - 1
    t36 = t8 * t12
    t39 = t19 * t17 * sdelta
    t41 = (-npsil + npsig) ^ 2
    t43 = 0.1e1 / t41 * t25
    t44 = t43 * t39
    contr[2] = -t44 * t36 * t34 * t31 * muM / 2
    t47 = psig + psil
    t48 = sin(t47)
    t50 = t33 + 1
    t54 = (npsil + npsig) ^ 2
    t56 = 0.1e1 / t54 * t25
    t57 = t56 * t39
    contr[3] = t57 * t36 * t50 * t48 * muM / 2
    t59 = 2 * TL
    t60 = -psil + t59
    t61 = sin(t60)
    t63 = muM * t11
    t64 = IMx * Q1
    t65 = cpa1EQ * t64
    t66 = Q2 * IMx
    t67 = cpa2EQ * t66
    t68 = IMy * Q1
    t69 = cpa2EQ * t68
    t70 = Q2 * IMy
    t71 = cpa1EQ * t70
    t72 = t65 + t67 - t69 + t71
    contr[4] = -3/2 * t28 * t19 * cdelta * t17 * t72 * t63 * t61 * t1
    t80 = -psil + psih
    t81 = sin(t80)
    t83 = cpa2EQ * t2
    t85 = Q1 * Q2 * cpa1EQ
    t87 = cpa2EQ * t3
    t88 = Q2 * cpa3EQ
    t90 = -t83 - 2 * t85 + t87 - 4 * t88 - cpa2EQ
    t98 = cpa1EQ * t2 + Q1 * (-2 * t7 + 4 * cpa3EQ) - cpa1EQ * t3 - cpa1EQ
    t99 = t98 * IMy
    t102 = t11 * muM * (IMx * t90 + t99)
    t104 = t28 * t39
    contr[5] = t104 * t102 * t1 * t81 / 4
    t106 = t65 + t67 + t69 - t71
    t108 = psil + t59
    t109 = sin(t108)
    t115 = t28 * t19 * cdelta * muM
    contr[6] = 3/2 * t115 * t11 * t109 * t1 * t17 * t106
    t117 = psil + psih
    t118 = sin(t117)
    t121 = -IMx * t90 + t99
    t124 = t11 * muM * t1
    contr[7] = t104 * t124 * t121 * t118 / 4
    t127 = t50 * muM
    t128 = t11 * sdelta
    t129 = t59 - psig - psil
    t130 = sin(t129)
    t134 = t19 * t17 * t72
    contr[8] = -3/4 * t56 * t134 * t130 * t128 * t127
    t138 = t34 * muM
    t139 = t106 * t128
    t141 = t59 - psig + psil
    t142 = sin(t141)
    contr[9] = 3/4 * t43 * t19 * t142 * t17 * t139 * t138
    t147 = t59 + psig - psil
    t148 = sin(t147)
    contr[10] = -3/4 * t43 * t134 * t148 * t128 * t138
    t155 = t59 + psig + psil
    t156 = sin(t155)
    contr[11] = 3/4 * t56 * t19 * t156 * t17 * t139 * t127
    t161 = t59 - psil - psih
    t162 = sin(t161)
    t164 = sdelta * muM
    t165 = IMx * cpa2EQ
    t166 = IMy * cpa1EQ
    t167 = t165 + t166
    t171 = t19 * t11 * t17
    t172 = t28 * t171
    contr[12] = 3/4 * t172 * t167 * t164 * t162 * t1
    t174 = t59 - psil + psih
    t175 = sin(t174)
    t177 = t2 * IMx
    t178 = cpa2EQ * t177
    t179 = Q2 * cpa1EQ
    t181 = 2 * t179 * t64
    t182 = t3 * IMx
    t183 = cpa2EQ * t182
    t184 = t2 * IMy
    t185 = cpa1EQ * t184
    t187 = 2 * t7 * t68
    t188 = t3 * IMy
    t189 = cpa1EQ * t188
    t190 = t178 - t181 - t183 + t185 + t187 - t189
    t192 = muM * t17 * t190
    t195 = t28 * t19 * t128
    contr[13] = 3/4 * t195 * t192 * t175 * t1
    t197 = t59 + psil - psih
    t198 = sin(t197)
    t200 = t165 - t166
    contr[14] = -3/4 * t172 * t200 * t164 * t198 * t1
    t205 = t59 + psil + psih
    t206 = sin(t205)
    t208 = t178 - t181 - t183 - t185 - t187 + t189
    t209 = t17 * t208
    contr[15] = -3/4 * t195 * muM * t209 * t206 * t1
    t214 = -psih + psig - psil
    t215 = sin(t214)
    t217 = cdelta - 1
    t222 = t19 * t17 * t121
    contr[16] = t43 * t222 * t34 * t217 * t11 * muM * t215 / 8
    t225 = -psih + psig + psil
    t226 = sin(t225)
    t229 = t17 * t217
    t231 = t56 * t19 * t229
    contr[17] = t231 * t102 * t226 * t50 / 8
    t233 = cdelta + 1
    t234 = psih + psig - psil
    t235 = sin(t234)
    t240 = t43 * t19 * t17 * t34
    contr[18] = -t240 * t102 * t235 * t233 / 8
    t243 = t50 * t233
    t244 = psih + psig + psil
    t245 = sin(t244)
    contr[19] = -t56 * t222 * t11 * muM * t245 * t243 / 8
    t254 = t11 * muM * t17
    t256 = -psig - psil - psih + t59
    t257 = sin(t256)
    contr[20] = -3/8 * t56 * t19 * t233 * t257 * t254 * t167 * t50
    t263 = t50 * t217
    t265 = -psig - psil + psih + t59
    t266 = sin(t265)
    contr[21] = -3/8 * t56 * t19 * t266 * t11 * t192 * t263
    t272 = -psig + psil - psih + t59
    t273 = sin(t272)
    t278 = t19 * t233 * t17
    contr[22] = 3/8 * t43 * t278 * t200 * t273 * t11 * t138
    t284 = -psig + psil + psih + t59
    t285 = sin(t284)
    contr[23] = 3/8 * t43 * t19 * t285 * t11 * muM * t229 * t208 * t34
    t290 = t217 * t34
    t294 = psig - psil - psih + t59
    t295 = sin(t294)
    contr[24] = -3/8 * t43 * t19 * t295 * t11 * muM * t17 * t167 * t290
    t303 = psig - psil + psih + t59
    t304 = sin(t303)
    contr[25] = -3/8 * t43 * t19 * t233 * t304 * t254 * t190 * t34
    t310 = psig + psil - psih + t59
    t311 = sin(t310)
    contr[26] = 3/8 * t56 * t19 * t17 * t200 * t311 * t63 * t263
    t318 = t11 * t127
    t320 = psig + psil + psih + t59
    t321 = sin(t320)
    contr[27] = 3/8 * t56 * t19 * t233 * t321 * t318 * t209
    t326 = t11 * IMy
    t329 = cos(psil)
    contr[28] = t28 * t19 * t17 * t329 * cdelta * t326 * t10
    t333 = cos(t30)
    t336 = t8 * t326
    contr[29] = t44 * t336 * t34 * t333 * muM / 2
    t339 = cos(t47)
    contr[30] = t57 * t336 * t50 * t339 * muM / 2
    t344 = cpa2EQ * t64
    t345 = cpa1EQ * t66
    t346 = cpa1EQ * t68
    t347 = cpa2EQ * t70
    t348 = t344 - t345 + t346 + t347
    t350 = cos(t60)
    contr[31] = 3/2 * t115 * t11 * t350 * t1 * t17 * t348
    t355 = IMx * t98
    t362 = 2 * IMy * (t85 + t83 / 2 - t87 / 2 + 2 * t88 + cpa2EQ / 2)
    t363 = t355 + t362
    t364 = cos(t80)
    contr[32] = t104 * t124 * t364 * t363 / 4
    t368 = t344 - t345 - t346 - t347
    t370 = cos(t108)
    contr[33] = -3/2 * t115 * t11 * t370 * t17 * t368 * t1
    t376 = cos(t117)
    t378 = t355 - t362
    contr[34] = -t104 * t378 * t63 * t1 * t376 / 4
    t383 = t348 * t128
    t385 = cos(t129)
    contr[35] = 3/4 * t56 * t19 * t385 * t17 * t383 * t127
    t390 = t17 * t368
    t393 = cos(t141)
    contr[36] = -3/4 * t43 * t19 * t393 * t11 * sdelta * t138 * t390
    t400 = cos(t147)
    contr[37] = 3/4 * t43 * t19 * t400 * t17 * t383 * t138
    t407 = cos(t155)
    contr[38] = -3/4 * t56 * t19 * t407 * t11 * sdelta * t127 * t390
    t413 = cos(t161)
    t415 = IMx * cpa1EQ
    t416 = IMy * cpa2EQ
    t417 = t415 - t416
    contr[39] = 3/4 * t172 * t417 * t164 * t413 * t1
    t421 = cpa1EQ * t177
    t423 = 2 * t7 * t64
    t424 = cpa1EQ * t182
    t425 = cpa2EQ * t184
    t427 = 2 * t179 * t68
    t428 = cpa2EQ * t188
    t429 = t421 + t423 - t424 - t425 + t427 + t428
    t431 = cos(t174)
    contr[40] = 3/4 * t195 * muM * t431 * t17 * t429 * t1
    t436 = cos(t197)
    t438 = t415 + t416
    contr[41] = -3/4 * t172 * t438 * t164 * t436 * t1
    t443 = cos(t205)
    t445 = t421 + t423 - t424 + t425 - t427 - t428
    contr[42] = -3/4 * t172 * t445 * t164 * t443 * t1
    t450 = cos(t214)
    contr[43] = t240 * t217 * t63 * t378 * t450 / 8
    t456 = cos(t225)
    contr[44] = -t231 * t11 * muM * t456 * t363 * t50 / 8
    t463 = cos(t234)
    contr[45] = -t240 * t11 * muM * t463 * t363 * t233 / 8
    t469 = cos(t244)
    contr[46] = t56 * t171 * muM * t378 * t469 * t243 / 8
    t475 = t17 * t417
    t477 = cos(t256)
    contr[47] = -3/8 * t56 * t19 * t233 * t477 * t318 * t475
    t483 = t17 * t429
    t486 = cos(t265)
    contr[48] = -3/8 * t56 * t19 * t486 * t11 * muM * t263 * t483
    t494 = cos(t272)
    contr[49] = 3/8 * t43 * t19 * t233 * t494 * t254 * t438 * t34
    t499 = cos(t284)
    contr[50] = 3/8 * t43 * t19 * t17 * t445 * t499 * t63 * t290
    t508 = cos(t294)
    contr[51] = -3/8 * t43 * t19 * t508 * t11 * muM * t475 * t290
    t516 = cos(t303)
    contr[52] = -3/8 * t43 * t19 * t233 * t516 * t11 * t138 * t483
    t526 = cos(t310)
    contr[53] = 3/8 * t56 * t19 * t526 * t11 * muM * t50 * t17 * t438 * t217
    t531 = cos(t320)
    contr[54] = 3/8 * t56 * t278 * t445 * t531 * t11 * t127

    contr = sum(contr)
    return contr;    

end

function derivativechiM2_csigma1_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    contr = zeros(36)
    t1 = Q1 ^ 2
    t2 = Q2 ^ 2
    t6 = Q2 * cpa2EQ
    t8 = (cpa3EQ * (t1 + t2 - 1) - Q1 * cpa1EQ + t6) * sdelta
    t9 = psig - psil
    t10 = sin(t9)
    t14 = 1 / (t1 + t2 + 1)
    t15 = t14 * muM
    t16 = rc ^ 2
    t18 = 0.1e1 / t16 / rc
    t21 = 0.1e1 / (-npsil + npsig) * t18
    t22 = t21 * t15
    contr[1] = t22 * t10 * IMx * t8 / 2
    t24 = psig + psil
    t25 = sin(t24)
    t30 = 0.1e1 / (npsil + npsig) * t18
    t31 = t30 * t15
    contr[2] = t31 * t25 * IMx * t8 / 2
    t33 = 2 * TL
    t34 = t33 - psig - psil
    t35 = sin(t34)
    t38 = Q1 * IMx
    t39 = cpa1EQ * t38
    t40 = Q2 * IMx
    t41 = cpa2EQ * t40
    t42 = Q1 * IMy
    t43 = cpa2EQ * t42
    t44 = Q2 * IMy
    t45 = cpa1EQ * t44
    t47 = t14 * (t39 + t41 - t43 + t45)
    contr[3] = 3/4 * t30 * t47 * muM * sdelta * t35
    t50 = t33 - psig + psil
    t51 = sin(t50)
    t55 = t14 * (t39 + t41 + t43 - t45)
    contr[4] = 3/4 * t21 * t55 * muM * sdelta * t51
    t58 = t33 + psig - psil
    t59 = sin(t58)
    contr[5] = -3/4 * t21 * t47 * muM * sdelta * t59
    t65 = t33 + psig + psil
    t66 = sin(t65)
    contr[6] = -3/4 * t30 * t55 * muM * sdelta * t66
    t72 = cdelta - 1
    t73 = -psih + psig - psil
    t74 = sin(t73)
    t84 = 2 * Q1 * Q2 * cpa1EQ + 4 * Q2 * cpa3EQ + cpa2EQ * t1 - cpa2EQ * t2 + cpa2EQ
    t92 = cpa1EQ * t1 + Q1 * (-2 * t6 + 4 * cpa3EQ) - cpa1EQ * t2 - cpa1EQ
    t93 = t92 * IMy
    t95 = t14 * (IMx * t84 + t93)
    contr[7] = t21 * t95 * muM * t74 * t72 / 8
    t98 = -psih + psig + psil
    t99 = sin(t98)
    t105 = t14 * (-IMx * t84 + t93)
    contr[8] = -t30 * t105 * muM * t99 * t72 / 8
    t109 = psih + psig - psil
    t110 = sin(t109)
    t112 = cdelta + 1
    contr[9] = -t21 * t105 * t112 * muM * t110 / 8
    t117 = psih + psig + psil
    t118 = sin(t117)
    contr[10] = t30 * t95 * t112 * muM * t118 / 8
    t123 = -psig - psil + t33 - psih
    t124 = sin(t123)
    t127 = IMx * cpa2EQ
    t128 = IMy * cpa1EQ
    t130 = t14 * (t127 + t128)
    contr[11] = 3/8 * t30 * t130 * t112 * muM * t124
    t133 = t1 * IMx
    t134 = cpa2EQ * t133
    t135 = Q2 * cpa1EQ
    t137 = 2 * t135 * t38
    t138 = t2 * IMx
    t139 = cpa2EQ * t138
    t140 = t1 * IMy
    t141 = cpa1EQ * t140
    t143 = 2 * t6 * t42
    t144 = t2 * IMy
    t145 = cpa1EQ * t144
    t146 = t134 - t137 - t139 + t141 + t143 - t145
    t149 = -psig - psil + t33 + psih
    t150 = sin(t149)
    contr[12] = 3/8 * t30 * t72 * t150 * t14 * t146 * muM
    t154 = muM * t112
    t155 = -psig + psil + t33 - psih
    t156 = sin(t155)
    t159 = t14 * (t127 - t128)
    contr[13] = 3/8 * t21 * t159 * t156 * t154
    t162 = t134 - t137 - t139 - t141 - t143 + t145
    t165 = -psig + psil + t33 + psih
    t166 = sin(t165)
    contr[14] = 3/8 * t21 * t72 * t166 * t14 * t162 * muM
    t170 = psig - psil + t33 - psih
    t171 = sin(t170)
    contr[15] = -3/8 * t21 * t130 * muM * t72 * t171
    t178 = psig - psil + t33 + psih
    t179 = sin(t178)
    contr[16] = -3/8 * t21 * t179 * t14 * t146 * t154
    t184 = psig + psil + t33 - psih
    t185 = sin(t184)
    contr[17] = -3/8 * t30 * t159 * t72 * t185 * muM
    t192 = psig + psil + t33 + psih
    t193 = sin(t192)
    contr[18] = -3/8 * t30 * t193 * t14 * t162 * t154
    t198 = cos(t9)
    contr[19] = -t22 * t198 * IMy * t8 / 2
    t203 = cos(t24)
    contr[20] = t31 * t203 * IMy * t8 / 2
    t207 = cos(t34)
    t210 = cpa2EQ * t38
    t211 = cpa1EQ * t40
    t212 = cpa1EQ * t42
    t213 = cpa2EQ * t44
    t215 = t14 * (t210 - t211 + t212 + t213)
    contr[21] = -3/4 * t30 * t215 * muM * sdelta * t207
    t219 = cos(t50)
    t221 = t210 - t211 - t212 - t213
    contr[22] = -3/4 * t22 * t221 * sdelta * t219
    t225 = cos(t58)
    contr[23] = 3/4 * t21 * t215 * muM * sdelta * t225
    t230 = cos(t65)
    contr[24] = 3/4 * t31 * t221 * sdelta * t230
    t234 = cos(t73)
    t237 = IMx * t92
    t238 = t84 * IMy
    t240 = t14 * (t237 - t238)
    contr[25] = t21 * t240 * muM * t234 * t72 / 8
    t243 = cos(t98)
    t246 = t237 + t238
    contr[26] = t30 * t14 * t246 * muM * t243 * t72 / 8
    t250 = cos(t109)
    contr[27] = -t21 * t14 * t112 * t246 * muM * t250 / 8
    t257 = cos(t117)
    contr[28] = -t30 * t240 * t112 * muM * t257 / 8
    t263 = IMx * cpa1EQ
    t264 = IMy * cpa2EQ
    t265 = t263 - t264
    t267 = cos(t123)
    contr[29] = 3/8 * t30 * t267 * t14 * t265 * t154
    t271 = cpa1EQ * t133
    t273 = 2 * t6 * t38
    t274 = cpa1EQ * t138
    t275 = cpa2EQ * t140
    t277 = 2 * t135 * t42
    t278 = cpa2EQ * t144
    t279 = t271 + t273 - t274 - t275 + t277 + t278
    t282 = cos(t149)
    contr[30] = 3/8 * t30 * t72 * t282 * t14 * t279 * muM
    t286 = cos(t155)
    t287 = t263 + t264
    contr[31] = 3/8 * t21 * t154 * t14 * t287 * t286
    t292 = cos(t165)
    t294 = t271 + t273 - t274 + t275 - t277 - t278
    contr[32] = 3/8 * t22 * t294 * t72 * t292
    t299 = cos(t170)
    contr[33] = -3/8 * t21 * t72 * t299 * t14 * t265 * muM
    t305 = cos(t178)
    contr[34] = -3/8 * t21 * t305 * t14 * t279 * t154
    t310 = cos(t184)
    contr[35] = -3/8 * t31 * t287 * t72 * t310
    t315 = cos(t192)
    contr[36] = -3/8 * t30 * t154 * t14 * t294 * t315
    contr = sum(contr)
    return contr
end

function derivativechiM2_csigma2_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    contr = zeros(35)
    t1 = sqrt(skm)
    t2 = Q1 ^ 2
    t3 = Q2 ^ 2
    t6 = Q1 * cpa1EQ
    t7 = Q2 * cpa2EQ
    t9 = (cpa3EQ * (t2 + t3 - 1) - t6 + t7) * t1
    t10 = sin(psil)
    t15 = 1 / (t2 + t3 + 1)
    t16 = rc ^ 2
    t18 = 0.1e1 / t16 / rc
    t19 = t18 * t15
    t20 = 0.1e1 / npsil
    t22 = t20 * t19 * cdelta * muM
    contr[1] = -t22 * t10 * IMx * t9
    t24 = 2 * TL
    t25 = -psig + t24
    t26 = cos(t25)
    t29 = Q2 * cpa1EQ
    t31 = t15 * (Q1 * cpa2EQ - t29)
    t33 = muM * sdelta
    t35 = 0.1e1 / npsig
    t36 = t35 * t18 * t1
    t37 = t36 * t33
    contr[2] = -3/2 * t37 * t31 * IMz * t26
    t40 = psig + t24
    t41 = cos(t40)
    contr[3] = 3/2 * t37 * t31 * IMz * t41
    t45 = psig - psih
    t46 = cos(t45)
    t48 = cpa1EQ * t2
    t49 = Q1 * Q2
    t51 = 2 * cpa2EQ * t49
    t52 = cpa1EQ * t3
    t55 = 4 * Q1 * cpa3EQ - cpa1EQ + t48 - t51 - t52
    t58 = cdelta - 1
    contr[4] = t36 * t58 * t15 * t55 * muM * IMz * t46 / 4
    t62 = psig + psih
    t63 = cos(t62)
    t64 = cdelta + 1
    t66 = IMz * muM
    contr[5] = -t36 * t15 * t55 * t66 * t64 * t63 / 4
    t72 = -psil + t24
    t73 = sin(t72)
    t75 = Q1 * IMx
    t76 = cpa1EQ * t75
    t77 = Q2 * IMx
    t78 = cpa2EQ * t77
    t79 = Q1 * IMy
    t80 = cpa2EQ * t79
    t81 = Q2 * IMy
    t82 = cpa1EQ * t81
    t86 = t1 * t15
    t87 = t20 * t18
    t88 = t87 * t86
    contr[6] = -3/2 * t88 * (t76 + t78 - t80 + t82) * muM * cdelta * t73
    t91 = -psil + psih
    t92 = sin(t91)
    t95 = cpa2EQ * t2
    t97 = 2 * cpa1EQ * t49
    t98 = cpa2EQ * t3
    t101 = -4 * Q2 * cpa3EQ - cpa2EQ - t95 - t97 + t98
    t107 = t48 + Q1 * (-2 * t7 + 4 * cpa3EQ) - t52 - cpa1EQ
    t108 = t107 * IMy
    contr[7] = t87 * t15 * (IMx * t101 + t108) * t33 * t92 * t1 / 4
    t113 = psil + t24
    t114 = sin(t113)
    contr[8] = 3/2 * t88 * (t76 + t78 + t80 - t82) * muM * cdelta * t114
    t120 = psil + psih
    t121 = sin(t120)
    t123 = -t101
    t129 = t87 * t15 * sdelta
    contr[9] = t129 * muM * (IMx * t123 + t108) * t121 * t1 / 4
    t133 = -psih - psig + t24
    t134 = cos(t133)
    t137 = t35 * t18 * IMz
    contr[10] = 3/4 * t137 * muM * t134 * t86 * cpa1EQ * t64
    t141 = -psih + psig + t24
    t142 = cos(t141)
    t145 = t58 * muM
    t146 = t137 * t145
    contr[11] = -3/4 * t146 * t142 * t1 * t15 * cpa1EQ
    t149 = -psih - psil + t24
    t150 = sin(t149)
    t152 = IMx * cpa2EQ
    t153 = IMy * cpa1EQ
    contr[12] = 3/4 * t88 * (t152 + t153) * muM * sdelta * t150
    t160 = t1 * sdelta
    t162 = -psih + psil + t24
    t163 = sin(t162)
    contr[13] = -3/4 * t87 * t163 * muM * t160 * t15 * (t152 - t153)
    t168 = psih - psig + t24
    t169 = cos(t168)
    t171 = t48 + t51 - t52
    contr[14] = 3/4 * t146 * t15 * t171 * t169 * t1
    t175 = t1 * t64
    t176 = psih + psig + t24
    t177 = cos(t176)
    contr[15] = -3/4 * t137 * muM * t15 * t171 * t177 * t175
    t184 = t2 * IMx
    t185 = cpa2EQ * t184
    t187 = 2 * t29 * t75
    t188 = t3 * IMx
    t189 = cpa2EQ * t188
    t190 = t2 * IMy
    t191 = cpa1EQ * t190
    t193 = 2 * t7 * t79
    t194 = t3 * IMy
    t195 = cpa1EQ * t194
    t199 = psih - psil + t24
    t200 = sin(t199)
    contr[16] = 3/4 * t87 * t200 * t15 * (t185 - t187 - t189 + t191 + t193 - t195) * muM * t160
    t207 = psih + psil + t24
    t208 = sin(t207)
    contr[17] = -3/4 * t87 * t208 * t15 * (t185 - t187 - t189 - t191 - t193 + t195) * muM * t160
    t213 = sin(psig)
    contr[18] = t35 * t19 * sdelta * IMz * t213 * muM * t9
    t219 = cos(psil)
    contr[19] = -t22 * t219 * IMy * t9
    t223 = sin(t25)
    t228 = t36 * t15 * (t6 + t7)
    contr[20] = 3/2 * t228 * t33 * IMz * t223
    t230 = sin(t40)
    contr[21] = -3/2 * t228 * t33 * IMz * t230
    t235 = sin(t45)
    contr[22] = t36 * t145 * IMz * t15 * t123 * t235 / 4
    t241 = sin(t62)
    contr[23] = t36 * t66 * t15 * t123 * t64 * t241 / 4
    t247 = cos(t72)
    t249 = cpa2EQ * t75
    t250 = cpa1EQ * t77
    t251 = cpa1EQ * t79
    t252 = cpa2EQ * t81
    contr[24] = 3/2 * t88 * (t249 - t250 + t251 + t252) * muM * cdelta * t247
    t257 = cos(t91)
    t260 = IMx * t107
    t261 = t123 * IMy
    contr[25] = t87 * t15 * (t260 + t261) * t33 * t257 * t1 / 4
    t266 = cos(t113)
    t272 = t87 * t1 * muM
    contr[26] = -3/2 * t272 * t15 * (t249 - t250 - t251 - t252) * cdelta * t266
    t277 = cos(t120)
    contr[27] = -t129 * muM * t277 * t1 * (t260 - t261) / 4
    t284 = sin(t133)
    contr[28] = 3/4 * t137 * muM * t284 * t86 * cpa2EQ * t64
    t289 = sin(t141)
    contr[29] = -3/4 * t146 * t289 * t1 * t15 * cpa2EQ
    t294 = IMx * cpa1EQ
    t295 = IMy * cpa2EQ
    t299 = cos(t149)
    contr[30] = 3/4 * t87 * t299 * muM * t160 * t15 * (t294 - t295)
    t306 = cos(t162)
    contr[31] = -3/4 * t87 * t306 * t15 * (t294 + t295) * muM * t160
    t312 = t15 * (t95 - t97 - t98)
    t313 = sin(t168)
    contr[32] = 3/4 * t146 * t313 * t1 * t312
    t318 = sin(t176)
    contr[33] = -3/4 * t137 * muM * t318 * t175 * t312
    t323 = cpa1EQ * t184
    t325 = 2 * t7 * t75
    t326 = cpa1EQ * t188
    t327 = cpa2EQ * t190
    t329 = 2 * t29 * t79
    t330 = cpa2EQ * t194
    t334 = cos(t199)
    contr[34] = 3/4 * t87 * t334 * t15 * (t323 + t325 - t326 - t327 + t329 + t330) * muM * t160
    t338 = cos(t207)
    contr[35] = -3/4 * t272 * t15 * (t323 + t325 - t326 + t327 - t329 - t330) * sdelta * t338
    contr = sum(contr)
    return contr
end

function derivativechiM2_Jg1_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    contr = zeros(53)
    t1 = 2 * TL
    t2 = -psig + t1
    t3 = cos(t2)
    t4 = sqrt(smk)
    t7 = Q2 * cpa1EQ
    t10 = Q1 ^ 2
    t11 = Q2 ^ 2
    t13 = 1 / (t10 + t11 + 1)
    t14 = t13 * (Q1 * cpa2EQ - t7) * IMz
    t17 = rc ^ 2
    t19 = 0.1e1 / t17 / rc
    t20 = npsig ^ 2
    t23 = 0.1e1 / A
    t24 = t23 / t20 * t19
    t25 = t24 * muM * sdelta
    contr[1] = -3/2 * t25 * t14 * t4 * t3
    t28 = psig + t1
    t29 = cos(t28)
    contr[2] = 3/2 * t25 * t14 * t4 * t29
    t33 = psig - psih
    t34 = cos(t33)
    t36 = IMz * muM
    t37 = cpa1EQ * t10
    t38 = Q1 * Q2
    t40 = 2 * cpa2EQ * t38
    t41 = cpa1EQ * t11
    t44 = 4 * Q1 * cpa3EQ - cpa1EQ + t37 - t40 - t41
    t47 = cdelta - 1
    t48 = t47 * t13
    contr[3] = t24 * t48 * t44 * t36 * t4 * t34 / 4
    t51 = psig + psih
    t52 = cos(t51)
    t54 = cdelta + 1
    contr[4] = -t24 * t13 * t44 * muM * IMz * t54 * t4 * t52 / 4
    t62 = psig - psil
    t63 = sin(t62)
    t65 = sqrt(skm)
    t66 = t65 - 1
    t69 = Q1 * cpa1EQ
    t70 = Q2 * cpa2EQ
    t71 = cpa3EQ * (-t10 - t11 + 1) + t69 - t70
    t73 = muM * t71 * t66
    t75 = t13 * IMx
    t77 = (-npsil + npsig) ^ 2
    t80 = t23 / t77 * t19
    contr[5] = t80 * t75 * t73 * sdelta * t63 / 2
    t83 = psig + psil
    t84 = sin(t83)
    t87 = t65 + 1
    t88 = t87 * muM * t71
    t91 = (npsil + npsig) ^ 2
    t94 = t23 / t91 * t19
    contr[6] = t94 * t75 * t88 * sdelta * t84 / 2
    t97 = t1 - psig - psil
    t98 = sin(t97)
    t100 = Q1 * IMx
    t101 = cpa1EQ * t100
    t102 = Q2 * IMx
    t103 = cpa2EQ * t102
    t104 = Q1 * IMy
    t105 = cpa2EQ * t104
    t106 = Q2 * IMy
    t107 = cpa1EQ * t106
    t108 = t101 + t103 - t105 + t107
    t111 = sdelta * t13
    t112 = t94 * t111
    contr[7] = -3/4 * t112 * t108 * t87 * muM * t98
    t115 = t1 - psig + psil
    t116 = sin(t115)
    t119 = t13 * (t101 + t103 + t105 - t107)
    t122 = t80 * sdelta * t66
    contr[8] = -3/4 * t122 * t119 * muM * t116
    t125 = t1 + psig - psil
    t126 = sin(t125)
    contr[9] = 3/4 * t80 * t111 * t108 * t66 * muM * t126
    t132 = t1 + psig + psil
    t133 = sin(t132)
    t137 = t94 * sdelta * t87
    contr[10] = 3/4 * t137 * t119 * muM * t133
    t139 = IMz * t4
    t140 = t13 * cpa1EQ
    t143 = -psih - psig + t1
    t144 = cos(t143)
    contr[11] = 3/4 * t24 * t144 * muM * t54 * t140 * t139
    t150 = -psih + psig + t1
    t151 = cos(t150)
    contr[12] = -3/4 * t24 * t151 * t47 * muM * t140 * t139
    t156 = -psih + psig - psil
    t157 = sin(t156)
    t159 = cpa2EQ * t10
    t160 = cpa1EQ * t38
    t161 = 2 * t160
    t162 = cpa2EQ * t11
    t163 = Q2 * cpa3EQ
    t165 = t159 + t161 - t162 + 4 * t163 + cpa2EQ
    t171 = t37 + Q1 * (-2 * t70 + 4 * cpa3EQ) - t41 - cpa1EQ
    t172 = t171 * IMy
    t173 = IMx * t165 + t172
    t176 = t80 * t48
    contr[13] = -t176 * muM * t173 * t66 * t157 / 8
    t179 = -psih + psig + psil
    t180 = sin(t179)
    t184 = -IMx * t165 + t172
    contr[14] = t94 * t48 * t184 * muM * t180 * t87 / 8
    t189 = t37 + t40 - t41
    t193 = psih - psig + t1
    t194 = cos(t193)
    contr[15] = 3/4 * t24 * t194 * t47 * t13 * t189 * muM * t139
    t198 = muM * t54
    t201 = psih + psig + t1
    t202 = cos(t201)
    contr[16] = -3/4 * t24 * t202 * t13 * t189 * t198 * t139
    t207 = psih + psig - psil
    t208 = sin(t207)
    t210 = muM * t66
    contr[17] = t80 * t13 * t184 * t210 * t208 * t54 / 8
    t215 = t87 * t54
    t216 = psih + psig + psil
    t217 = sin(t216)
    t220 = t13 * muM
    t221 = t94 * t220
    contr[18] = -t221 * t173 * t217 * t215 / 8
    t224 = -psig - psil + t1 - psih
    t225 = sin(t224)
    t228 = IMx * cpa2EQ
    t229 = IMy * cpa1EQ
    t231 = t13 * (t228 + t229)
    contr[19] = -3/8 * t94 * t231 * t198 * t87 * t225
    t235 = t10 * IMx
    t236 = cpa2EQ * t235
    t238 = 2 * t7 * t100
    t239 = t11 * IMx
    t240 = cpa2EQ * t239
    t241 = t10 * IMy
    t242 = cpa1EQ * t241
    t244 = 2 * t70 * t104
    t245 = t11 * IMy
    t246 = cpa1EQ * t245
    t247 = t236 - t238 - t240 + t242 + t244 - t246
    t249 = -psig - psil + t1 + psih
    t250 = sin(t249)
    t253 = t47 * muM
    t254 = t94 * t253
    contr[20] = -3/8 * t254 * t250 * t13 * t247 * t87
    t258 = -psig + psil + t1 - psih
    t259 = sin(t258)
    t263 = t13 * (t228 - t229)
    contr[21] = -3/8 * t80 * t263 * muM * t259 * t54 * t66
    t267 = t236 - t238 - t240 - t242 - t244 + t246
    t269 = -psig + psil + t1 + psih
    t270 = sin(t269)
    t273 = t80 * t253
    contr[22] = -3/8 * t273 * t270 * t13 * t267 * t66
    t276 = psig - psil + t1 - psih
    t277 = sin(t276)
    contr[23] = 3/8 * t80 * t231 * t210 * t47 * t277
    t283 = t54 * t13
    t285 = psig - psil + t1 + psih
    t286 = sin(t285)
    contr[24] = 3/8 * t80 * muM * t286 * t283 * t247 * t66
    t290 = psig + psil + t1 - psih
    t291 = sin(t290)
    contr[25] = 3/8 * t94 * t263 * t253 * t291 * t87
    t298 = psig + psil + t1 + psih
    t299 = sin(t298)
    contr[26] = 3/8 * t94 * muM * t299 * t283 * t267 * t87
    t303 = sin(psig)
    contr[27] = t24 * t111 * muM * (cpa3EQ * t10 + cpa3EQ * t11 - cpa3EQ - t69 + t70) * IMz * t4 * t303
    t312 = sin(t2)
    t314 = sdelta * t36
    t318 = t24 * t13 * (t69 + t70)
    contr[28] = 3/2 * t318 * t314 * t4 * t312
    t320 = sin(t28)
    contr[29] = -3/2 * t318 * t314 * t4 * t320
    t325 = sin(t33)
    contr[30] = t24 * t253 * IMz * t13 * t165 * t4 * t325 / 4
    t332 = sin(t51)
    contr[31] = t24 * t36 * t13 * t165 * t54 * t4 * t332 / 4
    t339 = cos(t62)
    t342 = t13 * IMy
    contr[32] = -t80 * t342 * t73 * sdelta * t339 / 2
    t346 = cos(t83)
    contr[33] = t94 * t342 * t88 * sdelta * t346 / 2
    t351 = cos(t97)
    t353 = cpa2EQ * t100
    t354 = cpa1EQ * t102
    t355 = cpa1EQ * t104
    t356 = cpa2EQ * t106
    t358 = t13 * (t353 - t354 + t355 + t356)
    contr[34] = 3/4 * t137 * t358 * muM * t351
    t361 = cos(t115)
    t363 = t353 - t354 - t355 - t356
    contr[35] = 3/4 * t122 * t13 * t363 * muM * t361
    t367 = cos(t125)
    contr[36] = -3/4 * t122 * t358 * muM * t367
    t372 = cos(t132)
    contr[37] = -3/4 * t112 * t363 * t87 * muM * t372
    t380 = sin(t143)
    contr[38] = 3/4 * t24 * t380 * t13 * cpa2EQ * t198 * t139
    t387 = sin(t150)
    contr[39] = -3/4 * t24 * t387 * t47 * t13 * cpa2EQ * muM * t139
    t392 = IMx * t171
    t399 = 2 * (t160 + t159 / 2 - t162 / 2 + 2 * t163 + cpa2EQ / 2) * IMy
    t400 = t392 - t399
    t401 = cos(t156)
    contr[40] = -t176 * t210 * t401 * t400 / 8
    t406 = cos(t179)
    t410 = t13 * (t392 + t399)
    contr[41] = -t94 * t410 * t253 * t406 * t87 / 8
    t415 = (t159 - t161 - t162) * t4
    t416 = IMz * t13
    t419 = sin(t193)
    contr[42] = 3/4 * t24 * t419 * t47 * muM * t416 * t415
    t425 = sin(t201)
    contr[43] = -3/4 * t24 * t425 * muM * t54 * t416 * t415
    t430 = cos(t207)
    contr[44] = t80 * t410 * t210 * t430 * t54 / 8
    t436 = cos(t216)
    contr[45] = t221 * t436 * t87 * t54 * t400 / 8
    t440 = IMx * cpa1EQ
    t441 = IMy * cpa2EQ
    t442 = t440 - t441
    t445 = cos(t224)
    contr[46] = -3/8 * t94 * muM * t445 * t13 * t442 * t215
    t450 = cpa1EQ * t235
    t452 = 2 * t70 * t100
    t453 = cpa1EQ * t239
    t454 = cpa2EQ * t241
    t456 = 2 * t7 * t104
    t457 = cpa2EQ * t245
    t458 = t450 + t452 - t453 - t454 + t456 + t457
    t460 = cos(t249)
    contr[47] = -3/8 * t254 * t460 * t13 * t458 * t87
    t465 = cos(t258)
    t468 = t13 * (t440 + t441)
    contr[48] = -3/8 * t80 * t198 * t468 * t66 * t465
    t473 = cos(t269)
    t475 = t450 + t452 - t453 + t454 - t456 - t457
    contr[49] = -3/8 * t80 * t220 * t475 * t66 * t47 * t473
    t482 = cos(t276)
    contr[50] = 3/8 * t273 * t482 * t13 * t442 * t66
    t488 = cos(t285)
    contr[51] = 3/8 * t80 * muM * t488 * t283 * t458 * t66
    t492 = cos(t290)
    contr[52] = 3/8 * t94 * muM * t87 * t468 * t47 * t492
    t498 = cos(t298)
    contr[53] = 3/8 * t94 * t198 * t87 * t13 * t475 * t498
    contr = sum(contr)
    return contr
end

function derivativechiM2_cdelta1_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    contr = zeros(42)
    t1 = sin(psil)
    t3 = Q1 ^ 2
    t4 = Q2 ^ 2
    t8 = Q2 * cpa2EQ
    t10 = sqrt(smk)
    t11 = t10 * (cpa3EQ * (t3 + t4 - 1) - Q1 * cpa1EQ + t8)
    t14 = 1 / (t3 + t4 + 1)
    t15 = t14 * muM
    t16 = rc ^ 2
    t18 = 0.1e1 / t16 / rc
    t20 = 0.1e1 / npsil * t18
    t21 = t20 * t15
    contr[1] = t21 * t11 * IMx * t1
    t22 = psig - psih
    t23 = cos(t22)
    t25 = IMz * muM
    t27 = cpa1EQ * t3
    t28 = Q1 * Q2
    t30 = 2 * cpa2EQ * t28
    t31 = cpa1EQ * t4
    t37 = 0.1e1 / npsig * t18
    t38 = t37 * t14 * (4 * Q1 * cpa3EQ - cpa1EQ + t27 - t30 - t31)
    contr[2] = -t38 * t25 * t10 * t23 / 4
    t41 = psig + psih
    t42 = cos(t41)
    contr[3] = t38 * t25 * t10 * t42 / 4
    t46 = 2 * TL
    t47 = -psil + t46
    t48 = sin(t47)
    t51 = Q1 * IMx
    t52 = cpa1EQ * t51
    t53 = Q2 * IMx
    t54 = cpa2EQ * t53
    t55 = Q1 * IMy
    t56 = cpa2EQ * t55
    t57 = Q2 * IMy
    t58 = cpa1EQ * t57
    contr[4] = 3/2 * t20 * t14 * (t52 + t54 - t56 + t58) * muM * t10 * t48
    t63 = psil + t46
    t64 = sin(t63)
    contr[5] = -3/2 * t20 * t14 * (t52 + t54 + t56 - t58) * muM * t10 * t64
    t72 = -psih - psig + t46
    t73 = cos(t72)
    t75 = muM * cpa1EQ
    t78 = t37 * IMz * t14
    contr[6] = -3/4 * t78 * t75 * t73 * t10
    t81 = -psih + psig + t46
    t82 = cos(t81)
    contr[7] = 3/4 * t78 * t75 * t82 * t10
    t86 = -psih + psig - psil
    t87 = sin(t86)
    t88 = sqrt(skm)
    t89 = t88 - 1
    t92 = cpa2EQ * t3
    t94 = 2 * cpa1EQ * t28
    t95 = cpa2EQ * t4
    t98 = 4 * Q2 * cpa3EQ + cpa2EQ + t92 + t94 - t95
    t104 = t27 + Q1 * (-2 * t8 + 4 * cpa3EQ) - t31 - cpa1EQ
    t105 = t104 * IMy
    t107 = t14 * (IMx * t98 + t105)
    t110 = 0.1e1 / (-npsil + npsig) * t18
    contr[8] = t110 * t107 * muM * t89 * t87 / 8
    t113 = -psih + psig + psil
    t114 = sin(t113)
    t118 = -IMx * t98 + t105
    t120 = t88 + 1
    t124 = 0.1e1 / (npsil + npsig) * t18
    t125 = t124 * t14 * t120
    contr[9] = -t125 * t118 * muM * t114 / 8
    t129 = (t27 + t30 - t31) * t10
    t130 = psih - psig + t46
    t131 = cos(t130)
    t134 = t37 * t25
    contr[10] = -3/4 * t134 * t131 * t14 * t129
    t137 = psih + psig + t46
    t138 = cos(t137)
    contr[11] = 3/4 * t134 * t138 * t14 * t129
    t142 = psih + psig - psil
    t143 = sin(t142)
    contr[12] = -t110 * t14 * t118 * muM * t89 * t143 / 8
    t150 = psih + psig + psil
    t151 = sin(t150)
    contr[13] = t124 * t107 * t120 * muM * t151 / 8
    t156 = -psig - psil + t46 - psih
    t157 = sin(t156)
    t160 = IMx * cpa2EQ
    t161 = IMy * cpa1EQ
    t163 = t14 * (t160 + t161)
    contr[14] = 3/8 * t124 * t163 * muM * t120 * t157
    t166 = muM * t120
    t167 = t3 * IMx
    t168 = cpa2EQ * t167
    t169 = Q2 * cpa1EQ
    t171 = 2 * t169 * t51
    t172 = t4 * IMx
    t173 = cpa2EQ * t172
    t174 = t3 * IMy
    t175 = cpa1EQ * t174
    t177 = 2 * t8 * t55
    t178 = t4 * IMy
    t179 = cpa1EQ * t178
    t180 = t168 - t171 - t173 + t175 + t177 - t179
    t182 = -psig - psil + t46 + psih
    t183 = sin(t182)
    contr[15] = 3/8 * t124 * t183 * t14 * t180 * t166
    t187 = -psig + psil + t46 - psih
    t188 = sin(t187)
    t192 = t14 * (t160 - t161)
    contr[16] = 3/8 * t110 * t192 * t89 * t188 * muM
    t195 = t168 - t171 - t173 - t175 - t177 + t179
    t198 = -psig + psil + t46 + psih
    t199 = sin(t198)
    contr[17] = 3/8 * t110 * t89 * t199 * t14 * t195 * muM
    t203 = psig - psil + t46 - psih
    t204 = sin(t203)
    contr[18] = -3/8 * t110 * t163 * muM * t89 * t204
    t212 = psig - psil + t46 + psih
    t213 = sin(t212)
    contr[19] = -3/8 * t110 * t89 * t213 * t14 * t180 * muM
    t218 = psig + psil + t46 - psih
    t219 = sin(t218)
    contr[20] = -3/8 * t124 * t192 * t219 * t166
    t225 = psig + psil + t46 + psih
    t226 = sin(t225)
    contr[21] = -3/8 * t124 * t226 * t14 * t195 * t166
    t231 = cos(psil)
    contr[22] = t21 * t11 * IMy * t231
    t234 = sin(t22)
    t236 = t14 * t98
    contr[23] = -t134 * t236 * t10 * t234 / 4
    t240 = sin(t41)
    contr[24] = -t134 * t236 * t10 * t240 / 4
    t245 = cos(t47)
    t248 = cpa2EQ * t51
    t249 = cpa1EQ * t53
    t250 = cpa1EQ * t55
    t251 = cpa2EQ * t57
    contr[25] = -3/2 * t20 * t14 * (t248 - t249 + t250 + t251) * muM * t10 * t245
    t257 = cos(t63)
    contr[26] = 3/2 * t21 * (t248 - t249 - t250 - t251) * t10 * t257
    t262 = cpa2EQ * t10
    t263 = sin(t72)
    contr[27] = -3/4 * t134 * t263 * t14 * t262
    t268 = sin(t81)
    contr[28] = 3/4 * t134 * t268 * t14 * t262
    t272 = cos(t86)
    t275 = IMx * t104
    t276 = t98 * IMy
    t278 = t14 * (t275 - t276)
    contr[29] = t110 * t278 * muM * t89 * t272 / 8
    t281 = cos(t113)
    t283 = t275 + t276
    contr[30] = t125 * t283 * muM * t281 / 8
    t286 = sin(t130)
    t289 = t14 * (t92 - t94 - t95)
    contr[31] = -3/4 * t134 * t289 * t286 * t10
    t293 = sin(t137)
    contr[32] = 3/4 * t134 * t289 * t293 * t10
    t297 = cos(t142)
    contr[33] = -t110 * t14 * t283 * muM * t89 * t297 / 8
    t304 = cos(t150)
    contr[34] = -t124 * t278 * t120 * muM * t304 / 8
    t310 = IMx * cpa1EQ
    t311 = IMy * cpa2EQ
    t312 = t310 - t311
    t314 = cos(t156)
    contr[35] = 3/8 * t124 * t314 * t14 * t312 * t166
    t318 = cpa1EQ * t167
    t320 = 2 * t8 * t51
    t321 = cpa1EQ * t172
    t322 = cpa2EQ * t174
    t324 = 2 * t169 * t55
    t325 = cpa2EQ * t178
    t326 = t318 + t320 - t321 - t322 + t324 + t325
    t328 = cos(t182)
    contr[36] = 3/8 * t124 * t328 * t14 * t326 * t166
    t332 = cos(t187)
    t334 = t310 + t311
    t336 = t110 * t15
    contr[37] = 3/8 * t336 * t334 * t89 * t332
    t338 = cos(t198)
    t340 = t318 + t320 - t321 + t322 - t324 - t325
    contr[38] = 3/8 * t336 * t340 * t89 * t338
    t345 = cos(t203)
    contr[39] = -3/8 * t110 * t89 * t345 * t14 * t312 * muM
    t352 = cos(t212)
    contr[40] = -3/8 * t110 * t89 * t352 * t14 * t326 * muM
    t357 = cos(t218)
    t360 = t124 * t166
    contr[41] = -3/8 * t360 * t14 * t334 * t357
    t363 = cos(t225)
    contr[42] = -3/8 * t360 * t14 * t340 * t363
    contr = sum(contr)
    return contr
end

function derivativechiM2_cdelta2_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    contr = zeros(29)
    t1 = 2 * TL
    t2 = -psig + t1
    t3 = cos(t2)
    t4 = sqrt(smk)
    t7 = Q2 * cpa1EQ
    t9 = (Q1 * cpa2EQ - t7) * IMz
    t11 = Q1 ^ 2
    t12 = Q2 ^ 2
    t14 = 1 / (t11 + t12 + 1)
    t15 = t14 * muM
    t16 = rc ^ 2
    t18 = 0.1e1 / t16 / rc
    t20 = 0.1e1 / npsig
    t21 = t20 * t18 * cdelta
    t22 = t21 * t15
    contr[1] = -3/2 * t22 * t9 * t4 * t3
    t25 = psig + t1
    t26 = cos(t25)
    contr[2] = 3/2 * t22 * t9 * t4 * t26
    t30 = sqrt(skm)
    t31 = t30 - 1
    t32 = cdelta * t31
    t33 = psig - psil
    t34 = sin(t33)
    t39 = Q1 * cpa1EQ
    t40 = Q2 * cpa2EQ
    t41 = cpa3EQ * (t11 + t12 - 1) - t39 + t40
    t43 = t18 * t14
    t44 = npsil - npsig
    t47 = 1 / t44 * t43 * muM * t41
    contr[3] = t47 * IMx * t34 * t32 / 2
    t49 = psig + psil
    t50 = sin(t49)
    t54 = t30 + 1
    t57 = 0.1e1 / (npsil + npsig)
    t59 = t57 * t43 * t54 * muM
    contr[4] = -t59 * t41 * IMx * t50 * cdelta / 2
    t69 = -2 * Q1 * Q2 * cpa1EQ - 4 * Q2 * cpa3EQ - cpa2EQ * t11 + cpa2EQ * t12 - cpa2EQ
    t77 = cpa1EQ * t11 + Q1 * (-2 * t40 + 4 * cpa3EQ) - cpa1EQ * t12 - cpa1EQ
    t78 = t77 * IMy
    t81 = -psil + psih
    t82 = sin(t81)
    t86 = 1 / npsil * t18
    t87 = t86 * t15
    contr[5] = t87 * t82 * cdelta * (IMx * t69 + t78) * t4 / 4
    t89 = cdelta * t4
    t90 = psil + psih
    t91 = sin(t90)
    t94 = -t69
    contr[6] = t86 * t14 * (IMx * t94 + t78) * muM * t91 * t89 / 4
    t100 = t1 - psig - psil
    t101 = sin(t100)
    t103 = Q1 * IMx
    t104 = cpa1EQ * t103
    t105 = Q2 * IMx
    t106 = cpa2EQ * t105
    t107 = Q1 * IMy
    t108 = cpa2EQ * t107
    t109 = Q2 * IMy
    t110 = cpa1EQ * t109
    t111 = t104 + t106 - t108 + t110
    t114 = cdelta * t14
    t115 = t57 * t18
    t116 = t115 * t114
    contr[7] = -3/4 * t116 * t111 * t54 * muM * t101
    t119 = t1 - psig + psil
    t120 = sin(t119)
    t122 = t104 + t106 + t108 - t110
    t127 = -1 / t44 * t18
    t128 = t127 * t114
    contr[8] = -3/4 * t128 * t122 * muM * t31 * t120
    t131 = t1 + psig - psil
    t132 = sin(t131)
    contr[9] = 3/4 * t128 * t111 * muM * t31 * t132
    t137 = t1 + psig + psil
    t138 = sin(t137)
    contr[10] = 3/4 * t116 * t122 * t54 * muM * t138
    t143 = -psih - psil + t1
    t144 = sin(t143)
    t146 = IMx * cpa2EQ
    t147 = IMy * cpa1EQ
    contr[11] = 3/4 * t86 * t114 * (t146 + t147) * muM * t4 * t144
    t156 = -psih + psil + t1
    t157 = sin(t156)
    contr[12] = -3/4 * t86 * t157 * muM * t89 * t14 * (t146 - t147)
    t162 = t11 * IMx
    t163 = cpa2EQ * t162
    t165 = 2 * t7 * t103
    t166 = t12 * IMx
    t167 = cpa2EQ * t166
    t168 = t11 * IMy
    t169 = cpa1EQ * t168
    t171 = 2 * t40 * t107
    t172 = t12 * IMy
    t173 = cpa1EQ * t172
    t177 = psih - psil + t1
    t178 = sin(t177)
    contr[13] = 3/4 * t86 * t178 * t14 * (t163 - t165 - t167 + t169 + t171 - t173) * muM * t89
    t185 = psih + psil + t1
    t186 = sin(t185)
    contr[14] = -3/4 * t86 * t186 * t14 * (t163 - t165 - t167 - t169 - t171 + t173) * muM * t89
    t191 = cdelta * muM
    t192 = sin(psig)
    contr[15] = t20 * t43 * IMz * t4 * t41 * t192 * t191
    t198 = sin(t2)
    t200 = IMz * muM
    t204 = t21 * t14 * (t39 + t40)
    contr[16] = 3/2 * t204 * t200 * t4 * t198
    t206 = sin(t25)
    contr[17] = -3/2 * t204 * t200 * t4 * t206
    t211 = cos(t33)
    contr[18] = -t47 * IMy * t211 * t32 / 2
    t216 = cos(t49)
    contr[19] = -t59 * t41 * IMy * t216 * cdelta / 2
    t222 = IMx * t77
    t223 = t94 * IMy
    t226 = cos(t81)
    contr[20] = t87 * t226 * cdelta * (t222 + t223) * t4 / 4
    t230 = cos(t90)
    contr[21] = -t87 * (t222 - t223) * t230 * t89 / 4
    t236 = cos(t100)
    t238 = cpa2EQ * t103
    t239 = cpa1EQ * t105
    t240 = cpa1EQ * t107
    t241 = cpa2EQ * t109
    t242 = t238 - t239 + t240 + t241
    contr[22] = 3/4 * t116 * t242 * t54 * muM * t236
    t246 = cos(t119)
    t248 = t238 - t239 - t240 - t241
    contr[23] = 3/4 * t127 * t191 * t14 * t248 * t31 * t246
    t253 = cos(t131)
    contr[24] = -3/4 * t128 * t242 * muM * t31 * t253
    t259 = cos(t137)
    contr[25] = -3/4 * t115 * cdelta * t54 * t15 * t248 * t259
    t266 = IMx * cpa1EQ
    t267 = IMy * cpa2EQ
    t271 = cos(t143)
    contr[26] = 3/4 * t86 * t271 * muM * t89 * t14 * (t266 - t267)
    t278 = cos(t156)
    contr[27] = -3/4 * t86 * t278 * t14 * (t266 + t267) * muM * t89
    t283 = cpa1EQ * t162
    t285 = 2 * t40 * t103
    t286 = cpa1EQ * t166
    t287 = cpa2EQ * t168
    t289 = 2 * t7 * t107
    t290 = cpa2EQ * t172
    t294 = cos(t177)
    contr[28] = 3/4 * t86 * t294 * t14 * (t283 + t285 - t286 - t287 + t289 + t290) * muM * t89
    t298 = cos(t185)
    contr[29] = -3/4 * t86 * t191 * t14 * (t283 + t285 - t286 + t287 - t289 - t290) * t4 * t298
    contr = sum(contr)
    return contr
end

function derivativechiM2_cdeltapsigMpsihOsdelta_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,npsig,npsil,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    contr = zeros(65)
    t1 = sqrt(smk)
    t2 = t1 * cdelta
    t4 = Q2 * cpa1EQ
    t7 = (Q1 * cpa2EQ - t4) * IMz * t2
    t8 = Q1 ^ 2
    t9 = Q2 ^ 2
    t11 = 0.1e1 / (t8 + t9 + 1)
    t12 = muM * t11
    t13 = 2 * TL
    t14 = -psig + t13
    t15 = sin(t14)
    t16 = rc ^ 2
    t18 = 0.1e1 / t16 / rc
    t20 = 0.1e1 / npsig
    contr[1] = 3/2 * t20 * t18 * t15 * t12 * t7
    t24 = psig + t13
    t25 = sin(t24)
    contr[2] = 3/2 * t20 * t18 * t25 * t12 * t7
    t30 = muM * t1
    t31 = sdelta * IMz
    t32 = t31 * t30
    t33 = cpa1EQ * t8
    t34 = Q1 * Q2
    t36 = 2 * cpa2EQ * t34
    t37 = cpa1EQ * t9
    t41 = t11 * (4 * Q1 * cpa3EQ - cpa1EQ + t33 - t36 - t37)
    t42 = psig - psih
    t43 = sin(t42)
    contr[3] = -t20 * t18 * t43 * t41 * t32 / 4
    t49 = psig + psih
    t50 = sin(t49)
    contr[4] = t20 * t18 * t50 * t41 * t32 / 4
    t55 = sqrt(skm)
    t56 = t55 - 1
    t57 = cdelta * t56
    t58 = psig - psil
    t59 = cos(t58)
    t64 = Q1 * cpa1EQ
    t65 = Q2 * cpa2EQ
    t66 = cpa3EQ * (t8 + t9 - 1) - t64 + t65
    t68 = t18 * t11
    t69 = npsil - npsig
    t72 = 0.1e1 / t69 * t68 * muM * t66
    contr[5] = -t72 * IMx * t59 * t57 / 2
    t75 = psig + psil
    t76 = cos(t75)
    t80 = t55 + 1
    t83 = 0.1e1 / (npsil + npsig)
    t85 = t83 * t68 * muM * t80
    contr[6] = t85 * t66 * IMx * t76 * cdelta / 2
    t87 = -psil + psih
    t88 = cos(t87)
    t91 = cpa2EQ * t8
    t93 = 2 * cpa1EQ * t34
    t94 = cpa2EQ * t9
    t97 = -4 * Q2 * cpa3EQ - cpa2EQ - t91 - t93 + t94
    t103 = t33 + Q1 * (-2 * t65 + 4 * cpa3EQ) - t37 - cpa1EQ
    t104 = t103 * IMy
    t106 = t11 * (IMx * t97 + t104)
    t108 = 0.1e1 / npsil * t18
    contr[7] = t108 * t106 * t1 * muM * t88 / 4
    t111 = psil + psih
    t112 = cos(t111)
    t113 = -t97
    t115 = IMx * t113 + t104
    t119 = t108 * t11 * t1
    contr[8] = t119 * muM * t115 * t112 / 4
    t121 = cdelta * muM
    t122 = Q1 * IMx
    t123 = cpa1EQ * t122
    t124 = Q2 * IMx
    t125 = cpa2EQ * t124
    t126 = Q1 * IMy
    t127 = cpa2EQ * t126
    t128 = Q2 * IMy
    t129 = cpa1EQ * t128
    t130 = t123 + t125 - t127 + t129
    t133 = t13 - psig - psil
    t134 = cos(t133)
    t136 = t83 * t18
    contr[9] = -3/4 * t136 * t134 * t11 * t130 * t80 * t121
    t140 = t123 + t125 + t127 - t129
    t143 = t13 - psig + psil
    t144 = cos(t143)
    t148 = -0.1e1 / t69 * t18
    contr[10] = -3/4 * t148 * t144 * t11 * t140 * muM * t57
    t154 = t13 + psig - psil
    t155 = cos(t154)
    contr[11] = -3/4 * t148 * t155 * t11 * t130 * muM * t57
    t162 = t13 + psig + psil
    t163 = cos(t162)
    contr[12] = -3/4 * t136 * t163 * t11 * t140 * t80 * t121
    t168 = t11 * cpa1EQ
    t169 = -psih - psig + t13
    t170 = sin(t169)
    t173 = muM * sdelta
    t176 = t20 * t18 * IMz * t173
    contr[13] = 3/4 * t176 * t170 * t1 * t168
    t178 = -psih + psig + t13
    t179 = sin(t178)
    contr[14] = 3/4 * t176 * t179 * t1 * t168
    t183 = -psih + psig - psil
    t184 = cos(t183)
    t188 = t148 * t11 * t56
    contr[15] = -t188 * t115 * t184 * t173 / 8
    t191 = sdelta * t80
    t192 = -psih + psig + psil
    t193 = cos(t192)
    contr[16] = t136 * t106 * t193 * muM * t191 / 8
    t198 = IMx * cpa2EQ
    t199 = IMy * cpa1EQ
    t200 = t198 + t199
    t202 = -psih - psil + t13
    t203 = cos(t202)
    contr[17] = -3/4 * t108 * t203 * t11 * t200 * t30
    t208 = t198 - t199
    t211 = -psih + psil + t13
    t212 = cos(t211)
    contr[18] = 3/4 * t108 * t212 * muM * t11 * t208 * t1
    t216 = psih - psig + t13
    t217 = sin(t216)
    t220 = t11 * (t33 + t36 - t37)
    contr[19] = 3/4 * t176 * t220 * t217 * t1
    t223 = psih + psig + t13
    t224 = sin(t223)
    contr[20] = 3/4 * t176 * t220 * t224 * t1
    t228 = psih + psig - psil
    t229 = cos(t228)
    contr[21] = t148 * t106 * t56 * t229 * t173 / 8
    t234 = psih + psig + psil
    t235 = cos(t234)
    contr[22] = -t136 * t11 * t115 * t235 * muM * t191 / 8
    t242 = psih - psil + t13
    t243 = cos(t242)
    t245 = t8 * IMx
    t246 = cpa2EQ * t245
    t248 = 2 * t4 * t122
    t249 = t9 * IMx
    t250 = cpa2EQ * t249
    t251 = t8 * IMy
    t252 = cpa1EQ * t251
    t254 = 2 * t65 * t126
    t255 = t9 * IMy
    t256 = cpa1EQ * t255
    t258 = t11 * (t246 - t248 - t250 + t252 + t254 - t256)
    contr[23] = 3/4 * t108 * t258 * t243 * t30
    t261 = t246 - t248 - t250 - t252 - t254 + t256
    t263 = psih + psil + t13
    t264 = cos(t263)
    contr[24] = -3/4 * t108 * t264 * t11 * t261 * t30
    t269 = t11 * t200
    t270 = -psig - psil + t13 - psih
    t271 = cos(t270)
    t274 = t136 * t191
    contr[25] = 3/8 * t274 * muM * t271 * t269
    t276 = -psig - psil + t13 + psih
    t277 = cos(t276)
    contr[26] = 3/8 * t274 * t258 * muM * t277
    t281 = -psig + psil + t13 - psih
    t282 = cos(t281)
    t284 = t11 * t208
    t287 = t148 * sdelta * t56
    contr[27] = 3/8 * t287 * t284 * muM * t282
    t289 = -psig + psil + t13 + psih
    t290 = cos(t289)
    t292 = t11 * t261
    contr[28] = 3/8 * t287 * t292 * muM * t290
    t295 = psig - psil + t13 - psih
    t296 = cos(t295)
    contr[29] = 3/8 * t287 * muM * t296 * t269
    t300 = psig - psil + t13 + psih
    t301 = cos(t300)
    contr[30] = 3/8 * t287 * t258 * muM * t301
    t305 = psig + psil + t13 - psih
    t306 = cos(t305)
    contr[31] = 3/8 * t274 * t284 * muM * t306
    t310 = psig + psil + t13 + psih
    t311 = cos(t310)
    contr[32] = 3/8 * t274 * t292 * muM * t311
    t315 = cos(psig)
    contr[33] = -t20 * t68 * IMz * t1 * t66 * t315 * t121
    t323 = IMz * muM * t2
    t325 = t11 * (t64 + t65)
    t326 = cos(t14)
    contr[34] = 3/2 * t20 * t18 * t326 * t325 * t323
    t331 = cos(t24)
    contr[35] = 3/2 * t20 * t18 * t331 * t325 * t323
    t337 = t11 * t113 * t30
    t338 = cos(t42)
    contr[36] = t20 * t18 * t338 * t31 * t337 / 4
    t343 = cos(t49)
    contr[37] = t20 * t18 * t343 * t31 * t337 / 4
    t348 = sin(t58)
    contr[38] = -t72 * IMy * t348 * t57 / 2
    t353 = sin(t75)
    contr[39] = -t85 * t66 * IMy * t353 * cdelta / 2
    t359 = sin(t87)
    t362 = IMx * t103
    t363 = t113 * IMy
    t364 = t362 + t363
    contr[40] = -t108 * t11 * t364 * t1 * muM * t359 / 4
    t369 = t362 - t363
    t370 = sin(t111)
    contr[41] = t119 * muM * t370 * t369 / 4
    t374 = cpa2EQ * t122
    t375 = cpa1EQ * t124
    t376 = cpa1EQ * t126
    t377 = cpa2EQ * t128
    t378 = t374 - t375 + t376 + t377
    t381 = sin(t133)
    contr[42] = -3/4 * t136 * t381 * t11 * t378 * t80 * t121
    t386 = t374 - t375 - t376 - t377
    t389 = sin(t143)
    contr[43] = -3/4 * t148 * t389 * muM * t11 * t386 * t57
    t396 = sin(t154)
    contr[44] = -3/4 * t148 * t396 * t11 * t378 * muM * t57
    t403 = sin(t162)
    contr[45] = -3/4 * t136 * t403 * t80 * t12 * t386 * cdelta
    t408 = t11 * cpa2EQ
    t409 = cos(t169)
    contr[46] = -3/4 * t176 * t409 * t1 * t408
    t414 = cos(t178)
    contr[47] = -3/4 * t176 * t414 * t1 * t408
    t419 = sin(t183)
    contr[48] = t188 * t369 * t419 * t173 / 8
    t425 = sin(t192)
    contr[49] = t136 * t11 * t425 * t173 * t80 * t364 / 8
    t429 = IMx * cpa1EQ
    t430 = IMy * cpa2EQ
    t432 = t11 * (t429 - t430)
    t434 = sin(t202)
    contr[50] = 3/4 * t108 * t434 * muM * t1 * t432
    t438 = t429 + t430
    t440 = sin(t211)
    contr[51] = -3/4 * t108 * t440 * t11 * t438 * t30
    t446 = t11 * (t91 - t93 - t94)
    t447 = cos(t216)
    contr[52] = -3/4 * t176 * t447 * t1 * t446
    t452 = cos(t223)
    contr[53] = -3/4 * t176 * t452 * t1 * t446
    t458 = sin(t228)
    contr[54] = -t188 * t458 * muM * sdelta * t364 / 8
    t463 = sin(t234)
    contr[55] = -t136 * t11 * t369 * t463 * muM * t191 / 8
    t470 = sin(t242)
    t472 = cpa1EQ * t245
    t474 = 2 * t65 * t122
    t475 = cpa1EQ * t249
    t476 = cpa2EQ * t251
    t478 = 2 * t4 * t126
    t479 = cpa2EQ * t255
    t481 = t11 * (t472 + t474 - t475 - t476 + t478 + t479)
    contr[56] = -3/4 * t108 * t481 * t470 * t30
    t485 = t472 + t474 - t475 + t476 - t478 - t479
    t488 = sin(t263)
    contr[57] = 3/4 * t108 * t488 * muM * t11 * t485 * t1
    t492 = sin(t270)
    contr[58] = -3/8 * t274 * muM * t492 * t432
    t497 = sin(t276)
    contr[59] = -3/8 * t274 * t481 * muM * t497
    t502 = sin(t281)
    t504 = t11 * t438
    contr[60] = -3/8 * t287 * t504 * muM * t502
    t508 = sin(t289)
    t510 = t11 * t485
    contr[61] = -3/8 * t287 * t510 * muM * t508
    t514 = sin(t295)
    contr[62] = -3/8 * t287 * muM * t514 * t432
    t519 = sin(t300)
    contr[63] = -3/8 * t287 * t481 * muM * t519
    t524 = sin(t305)
    contr[64] = -3/8 * t274 * t504 * muM * t524
    t529 = sin(t310)
    contr[65] = -3/8 * t274 * t510 * muM * t529
    contr = sum(contr)
    return contr
end

function derivativechiM3_psil_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    return 0.0;
end

function derivativechiM3_psig_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    return 0.0;
end

function derivativechiM3_psih_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    contr = zeros(14)
    t1 = sqrt(skm)
    t2 = t1 * IMz
    t3 = sdelta * muM
    t4 = P1 ^ 2
    t5 = cpa1EQ * t4
    t6 = 3/4 * t5
    t7 = P2 ^ 2
    t8 = cpa1EQ * t7
    t9 = 3/4 * t8
    t10 = cpa2EQ * phiTA
    t11 = t10 / 2
    t12 = P2 * P1
    t13 = cpa2EQ * t12
    t14 = 3/2 * t13
    t16 = Q2 ^ 2
    t18 = t4 * cpa2EQ
    t20 = 3/2 * Q1 * t18
    t21 = P1 * cpa1EQ
    t22 = P2 * Q1
    t24 = 3 * t22 * t21
    t25 = t7 * cpa2EQ
    t27 = 3/2 * Q1 * t25
    t29 = 2 * cpa3EQ
    t31 = (Q1 * cpa1EQ + t29) * phiTA
    t34 = Q1 ^ 2
    t35 = t34 + 1
    t43 = eta ^ 2
    t44 = t43 * eta
    t46 = 3/2 * t10
    t49 = 3 * t31
    t59 = t4 ^ 2
    t60 = cpa1EQ * t59
    t62 = t7 ^ 2
    t63 = cpa1EQ * t62
    t65 = t4 * P1
    t66 = P2 * t65
    t67 = cpa2EQ * t66
    t69 = t7 * P2
    t70 = t69 * P1
    t71 = cpa2EQ * t70
    t75 = t59 * cpa2EQ
    t76 = Q1 * t75
    t79 = t22 * t65 * cpa1EQ
    t82 = Q1 * t69 * t21
    t84 = t62 * cpa2EQ
    t85 = Q1 * t84
    t92 = (t60 / 2 - t63 / 2 + t10 - t67 - t71) * t35
    t110 = sin(psih)
    t112 = 0.1e1 / (t34 + t16 + 1)
    t114 = sma ^ 2
    t116 = 0.1e1 / t114 / sma
    t120 = 0.1e1 / n / t44
    t121 = 1 + eta
    t122 = t121 ^ 2
    t125 = 1 / t122 / t121 * t120
    contr[1] = t125 * t116 * t112 * t110 * (t44 * (t16 * (-t6 + t9 - t11 + t14) + Q2 * (t20 + t24 - t27 + t31) + (3/2 * t5 - 3/2 * t8 + t10 - 3 * t13) * t35 / 2) + t43 * (t16 * (-t6 + t9 - t46 + t14) + Q2 * (t20 + t24 - t27 + t49) + 3/2 * (t5 / 2 - t8 / 2 + t10 - t13) * t35) + eta * (t16 * (-3/4 * t60 + 3/4 * t63 - t46 + 3/2 * t67 + 3/2 * t71) + Q2 * (3/2 * t76 + 3 * t79 + 3 * t82 - 3/2 * t85 + t49) + 3/2 * t92) + t16 * (t67 / 2 + t71 / 2 - t60 / 4 + t63 / 4 - t11) + Q2 * (t76 / 2 + t79 + t82 - t85 / 2 + t31) + t92 / 2) * t3 * t2
    t127 = sdelta * t1
    t128 = Q2 * Q1
    t129 = cpa1EQ * t128
    t130 = cpa2EQ * t34
    t131 = t130 / 2
    t132 = cpa2EQ * t16
    t133 = t132 / 2
    t134 = Q2 * cpa3EQ
    t135 = 2 * t134
    t139 = cpa1EQ * t34
    t140 = Q2 * cpa2EQ
    t144 = Q1 * (-2 * t140 + 4 * cpa3EQ)
    t145 = cpa1EQ * t16
    t154 = TL - psih
    t155 = sin(t154)
    t157 = t116 * t120
    contr[2] = t157 * t112 * t155 * IMz * muM * (P1 * (t129 + t131 - t133 + t135 + 2 * cpa2EQ) - P2 * (t139 + t144 - t145 - 4 * cpa1EQ) / 2) * t127 / 2
    t172 = TL + psih
    t173 = sin(t172)
    contr[3] = t157 * t112 * t173 * IMz * muM * (P1 * (t129 - t130 + t132 - t134 - cpa2EQ / 4) - (t139 + Q1 * (t140 + cpa3EQ) - t145 - cpa1EQ / 4) * P2) * t127
    t176 = muM * IMz
    t179 = 2 * TL
    t180 = t179 - psih
    t181 = sin(t180)
    contr[4] = 3/4 * t157 * t181 * t112 * cpa1EQ * t127 * t176
    t189 = sdelta * t176
    t191 = t179 + psih
    t192 = sin(t191)
    contr[5] = -3/4 * t157 * t192 * t1 * t189 * t112 * (2 * cpa2EQ * t128 + t139 - t145)
    t197 = P1 * cpa2EQ
    t202 = 3 * TL
    t203 = t202 - psih
    t204 = sin(t203)
    contr[6] = -t157 * t204 * t1 * t189 * t112 * (-P2 * cpa1EQ + t197) / 4
    t209 = t34 * P1
    t211 = P1 * Q1
    t212 = Q2 * cpa1EQ
    t215 = t16 * P1
    t217 = t34 * P2
    t221 = t16 * P2
    t228 = t202 + psih
    t229 = sin(t228)
    contr[7] = t157 * t229 * t1 * sdelta * IMz * t112 * (-cpa1EQ * t217 + cpa1EQ * t221 + cpa2EQ * t209 - cpa2EQ * t215 - 2 * t140 * t22 - 2 * t212 * t211) * muM / 4
    t233 = cos(psih)
    t236 = 3/2 * t18
    t237 = cpa1EQ * t12
    t238 = 3 * t237
    t239 = 3/2 * t25
    t240 = cpa1EQ * phiTA
    t241 = t236 + t238 - t239 + t240
    t244 = 3 * Q2 * t5
    t245 = P2 * Q2
    t247 = 6 * t245 * t197
    t249 = 3 * Q2 * t8
    t251 = (t140 - t29) * phiTA
    t252 = 2 * t251
    t255 = t16 + 1
    t259 = 3 * t240
    t262 = 6 * t251
    t274 = cpa1EQ * t66
    t276 = cpa1EQ * t70
    t280 = Q2 * t60
    t283 = t245 * t65 * cpa2EQ
    t286 = Q2 * t69 * t197
    t288 = Q2 * t63
    t294 = t75 / 2 - t84 / 2 + t274 + t276 + t240
    t295 = t294 * t255
    contr[8] = -t125 * t116 * t112 * (t44 * (t34 * t241 + Q1 * (-t244 + t247 + t249 - t252) - t241 * t255) + t43 * (t34 * (t238 + t236 - t239 + t259) + Q1 * (-t244 + t247 + t249 - t262) - 3 * t255 * (t237 + t18 / 2 - t25 / 2 + t240)) + eta * (t34 * (3/2 * t75 - 3/2 * t84 + 3 * t274 + 3 * t276 + t259) + Q1 * (-3 * t280 + 6 * t283 + 6 * t286 + 3 * t288 - t262) - 3 * t295) + t34 * t294 + Q1 * (-t280 + 2 * t283 + 2 * t286 + t288 - t252) - t295) * t233 * t3 * t2 / 2
    t319 = cos(t154)
    contr[9] = t157 * t112 * t319 * (P1 * (t139 + t144 - t145 + 2 * cpa1EQ) + 2 * (t129 + t131 - t133 + t135 - cpa2EQ) * P2) * t176 * t127 / 4
    t339 = cos(t172)
    contr[10] = -t157 * t112 * t339 * t189 * t1 * (P1 * (t139 + Q1 * (4 * t140 - t29) - t145 + cpa1EQ / 2) + 4 * (t129 - t130 / 4 + t132 / 4 + t134 / 2 + cpa2EQ / 8) * P2) / 2
    t346 = cos(t180)
    contr[11] = -3/4 * t157 * t346 * t112 * cpa2EQ * t127 * t176
    t355 = cos(t191)
    contr[12] = 3/4 * t157 * t355 * t112 * (t130 - 2 * t129 - t132) * t127 * t176
    t364 = cos(t203)
    contr[13] = -t157 * t364 * IMz * t1 * t112 * (P2 * cpa2EQ + t21) * t3 / 4
    t381 = cos(t228)
    contr[14] = t157 * t381 * t1 * t112 * (cpa1EQ * t209 - cpa1EQ * t215 + cpa2EQ * t217 - cpa2EQ * t221 + 2 * t140 * t211 - 2 * t212 * t22) * sdelta * t176 / 4

    contr = sum(contr);
    return contr;

end

function derivativechiM3_csigma1_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    contr = zeros(21)
    t1 = Q1 ^ 2
    t2 = cpa3EQ * t1
    t4 = Q2 ^ 2
    t5 = cpa3EQ * t4
    t7 = Q1 * cpa1EQ
    t8 = Q2 * cpa2EQ
    t10 = 2 * cpa3EQ
    t14 = Q2 * cpa1EQ
    t15 = -Q1 * cpa2EQ + t14
    t20 = cos(TL)
    t24 = 1 / (t1 + t4 + 1)
    t27 = eta ^ 2
    t28 = t27 * eta
    t30 = 0.1e1 / t28 / n
    t31 = sma ^ 2
    t33 = 0.1e1 / t31 / sma
    t34 = t33 * t30
    t35 = t34 * t24 * cdelta
    contr[1] = -t35 * t20 * muM * IMz * (P1 * (2 * t2 + 2 * t5 + t7 + 5 * t8 - t10) + 3 * t15 * P2) / 2
    t38 = IMz * sdelta
    t39 = P1 ^ 2
    t40 = cpa1EQ * t39
    t41 = 3/4 * t40
    t42 = P2 ^ 2
    t43 = cpa1EQ * t42
    t44 = 3/4 * t43
    t45 = cpa2EQ * phiTA
    t46 = t45 / 2
    t47 = P2 * P1
    t48 = cpa2EQ * t47
    t49 = 3/2 * t48
    t52 = t39 * cpa2EQ
    t54 = 3/2 * Q1 * t52
    t55 = P1 * cpa1EQ
    t56 = P2 * Q1
    t58 = 3 * t56 * t55
    t59 = t42 * cpa2EQ
    t61 = 3/2 * Q1 * t59
    t63 = (t7 + t10) * phiTA
    t66 = t1 + 1
    t67 = 3/2 * t40
    t68 = 3/2 * t43
    t69 = 3 * t48
    t70 = t67 - t68 + t45 - t69
    t75 = 3/2 * t45
    t78 = 3 * t63
    t88 = t39 ^ 2
    t89 = cpa1EQ * t88
    t91 = t42 ^ 2
    t92 = cpa1EQ * t91
    t94 = t39 * P1
    t95 = P2 * t94
    t96 = cpa2EQ * t95
    t98 = t42 * P2
    t99 = t98 * P1
    t100 = cpa2EQ * t99
    t104 = t88 * cpa2EQ
    t105 = Q1 * t104
    t108 = t56 * t94 * cpa1EQ
    t111 = Q1 * t98 * t55
    t113 = t91 * cpa2EQ
    t114 = Q1 * t113
    t121 = (t89 / 2 - t92 / 2 + t45 - t96 - t100) * t66
    t138 = cos(psih)
    t142 = 1 + eta
    t143 = t142 ^ 2
    t147 = 1 / t143 / t142 * t30 * t33 * t24
    contr[2] = -t147 * t138 * (t28 * (t4 * (-t41 + t44 - t46 + t49) + Q2 * (t54 + t58 - t61 + t63) + t70 * t66 / 2) + t27 * (t4 * (-t41 + t44 - t75 + t49) + Q2 * (t54 + t58 - t61 + t78) + 3/2 * (t40 / 2 - t43 / 2 + t45 - t48) * t66) + eta * (t4 * (-3/4 * t89 + 3/4 * t92 - t75 + 3/2 * t96 + 3/2 * t100) + Q2 * (3/2 * t105 + 3 * t108 + 3 * t111 - 3/2 * t114 + t78) + 3/2 * t121) + t4 * (t96 / 2 + t100 / 2 - t89 / 4 + t92 / 4 - t46) + Q2 * (t105 / 2 + t108 + t111 - t114 / 2 + t63) + t121 / 2) * muM * t38
    t149 = 2 * TL
    t150 = cos(t149)
    t152 = muM * cdelta
    contr[3] = -3/2 * t34 * t24 * t15 * t152 * IMz * t150
    t158 = 3 * TL
    t159 = cos(t158)
    t160 = P1 * Q1
    t162 = Q2 * P1
    t165 = P2 * Q2
    t169 = muM * t24
    t172 = t34 * IMz * cdelta
    contr[4] = t172 * t169 * (cpa1EQ * t160 - cpa1EQ * t165 + cpa2EQ * t162 + cpa2EQ * t56) * t159 / 2
    t174 = Q2 * Q1
    t175 = cpa1EQ * t174
    t176 = t1 * cpa2EQ
    t177 = t176 / 2
    t178 = t4 * cpa2EQ
    t179 = t178 / 2
    t180 = Q2 * cpa3EQ
    t181 = 2 * t180
    t185 = cpa1EQ * t1
    t189 = Q1 * (-2 * t8 + 4 * cpa3EQ)
    t190 = cpa1EQ * t4
    t197 = muM * IMz
    t199 = TL - psih
    t200 = cos(t199)
    contr[5] = t34 * t24 * t200 * t197 * (P1 * (t175 + t177 - t179 + t181 + 2 * cpa2EQ) - P2 * (t185 + t189 - t190 - 4 * cpa1EQ) / 2) * sdelta / 2
    t215 = TL + psih
    t216 = cos(t215)
    contr[6] = -t34 * t24 * t216 * t197 * (P1 * (t175 - t176 + t178 - t180 - cpa2EQ / 4) - (t185 + Q1 * (t8 + cpa3EQ) - t190 - cpa1EQ / 4) * P2) * sdelta
    t220 = t149 - psih
    t221 = cos(t220)
    t224 = sdelta * t24
    contr[7] = 3/4 * t34 * t224 * cpa1EQ * t221 * t197
    t232 = t149 + psih
    t233 = cos(t232)
    contr[8] = 3/4 * t34 * sdelta * t233 * t197 * t24 * (2 * cpa2EQ * t174 + t185 - t190)
    t237 = t158 - psih
    t238 = cos(t237)
    t239 = P1 * cpa2EQ
    t244 = t34 * t38
    contr[9] = -t244 * t169 * (-P2 * cpa1EQ + t239) * t238 / 4
    t247 = t158 + psih
    t248 = cos(t247)
    t250 = t1 * P1
    t254 = t4 * P1
    t256 = t1 * P2
    t260 = t4 * P2
    contr[10] = -t244 * t24 * (-cpa1EQ * t256 + cpa1EQ * t260 + cpa2EQ * t250 - cpa2EQ * t254 - 2 * t14 * t160 - 2 * t8 * t56) * muM * t248 / 4
    t267 = sin(TL)
    t273 = cpa2EQ * t160
    t275 = cpa1EQ * t162
    t277 = cpa1EQ * t56
    t279 = cpa2EQ * t165
    contr[11] = -t35 * (2 * P2 * cpa3EQ - 2 * cpa3EQ * t256 - 2 * cpa3EQ * t260 + 3 * t273 - 3 * t275 + 5 * t277 + t279) * IMz * muM * t267 / 2
    t287 = 3/2 * t52
    t288 = cpa1EQ * t47
    t289 = 3 * t288
    t290 = 3/2 * t59
    t291 = cpa1EQ * phiTA
    t292 = t287 + t289 - t290 + t291
    t295 = 3 * Q2 * t40
    t297 = 6 * t165 * t239
    t299 = 3 * Q2 * t43
    t301 = (t8 - t10) * phiTA
    t302 = 2 * t301
    t305 = t4 + 1
    t309 = 3 * t291
    t310 = t289 + t287 - t290 + t309
    t312 = 6 * t301
    t315 = t52 / 2
    t316 = t59 / 2
    t324 = cpa1EQ * t95
    t326 = cpa1EQ * t99
    t328 = 3/2 * t104 - 3/2 * t113 + 3 * t324 + 3 * t326 + t309
    t330 = Q2 * t89
    t333 = t165 * t94 * cpa2EQ
    t336 = Q2 * t98 * t239
    t338 = Q2 * t92
    t344 = t104 / 2 - t113 / 2 + t324 + t326 + t291
    t345 = t344 * t305
    t356 = sin(psih)
    contr[12] = -t147 * t356 * (t28 * (t1 * t292 + Q1 * (-t295 + t297 + t299 - t302) - t292 * t305) + t27 * (t1 * t310 + Q1 * (-t295 + t297 + t299 - t312) - 3 * t305 * (t288 + t315 - t316 + t291)) + eta * (t1 * t328 + Q1 * (-3 * t330 + 6 * t333 + 6 * t336 + 3 * t338 - t312) - 3 * t345) + t1 * t344 + Q1 * (-t330 + 2 * t333 + 2 * t336 + t338 - t302) - t345) * muM * t38 / 2
    t361 = sin(t149)
    contr[13] = -3/2 * t34 * t24 * (t7 + t8) * t152 * IMz * t361
    t369 = sin(t158)
    contr[14] = t172 * t169 * (t273 - t275 - t277 - t279) * t369 / 2
    t383 = sin(t199)
    contr[15] = -t34 * t24 * t383 * t197 * sdelta * (P1 * (t185 + t189 - t190 + 2 * cpa1EQ) + 2 * (t175 + t177 - t179 + t181 - cpa2EQ) * P2) / 4
    t404 = sin(t215)
    contr[16] = -t34 * t24 * t404 * t197 * sdelta * (P1 * (t185 + Q1 * (4 * t8 - t10) - t190 + cpa1EQ / 2) + 4 * (t175 - t176 / 4 + t178 / 4 + t180 / 2 + cpa2EQ / 8) * P2) / 2
    t409 = sin(t220)
    t411 = sdelta * muM
    contr[17] = 3/4 * t34 * t24 * cpa2EQ * t411 * IMz * t409
    t416 = sin(t232)
    contr[18] = 3/4 * t34 * t24 * (t176 - 2 * t175 - t178) * t411 * IMz * t416
    t428 = sin(t237)
    contr[19] = t34 * t428 * IMz * t224 * (P2 * cpa2EQ + t55) * muM / 4
    t432 = sin(t247)
    contr[20] = t34 * t24 * (cpa1EQ * t250 - cpa1EQ * t254 + cpa2EQ * t256 - cpa2EQ * t260 - 2 * t14 * t56 + 2 * t8 * t160) * t38 * muM * t432 / 4
    t447 = phiTA * t2
    t449 = phiTA * t5
    t452 = cpa3EQ * phiTA
    t455 = 3 * t447
    t457 = 3 * t449
    t458 = 3 * t45
    t461 = 3 * t452
    t465 = t39 + t42
    t468 = (t40 - 2 * t48 - t43) * t465
    contr[21] = -t147 * t197 * cdelta * (t28 * (Q1 * t292 - Q2 * t70 - t447 - t449 + t452) + t27 * (-t455 + Q1 * t310 - t457 + Q2 * (-t67 + t68 - t458 + t69) + t461) + eta * (-t455 + Q1 * t328 - t457 + Q2 * (-t458 - 3/2 * t468) + t461) - t447 + Q1 * (t291 + (t315 - t316 + t288) * t465) - t449 + Q2 * (-t45 - t468 / 2) + t452)
    
    contr = sum(contr);
    return contr;
end

function derivativechiM3_csigma2_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    return 0.0;
end

function derivativechiM3_cdelta1_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    contr = zeros(7)
    t1 = sqrt(skm)
    t2 = t1 * IMz
    t3 = cos(TL)
    t6 = Q1 ^ 2
    t7 = cpa3EQ * t6
    t9 = Q2 ^ 2
    t10 = cpa3EQ * t9
    t12 = Q1 * cpa1EQ
    t13 = Q2 * cpa2EQ
    t20 = -Q1 * cpa2EQ + Q2 * cpa1EQ
    t25 = 1 / (t6 + t9 + 1)
    t28 = eta ^ 2
    t29 = t28 * eta
    t31 = 0.1e1 / t29 / n
    t32 = sma ^ 2
    t34 = 0.1e1 / t32 / sma
    t35 = t34 * t31
    contr[1] = -t35 * t25 * (P1 * (2 * t7 + 2 * t10 + t12 + 5 * t13 - 2 * cpa3EQ) + 3 * t20 * P2) * t3 * muM * t2 / 2
    t39 = 2 * TL
    t40 = cos(t39)
    t42 = t1 * muM
    contr[2] = -3/2 * t35 * t25 * t20 * t42 * IMz * t40
    t48 = 3 * TL
    t49 = cos(t48)
    t50 = P1 * Q1
    t52 = Q2 * P1
    t54 = P2 * Q1
    t56 = P2 * Q2
    t60 = muM * t25
    t62 = t35 * t2
    contr[3] = t62 * t60 * (cpa1EQ * t50 - cpa1EQ * t56 + cpa2EQ * t52 + cpa2EQ * t54) * t49 / 2
    t64 = sin(TL)
    t72 = cpa2EQ * t50
    t74 = cpa1EQ * t52
    t76 = cpa1EQ * t54
    t78 = cpa2EQ * t56
    contr[4] = -t35 * t1 * t25 * (-2 * cpa3EQ * t6 * P2 - 2 * cpa3EQ * t9 * P2 + 2 * P2 * cpa3EQ + 3 * t72 - 3 * t74 + 5 * t76 + t78) * IMz * muM * t64 / 2
    t88 = sin(t39)
    contr[5] = -3/2 * t35 * t25 * (t12 + t13) * t42 * IMz * t88
    t96 = sin(t48)
    contr[6] = t62 * t60 * (t72 - t74 - t76 - t78) * t96 / 2
    t101 = phiTA * t7
    t102 = P1 ^ 2
    t103 = cpa2EQ * t102
    t104 = 3/2 * t103
    t105 = P2 * P1
    t106 = cpa1EQ * t105
    t107 = 3 * t106
    t108 = P2 ^ 2
    t109 = cpa2EQ * t108
    t110 = 3/2 * t109
    t111 = cpa1EQ * phiTA
    t114 = phiTA * t10
    t115 = cpa1EQ * t102
    t116 = 3/2 * t115
    t117 = cpa1EQ * t108
    t118 = 3/2 * t117
    t119 = cpa2EQ * phiTA
    t120 = cpa2EQ * t105
    t121 = 3 * t120
    t124 = cpa3EQ * phiTA
    t127 = 3 * t101
    t128 = 3 * t111
    t131 = 3 * t114
    t132 = 3 * t119
    t135 = 3 * t124
    t138 = t102 ^ 2
    t141 = t108 ^ 2
    t154 = t102 + t108
    t157 = (t115 - 2 * t120 - t117) * t154
    t177 = 1 + eta
    t178 = t177 ^ 2
    contr[7] = -1 / t178 / t177 * t31 * t34 * t25 * muM * IMz * (t29 * (-t101 + Q1 * (t104 + t107 - t110 + t111) - t114 + Q2 * (-t116 + t118 - t119 + t121) + t124) + t28 * (-t127 + Q1 * (t107 + t104 - t110 + t128) - t131 + Q2 * (-t116 + t118 - t132 + t121) + t135) + eta * (-t127 + Q1 * (3/2 * cpa2EQ * t138 - 3/2 * cpa2EQ * t141 + 3 * cpa1EQ * P2 * t102 * P1 + 3 * cpa1EQ * t108 * P2 * P1 + t128) - t131 + Q2 * (-t132 - 3/2 * t157) + t135) - t101 + Q1 * (t111 + (t103 / 2 - t109 / 2 + t106) * t154) - t114 + Q2 * (-t119 - t157 / 2) + t124) * t1

    contr = sum(contr);
    return contr;
end

function derivativechiM3_cdelta2_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    contr = zeros(14)
    t1 = P1 ^ 2
    t2 = cpa1EQ * t1
    t3 = 3/4 * t2
    t4 = P2 ^ 2
    t5 = cpa1EQ * t4
    t6 = 3/4 * t5
    t7 = cpa2EQ * phiTA
    t8 = t7 / 2
    t9 = P2 * P1
    t10 = cpa2EQ * t9
    t11 = 3/2 * t10
    t13 = Q2 ^ 2
    t15 = t1 * cpa2EQ
    t17 = 3/2 * Q1 * t15
    t18 = P1 * cpa1EQ
    t19 = P2 * Q1
    t21 = 3 * t19 * t18
    t22 = t4 * cpa2EQ
    t24 = 3/2 * Q1 * t22
    t26 = 2 * cpa3EQ
    t28 = (Q1 * cpa1EQ + t26) * phiTA
    t31 = Q1 ^ 2
    t32 = t31 + 1
    t40 = eta ^ 2
    t41 = t40 * eta
    t43 = 3/2 * t7
    t46 = 3 * t28
    t56 = t1 ^ 2
    t57 = cpa1EQ * t56
    t59 = t4 ^ 2
    t60 = cpa1EQ * t59
    t62 = t1 * P1
    t63 = P2 * t62
    t64 = cpa2EQ * t63
    t66 = t4 * P2
    t67 = t66 * P1
    t68 = cpa2EQ * t67
    t72 = cpa2EQ * t56
    t73 = Q1 * t72
    t76 = t19 * t62 * cpa1EQ
    t79 = Q1 * t66 * t18
    t81 = t59 * cpa2EQ
    t82 = Q1 * t81
    t89 = (t57 / 2 - t60 / 2 + t7 - t64 - t68) * t32
    t106 = sqrt(skm)
    t107 = t106 * muM
    t108 = cdelta * t107
    t110 = cos(psih)
    t112 = 0.1e1 / (t31 + t13 + 1)
    t114 = sma ^ 2
    t116 = 0.1e1 / t114 / sma
    t120 = 0.1e1 / n / t41
    t121 = 1 + eta
    t122 = t121 ^ 2
    t125 = 1 / t122 / t121 * t120
    contr[1] = t125 * t116 * t112 * t110 * t108 * IMz * (t41 * (t13 * (-t3 + t6 - t8 + t11) + Q2 * (t17 + t21 - t24 + t28) + (3/2 * t2 - 3/2 * t5 + t7 - 3 * t10) * t32 / 2) + t40 * (t13 * (-t3 + t6 - t43 + t11) + Q2 * (t17 + t21 - t24 + t46) + 3/2 * (t2 / 2 - t5 / 2 + t7 - t10) * t32) + eta * (t13 * (-3/4 * t57 + 3/4 * t60 - t43 + 3/2 * t64 + 3/2 * t68) + Q2 * (3/2 * t73 + 3 * t76 + 3 * t79 - 3/2 * t82 + t46) + 3/2 * t89) + t13 * (t64 / 2 + t68 / 2 - t57 / 4 + t60 / 4 - t8) + Q2 * (t73 / 2 + t76 + t79 - t82 / 2 + t28) + t89 / 2)
    t127 = Q2 * Q1
    t128 = cpa1EQ * t127
    t129 = cpa2EQ * t31
    t130 = t129 / 2
    t131 = cpa2EQ * t13
    t132 = t131 / 2
    t133 = Q2 * cpa3EQ
    t134 = 2 * t133
    t138 = cpa1EQ * t31
    t139 = Q2 * cpa2EQ
    t143 = Q1 * (-2 * t139 + 4 * cpa3EQ)
    t144 = cpa1EQ * t13
    t151 = muM * cdelta
    t152 = IMz * t151
    t154 = TL - psih
    t155 = cos(t154)
    t157 = t116 * t120
    contr[2] = -t157 * t112 * t155 * t152 * t106 * (P1 * (t128 + t130 - t132 + t134 + 2 * cpa2EQ) - P2 * (t138 + t143 - t144 - 4 * cpa1EQ) / 2) / 2
    t172 = TL + psih
    t173 = cos(t172)
    contr[3] = t157 * t112 * t173 * t152 * t106 * (P1 * (t128 - t129 + t131 - t133 - cpa2EQ / 4) - (t138 + Q1 * (t139 + cpa3EQ) - t144 - cpa1EQ / 4) * P2)
    t177 = t106 * cdelta
    t180 = 2 * TL
    t181 = t180 - psih
    t182 = cos(t181)
    contr[4] = -3/4 * t157 * t182 * t112 * cpa1EQ * t177 * muM * IMz
    t192 = t180 + psih
    t193 = cos(t192)
    contr[5] = -3/4 * t157 * t193 * t106 * t152 * t112 * (2 * cpa2EQ * t127 + t138 - t144)
    t198 = 3 * TL
    t199 = t198 - psih
    t200 = cos(t199)
    t201 = P1 * cpa2EQ
    t208 = t157 * t177
    contr[6] = t208 * IMz * muM * t112 * (-P2 * cpa1EQ + t201) * t200 / 4
    t210 = t198 + psih
    t211 = cos(t210)
    t213 = t31 * P1
    t215 = P1 * Q1
    t216 = Q2 * cpa1EQ
    t219 = t13 * P1
    t221 = t31 * P2
    t225 = t13 * P2
    contr[7] = t208 * IMz * t112 * (-cpa1EQ * t221 + cpa1EQ * t225 + cpa2EQ * t213 - cpa2EQ * t219 - 2 * t139 * t19 - 2 * t216 * t215) * muM * t211 / 4
    t232 = 3/2 * t15
    t233 = cpa1EQ * t9
    t234 = 3 * t233
    t235 = 3/2 * t22
    t236 = cpa1EQ * phiTA
    t237 = t232 + t234 - t235 + t236
    t240 = 3 * Q2 * t2
    t241 = P2 * Q2
    t243 = 6 * t241 * t201
    t245 = 3 * Q2 * t5
    t247 = (t139 - t26) * phiTA
    t248 = 2 * t247
    t251 = t13 + 1
    t255 = 3 * t236
    t258 = 6 * t247
    t270 = cpa1EQ * t63
    t272 = cpa1EQ * t67
    t276 = Q2 * t57
    t279 = t241 * t62 * cpa2EQ
    t282 = Q2 * t66 * t201
    t284 = Q2 * t60
    t290 = t72 / 2 - t81 / 2 + t270 + t272 + t236
    t291 = t290 * t251
    t303 = sin(psih)
    contr[8] = t125 * t116 * t112 * t303 * t108 * IMz * (t41 * (t31 * t237 + Q1 * (-t240 + t243 + t245 - t248) - t237 * t251) + t40 * (t31 * (t234 + t232 - t235 + t255) + Q1 * (-t240 + t243 + t245 - t258) - 3 * t251 * (t233 + t15 / 2 - t22 / 2 + t236)) + eta * (t31 * (3/2 * t72 - 3/2 * t81 + 3 * t270 + 3 * t272 + t255) + Q1 * (-3 * t276 + 6 * t279 + 6 * t282 + 3 * t284 - t258) - 3 * t291) + t31 * t290 + Q1 * (-t276 + 2 * t279 + 2 * t282 + t284 - t248) - t291) / 2
    t318 = sin(t154)
    contr[9] = t157 * t112 * t318 * IMz * muM * (P1 * (t138 + t143 - t144 + 2 * cpa1EQ) + 2 * (t128 + t130 - t132 + t134 - cpa2EQ) * P2) * t177 / 4
    t338 = sin(t172)
    contr[10] = t157 * t112 * t338 * t152 * t106 * (P1 * (t138 + Q1 * (4 * t139 - t26) - t144 + cpa1EQ / 2) + 4 * (t128 - t129 / 4 + t131 / 4 + t133 / 2 + cpa2EQ / 8) * P2) / 2
    t342 = sin(t181)
    t347 = t157 * cdelta * t112
    contr[11] = -3/4 * t347 * cpa2EQ * t107 * IMz * t342
    t350 = sin(t192)
    contr[12] = -3/4 * t347 * (t129 - 2 * t128 - t131) * t107 * IMz * t350
    t363 = sin(t199)
    contr[13] = -t157 * t363 * IMz * t106 * t112 * (P2 * cpa2EQ + t18) * t151 / 4
    t368 = sin(t210)
    contr[14] = -t208 * t112 * (cpa1EQ * t213 - cpa1EQ * t219 + cpa2EQ * t221 - cpa2EQ * t225 + 2 * t139 * t215 - 2 * t216 * t19) * IMz * muM * t368 / 4
    
    contr = sum(contr);
    return contr;
end

function derivativechiM3_cdeltapsigMpsihOsdelta_k0(skm,smk,Jg,cdelta,sdelta,psil,psig,psih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1EQ,cpa2EQ,cpa3EQ,A,C)
    contr = zeros(14)
    t1 = sqrt(skm)
    t2 = t1 * IMz
    t3 = P1 ^ 2
    t4 = cpa1EQ * t3
    t5 = 3/4 * t4
    t6 = P2 ^ 2
    t7 = cpa1EQ * t6
    t8 = 3/4 * t7
    t9 = cpa2EQ * phiTA
    t10 = t9 / 2
    t11 = P2 * P1
    t12 = cpa2EQ * t11
    t13 = 3/2 * t12
    t15 = Q2 ^ 2
    t17 = t3 * cpa2EQ
    t19 = 3/2 * Q1 * t17
    t20 = P1 * cpa1EQ
    t21 = P2 * Q1
    t23 = 3 * t21 * t20
    t24 = t6 * cpa2EQ
    t26 = 3/2 * Q1 * t24
    t28 = 2 * cpa3EQ
    t30 = (Q1 * cpa1EQ + t28) * phiTA
    t33 = Q1 ^ 2
    t34 = t33 + 1
    t42 = eta ^ 2
    t43 = t42 * eta
    t45 = 3/2 * t9
    t48 = 3 * t30
    t58 = t3 ^ 2
    t59 = cpa1EQ * t58
    t61 = t6 ^ 2
    t62 = cpa1EQ * t61
    t64 = t3 * P1
    t65 = P2 * t64
    t66 = cpa2EQ * t65
    t68 = t6 * P2
    t69 = t68 * P1
    t70 = cpa2EQ * t69
    t74 = t58 * cpa2EQ
    t75 = Q1 * t74
    t78 = t21 * t64 * cpa1EQ
    t81 = Q1 * t68 * t20
    t83 = t61 * cpa2EQ
    t84 = Q1 * t83
    t91 = (t59 / 2 - t62 / 2 + t9 - t66 - t70) * t34
    t108 = sin(psih)
    t112 = 0.1e1 / (t33 + t15 + 1)
    t113 = sma ^ 2
    t115 = 0.1e1 / t113 / sma
    t117 = 0.1e1 / t43
    t118 = 0.1e1 / n
    t120 = 1 + eta
    t121 = t120 ^ 2
    t125 = 1 / t121 / t120 * t118 * t117 * t115 * t112
    contr[1] = -t125 * t108 * (t43 * (t15 * (-t5 + t8 - t10 + t13) + Q2 * (t19 + t23 - t26 + t30) + (3/2 * t4 - 3/2 * t7 + t9 - 3 * t12) * t34 / 2) + t42 * (t15 * (-t5 + t8 - t45 + t13) + Q2 * (t19 + t23 - t26 + t48) + 3/2 * (t4 / 2 - t7 / 2 + t9 - t12) * t34) + eta * (t15 * (-3/4 * t59 + 3/4 * t62 - t45 + 3/2 * t66 + 3/2 * t70) + Q2 * (3/2 * t75 + 3 * t78 + 3 * t81 - 3/2 * t84 + t48) + 3/2 * t91) + t15 * (t66 / 2 + t70 / 2 - t59 / 4 + t62 / 4 - t10) + Q2 * (t75 / 2 + t78 + t81 - t84 / 2 + t30) + t91 / 2) * muM * t2
    t127 = Q2 * Q1
    t128 = cpa1EQ * t127
    t129 = cpa2EQ * t33
    t130 = t129 / 2
    t131 = cpa2EQ * t15
    t132 = t131 / 2
    t133 = Q2 * cpa3EQ
    t134 = 2 * t133
    t138 = cpa1EQ * t33
    t139 = Q2 * cpa2EQ
    t143 = Q1 * (-2 * t139 + 4 * cpa3EQ)
    t144 = cpa1EQ * t15
    t151 = muM * IMz
    t153 = TL - psih
    t154 = sin(t153)
    t157 = t118 * t117 * t115
    contr[2] = -t157 * t112 * t154 * t151 * (P1 * (t128 + t130 - t132 + t134 + 2 * cpa2EQ) - P2 * (t138 + t143 - t144 - 4 * cpa1EQ) / 2) * t1 / 2
    t172 = TL + psih
    t173 = sin(t172)
    contr[3] = -t157 * t112 * t173 * t151 * (P1 * (t128 - t129 + t131 - t133 - cpa2EQ / 4) - (t138 + Q1 * (t139 + cpa3EQ) - t144 - cpa1EQ / 4) * P2) * t1
    t177 = 2 * TL
    t178 = t177 - psih
    t179 = sin(t178)
    t182 = t1 * t112
    contr[4] = -3/4 * t157 * t182 * cpa1EQ * t179 * t151
    t191 = t177 + psih
    t192 = sin(t191)
    contr[5] = 3/4 * t157 * t1 * t192 * t151 * t112 * (2 * cpa2EQ * t127 + t138 - t144)
    t196 = P1 * cpa2EQ
    t201 = 3 * TL
    t202 = t201 - psih
    t203 = sin(t202)
    contr[6] = t157 * t203 * t1 * t151 * t112 * (-P2 * cpa1EQ + t196) / 4
    t207 = t33 * P1
    t209 = P1 * Q1
    t210 = Q2 * cpa1EQ
    t213 = t15 * P1
    t215 = t33 * P2
    t219 = t15 * P2
    t225 = t201 + psih
    t226 = sin(t225)
    contr[7] = -t157 * t226 * t1 * IMz * t112 * (-cpa1EQ * t215 + cpa1EQ * t219 + cpa2EQ * t207 - cpa2EQ * t213 - 2 * t139 * t21 - 2 * t210 * t209) * muM / 4
    t231 = 3/2 * t17
    t232 = cpa1EQ * t11
    t233 = 3 * t232
    t234 = 3/2 * t24
    t235 = cpa1EQ * phiTA
    t236 = t231 + t233 - t234 + t235
    t239 = 3 * Q2 * t4
    t240 = P2 * Q2
    t242 = 6 * t240 * t196
    t244 = 3 * Q2 * t7
    t246 = (t139 - t28) * phiTA
    t247 = 2 * t246
    t250 = t15 + 1
    t254 = 3 * t235
    t257 = 6 * t246
    t269 = cpa1EQ * t65
    t271 = cpa1EQ * t69
    t275 = Q2 * t59
    t278 = t240 * t64 * cpa2EQ
    t281 = Q2 * t68 * t196
    t283 = Q2 * t62
    t289 = t74 / 2 - t83 / 2 + t269 + t271 + t235
    t290 = t289 * t250
    t301 = cos(psih)
    contr[8] = t125 * t301 * (t43 * (t33 * t236 + Q1 * (-t239 + t242 + t244 - t247) - t236 * t250) + t42 * (t33 * (t233 + t231 - t234 + t254) + Q1 * (-t239 + t242 + t244 - t257) - 3 * t250 * (t232 + t17 / 2 - t24 / 2 + t235)) + eta * (t33 * (3/2 * t74 - 3/2 * t83 + 3 * t269 + 3 * t271 + t254) + Q1 * (-3 * t275 + 6 * t278 + 6 * t281 + 3 * t283 - t257) - 3 * t290) + t33 * t289 + Q1 * (-t275 + 2 * t278 + 2 * t281 + t283 - t247) - t290) * muM * t2 / 2
    t314 = cos(t153)
    contr[9] = -t157 * t112 * t314 * t151 * t1 * (P1 * (t138 + t143 - t144 + 2 * cpa1EQ) + 2 * (t128 + t130 - t132 + t134 - cpa2EQ) * P2) / 4
    t335 = cos(t172)
    contr[10] = t157 * t112 * t335 * t151 * t1 * (P1 * (t138 + Q1 * (4 * t139 - t28) - t144 + cpa1EQ / 2) + 4 * (t128 - t129 / 4 + t131 / 4 + t133 / 2 + cpa2EQ / 8) * P2) / 2
    t341 = cos(t178)
    contr[11] = 3/4 * t157 * t341 * t112 * cpa2EQ * t1 * t151
    t349 = cos(t191)
    contr[12] = -3/4 * t157 * t349 * t112 * (t129 - 2 * t128 - t131) * t1 * t151
    t358 = cos(t202)
    contr[13] = t157 * t358 * IMz * t182 * (P2 * cpa2EQ + t20) * muM / 4
    t373 = cos(t225)
    contr[14] = -t157 * t373 * t1 * t112 * (cpa1EQ * t207 - cpa1EQ * t213 + cpa2EQ * t215 - cpa2EQ * t219 + 2 * t139 * t209 - 2 * t210 * t21) * t151 / 4
    

    contr = sum(contr);
    return contr;
end

############################################
# case smk = 0.0
function CMterms_M2_smk0_magnetic(cdelta,sdelta,cpsih,spsih,rc,Q1,Q2,TL,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,A,B,C)

    CMXb11 = zeros(8)
    CMXb12 = zeros(8)
    CMXb13 = zeros(8)
    CMYb21 = zeros(8)
    CMYb22 = zeros(8)
    CMYb23 = zeros(8)
    CMZb31 = zeros(8)
    CMZb32 = zeros(8)
    CMZb33 = zeros(8)
    GG = 1+Q1^2+Q2^2
    t1 = cpa1 * spsih
    t2 = cpa2 * cpsih
    t3 = t1 + t2
    t4 = 3 * t3
    t5 = Q2 ^ 2
    t6 = t5 ^ 2
    t8 = cpa1 * cpsih
    t9 = cpa2 * spsih
    t10 = -t8 + t9
    t11 = 12 * t10
    t13 = cpsih * cpa3
    t14 = 6 * t13
    t16 = t5 * Q2
    t18 = -t3
    t19 = 18 * t18
    t20 = Q1 ^ 2
    t22 = cpa3 * spsih
    t23 = Q1 * t22
    t24 = 18 * t23
    t25 = 6 * t2
    t26 = 6 * t1
    t29 = -t11
    t30 = t20 * Q1
    t32 = t20 * t13
    t33 = 18 * t32
    t36 = t20 ^ 2
    t39 = 6 * t30 * t22
    t40 = -t1 + t2
    t41 = 6 * t40
    t43 = 6 * t23
    t44 = 3 * t2
    t45 = 3 * t1
    t48 = cpa2 * t16
    t50 = Q1 * cpa1
    t54 = cpa2 * t20
    t59 = cpa1 * t20
    t61 = Q1 * cpa3
    t65 = t48 / 2 + t5 * (-3/2 * t50 - cpa3) + Q2 * (-3/2 * t54 - cpa2 / 2) + (t59 / 2 + t61 - cpa1 / 2) * Q1
    t69 = cos(TL)
    t70 = t69 ^ 2
    t72 = -t10
    t73 = t72 / 2
    t75 = 2 * t3
    t79 = 3 * t10
    t81 = Q1 * t13
    t87 = t20 * t22
    t98 = t20 + 1
    t100 = t6 * t73 + t16 * (Q1 * t75 + t22) + t5 * (t20 * t79 - 3 * t81) + Q2 * (-2 * Q1 * t40 - t30 * t75 + t22 - 3 * t87) + t98 * (t20 * t73 + t81 - t8 / 2 + t9 / 2)
    t114 = -cpa1 * t16 / 4 - 3/4 * cpa2 * t5 * Q1 + Q2 * (3/4 * t59 + t61 - cpa1 / 4) + t98 * cpa2 * Q1 / 4
    t118 = sin(TL)
    t124 = 3 * cpa2 * t6 * cpsih
    t125 = 6 * t72
    t130 = 12 * t1 + t25
    t132 = 12 * t23
    t139 = 6 * Q2 * t98 * (Q1 * t72 + t13)
    t142 = 3 * cpa2 * t36 * cpsih
    t145 = 6 * cpa2 * t20 * cpsih
    t146 = GG ^ 2
    t147 = t146 - 3
    t148 = t147 * cpa2
    t149 = cpsih * t148
    t151 = cpa1 * spsih * t146
    t161 = t146 * cpa3
    t162 = 6 * t48 + t5 * (-12 * t50 - 12 * cpa3) + Q2 * (-6 * t54 - 6 * cpa2) + t161
    t166 = rc ^ 2
    t168 = 0.1e1 / t166 / rc
    t170 = 1 / t146
    CMXb11[2] = t170 * t168 * IMz * (t70 * (cdelta * (t6 * t4 + t16 * (Q1 * t11 - t14) + t5 * (t20 * t19 - t24 - t25 + t26) + Q2 * (t30 * t29 + t14 + t33) + t36 * t4 + t39 + t20 * t41 - t43 + t44 + t45) - 12 * t65 * sdelta) + 6 * t69 * t118 * (cdelta * t100 + 4 * t114 * sdelta) + cdelta * (-t124 + t16 * (Q1 * t125 + t14) + t5 * (t20 * t130 + t132 + t25) - t139 - t142 - t145 + t149 - t151) + t162 * sdelta) * muM / 2
    t173 = -t4
    t186 = -t41
    t216 = (t70 * (sdelta * (t6 * t173 + t16 * (Q1 * t29 + t14) + t5 * (-t20 * t19 + t24 + t25 - t26) + Q2 * (t30 * t11 - t14 - t33) + t36 * t173 - t39 + t20 * t186 + t43 - t44 - t45) - 12 * t65 * cdelta) - 6 * t69 * t118 * (-4 * t114 * cdelta + sdelta * t100) + sdelta * (t124 + t16 * (-Q1 * t125 - t14) + t5 * (-t20 * t130 - t132 - t25) + t139 + t142 + t145 - cpsih * t147 * cpa2 + t151) + t162 * cdelta) * muM
    t219 = t170 * t168 * IMy * t216
    CMXb11[5] = -t219
    t222 = 12 * t18
    t224 = 6 * t22
    t231 = 6 * t9
    t243 = t8 + t9
    t253 = 2/3 * t10
    t255 = t13 / 3
    t302 = spsih * t148
    t304 = cpsih * cpa1 * t146
    t309 = t170 * t168 * (t70 * (t6 * t79 + t16 * (Q1 * t222 - t224) + t5 * (18 * t20 * t72 - t231 - 6 * t8 + 18 * t81) + Q2 * (-t30 * t222 + t224 + 18 * t87) + t36 * t79 - 6 * cpsih * cpa3 * t30 + 6 * t20 * t243 + 6 * t81 - 3 * t8 + 3 * t9) + 18 * t69 * (t6 * t3 / 6 + t16 * (Q1 * t253 - t255) + t5 * (t20 * t18 - t23) + Q2 * (-t30 * t253 + t32 - 2/3 * Q1 * t243 - t255) + t98 * (t20 * t3 / 2 + t23 - t2 / 2 - t1 / 2) / 3) * t118 - 3 * spsih * cpa2 * t6 + t16 * (6 * Q1 * t3 + t224) + t5 * (t20 * (-12 * t8 + t231) - 12 * t81 + t231) - 6 * Q2 * t98 * (Q1 * t3 + t22) - 3 * spsih * cpa2 * t36 - 6 * spsih * t54 + t302 + t304) * muM * IMz / 2
    CMXb11[6] = -t309
    CMXb12[1] = t219
    CMXb12[2] = t309
    CMXb12[6] = CMXb11[2]
    CMYb21[1] = t170 * t168 * IMx * t216
    CMYb21[2] = -CMXb12[6]
    CMYb21[6] = CMXb12[2]
    CMYb22[2] = CMXb11[6]
    CMYb22[5] = CMYb21[1]
    CMYb22[6] = CMYb21[2]
    t312 = t3 * cdelta
    t313 = IMy * t312
    t314 = t10 * IMx
    t315 = t313 + t314
    t316 = 3 * t315
    t318 = t10 * cdelta
    t319 = IMy * t318
    t320 = t3 * IMx
    t321 = t319 - t320
    t322 = 12 * t321
    t327 = -cdelta * cpa3 * cpsih - cpa2 * sdelta
    t328 = 6 * t327
    t330 = IMx * t22
    t331 = 6 * t330
    t334 = -t315
    t339 = -cdelta * t22 + sdelta * cpa1
    t340 = 18 * t339
    t342 = IMx * t13
    t347 = cpa3 * sdelta
    t348 = 12 * t347
    t349 = cdelta * t186 + t348
    t351 = t243 * IMx
    t352 = 6 * t351
    t357 = -t327
    t358 = 18 * t357
    t363 = -t328
    t364 = IMy * t363
    t368 = -t339
    t369 = 6 * t368
    t371 = 6 * t342
    t375 = cdelta * t41 - t348
    t379 = -t369
    t390 = t339 / 2
    t391 = IMy * t390
    t392 = t342 / 2
    t395 = -t321
    t398 = IMy * t357 + Q1 * t395 + t330
    t403 = 3/2 * t368
    t410 = cdelta * t40 - 2 * t347
    t417 = 2 * t357
    t433 = (IMy * cdelta * cpsih + IMx * spsih) * cpa2
    t442 = (2 * t1 + t2) * cdelta
    t445 = -2 * t8 + t9
    t450 = 12 * t368
    t458 = 6 * cdelta * cpa2 * cpsih - t348
    t475 = cdelta * (t149 - t151) + sdelta * t161
    t477 = t304 + t302
    t481 = t170 * t168
    CMZb33[1] = -t481 * (t70 * (t6 * t316 + t16 * (IMy * t328 + Q1 * t322 - t331) + t5 * (18 * t20 * t334 + Q1 * (IMy * t340 + 18 * t342) + IMy * t349 - t352) + Q2 * (-t30 * t322 + t20 * (IMy * t358 + 18 * t330) + t364 + t331) + t36 * t316 + t30 * (IMy * t369 - t371) + t20 * (IMy * t375 + t352) + Q1 * (IMy * t379 + t371) + 3 * t313 + 3 * t314) - 12 * t69 * t118 * (t6 * t321 / 4 + t16 * (Q1 * t334 + t391 + t392) + 3/2 * t5 * t398 * Q1 + Q2 * (t30 * t315 + t20 * (IMy * t403 - 3/2 * t342) + Q1 * (IMy * t410 + t351) + t391 + t392) - t98 * (t20 * t395 + Q1 * (IMy * t417 + 2 * t330) + t319 - t320) / 4) - 3 * t6 * t433 + t16 * (6 * Q1 * t395 + t331 + t364) + t5 * (t20 * (6 * t445 * IMx + 6 * IMy * t442) + Q1 * (IMy * t450 - 12 * t342) + IMy * t458 + 6 * IMx * cpa2 * spsih) - 6 * Q2 * t98 * t398 - 3 * t36 * t433 - 6 * t20 * t433 + IMy * t475 + IMx * t477) * muM
    t483 = IMx * t312
    t484 = t10 * IMy
    t485 = t483 - t484
    t486 = 3 * t485
    t488 = IMx * t318
    t489 = t3 * IMy
    t490 = t488 + t489
    t491 = 12 * t490
    t494 = IMy * t22
    t495 = 6 * t494
    t498 = -t485
    t503 = IMy * cpa3 * cpsih
    t508 = t243 * IMy
    t509 = 6 * t508
    t518 = IMx * t363
    t523 = 6 * t503
    t539 = IMx * t390
    t540 = t503 / 2
    t545 = IMx * t327 + Q1 * t490 + t494
    t576 = (IMx * cdelta * cpsih - IMy * spsih) * cpa2
    CMZb33[5] = -t481 * muM * (t70 * (t6 * t486 + t16 * (IMx * t328 + Q1 * t491 + t495) + t5 * (18 * t20 * t498 + Q1 * (IMx * t340 - 18 * t503) + IMx * t349 + t509) + Q2 * (-t30 * t491 + t20 * (IMx * t358 - 18 * t494) + t518 - t495) + t36 * t486 + t30 * (IMx * t369 + t523) + t20 * (IMx * t375 - t509) + Q1 * (IMx * t379 - t523) + 3 * t483 - 3 * t484) - 12 * t69 * (t6 * t490 / 4 + t16 * (Q1 * t498 + t539 - t540) - 3/2 * t5 * Q1 * t545 + Q2 * (t30 * t485 + t20 * (IMx * t403 + 3/2 * t503) + Q1 * (IMx * t410 - t508) + t539 - t540) + (t20 * t490 + Q1 * (-IMx * t417 + 2 * t494) - t488 - t489) * t98 / 4) * t118 - 3 * t6 * t576 + t16 * (-6 * Q1 * t490 - t495 + t518) + t5 * (t20 * (6 * IMx * t442 - 6 * t445 * IMy) + Q1 * (IMx * t450 + 12 * t503) + IMx * t458 - 6 * IMy * cpa2 * spsih) + 6 * Q2 * t98 * t545 - 3 * t36 * t576 - 6 * t20 * t576 + IMx * t475 - t477 * IMy)
    
    return CMXb11,CMXb12,CMXb13,CMYb21,CMYb22,CMYb23,CMZb31,CMZb32,CMZb33;

end

function CMterms_M3_smk0_magnetic(cdelta,sdelta,cpsih,spsih,sma,eta,P1,P2,Q1,Q2,TL,phiTA,n,muM,IMx,IMy,IMz,cpa1,cpa2,cpa3,A,B,C)
    GG = 1+Q1^2+Q2^2
    t1 = 1 + eta
    t2 = t1 ^ 2
    t3 = t2 * t1
    t4 = cpa1 * spsih
    t5 = cpa2 * cpsih
    t6 = t4 + t5
    t7 = t6 / 4
    t8 = P1 * t7
    t9 = cpsih * cpa1
    t10 = spsih * cpa2
    t11 = t9 - t10
    t12 = t11 * P2
    t13 = t12 / 4
    t14 = t8 + t13
    t15 = Q2 ^ 2
    t16 = t15 ^ 2
    t18 = -t11
    t19 = P1 * t18
    t20 = t6 * P2
    t23 = P1 * cpsih
    t24 = P2 * spsih
    t26 = (t23 - t24) * cpa3
    t27 = t26 / 2
    t29 = t15 * Q2
    t31 = -t6
    t32 = 3/2 * t31
    t36 = Q1 ^ 2
    t38 = spsih * P1
    t39 = cpsih * P2
    t41 = (t38 + t39) * cpa3
    t43 = 3/2 * Q1 * t41
    t44 = t4 - t5
    t45 = t44 * P1
    t49 = P1 * t11
    t50 = t49 - t20
    t51 = t36 * Q1
    t54 = 3/2 * t36 * t26
    t55 = t44 * P2
    t58 = (t23 + t24) * cpa3
    t59 = t58 / 2
    t62 = t36 ^ 2
    t65 = t51 * t41 / 2
    t69 = (-t38 + t39) * cpa3
    t71 = Q1 * t69 / 2
    t74 = cpa2 * P1
    t75 = cpa1 * P2
    t76 = t74 + t75
    t78 = cpa1 * P1
    t79 = cpa2 * P2
    t80 = -t78 + t79
    t83 = cpa3 * P1
    t87 = -t76
    t90 = cpa3 * P2
    t91 = Q1 * t90
    t95 = -t80
    t96 = t36 * t95
    t97 = Q1 * t83
    t106 = cos(TL)
    t107 = t106 ^ 2
    t108 = t107 * t106
    t112 = 4 * t6
    t113 = P1 * t112
    t114 = 4 * t12
    t117 = 2 * t41
    t120 = 6 * t18
    t121 = P1 * t120
    t126 = 6 * Q1 * t26
    t130 = -t112
    t131 = P1 * t130
    t135 = 6 * t36 * t41
    t138 = 2 * t69
    t143 = 2 * t51 * t26
    t147 = 2 * Q1 * t58
    t151 = t29 * t80 / 3
    t153 = 2/3 * t90
    t156 = 4/3 * t97
    t157 = t78 / 3
    t158 = t79 / 3
    t170 = sin(TL)
    t172 = 3/2 * t18
    t174 = 6 * t31
    t175 = Q1 * t174
    t176 = cpa3 * spsih
    t177 = 3 * t176
    t182 = cpa3 * cpsih
    t183 = Q1 * t182
    t187 = -t174
    t189 = t36 * t176
    t191 = -t44
    t196 = t36 + 1
    t198 = 2 * t183
    t208 = cpa1 * t36
    t209 = Q1 * cpa3
    t225 = Q1 * t18
    t226 = t182 / 2
    t230 = Q1 * t176
    t232 = t5 / 2
    t233 = t4 / 2
    t237 = t36 * t182
    t243 = t51 * t176 / 2
    t245 = t36 * t191 / 2
    t246 = t230 / 2
    t251 = cpa2 * t29
    t252 = Q1 * cpa1
    t254 = 2 * cpa3
    t257 = cpa2 * t36
    t274 = 2 * t4
    t277 = 2 * t230
    t280 = Q1 * t11
    t289 = GG ^ 2
    t291 = (t289 - 3) * cpa2
    t305 = t289 * cpa3
    t317 = t49 + (t274 - t5) * P2
    t319 = 2 * t12
    t332 = 4 * t4 + 2 * t5
    t348 = 2 * t24
    t363 = t289 - 2
    t372 = t78 + t79
    t376 = 2/3 * t75
    t377 = t74 / 3
    t393 = t11 / 8
    t394 = P1 ^ 2
    t396 = P1 * t20
    t397 = t396 / 4
    t398 = P2 ^ 2
    t399 = t398 + 1
    t400 = t11 * t399
    t401 = t400 / 8
    t402 = t394 * t393 + t397 - t401
    t404 = t6 / 2
    t406 = P1 * t12
    t408 = t6 * t399 / 2
    t411 = t394 * spsih
    t412 = t411 / 2
    t413 = P1 * P2
    t414 = cpsih * t413
    t416 = t399 * spsih / 2
    t418 = cpa3 * (-t412 + t414 + t416)
    t422 = 3/4 * t18
    t423 = t394 * t422
    t428 = t394 * cpsih
    t430 = 2 * spsih * t413
    t431 = t398 * cpsih
    t433 = (t428 + t430 - t431 - cpsih) * cpa3
    t436 = t44 * t413
    t440 = -t404
    t446 = t394 - t398 - 1
    t459 = t36 * t44 * t413
    t465 = -t393
    t467 = t16 * t402 + t29 * (Q1 * (t394 * t404 - t406 - t408) - t418 / 2) + t15 * (t36 * (t423 - 3/2 * t396 + 3/4 * t400) - 3/4 * Q1 * t433 + t436 / 2) + Q2 * (t51 * (t394 * t440 + t406 + t408) + 3/2 * t36 * t418 + Q1 * t44 * t446 / 2 + cpa3 * (t412 + t414 - t416) / 2) + t62 * t402 + t51 * t433 / 4 - t459 / 2 + Q1 * (t428 - t430 - t431 - cpsih) * cpa3 / 4 + t394 * t465 + t397 + t401
    t468 = eta ^ 2
    t469 = t468 * eta
    t471 = 5/8 * t11
    t473 = 5/4 * t396
    t474 = t398 + 3/5
    t475 = t474 * t11
    t476 = 5/8 * t475
    t477 = t394 * t471 + t473 - t476
    t479 = 5/2 * t6
    t481 = 5 * t406
    t483 = 5/2 * t6 * t474
    t487 = t398 * spsih / 2
    t488 = 3/10 * spsih
    t490 = cpa3 * (t414 - t412 + t487 + t488)
    t500 = 3/5 * cpsih
    t502 = (t428 - t431 + t430 - t500) * cpa3
    t514 = t394 - t398 - 3/5
    t533 = t16 * t477 + t29 * (Q1 * (t394 * t479 - t481 - t483) - 5/2 * t490) + t15 * (t36 * (15/4 * t394 * t18 - 15/2 * t396 + 15/4 * t475) - 15/4 * Q1 * t502 + 5/2 * t436) + Q2 * (t51 * (-t394 * t479 + t481 + t483) + 15/2 * t36 * t490 + 5/2 * Q1 * t44 * t514 + 5/2 * (t414 + t412 - t487 - t488) * cpa3) + t62 * t477 + 5/4 * t51 * t502 - 5/2 * t459 + 5/4 * Q1 * (t428 - t431 - t430 - t500) * cpa3 - t394 * t471 + t473 + t476
    t535 = t394 ^ 2
    t537 = t394 * P1
    t538 = t537 * t20
    t539 = t538 / 4
    t542 = t398 + 6
    t543 = t542 * P2
    t545 = P1 * t6 * t543
    t546 = t545 / 4
    t547 = t398 ^ 2
    t548 = 6 * t398
    t549 = t547 + t548 + 3
    t550 = t11 * t549
    t551 = t550 / 8
    t552 = t535 * t393 - t394 * t422 + t539 + t546 - t551
    t555 = t537 * t12
    t556 = 3 * t6
    t558 = t49 * t543
    t559 = t6 * t549
    t560 = t559 / 2
    t564 = t535 * spsih / 2
    t566 = P2 * t537 * cpsih
    t567 = 3 * t411
    t568 = P1 * t542
    t569 = t568 * t39
    t571 = t549 * spsih / 2
    t573 = (-t564 + t566 - t567 + t569 + t571) * cpa3
    t585 = t535 * cpsih
    t588 = 2 * P2 * spsih * t537
    t589 = 6 * t428
    t591 = 2 * t568 * t24
    t592 = t549 * cpsih
    t594 = cpa3 * (t585 + t588 + t589 + t591 - t592)
    t595 = Q1 * t594
    t597 = t394 + t398 + 6
    t598 = t44 * t597
    t599 = t598 * t413
    t608 = t36 * t573
    t611 = t535 - t547 + 6 * t394 - t548 - 3
    t613 = Q1 * t44 * t611
    t616 = cpa3 * (t564 + t566 + t567 + t569 - t571)
    t621 = t51 * t594
    t624 = t36 * t598 * t413
    t628 = Q1 * (t585 - t588 + t589 - t591 - t592) * cpa3
    t631 = t16 * t552 + t29 * (Q1 * (t394 * t556 + t535 * t404 - t555 - t558 - t560) - t573 / 2) + t15 * (t36 * (t535 * t422 - 3/2 * t538 + 9/2 * t394 * t18 - 3/2 * t545 + 3/4 * t550) - 3/4 * t595 + t599 / 2) + Q2 * (t51 * (-t394 * t556 + t535 * t440 + t555 + t558 + t560) + 3/2 * t608 + t613 / 2 + t616 / 2) + t62 * t552 + t621 / 4 - t624 / 2 + t628 / 4 + t535 * t465 + t539 + t423 + t546 + t551
    t633 = t11 / 24
    t635 = t538 / 12
    t636 = t11 / 4
    t638 = t545 / 12
    t639 = t550 / 24
    t640 = t394 * t636 + t535 * t633 + t635 + t638 - t639
    t642 = t6 / 6
    t644 = t555 / 3
    t646 = t558 / 3
    t647 = t559 / 6
    t653 = -t636
    t682 = t469 * t467 + t468 * t533 + eta * t631 + t16 * t640 + t29 * (Q1 * (t394 * t6 + t535 * t642 - t644 - t646 - t647) - t573 / 6) + t15 * (t36 * (t535 * t653 - t538 / 2 + t394 * t172 - t545 / 2 + t550 / 4) - t595 / 4 + t599 / 6) + Q2 * (t51 * (t394 * t31 - t535 * t642 + t644 + t646 + t647) + t608 / 2 + t613 / 6 + t616 / 6) + t62 * t640 + t621 / 12 - t624 / 6 + t628 / 12 - t535 * t633 + t635 + t394 * t653 + t638 + t639
    t684 = t394 * cpa1
    t685 = t684 / 3
    t686 = P2 * t74
    t687 = 2/3 * t686
    t688 = t399 * cpa1
    t689 = t688 / 3
    t692 = t394 * cpa2
    t693 = P1 * t75
    t695 = t399 * cpa2
    t698 = P2 * t83
    t702 = 2 * t686
    t703 = t398 * cpa1
    t704 = t684 + t702 - t703 - cpa1
    t711 = t692 / 2
    t712 = t695 / 2
    t713 = -t711 + t693 + t712
    t716 = 2 * t413 * t209
    t722 = 10/3 * t686
    t723 = 5/3 * t703
    t724 = 5/3 * t684
    t729 = t398 * cpa2
    t731 = 3 * cpa2
    t748 = t729 / 2
    t749 = 3/10 * cpa2
    t750 = t693 - t711 + t748 + t749
    t757 = cpa1 * t535
    t758 = t757 / 3
    t760 = P2 * cpa2 * t537
    t761 = 2/3 * t760
    t762 = 2 * t684
    t763 = t568 * t79
    t764 = 2/3 * t763
    t765 = t549 * cpa1
    t766 = t765 / 3
    t767 = -t758 - t761 - t762 - t764 + t766
    t769 = cpa2 * t535
    t771 = P2 * cpa1 * t537
    t774 = t568 * t75
    t776 = t549 * cpa2
    t777 = -t769 + 2 * t771 - 6 * t692 + 2 * t774 + t776
    t779 = t597 * P2
    t780 = t779 * t83
    t787 = t757 + 2 * t760 + 6 * t684 + 2 * t763 - t765
    t790 = Q1 * t611 * cpa3
    t794 = t769 / 2
    t795 = 3 * t692
    t796 = t776 / 2
    t797 = -t794 + t771 - t795 + t774 + t796
    t803 = Q1 * (2 * Q1 * t779 * t83 + t36 * t797 - t771 - t774 - t794 - t795 + t796)
    t807 = t757 / 9
    t808 = 2/9 * t760
    t809 = 2/3 * t684
    t810 = 2/9 * t763
    t811 = t765 / 9
    t833 = t191 / 4
    t835 = cpa3 * t29
    t845 = t289 - 3/2
    t866 = sma ^ 2
    t869 = 0.1e1 / t866 / sma * muM
    t877 = 1 / t3 / n / t289 / t469
    gfun3Mxb11 = 3 * t877 * t869 * IMz * (-2/3 * t108 * (cdelta * (t16 * t14 + t29 * (Q1 * (t19 + t20) - t27) + t15 * (t36 * (t32 * P1 - 3/2 * t12) - t43 + t45 / 2) + Q2 * (Q1 * t55 + t51 * t50 + t54 + t59) + t62 * t14 + t65 - t36 * t45 / 2 + t71 + t8 - t13) - (t29 * t76 + t15 * (3 * Q1 * t80 - 2 * t83) + Q2 * (3 * t36 * t87 - t74 + t75 - 4 * t91) + (t96 + 2 * t97 - t78 - t79) * Q1) * sdelta / 2) * t3 - t107 * (t170 * (cdelta * (t16 * t50 + t29 * (Q1 * (t113 + t114) + t117) + t15 * (t36 * (t121 + 6 * t20) - t126 - 2 * t55) + Q2 * (t51 * (t131 - t114) - t135 + 4 * Q1 * t45 - t138) + t62 * t50 + t143 + 2 * t36 * t55 + t147 + t19 - t20) + 6 * (t151 + t15 * (Q1 * t87 - t153) + Q2 * (t96 + t156 - t157 - t158) + (t36 * t76 + t74 - t75 + 2 * t91) * Q1 / 3) * sdelta) + cdelta * (t16 * t172 + t29 * (t175 - t177) + t15 * (9 * t36 * t11 + 9 * t183) + Q2 * (6 * Q1 * t191 + t51 * t187 - t177 + 9 * t189) - 3/2 * (t36 * t11 + t10 + t198 - t9) * t196) - 9 * (-cpa1 * t29 / 3 - cpa2 * t15 * Q1 + Q2 * (t208 + 4/3 * t209 - cpa1 / 3) + t196 * cpa2 * Q1 / 3) * sdelta) * t3 / 6 - t106 * (t170 * (cdelta * (t16 * t7 + t29 * (t225 - t226) + t15 * (t36 * t32 - 3/2 * t230 - t232 + t233) + Q2 * (t51 * t11 + 3/2 * t237 + t226) + t62 * t7 + t243 + t245 - t246 + t4 / 4 + t5 / 4) - (t251 + t15 * (-3 * t252 - t254) + Q2 * (-3 * t257 - cpa2) + (t208 + 2 * t209 - cpa1) * Q1) * sdelta / 2) - P1 * (cdelta * (cpa2 * t16 * cpsih / 2 + t29 * (t225 - t182) + t15 * (t36 * (-t274 - t5) - t277 - t5) + Q2 * (t280 + t182) * t196 + cpa2 * t62 * cpsih / 2 + cpa2 * t36 * cpsih - cpsih * t291 / 6 + cpa1 * spsih * t289 / 6) + 2 * sdelta * (-t251 / 2 + t15 * (t252 + cpa3) + Q2 * t196 * cpa2 / 2 - t305 / 12))) * t3 + t170 * (cdelta * (t16 * t317 + t29 * (Q1 * (t113 - t319) + t117) + t15 * (t36 * (-6 * cpsih * t79 + t121) - 6 * t23 * t209 + P2 * t332) + Q2 * (t51 * (t131 + t319) + 6 * t36 * t69 + Q1 * (4 * t44 * P1 - 6 * t12) - t138) + t62 * t317 + 2 * t51 * (t23 + t348) * cpa3 - t36 * P2 * t332 + 2 * Q1 * (t23 - t348) * cpa3 + t19 - P2 * (cpsih * cpa2 * (-t289 + 1) + t363 * t4)) + 6 * sdelta * (t151 + t15 * (-Q1 * t74 - t153) + Q2 * (t36 * t372 + t156 - t157 - t158) + t51 * (-t376 + t377) - 4/3 * t36 * t90 + Q1 * (t376 + t377) + P2 * t305 / 6)) * t3 / 6 + cdelta * t682 + 3/4 * sdelta * (t469 * (t29 * (-t685 - t687 + t689) + t15 * (Q1 * (-t692 + 2 * t693 + t695) + 4/3 * t698) + Q2 * (t36 * t704 + 4/3 * Q1 * t446 * cpa3 - t685 + t687 + t689) - 2/3 * Q1 * (t36 * t713 - t693 - t711 + t712 + t716)) + t468 * (t29 * (-t722 + t723 - t724 + cpa1) + t15 * (Q1 * (-5 * t692 + 10 * t693 + 5 * t729 + t731) + 20/3 * t698) + Q2 * (t36 * (5 * t684 + 10 * t686 - 5 * t703 - 3 * cpa1) + 20/3 * Q1 * t514 * cpa3 + cpa1 + t722 + t723 - t724) - 10/3 * (t36 * t750 - t693 - t711 + t716 + t748 + t749) * Q1) + eta * (t29 * t767 + t15 * (Q1 * t777 + 4/3 * t780) + Q2 * (t36 * t787 + 4/3 * t790 - t758 + t761 - t762 + t764 + t766) - 2/3 * t803) + t29 * (-t807 - t808 - t809 - t810 + t811) + t15 * (Q1 * (-t769 / 3 + 2/3 * t771 - 2 * t692 + 2/3 * t774 + t776 / 3) + 4/9 * t780) + Q2 * (-t36 * t767 + 4/9 * t790 - t807 + t808 - t809 + t810 + t811) - 2/9 * t803) + phiTA * (cdelta * (t16 * t833 - cpsih * t835 / 2 + t15 * (t245 - t246 - t232 - t233) + Q2 * (-t237 / 2 + t280 + t226) + t62 * t833 - t243 + t36 * t404 + t246 + t44 * t845 / 6) + (-t251 + t15 * (t252 + t254) + Q2 * (-t257 + cpa2) + cpa1 * t51 - t305 / 3 + 2 * cpa3 * t36 - t252) * sdelta / 2) * t3)
    t880 = t95 * cpsih
    t881 = spsih * t87 + t880
    t883 = 4 * t95
    t885 = t76 * cpsih
    t886 = 4 * t885
    t896 = t9 + t10
    t897 = t896 * P1
    t905 = t896 * P2
    t913 = -t74 + t75
    t922 = spsih * t95 / 4 + t885 / 4
    t944 = -t372
    t955 = 3/4 * t182
    t959 = Q1 * t6 + t176
    t965 = 3/2 * t896
    t979 = 2 * t176
    t994 = cpsih * cpa3 * t51
    t996 = -t896
    t1009 = 6 * t10
    t1035 = 2 * t75
    t1038 = spsih * t95 + cpsih * (t74 - t1035)
    t1040 = 4 * t74
    t1041 = t1040 - t1035
    t1043 = 4 * t78
    t1045 = -t1043 - 2 * t79
    t1062 = 4 * P2 * t9
    t1064 = 2 * P2 * t10
    t1088 = 2 * spsih * t83
    t1090 = 4 * cpsih * t90
    t1109 = 3/4 * t684
    t1110 = 3/2 * t686
    t1111 = 3/4 * t688
    t1114 = cpsih * t713
    t1116 = spsih * (-t1109 - t1110 + t1111) + 3/2 * t1114
    t1120 = -t795 + 6 * t693 + 3 * t729 + t731
    t1123 = 3 * t704 * cpsih
    t1126 = cpsih * t446
    t1128 = (t1126 + t430) * cpa3
    t1132 = 9/2 * t684
    t1141 = -t446 / 2
    t1144 = cpa3 * (spsih * t1141 + t414)
    t1147 = t896 * t413
    t1169 = t36 * t896 * t413
    t1184 = 15/2 * t686
    t1185 = 9/4 * cpa1
    t1186 = 15/4 * t684
    t1187 = 15/4 * t703
    t1190 = cpsih * t750
    t1192 = spsih * (-t1184 + t1185 - t1186 + t1187) + 15/2 * t1190
    t1198 = -15 * t692 + 30 * t693 + 15 * t729 + 9 * cpa2
    t1203 = 15 * (t702 - 3/5 * cpa1 + t684 - t703) * cpsih
    t1206 = cpsih * t514
    t1208 = cpa3 * (t1206 + t430)
    t1223 = -t394 / 2 + t398 / 2 + 3/10
    t1226 = (spsih * t1223 + t414) * cpa3
    t1263 = 3/4 * t757
    t1264 = 3/2 * t760
    t1265 = 3/2 * t763
    t1266 = 3/4 * t765
    t1269 = cpsih * t797
    t1271 = spsih * (-t1263 - t1264 - t1132 - t1265 + t1266) + 3/2 * t1269
    t1278 = -3 * t769 + 6 * t771 - 18 * t692 + 6 * t774 + 3 * t776
    t1280 = cpsih * t787
    t1281 = 3 * t1280
    t1284 = cpsih * t611
    t1287 = 2 * t597 * spsih * t413
    t1289 = cpa3 * (t1284 + t1287)
    t1307 = -t535 / 2 + t547 / 2 - 3 * t394 + 3 * t398 + 3/2
    t1310 = cpsih * t597 * t413
    t1312 = cpa3 * (spsih * t1307 + t1310)
    t1313 = Q1 * t1312
    t1315 = t896 * t597
    t1316 = t1315 * t413
    t1324 = t36 * t1289
    t1327 = Q1 * t896 * t611
    t1330 = (t1284 - t1287) * cpa3
    t1335 = t51 * t1312
    t1338 = t36 * t1315 * t413
    t1344 = Q1 * (-spsih * t1307 + t1310) * cpa3
    t1349 = cpsih * (t794 + t771 + t795 + t774 - t796)
    t1353 = t757 / 4
    t1354 = t760 / 2
    t1355 = 3/2 * t684
    t1356 = t763 / 2
    t1357 = t765 / 4
    t1361 = spsih * (-t1353 - t1354 - t1355 - t1356 + t1357) + t1269 / 2
    t1394 = -t965
    t1400 = 3 * t183
    t1416 = -t108 * (t16 * t881 + t29 * (Q1 * (spsih * t883 + t886) + t117) + t15 * (t36 * (6 * spsih * t76 - 6 * t880) - t126 + 2 * t897) + Q2 * (t51 * (-spsih * t883 - t886) - t135 + 4 * Q1 * t905 + t138) + t62 * t881 + t143 - 2 * t36 * t897 - t147 + spsih * t913 + t372 * cpsih) * t3 + 4 * t107 * (t170 * (t16 * t922 + t29 * (Q1 * (spsih * t76 - t880) - t27) + t15 * (t36 * (3/2 * spsih * t80 - 3/2 * t885) - t43 + t905 / 2) + Q2 * (-Q1 * t897 + t51 * t881 + t54 - t59) + t62 * t922 + t65 - t36 * t905 / 2 - t71 + spsih * t944 / 4 + t913 * cpsih / 4) + 3/8 * t16 * t31 + t29 * (-Q1 * t172 + t955) + 9/4 * t15 * Q1 * t959 + Q2 * (t51 * t172 - 9/4 * t237 + Q1 * t965 + t955) - 3/8 * (t36 * t6 + t277 - t4 - t5) * t196) * t3 - 3/2 * t106 * t3 * (t170 * (t16 * t11 + t29 * (Q1 * t112 + t979) + t15 * (t36 * t120 + 2 * t10 - 6 * t183 + 2 * t9) + Q2 * (t51 * t130 - 6 * t189 - t979) + t62 * t11 + 2 * t994 + 2 * t36 * t996 - t198 + t9 - t10) - 2/3 * P1 * (-3 * cpa2 * spsih * t16 + t29 * (Q1 * t187 + 6 * t176) + t15 * (t36 * (-12 * t9 + t1009) - 12 * t183 + t1009) - 6 * Q2 * t959 * t196 - 3 * spsih * cpa2 * t62 - 6 * cpa2 * spsih * t36 + spsih * t291 + cpsih * cpa1 * t289)) - t170 * (t16 * t1038 + t29 * (Q1 * (cpsih * t1045 + spsih * t1041) - 2 * t26) + t15 * (t36 * (-6 * P1 * t5 + 6 * spsih * t944) - 6 * Q1 * P1 * t176 - t1062 + t1064) + Q2 * (t51 * (-cpsih * t1045 - spsih * t1041) + 6 * t36 * t58 + Q1 * (spsih * (-t1040 - 6 * t75) + cpsih * (-t1043 - 6 * t79)) - 2 * t58) + t62 * t1038 + t51 * (t1088 - t1090) + t36 * (t1062 - t1064) + Q1 * (t1088 + t1090) + spsih * (-t78 + (GG - 1) * (GG + 1) * t79) + (t363 * t75 - t74) * cpsih) * t3 + t469 * (t16 * t1116 + t29 * (Q1 * (spsih * t1120 + t1123) + 3/2 * t1128) + t15 * (t36 * (spsih * (t1132 + 9 * t686 - 9/2 * t688) - 9 * t1114) - 9 * Q1 * t1144 + 3 * t1147) + Q2 * (t51 * (-spsih * t1120 - t1123) - 9/2 * t36 * t1128 + 3 * Q1 * t896 * t446 + 3/2 * cpa3 * (t1126 - t430)) + t62 * t1116 + 3 * t51 * t1144 - 3 * t1169 - 3 * Q1 * (-spsih * t1141 + t414) * cpa3 + spsih * (t1109 - t1110 - t1111) + 3/2 * cpsih * (t711 + t693 - t712)) + t468 * (t16 * t1192 + t29 * (Q1 * (spsih * t1198 + t1203) + 15/2 * t1208) + t15 * (t36 * (spsih * (45/2 * t684 + 45 * t686 - 45/2 * t703 - 27/2 * cpa1) - 45 * t1190) - 45 * Q1 * t1226 + 15 * t1147) + Q2 * (t51 * (-spsih * t1198 - t1203) - 45/2 * t36 * t1208 + 15 * Q1 * t514 * t896 + 15/2 * cpa3 * (t1206 - t430)) + t62 * t1192 + 15 * t51 * t1226 - 15 * t1169 - 15 * Q1 * (-spsih * t1223 + t414) * cpa3 + spsih * (-t1185 - t1187 + t1186 - t1184) + 15/2 * (t693 + t711 - t748 - t749) * cpsih) + eta * (t16 * t1271 + t29 * (Q1 * (spsih * t1278 + t1281) + 3/2 * t1289) + t15 * (t36 * (spsih * (9/2 * t757 + 9 * t760 + 27 * t684 + 9 * t763 - 9/2 * t765) - 9 * t1269) - 9 * t1313 + 3 * t1316) + Q2 * (t51 * (-spsih * t1278 - t1281) - 9/2 * t1324 + 3 * t1327 + 3/2 * t1330) + t62 * t1271 + 3 * t1335 - 3 * t1338 - 3 * t1344 + spsih * (t1263 - t1264 + t1132 - t1265 - t1266) + 3/2 * t1349) + t16 * t1361 + t29 * (Q1 * (spsih * t777 + t1280) + t1289 / 2) + t15 * (t36 * (spsih * (3/2 * t757 + 3 * t760 + 9 * t684 + 3 * t763 - 3/2 * t765) - 3 * t1269) - 3 * t1313 + t1316) + Q2 * (t51 * (-spsih * t777 - t1280) - 3/2 * t1324 + t1327 + t1330 / 2) + t62 * t1361 + t1335 - t1338 - t1344 + spsih * (t1353 - t1354 + t1355 - t1356 - t1357) + t1349 / 2 + phiTA * t3 * (t16 * t1394 + 3 * spsih * t835 + t15 * (3 * t36 * t996 + 3 * t10 - t1400 - 3 * t9) + Q2 * (3 * t189 + t175 - t177) + t62 * t1394 - 3 * t994 + 3 * t36 * t11 + t1400 + t896 * t845)
    gfun3Mxb12 = t877 * t869 * IMz * t1416 / 2
    gfun3Mxb13 = 0
    gfun3Myb21 = gfun3Mxb11
    gfun3Myb22 = gfun3Mxb12
    gfun3Myb23 = 0
    gfun3Mzb31 = 0
    gfun3Mzb32 = 0
    gfun3Mzb33 = 0
    
    return gfun3Mxb11, gfun3Mxb12, gfun3Mxb13, gfun3Myb21, gfun3Myb22, gfun3Myb23, gfun3Mzb31, gfun3Mzb32, gfun3Mzb33;

end
