###### functions to compute higher order corrections for the averaged attitude equations of motion considering the perturbations by the gravity and the magnetic torques
"""
    gethigherordercorrections(k,m,KK,EE,PP,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,A,B,C,mu,IMz,muM,cpa1,cpa2,cpa3,settings)
    Returns higher order corrections for the averaged attitude equations of motion considering the perturbations by the gravity and the magnetic torques

    typeofvariables = 1--> sadov
                      2--> sadovlike
"""
function gethigherordercorrections(k,m,skm,smk,mM1KK,KK,EE,PP,T2,Jg,cdelta,sdelta,psih,sma,eta,P1,P2,Q1,Q2,A,B,C,mu,IMz,muM,cpa1,cpa2,cpa3,settings,typeofvariables)

    includeGravity  = settings[1];
    includeMagnetic = settings[2];

    if typeofvariables == 1
        out = zeros(6);
    else
        out = zeros(7);
    end
    n = sqrt(mu/sma^3);

    if includeGravity
        gterms = gethigherorderterms_gravity(k,m,skm,smk,mM1KK,KK,EE,PP,T2,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,A,B,C,mu,typeofvariables);
        out = out + gterms;
        # println(gterms)
    end

    if includeMagnetic
        mterms = gethigherorderterms_magnetic(k,m,skm,smk,mM1KK,KK,EE,PP,T2,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,IMz,muM,cpa1,cpa2,cpa3,typeofvariables);
        out = out + mterms;
    end

    if includeGravity && includeMagnetic
        mgterms = gethigherorderterms_mixgravitymagnetic(k,m,skm,smk,mM1KK,KK,EE,PP,T2,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,A,B,C,mu,IMz,muM,cpa1,cpa2,cpa3,typeofvariables);
        out = out + mgterms;

    end
    
    return out;
    
end

################################

function gethigherorderterms_gravity(k,m,skm,smk,mM1KK,KK,EE,PP,T2,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,A,B,C,mu,typeofvariables)
    if k!=0.0
        dmdJl        = -pi*(m + k)^(3/2)/(sqrt(k)*sqrt(1 + k)*KK*Jg);
        dmdJg        = 2*(m + k)^2.0*(PP - smk*KK)/(KK*k*Jg);
        dcdeltadJh   = 1/Jg;
        dcdeltadJg   = -cdelta*dcdeltadJh 
        dZ3dm        = meandZ3dm_Gravity(k,m,skm,smk,mM1KK,KK,EE,PP,T2,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,A,B,C,mu);
        dZ3dJgP1     = meandZ3dJgP1_Gravity(k,m,skm,smk,mM1KK,KK,EE,PP,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,A,B,C,mu);
        dZ3dcdeltaP1 = meandZ3dcdeltaP1_Gravity(k,m,skm,smk,mM1KK,KK,EE,PP,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,A,B,C,mu);
        dZ3dcdeltaP2 = meandZ3dcdeltaP2_Gravity(k,m,skm,smk,mM1KK,KK,EE,PP,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,A,B,C,mu);
        dZ3dJl       = dmdJl*dZ3dm;
        dZ3dJgP1     = dmdJg*dZ3dm + dZ3dJgP1 + dZ3dcdeltaP1*dcdeltadJg;
        dZ3dJgP2     = dZ3dcdeltaP2*dcdeltadJg;
        dZ3dJhP1     = dZ3dcdeltaP1*dcdeltadJh;
        dZ3dJhP2     = dZ3dcdeltaP2*dcdeltadJh;
        dZ3dpsih     = meandZ3dpsih_Gravity(k,m,skm,smk,mM1KK,KK,EE,PP,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,A,B,C,mu);
        if typeofvariables != 1
            cdeltadZ3dpsigMdZ3psihOsdelta = meandZ3cdeltadpsigMdpsihOsdelta_Gravity(k,m,skm,smk,mM1KK,KK,EE,PP,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,A,B,C,mu);
        end
    else
        dcsigmadJl   = 1/Jg
        dcsigmadJg   = -sqrt(skm)*dcsigmadJl
        dcdeltadJh   = 1/Jg;
        dcdeltadJg   = -cdelta*dcdeltadJh 
        dZ3dcsigma   = meandZ3dcsigma1_Gravity_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,A,B,C,mu);
        dZ3dJgP1     = meandZ3dJgP1_Gravity_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,A,B,C,mu);
        dZ3dcdeltaP1 = meandZ3dcdelta1_Gravity_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,A,B,C,mu);
        dZ3dcdeltaP2 = meandZ3dcdelta2_Gravity_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,A,B,C,mu);
        dZ3dJl       = dZ3dcsigma*dcsigmadJl;
        dZ3dJgP1     = dZ3dcsigma*dcsigmadJg + dZ3dJgP1 + dZ3dcdeltaP1*dcdeltadJg;
        dZ3dJgP2     = dZ3dcdeltaP2*dcdeltadJg;
        dZ3dJhP1     = dZ3dcdeltaP1*dcdeltadJh;
        dZ3dJhP2     = dZ3dcdeltaP2*dcdeltadJh;
        dZ3dpsih     = meandZ3dpsih_Gravity_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,A,B,C,mu);
        if typeofvariables != 1
            cdeltadZ3dpsigMdZ3psihOsdelta = meandZ3cdeltadpsigMdpsihOsdelta_Gravity_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,A,B,C,mu);
        end
    end

        
    if typeofvariables == 1
        dZ3dJg     =  dZ3dJgP1 + dZ3dJgP2/sdelta;
        dZ3dJh     =  dZ3dJhP1 + dZ3dJhP2/sdelta;
        out = zeros(6);
        out[3] = -dZ3dpsih;
        out[4] = dZ3dJl;
        out[5] = dZ3dJg;
        out[6] = dZ3dJh;
    else
        out = zeros(7);
        out[3] = -dZ3dpsih;
        out[4] = dZ3dJl;
        out[5] = dZ3dJgP1 + cdelta*dZ3dJhP1 - psih/Jg*dZ3dpsih;
        out[6] = -Jg*sdelta*sin(psih)*dZ3dJhP1 - Jg*sin(psih)*dZ3dJhP2 + cdelta*cos(psih)*cdeltadZ3dpsigMdZ3psihOsdelta;
        out[7] =  Jg*sdelta*cos(psih)*dZ3dJhP1 + Jg*cos(psih)*dZ3dJhP2 + cdelta*sin(psih)*cdeltadZ3dpsigMdZ3psihOsdelta;
    end

    return out;

end

function meandZ3dm_Gravity(k,m,skm,smk,mM1KK,KK,EE,PP,T2,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,A,B,C,mu)
    
    GG = 1+Q1^2+Q2^2
    contr = zeros(56)
    t1 = mu ^ 2
    t2 = cos(psih)
    t3 = t2 * t1
    t4 = P2 ^ 2
    t6 = P1 ^ 2
    t9 = sdelta ^ 2
    t10 = t9 * (t4 / 11 - 9/11 * t6 + 6/11)
    t11 = 20/33 * t6
    t12 = 4/33 * t4
    t14 = Q2 ^ 2
    t15 = t14 ^ 2
    t16 = t15 * Q2
    t18 = t9 - 4/5
    t20 = P1 * P2
    t31 = Q1 ^ 2
    t40 = t14 * Q2
    t42 = Q1 + 2
    t45 = Q1 - 2
    t55 = 4/3 * t4
    t57 = t31 ^ 2
    t81 = skm ^ 2
    t82 = t81 * skm
    t83 = sdelta * t82
    t84 = T2 ^ 2
    t85 = t84 * T2
    t86 = B - C
    t87 = t86 ^ 2
    t89 = k ^ 2
    t90 = t89 * k
    t93 = A - B
    t98 = B ^ 2
    t107 = A ^ 2
    t109 = A * C
    t111 = C ^ 2
    t121 = m ^ 2
    t122 = t121 ^ 2
    t123 = t122 * m
    t137 = 6 * t84 * A
    t143 = t84 / 3
    t153 = 3 * t84
    t173 = 11/2 * T2
    t187 = 2/3 * t84
    t190 = 6 * T2
    t198 = 2/3 * T2
    t199 = -t198 + t187 + 5
    t208 = 3 * T2
    t216 = t208 + 46
    t228 = t121 * m
    t241 = 4/3 * T2
    t245 = 8/3 * T2
    t250 = t241 - 43/3
    t284 = 8 * C
    t329 = t93 ^ 2
    t332 = KK ^ 2
    t333 = t332 * KK
    t337 = 5/2 * C
    t340 = 3/2 * A
    t341 = 3/2 * B
    t352 = m - 2
    t353 = t352 ^ 2
    t354 = t353 * t352
    t356 = -t86
    t358 = k * t356 + A - B
    t363 = EE ^ 2
    t364 = t363 * t354
    t383 = t363 * EE
    t384 = t383 * t354
    t385 = t358 ^ 2
    t387 = t333 * (t123 * (t90 * t87 * t85 - 2 * t89 * t93 * t86 * t85 + k * (t98 * (t85 + 1/3) + B * (-4/3 * A - 2 * t85 * A + 2/3 * C) + t107 * (t85 + 4/3) - 4/3 * t109 + t111 / 3) + 2/3 * (A - B / 2 - C / 2) * t93) + t122 * (t90 * (A + 10 * B - 11 * C) * t86 * t84 / 3 + t89 * (t98 * (19/3 * t84 - 1) + B * (-C / 3 - t137 - 20/3 * C * t84 + 7/3 * A) + t107 * (-t143 - 2/3) + A * (20/3 * t84 - 1) * C + 2/3 * t111) + k * (t98 * (t153 - 13/3) + B * (-t137 + 43/3 * A - 17/3 * C) + t107 * (t153 - 37/3) + 31/3 * t109 - 7/3 * t111) - 17/3 * (A - 10/17 * B - 7/17 * C) * t93) + t228 * (-2/3 * t90 * (B * (t84 - t173 - 1) + A * (t84 - T2 + 1/2) - 2 * C * (t84 - 13/4 * T2 - 1/4)) * t86 + t89 * (t98 * (20/3 * T2 - t187 + 26/3) + B * (A * (-t190 - 55/3) + 4/3 * C * (t84 - t173 + 3/4)) + t107 * t199 - 4/3 * A * (t84 - t173 - 25/4) * C - 14/3 * t111) + k * (t98 * (t208 + 21) + B * (A * (-t190 - 61) + 19 * C) + t107 * t216 - 31 * t109 + 6 * t111) + 19 * (A - 13/19 * B - 6/19 * C) * t93) + t121 * (-4/3 * t90 * ((T2 + 2) * B + (T2 - 7/4) * A - 2 * (T2 + 1/8) * C) * t86 + t89 * (t98 * (-t241 - 77/3) + B * (52 * A + C * (-2/3 + t245)) + t107 * t250 - 8/3 * C * (T2 + 35/4) * A + 12 * t111) + k * (-143/3 * t98 + (380/3 * A - 94/3 * C) * B + 134/3 * t109 - 20/3 * t111 - 257/3 * t107) - 94/3 * (A - 37/47 * B - 10/47 * C) * t93) + m * (-14/3 * t90 * t86 * (-11/7 * B + A + 4/7 * C) + t89 * (118/3 * t98 + B * (-212/3 * A - t284) - 40/3 * t111 + 104/3 * t109 + 18 * t107) + k * (164/3 * t98 + (76/3 * C - 404/3 * A) * B + 248/3 * t107 + 8/3 * t111 - 92/3 * t109) + 76/3 * (A - 17/19 * B - 2/19 * C) * t93) + 8/3 * t90 * (A - 2 * B + C) * t86 + t89 * (-64/3 * t98 + B * (t284 + 104/3 * A) - 56/3 * t109 + 16/3 * t111 - 8 * t107) - 32 * k * (A - 3/4 * B - C / 4) * t93 - 8 * t329) - 2/3 * t332 * t358 * EE * t354 * (m * (k * (-5 * A + 5/2 * B + t337) - t340 + t341) + t89 * (A - 7/2 * B + t337) + k * (19/2 * A - 7 * B - t337) + t340 - t341) + 7/3 * KK * ((2/7 * A - B / 7 - C / 7) * m + 6/7 * t89 * t356 + (A - 5/7 * B - 2/7 * C) * k - 3/7 * A + 3/7 * B) * t358 * t364 + t385 * t384
    t388 = 1 / t90
    t389 = t388 * t387
    t390 = t389 * t83
    t392 = 1 / t354
    t393 = 0.1e1 / mM1KK
    t395 = GG ^ 2
    t397 = 0.1e1 / t395 / GG
    t398 = sma ^ 2
    t399 = t398 ^ 2
    t401 = 0.1e1 / t399 / t398
    t402 = t401 * t397
    t404 = eta ^ 2
    t405 = t404 ^ 2
    t407 = 0.1e1 / t405 / t404
    t408 = 0.1e1 / Jg
    t410 = 0.1e1 / n
    t411 = 0.1e1 / t332
    t414 = t411 * t410 * t408 * t407 * t402 * t393 * t392
    contr[1] = -891/64 * t414 * t390 * (t16 * (t10 - 4/11 + t11 - t12) + 30/11 * t15 * t20 * t18 * Q1 + t40 * (t31 * (t9 * (12/11 + 2/11 * t6 - 18/11 * t4) - 8/33 * t6 + 40/33 * t4 - 8/11) + t9 * (32/11 * t6 - 8/11 * t4 - 18/11) + 16/11 - 80/33 * t6 + 16/33 * t4) + 20/11 * t14 * P2 * P1 * t45 * t18 * Q1 * t42 + Q2 * (t57 * (t9 * (6/11 + t6 - 19/11 * t4) - 28/33 * t6 + t55 - 4/11) + t31 * (t9 * (-18/11 - 8/11 * t6 + 32/11 * t4) + 16/33 * t6 - 80/33 * t4 + 16/11) + t10 - 4/11 + t11 - t12) - 10/11 * (Q1 - 1) * P1 * P2 * (Q1 + 1) * t18 * (t31 + 1) * Q1) * t3
    t417 = 2 * psih
    t418 = cos(t417)
    t419 = t1 * t418
    t420 = t82 * t9
    t422 = t6 - t4
    t423 = t57 * t31
    t424 = t423 * t422
    t425 = t57 * Q1
    t426 = Q2 * t425
    t428 = 8 * t426 * t20
    t429 = -t422
    t430 = 5 * t429
    t432 = 9 * t4
    t435 = t31 * Q1
    t436 = Q2 * t435
    t438 = 40 * t436 * t20
    t444 = P1 * t40
    t449 = 8 * Q1 * (t14 - 5) * P2 * t444
    t450 = Q2 + 1
    t451 = t15 * t422
    t452 = 8 * t6
    t457 = Q2 - 1
    contr[2] = -81/64 * t414 * t389 * (t424 + t428 + t57 * (t14 * t430 + t432 - t6 - 6) - t438 + t31 * (30 * t14 * t422 + t15 * t430 - t432 + t6 + 6) - t449 + t457 * (t451 + t14 * (-t452 + 6) + t6 - t4) * t450) * cdelta * t420 * t419
    t465 = 3 * psih
    t466 = cos(t465)
    t467 = t466 * t1
    t469 = t9 * sdelta
    t470 = t422 / 5
    t471 = t16 * t470
    t474 = P2 * Q1 * P1 * t15
    t475 = 2 * t474
    t482 = P1 * t14
    t484 = t435 * P2 * t482
    t485 = 4 * t484
    t492 = t4 / 5
    t497 = Q1 * t20
    contr[3] = 405/64 * t414 * t389 * (t471 - t475 + t40 * (2 * t31 * t429 - 4/15 * t6 - 4/15 * t4 + 2/5) + t485 + Q2 * (t57 * t422 + t31 * (4/5 * t6 + 4/5 * t4 - 6/5) + t6 / 5 - t492) - 2/5 * t425 * t20 + 2/5 * t497) * t469 * t82 * t467
    t505 = t9 * (t6 - t432 + 6)
    t506 = 4/3 * t6
    t507 = 20/3 * t4
    t515 = 2 * t4
    t529 = Q2 + 2
    t532 = Q2 - 2
    t534 = t31 * P2
    t558 = t14 + 1
    t566 = sin(psih)
    contr[4] = -81/64 * t414 * t390 * t566 * (t425 * (t505 - 4 - t506 + t507) + 30 * t57 * t20 * t18 * Q2 + t435 * (t14 * (t9 * (-18 * t6 + t515 + 12) + 40/3 * t6 - 8/3 * t4 - 8) + t9 * (-t452 + 32 * t4 - 18) + 16 + 16/3 * t6 - 80/3 * t4) + 20 * t534 * P1 * t532 * t18 * Q2 * t529 + Q1 * (t15 * (t9 * (-19 * t6 + 11 * t4 + 6) - 28/3 * t4 + 44/3 * t6 - 4) + t14 * (t9 * (32 * t6 - 8 * t4 - 18) - 80/3 * t6 + 16/3 * t4 + 16) + t505 - 4 - t506 + t507) - 10 * t457 * P2 * P1 * t558 * t18 * Q2 * t450) * t1
    t571 = sin(t417)
    t572 = t1 * t571
    t585 = 2 * Q2
    t586 = t14 + t585 - 1
    t587 = t14 - t585 - 1
    t592 = 7 * t6
    t596 = 2 * t6
    t607 = cdelta * t82
    contr[5] = 81/16 * t414 * t389 * t607 * (-t423 * t20 / 2 + t425 * t422 * Q2 + 5/2 * t57 * t558 * t20 - 3 * t435 * (t6 - 7/3 * t4 + 1) * Q2 + 5/2 * t31 * t587 * t586 * t20 - Q1 * (t451 + t14 * (-t592 + 3 * t4 + 3) + t596 + t515 - 3) * Q2 - t587 * t586 * t558 * t20 / 2) * t9 * t572
    t611 = sin(t465)
    t612 = t611 * t1
    t614 = t387 * t469
    t615 = t425 * t422
    t618 = P1 * Q2 * P2 * t57
    t619 = 10 * t618
    t625 = 20 * t444 * t534
    t636 = Q2 * t20
    contr[6] = 81/64 * t414 * t388 * (t615 + t619 + t435 * (10 * t14 * t429 + t506 + t55 - 2) - t625 + Q1 * (-t15 * t430 + t14 * (-4 * t6 - 4 * t4 + 6) + t6 - t4) + 2 * t16 * t20 - 2 * t636) * t614 * t82 * t612
    t643 = t31 + t14 - 1
    t644 = -3/2 + t4 + t6
    t652 = Q1 * Q2 * t20
    contr[7] = -27/32 * t414 * t388 * t82 * t1 * t387 * cdelta * (t9 * (t57 * t644 + t31 * (t14 * (t596 + t515 - 3) + t592 - 23 * t4 + 12) + 60 * t652 + t15 * t644 + t14 * (-23 * t6 + 7 * t4 + 12) - 3/2 + t4 + t6) + t31 * (-t596 + 10 * t4 - 6) - 24 * t652 + 10 * (t6 - t492 - 3/5) * t14) * t643
    t678 = k * t85
    t683 = t89 * t84
    t686 = 3 * k * t84
    t702 = 32 * k
    t717 = KK * t354
    t720 = t333 * (t123 * (4/3 * k + 2/3 + t678) + t122 * (-2/3 * t89 - 37/3 * k - 17/3 - t683 / 3 + t686) + t228 * (k * t216 + t89 * t199 + 19) + t121 * (-94/3 + t89 * t250 - 257/3 * k) + m * (18 * t89 + 248/3 * k + 76/3) - 8 * t89 - t702 - 8) - 2/3 * t332 * t354 * ((-5 * k - 3/2) * m + t89 + 19/2 * k + 3/2) * EE + 7/3 * t717 * t363 * (k + 2/7 * m - 3/7) + t384
    t721 = t1 * t720
    t722 = t721 * t83
    t725 = -2/3 * t6 - 2/3 * t4 + eta + 1
    t727 = t422 / 2
    t730 = t31 + 2
    t731 = P1 - P2
    t733 = P1 + P2
    t734 = t40 * t733
    t735 = t734 * t731 * t730
    t742 = t57 - 4/3 * t31 - 1/3
    t744 = Q2 * t733
    t745 = t744 * t731 * t742
    t747 = t425 - Q1
    t749 = P1 * P2 * t747
    t750 = t16 * t727 - 3 * t474 - t735 + t482 * P2 * (-2 * t435 + 8 * Q1) - 3/2 * t745 + t749
    t758 = 1 + eta
    t759 = t758 ^ 2
    t761 = 0.1e1 / t759 / t758
    t764 = t411 * t393 * t410
    t765 = t764 * t408 * t761
    t766 = t765 * t407 * t402 * t392 * t388
    contr[8] = -405/32 * t766 * t107 * t750 * t18 * t2 * t725 * t722
    t772 = t57 * t733
    t776 = t15 - 6 * t14 - 1
    t778 = t31 * t733
    t781 = t450 * t457
    t783 = t15 - 4 * t14 + 1
    t787 = t733 * t731 * t783 * t781 - 5 * t772 * t731 * t558 - 5 * t778 * t731 * t776 + t424 + t428 - t438 - t449
    t788 = t9 * t787
    contr[9] = 81/64 * t766 * t107 * t788 * t418 * t725 * t721 * t607
    t793 = t82 * t469
    t799 = -t4 * t31 + t31 * t6
    t803 = t57 + 1/5
    t805 = t744 * t731 * t803
    t807 = -t16 * t727 + 5 * t474 + 5 * t40 * t799 - 10 * t484 - 5/2 * t805 + t749
    t810 = t725 * t1
    t815 = t397 * t392
    t816 = t407 * t401
    t818 = t765 * t816 * t815
    contr[10] = 81/32 * t818 * t388 * t107 * t466 * t810 * t807 * t720 * t793
    t821 = 6 * t618
    t822 = t14 + 2
    t824 = t435 * t733
    t826 = 2 * t824 * t731 * t822
    t834 = t15 - 4/3 * t14 - 1/3
    t836 = Q1 * t731
    t838 = 3 * t836 * t834 * t733
    t840 = -2 * t16 + 2 * Q2
    t842 = P1 * P2 * t840
    t843 = t615 + t821 - t826 + t31 * P1 * P2 * (4 * t40 - 16 * Q2) - t838 + t842
    contr[11] = 405/64 * t766 * t107 * t843 * t18 * t566 * t725 * t722
    t860 = 5 * t15
    t868 = P1 * (t423 - 5 * t57 * t558 + t31 * (-t860 + 30 * t14 - 5) + t15 * t14 - t860 - 5 * t14 + 1) * P2
    t872 = Q1 - Q2
    t874 = Q1 + Q2
    t876 = t874 * t872 * (t31 + t14 - 5) * Q2 * Q1 * t4
    t878 = t6 * (-2 * t426 + 10 * t436 + Q1 * (2 * t16 - 10 * t40)) + t868 + 2 * t876
    t881 = t9 * t571
    contr[12] = 81/32 * t766 * t107 * t881 * t810 * t878 * t720 * t607
    t891 = 10 * t14 * t4 - 10 * t14 * t6
    t893 = t15 + 1/5
    t899 = -P1 * P2 * t840
    t900 = 5 * t836 * t893 * t733 + t435 * t891 + t615 + t619 - t625 + t899
    contr[13] = -81/64 * t818 * t388 * t107 * t900 * t611 * t725 * t721 * t793
    t910 = t872 * P2
    t911 = -P1 * t874 + t910
    t912 = t9 - 2/5
    t915 = t6 + t4 - 3/2 * eta - 3/2
    t916 = t915 * t912 * t911
    t920 = P1 * t872 + t874 * P2
    t921 = t1 * t920
    contr[14] = 135/16 * t766 * t643 * t107 * t82 * t921 * t916 * cdelta * t720
    t928 = 2/3 * k
    t929 = t89 * t85
    t965 = t354 * EE
    t984 = 1 + k
    t985 = t984 * t384
    t986 = t333 * (t123 * (t928 + 1/2 + t929 + t678) + t122 * (-9/2 - t90 * t84 / 6 + t89 * (-7/6 + t153) + k * (-43/6 + t153)) + t228 * (16 + t90 * (t143 - T2 / 3 + 1/6) + t89 * (55/6 + t208) + k * (61/2 + t208)) + t121 * (-28 + t90 * (t198 - 7/6) - 26 * t89 - 190/3 * k) + m * (202/3 * k + 106/3 * t89 + 24 + 7/3 * t90) - 8 - 4/3 * t90 - 28 * k - 52/3 * t89) - t332 * (m * (-5 * t89 - 9 * k - 3) + t90 + 14 * t89 + 18 * k + 3) * t965 / 3 + 13/6 * KK * ((2/13 * k + 3/13) * m + t89 + 9/13 * k - 6/13) * t364 + t985
    t987 = t915 * t986
    t990 = sdelta * t1
    t991 = t422 / 3
    t993 = -t731
    t1000 = 4/3 * t14 * t42 * t45 * t497
    t1003 = 2/3 * t747
    t1006 = t16 * t991 - t475 + 2/3 * t734 * t993 * t730 - t1000 + t744 * t993 * t742 + P1 * P2 * t1003
    contr[15] = -405/16 * t766 * A * t1006 * t82 * t990 * t2 * t987 * t18 * B
    t1013 = t915 * B
    t1025 = t733 * t993 * t783 * t781 - 5 * t772 * t993 * t558 - 5 * t778 * t993 * t776 + t423 * t429 - t428 + t438 + t449
    t1028 = t1 * t9
    contr[16] = -27/16 * t766 * A * t607 * t1028 * t1025 * t418 * t986 * t1013
    t1036 = 2 * t799
    t1040 = 2/5 * t747
    t1043 = P1 * P2 * t1040 + t744 * t993 * t803 + t40 * t1036 - t16 * t470 + t475 - t485
    t1046 = A * t793
    contr[17] = 135/16 * t766 * t1046 * t467 * t986 * t1043 * t1013
    t1053 = t425 * t429
    t1063 = Q1 * t733
    t1066 = t1053 - t821 - 2 * t824 * t993 * t822 + t31 * (-4 * t40 * t20 + 16 * t636) - 3 * t1063 * t993 * t834 + t899
    contr[18] = -135/16 * t766 * A * t1066 * t82 * t990 * t566 * t986 * t18 * t1013
    t1077 = 5 * t436
    t1079 = t16 - 5 * t40
    t1083 = t868 / 2
    t1084 = t6 * (Q1 * t1079 + t1077 - t426) + t1083 + t876
    t1085 = t1084 * t82
    contr[19] = 27/4 * t766 * A * t1085 * cdelta * t1 * t9 * t571 * t986 * t1013
    t1095 = 5 * t1063 * t993 * t893 - t435 * t891 + t1053 - t619 + t625 + t842
    contr[20] = 27/16 * t766 * t1046 * t612 * t987 * t1095 * B
    t1104 = P1 * t874 - t910
    t1107 = t915 * cdelta
    t1113 = t401 * t815
    t1115 = t761 * t407
    t1117 = t764 * t408 * t1115
    t1118 = t1117 * t1113 * t388 * A
    contr[21] = 135/8 * t1118 * t912 * t643 * t920 * t1107 * t1104 * t986 * t82 * t1 * B
    t1120 = t18 * t915
    t1124 = 2 * T2
    t1127 = 5 * m
    t1132 = t123 * t85
    t1133 = 10/3 * t84
    t1136 = 11/3 * T2
    t1144 = m - 1
    t1152 = t354 * t1144 * m / 6
    t1170 = t383 * k
    t1171 = t354 * t1170
    t1172 = t333 * (-t90 * (-4 + t228 * t84 + t121 * (t1124 - 1) + t1127) * t352 / 6 + t89 * (-28/3 + t1132 + t122 * (t1133 - 1/2) + t228 * (-t187 + t1136 + 25/6) + t121 * (-t241 - 35/3) + 52/3 * m) - 2/3 * (m - 3/4) * k * t354 * t1144 - t1152) - t332 * t965 * (t89 + k * (-t1127 + 12) + m - 1) * k / 3 + 13/6 * t717 * (t89 + (2/13 * m - 5/13) * k - m / 13) * t363 + t1171
    contr[22] = 405/16 * t766 * A * t1172 * t1006 * t83 * C * t3 * t1120
    t1178 = t418 * t915
    t1182 = C * cdelta
    t1183 = t1172 * t82
    t1184 = A * t1183
    contr[23] = 27/16 * t766 * t1184 * t1182 * t1 * t9 * t1025 * t1178
    t1191 = t1184 * t469 * C
    contr[24] = -135/16 * t766 * t1191 * t467 * t1043 * t915
    t1196 = C * t1 * t566
    contr[25] = 135/16 * t766 * A * t1172 * t1066 * t83 * t1196 * t1120
    t1203 = t571 * t915
    contr[26] = -27/4 * t766 * A * t1172 * t1084 * t607 * C * t1028 * t1203
    t1212 = t915 * t1095
    contr[27] = -27/16 * t766 * t1191 * t612 * t1212
    t1217 = t1 * t643
    t1220 = t920 * t915
    t1222 = t912 * t1220 * t1182
    contr[28] = -135/8 * t1118 * t1222 * t1104 * t1183 * t1217
    t1251 = EE * k
    t1253 = m / 6
    t1268 = t333 * (t90 * (-4 + t1132 + 7/2 * t84 * t122 + t228 * (1/2 - t84 + 4 * T2) + t121 * (-3/2 - t1124) + t1127) + t89 * (-4 + t1132 + t122 * (t1133 + 1/6) + t228 * (-t187 + t1136 - 1/2) + t121 * (-t241 + 1/3) + 4 * m) - k * t354 * (m - 3/2) * t1144 / 3 - t1152) - 2 * t332 * t354 * (t89 + 7/6 * k + t1253 - 1/6) * t1251 + 2 * KK * (t90 + 3/4 * t89 - 5/12 * k - m / 12) * t364 + t984 * t354 * t1170
    t1269 = t1268 * t915
    contr[29] = -405/16 * t766 * B * t18 * t82 * C * sdelta * t1 * t1006 * t2 * t1269
    t1283 = C * t1
    contr[30] = -27/16 * t766 * B * t607 * t1283 * t9 * t1025 * t1268 * t1178
    t1292 = B * t793 * t1283
    contr[31] = 135/16 * t766 * t1292 * t466 * t1043 * t1269
    contr[32] = -135/16 * t766 * B * t1066 * t18 * t83 * t1196 * t1269
    contr[33] = 27/4 * t766 * B * t1085 * t1182 * t1 * t9 * t1268 * t1203
    contr[34] = 27/16 * t766 * t1292 * t611 * t1268 * t1212
    contr[35] = 135/8 * t1117 * t1113 * t388 * B * t1222 * t1104 * t1268 * t82 * t1217
    t1358 = t333 * (t123 * (t929 + t678 + 1/3) + t122 * (10/3 * t683 + t686 - 10/3 - k) + t228 * (13 + t89 * (-t187 + t1136 + 2/3) + k * (t208 + 8)) + t121 * (-74/3 + t89 * (-t241 - 8/3) - 23 * k) + m * (68/3 + 22/3 * t89 + t702) - 8 - 16 * k - 16/3 * t89) - 7/3 * t332 * ((-5/7 * k - 3/7) * m + t89 + 2 * k + 3/7) * t965 + 2 * t717 * t363 * (t89 + 5/6 * k + t1253 - 1/2) + t985
    t1359 = t1358 * t83
    contr[36] = -405/32 * t766 * t98 * t750 * t2 * t810 * t1359 * t984 * t18
    t1367 = t984 * t725
    t1369 = t1358 * t607 * t1367
    contr[37] = 81/64 * t766 * t98 * t788 * t419 * t1369
    t1374 = t793 * t1367
    contr[38] = 81/32 * t766 * t98 * t467 * t807 * t1358 * t1374
    contr[39] = 405/64 * t766 * t98 * t843 * t566 * t18 * t1 * t1359 * t1367
    t1387 = t1 * t878
    contr[40] = 81/32 * t766 * t98 * t881 * t1387 * t1369
    t1393 = t900 * t611
    contr[41] = -81/64 * t766 * t98 * t1393 * t1 * t1358 * t1374
    contr[42] = 135/16 * t1117 * t1113 * t388 * t643 * t98 * t1358 * t82 * t921 * t916 * cdelta * t984
    t1410 = t82 * t111
    t1411 = t1410 * sdelta * t725
    t1430 = 8/3 * t89
    t1447 = t333 * (t123 * (1/3 + t929) + t122 * (-7/3 + t928 + 11/3 * t683) + t228 * (6 + t89 * (1/3 - 4/3 * t84 + 13/3 * T2) - 14/3 * k) + t121 * (-20/3 + t89 * (-1/3 - t245) + 12 * k) + m * (t1430 - 40/3 * k + 8/3) - t1430 + 16/3 * k) - 5/3 * t332 * (k + m - 1) * t354 * t1251 + 2 * t717 * t363 * (t89 - k / 3 - t1253) + t1171
    t1458 = t411 / t89 * t393 * t410 * t408
    t1459 = t1458 * t761 * t816 * t815
    contr[43] = -405/32 * t1459 * t2 * t18 * t1447 * t1 * t750 * t1411
    t1463 = t1410 * cdelta * t725
    t1464 = t1447 * t1
    contr[44] = 81/64 * t1459 * t9 * t787 * t418 * t1464 * t1463
    t1471 = t1410 * t469 * t725
    t1478 = t1458 * t1115 * t402
    contr[45] = 81/32 * t1478 * t392 * t466 * t1447 * t1 * t807 * t1471
    t1480 = t566 * t18
    contr[46] = 405/64 * t1459 * t843 * t1480 * t1464 * t1411
    contr[47] = 81/32 * t1459 * t9 * t571 * t1447 * t1387 * t1463
    contr[48] = -81/64 * t1478 * t392 * t1393 * t1464 * t1471
    t1499 = t82 * t1
    contr[49] = 135/16 * t1459 * t643 * t1499 * t1220 * t911 * t912 * t111 * t1447 * cdelta
    t1506 = sdelta * t387
    contr[50] = 2835/32 * t818 * t388 * t915 * (-t16 * t991 + t475 + 2/3 * t735 + t1000 + t745 - P1 * P2 * t1003) * t1506 * t2 * t18 * t1499
    contr[51] = 189/32 * t818 * t388 * t1107 * t387 * t9 * t787 * t82 * t419
    contr[52] = -945/32 * t818 * t388 * t915 * t614 * t466 * t82 * (-P1 * P2 * t1040 - t40 * t1036 + t471 - t475 + t485 + t805) * t1
    contr[53] = 945/32 * t818 * t388 * t915 * (4 * t31 * t529 * t532 * t636 + t615 + t821 - t826 - t838 + t842) * t1506 * t1480 * t1499
    contr[54] = -189/8 * t818 * t388 * (t6 * (-Q1 * t1079 - t1077 + t426) - t1083 - t876) * t915 * cdelta * t387 * t420 * t572
    contr[55] = -189/32 * t818 * t388 * t900 * t915 * t469 * t387 * t611 * t1499
    contr[56] = 945/16 * t766 * t915 * t920 * t82 * t912 * t1 * t1104 * cdelta * t387 * t643
       
        

    contr = sum(contr)
    return contr;

end

function meandZ3dJgP1_Gravity(k,m,skm,smk,mM1KK,KK,EE,PP,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,A,B,C,mu)
    
    GG = 1+Q1^2+Q2^2
    contr = zeros(56)
    t1 = P2 ^ 2
    t3 = P1 ^ 2
    t6 = sdelta ^ 2
    t7 = t6 * (t1 / 11 - 9/11 * t3 + 6/11)
    t8 = 20/33 * t3
    t9 = 4/33 * t1
    t11 = Q2 ^ 2
    t12 = t11 ^ 2
    t13 = t12 * Q2
    t15 = t6 - 4/5
    t17 = P1 * P2
    t28 = Q1 ^ 2
    t37 = t11 * Q2
    t39 = Q1 + 2
    t42 = Q1 - 2
    t52 = 4/3 * t1
    t54 = t28 ^ 2
    t78 = mu ^ 2
    t80 = cos(psih)
    t86 = 2 * m
    t98 = (KK * ((A - 2 * B + C) * k + (m - 3) * B + A * (-t86 + 3) + C * m) - 3 * EE * ((-B + C) * k + A - B)) ^ 2
    t100 = skm ^ 2
    t103 = GG ^ 2
    t105 = 0.1e1 / t103 / GG
    t106 = sma ^ 2
    t107 = t106 ^ 2
    t109 = 0.1e1 / t107 / t106
    t110 = t109 * t105
    t111 = eta ^ 2
    t112 = t111 ^ 2
    t114 = 0.1e1 / t112 / t111
    t116 = k ^ 2
    t117 = 1 / t116
    t118 = KK ^ 2
    t119 = 1 / t118
    t121 = Jg ^ 2
    t122 = 0.1e1 / t121
    t123 = 0.1e1 / n
    t124 = t123 * t122
    t126 = t124 * t119 * t117 * t114 * t110
    contr[1] = 99/64 * t126 * t100 * t98 * t80 * t78 * (t13 * (t7 - 4/11 + t8 - t9) + 30/11 * t12 * t17 * t15 * Q1 + t37 * (t28 * (t6 * (12/11 + 2/11 * t3 - 18/11 * t1) - 8/33 * t3 + 40/33 * t1 - 8/11) + t6 * (32/11 * t3 - 8/11 * t1 - 18/11) + 16/11 - 80/33 * t3 + 16/33 * t1) + 20/11 * t11 * P2 * P1 * t42 * t15 * Q1 * t39 + Q2 * (t54 * (t6 * (6/11 + t3 - 19/11 * t1) - 28/33 * t3 + t52 - 4/11) + t28 * (t6 * (-18/11 - 8/11 * t3 + 32/11 * t1) + 16/33 * t3 - 80/33 * t1 + 16/11) + t7 - 4/11 + t8 - t9) - 10/11 * (Q1 - 1) * P1 * P2 * (Q1 + 1) * t15 * (t28 + 1) * Q1) * sdelta
    t128 = t3 - t1
    t129 = t54 * t28
    t130 = t129 * t128
    t131 = t54 * Q1
    t132 = Q2 * t131
    t134 = 8 * t132 * t17
    t135 = -t128
    t136 = 5 * t135
    t138 = 9 * t1
    t141 = t28 * Q1
    t142 = Q2 * t141
    t144 = 40 * t142 * t17
    t150 = P1 * t37
    t155 = 8 * Q1 * (t11 - 5) * P2 * t150
    t156 = Q2 + 1
    t157 = t12 * t128
    t158 = 8 * t3
    t163 = Q2 - 1
    t167 = 2 * psih
    t168 = cos(t167)
    t171 = t100 * t98
    t172 = t171 * t6 * t78
    contr[2] = 9/64 * t126 * t172 * t168 * (t130 + t134 + t54 * (t11 * t136 + t138 - t3 - 6) - t144 + t28 * (30 * t11 * t128 + t12 * t136 - t138 + t3 + 6) - t155 + t163 * (t157 + t11 * (-t158 + 6) + t3 - t1) * t156) * cdelta
    t175 = t6 * sdelta
    t176 = t128 / 5
    t177 = t13 * t176
    t180 = P2 * Q1 * P1 * t12
    t181 = 2 * t180
    t188 = P1 * t11
    t190 = t141 * P2 * t188
    t191 = 4 * t190
    t198 = t1 / 5
    t203 = Q1 * t17
    t208 = 3 * psih
    t209 = cos(t208)
    contr[3] = -45/64 * t126 * t100 * t98 * t209 * t78 * (t177 - t181 + t37 * (2 * t28 * t135 - 4/15 * t3 - 4/15 * t1 + 2/5) + t191 + Q2 * (t54 * t128 + t28 * (4/5 * t3 + 4/5 * t1 - 6/5) + t3 / 5 - t198) - 2/5 * t131 * t17 + 2/5 * t203) * t175
    t216 = t6 * (t3 - t138 + 6)
    t217 = 4/3 * t3
    t218 = 20/3 * t1
    t226 = 2 * t1
    t240 = Q2 + 2
    t243 = Q2 - 2
    t245 = t28 * P2
    t269 = t11 + 1
    t278 = sin(psih)
    contr[4] = 9/64 * t126 * t100 * t98 * t278 * t78 * (t131 * (t216 - 4 - t217 + t218) + 30 * t54 * t17 * t15 * Q2 + t141 * (t11 * (t6 * (-18 * t3 + t226 + 12) + 40/3 * t3 - 8/3 * t1 - 8) + t6 * (-t158 + 32 * t1 - 18) + 16 + 16/3 * t3 - 80/3 * t1) + 20 * t245 * P1 * t243 * t15 * Q2 * t240 + Q1 * (t12 * (t6 * (-19 * t3 + 11 * t1 + 6) - 28/3 * t1 + 44/3 * t3 - 4) + t11 * (t6 * (32 * t3 - 8 * t1 - 18) - 80/3 * t3 + 16/3 * t1 + 16) + t216 - 4 - t217 + t218) - 10 * t163 * P2 * P1 * t269 * t15 * Q2 * t156) * sdelta
    t283 = sin(t167)
    t297 = 2 * Q2
    t298 = t11 + t297 - 1
    t299 = t11 - t297 - 1
    t304 = 7 * t3
    t308 = 2 * t3
    contr[5] = -9/16 * t126 * t172 * (-t129 * t17 / 2 + t131 * t128 * Q2 + 5/2 * t54 * t269 * t17 - 3 * t141 * (t3 - 7/3 * t1 + 1) * Q2 + 5/2 * t28 * t299 * t298 * t17 - Q1 * (t157 + t11 * (-t304 + 3 * t1 + 3) + t308 + t226 - 3) * Q2 - t299 * t298 * t269 * t17 / 2) * t283 * cdelta
    t321 = t131 * t128
    t324 = P1 * Q2 * P2 * t54
    t325 = 10 * t324
    t331 = 20 * t150 * t245
    t342 = Q2 * t17
    t347 = sin(t208)
    contr[6] = -9/64 * t126 * t100 * t98 * t347 * t78 * (t321 + t325 + t141 * (10 * t11 * t135 + t217 + t52 - 2) - t331 + Q1 * (-t12 * t136 + t11 * (-4 * t3 - 4 * t1 + 6) + t3 - t1) + 2 * t13 * t17 - 2 * t342) * t175
    t353 = t28 + t11 - 1
    t356 = -3/2 + t1 + t3
    t364 = Q1 * Q2 * t17
    contr[7] = 3/32 * t126 * t100 * (t6 * (t54 * t356 + t28 * (t11 * (t308 + t226 - 3) + t304 - 23 * t1 + 12) + 60 * t364 + t12 * t356 + t11 * (-23 * t3 + 7 * t1 + 12) - 3/2 + t1 + t3) + t28 * (-t308 + 10 * t1 - 6) - 24 * t364 + 10 * (t3 - t198 - 3/5) * t11) * t98 * t78 * cdelta * t353
    t387 = -2/3 * t3 - 2/3 * t1 + eta + 1
    t388 = t15 * t387
    t389 = t128 / 2
    t392 = t28 + 2
    t393 = P1 - P2
    t395 = P1 + P2
    t396 = t37 * t395
    t397 = t396 * t393 * t392
    t404 = t54 - 4/3 * t28 - 1/3
    t406 = Q2 * t395
    t407 = t406 * t393 * t404
    t409 = t131 - Q1
    t411 = P1 * P2 * t409
    t412 = t13 * t389 - 3 * t180 - t397 + t188 * P2 * (-2 * t141 + 8 * Q1) - 3/2 * t407 + t411
    t413 = t412 * sdelta
    t418 = KK * (k - t86 + 3) - 3 * EE
    t419 = t418 ^ 2
    t420 = t100 * t419
    t421 = A ^ 2
    t428 = 1 + eta
    t429 = t428 ^ 2
    t431 = 0.1e1 / t429 / t428
    t434 = t123 * t122 * t431 * t114 * t119
    t435 = t434 * t110 * t117 * t78
    contr[8] = 45/32 * t435 * t421 * t80 * t420 * t413 * t388
    t437 = t168 * t387
    t441 = t54 * t395
    t445 = t12 - 6 * t11 - 1
    t447 = t28 * t395
    t450 = t156 * t163
    t452 = t12 - 4 * t11 + 1
    t456 = t395 * t393 * t452 * t450 - 5 * t441 * t393 * t269 - 5 * t447 * t393 * t445 + t130 + t134 - t144 - t155
    t457 = t100 * t456
    t458 = t421 * t6
    contr[9] = -9/64 * t435 * t458 * t457 * t419 * cdelta * t437
    t463 = t175 * t387
    t464 = t420 * t463
    t470 = -t1 * t28 + t28 * t3
    t474 = t54 + 1/5
    t476 = t406 * t393 * t474
    t478 = -t13 * t389 + 5 * t180 + 5 * t37 * t470 - 10 * t190 - 5/2 * t476 + t411
    t479 = t478 * t209
    t480 = t78 * t421
    t483 = t105 * t117
    t488 = t124 * t431 * t114 * t119 * t109 * t483
    contr[10] = -9/32 * t488 * t480 * t479 * t464
    t493 = t278 * t100
    t494 = 6 * t324
    t495 = t11 + 2
    t497 = t141 * t395
    t499 = 2 * t497 * t393 * t495
    t507 = t12 - 4/3 * t11 - 1/3
    t509 = Q1 * t393
    t511 = 3 * t509 * t507 * t395
    t513 = -2 * t13 + 2 * Q2
    t515 = P1 * P2 * t513
    t516 = t321 + t494 - t499 + t28 * P1 * P2 * (4 * t37 - 16 * Q2) - t511 + t515
    contr[11] = -45/64 * t435 * t421 * t516 * t493 * t419 * sdelta * t388
    t534 = 5 * t12
    t542 = P1 * (t129 - 5 * t54 * t269 + t28 * (-t534 + 30 * t11 - 5) + t12 * t11 - t534 - 5 * t11 + 1) * P2
    t546 = Q1 - Q2
    t548 = Q1 + Q2
    t550 = t548 * t546 * (t28 + t11 - 5) * Q2 * Q1 * t1
    t552 = t3 * (-2 * t132 + 10 * t142 + Q1 * (2 * t13 - 10 * t37)) + t542 + 2 * t550
    t554 = t552 * cdelta * t283 * t387
    contr[12] = -9/32 * t435 * t458 * t420 * t554
    t562 = 10 * t11 * t1 - 10 * t11 * t3
    t564 = t12 + 1/5
    t570 = -P1 * P2 * t513
    t571 = 5 * t509 * t564 * t395 + t141 * t562 + t321 + t325 - t331 + t570
    t572 = t571 * t347
    contr[13] = 9/64 * t488 * t480 * t572 * t464
    t578 = P1 * t546 + t548 * P2
    t582 = t546 * P2
    t583 = -P1 * t548 + t582
    t584 = t583 * cdelta
    t587 = t6 - 2/5
    t590 = t3 + t1 - 3/2 * eta - 3/2
    t596 = t434 * t110 * t117 * t353
    contr[14] = -15/16 * t596 * t590 * t421 * t587 * t419 * t78 * t584 * t100 * t578
    t599 = B * t418
    t600 = t100 * t80
    t602 = t78 * t15
    t603 = t128 / 3
    t605 = -t393
    t612 = 4/3 * t11 * t39 * t42 * t203
    t615 = 2/3 * t409
    t618 = t13 * t603 - t181 + 2/3 * t396 * t605 * t392 - t612 + t406 * t605 * t404 + P1 * P2 * t615
    t626 = (-2/3 * k + m / 3 - 1) * KK + EE * (1 + k)
    t631 = t109 * t483
    t633 = t434 * t631 * t590 * A
    contr[15] = -135/16 * t633 * t626 * sdelta * t618 * t602 * t600 * t599
    t636 = t100 * t6
    t637 = t636 * t599
    t648 = t395 * t605 * t452 * t450 - 5 * t441 * t605 * t269 - 5 * t447 * t605 * t445 + t129 * t135 - t134 + t144 + t155
    t650 = cdelta * t168
    contr[16] = -9/16 * t633 * t626 * t650 * t648 * t78 * t637
    t656 = t100 * t209
    t660 = 2 * t470
    t664 = 2/5 * t409
    t667 = P1 * P2 * t664 + t406 * t605 * t474 - t13 * t176 + t37 * t660 + t181 - t191
    t675 = t434 * t110 * t117 * t590
    contr[17] = 45/16 * t675 * A * t626 * t175 * t667 * t78 * t656 * t599
    t678 = t131 * t135
    t688 = Q1 * t395
    t691 = t678 - t494 - 2 * t497 * t605 * t495 + t28 * (-4 * t37 * t17 + 16 * t342) - 3 * t688 * t605 * t507 + t570
    contr[18] = -45/16 * t633 * t626 * sdelta * t691 * t602 * t493 * t599
    t698 = t283 * t78
    t699 = 5 * t142
    t701 = t13 - 5 * t37
    t705 = t542 / 2
    t706 = t3 * (Q1 * t701 - t132 + t699) + t705 + t550
    t707 = cdelta * t706
    contr[19] = 9/4 * t633 * t626 * t707 * t698 * t637
    t712 = t100 * t347
    t720 = 5 * t688 * t605 * t564 - t141 * t562 - t325 + t331 + t515 + t678
    contr[20] = 9/16 * t675 * A * t720 * t626 * t175 * t78 * t712 * t599
    t726 = B * t590
    t732 = P1 * t548 - t582
    contr[21] = 45/8 * t434 * t631 * A * t626 * t353 * t732 * cdelta * t100 * t78 * t587 * t418 * t578 * t726
    t741 = t602 * t600
    t746 = (-k / 3 - m / 3) * KK + EE * k
    t748 = sdelta * C
    contr[22] = 135/16 * t633 * t418 * t748 * t746 * t618 * t741
    t753 = t746 * t78
    t754 = t753 * t636
    contr[23] = 9/16 * t633 * t418 * t650 * C * t648 * t754
    t762 = t590 * t175
    t768 = t434 * t110 * t117 * A
    contr[24] = -45/16 * t768 * t418 * t762 * t667 * C * t753 * t656
    t771 = t602 * t493
    t778 = t434 * t631 * A * t418
    contr[25] = 45/16 * t778 * t590 * t748 * t746 * t691 * t771
    contr[26] = -9/4 * t778 * t590 * t707 * t283 * C * t754
    contr[27] = -9/16 * t768 * t720 * t418 * t590 * t175 * C * t753 * t712
    t794 = t578 * t590
    t800 = t732 * t746 * cdelta
    contr[28] = -45/8 * t434 * t631 * A * t353 * t800 * t418 * t100 * C * t78 * t587 * t794
    t809 = C * t746
    t810 = sdelta * t809
    t814 = t434 * t631 * t726
    contr[29] = 405/16 * t814 * t810 * t618 * t626 * t741
    t816 = t626 * t78
    t817 = t816 * t636
    contr[30] = 27/16 * t814 * cdelta * t168 * C * t648 * t746 * t817
    t831 = t434 * t110 * t117 * B
    contr[31] = -135/16 * t831 * t590 * t175 * t667 * t809 * t816 * t656
    contr[32] = 135/16 * t814 * t810 * t691 * t626 * t771
    contr[33] = -27/4 * t814 * cdelta * t706 * t283 * t809 * t817
    contr[34] = -27/16 * t831 * t720 * t762 * t809 * t816 * t712
    contr[35] = -135/8 * t434 * t631 * B * t353 * t800 * t100 * C * t78 * t626 * t587 * t794
    t861 = sdelta * t387
    t862 = t626 ^ 2
    t865 = B ^ 2
    t866 = t865 * t15
    contr[36] = 405/32 * t435 * t866 * t600 * t412 * t862 * t861
    t872 = t865 * t6
    contr[37] = -81/64 * t435 * t872 * t457 * t862 * cdelta * t437
    t877 = t100 * t862
    t878 = t877 * t463
    t879 = t78 * t865
    contr[38] = -81/32 * t488 * t879 * t479 * t878
    contr[39] = -405/64 * t435 * t866 * t516 * t278 * t877 * t861
    contr[40] = -81/32 * t435 * t872 * t877 * t554
    contr[41] = 81/64 * t488 * t879 * t572 * t878
    contr[42] = -135/16 * t596 * t865 * t587 * t590 * t78 * t583 * cdelta * t100 * t578 * t862
    t907 = C ^ 2
    t908 = t387 * t907
    t910 = t746 ^ 2
    contr[43] = 405/32 * t435 * t15 * t80 * t100 * t910 * t413 * t908
    t917 = cdelta * t387
    contr[44] = -81/64 * t435 * t636 * t456 * t910 * t917 * t907 * t168
    t925 = t910 * t175 * t908
    contr[45] = -81/32 * t488 * t78 * t209 * t100 * t478 * t925
    contr[46] = -405/64 * t435 * t15 * t516 * t493 * t910 * sdelta * t908
    contr[47] = -81/32 * t435 * t636 * t910 * t552 * t917 * t907 * t283
    contr[48] = 81/64 * t488 * t78 * t571 * t712 * t925
    contr[49] = -135/16 * t596 * t587 * t590 * t78 * t584 * t100 * t907 * t910 * t578
    t959 = sdelta * t590
    contr[50] = -315/32 * t488 * t741 * (-t13 * t603 + t181 + 2/3 * t397 + t612 + t407 - P1 * P2 * t615) * t98 * t959
    contr[51] = -21/32 * t488 * t636 * t78 * t168 * t98 * t456 * cdelta * t590
    contr[52] = 105/32 * t488 * t656 * t78 * (-P1 * P2 * t664 - t37 * t660 + t177 - t181 + t191 + t476) * t98 * t762
    contr[53] = -105/32 * t488 * t771 * t98 * (4 * t28 * t240 * t243 * t342 + t321 + t494 - t499 - t511 + t515) * t959
    contr[54] = 21/8 * t488 * t636 * t698 * t98 * cdelta * t590 * (t3 * (-Q1 * t701 + t132 - t699) - t705 - t550)
    contr[55] = 21/32 * t488 * t712 * t78 * t98 * t571 * t762
    contr[56] = -105/16 * t675 * t353 * t578 * t732 * t587 * t171 * t78 * cdelta
       

    contr = sum(contr);
    return contr;

end

function meandZ3dcdeltaP1_Gravity(k,m,skm,smk,mM1KK,KK,EE,PP,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,A,B,C,mu)
    
    GG = 1+Q1^2+Q2^2
    contr = zeros(40)
    t1 = P1 ^ 2
    t2 = P2 ^ 2
    t3 = t1 - t2
    t4 = Q1 ^ 2
    t5 = t4 ^ 2
    t6 = t5 * t4
    t7 = t6 * t3
    t8 = P1 * P2
    t9 = t5 * Q1
    t10 = Q2 * t9
    t12 = 8 * t10 * t8
    t13 = -t3
    t14 = 5 * t13
    t15 = Q2 ^ 2
    t17 = 9 * t2
    t20 = t4 * Q1
    t21 = Q2 * t20
    t23 = 40 * t21 * t8
    t24 = t15 ^ 2
    t30 = t15 * Q2
    t31 = P1 * t30
    t36 = 8 * Q1 * (t15 - 5) * P2 * t31
    t37 = Q2 + 1
    t38 = t24 * t3
    t44 = Q2 - 1
    t47 = cdelta ^ 2
    t48 = t47 - 1/3
    t50 = mu ^ 2
    t52 = 2 * psih
    t53 = cos(t52)
    t54 = skm ^ 2
    t55 = t54 * t53
    t61 = 2 * m
    t73 = (KK * ((A - 2 * B + C) * k + (m - 3) * B + A * (-t61 + 3) + C * m) - 3 * EE * ((-B + C) * k + A - B)) ^ 2
    t76 = 0.1e1 / Jg
    t77 = sma ^ 2
    t78 = t77 ^ 2
    t80 = 0.1e1 / t78 / t77
    t81 = t80 * t76
    t82 = eta ^ 2
    t83 = t82 ^ 2
    t85 = 0.1e1 / t83 / t82
    t87 = 0.1e1 / n
    t88 = k ^ 2
    t89 = 1 / t88
    t91 = GG ^ 2
    t93 = 0.1e1 / t91 / GG
    t94 = KK ^ 2
    t95 = 1 / t94
    t96 = t95 * t93
    t98 = t96 * t89 * t87 * t85 * t81
    contr[1] = 27/64 * t98 * t73 * t55 * t50 * t48 * (t7 + t12 + t5 * (t15 * t14 - t1 + t17 - 6) - t23 + t4 * (t24 * t14 + 30 * t15 * t3 + t1 - t17 + 6) - t36 + t44 * (t38 + t15 * (-8 * t1 + 6) + t1 - t2) * t37)
    t100 = t50 * cdelta
    t101 = t3 / 5
    t102 = t24 * Q2
    t103 = t102 * t101
    t106 = P2 * Q1 * P1 * t24
    t107 = 2 * t106
    t116 = t20 * P2 * P1 * t15
    t117 = 4 * t116
    t133 = t54 * sdelta
    t134 = 3 * psih
    t135 = cos(t134)
    contr[2] = -135/64 * t98 * t135 * t73 * t133 * (t103 - t107 + t30 * (2 * t4 * t13 - 4/15 * t1 - 4/15 * t2 + 2/5) + t117 + Q2 * (t5 * t3 + t4 * (4/5 * t1 + 4/5 * t2 - 6/5) + t1 / 5 - t2 / 5) - 2/5 * t9 * t8 + 2/5 * Q1 * t8) * t100
    t145 = t15 + 1
    t154 = 2 * Q2
    t155 = t15 + t154 - 1
    t156 = t15 - t154 - 1
    t161 = 7 * t1
    t177 = sin(t52)
    t178 = t54 * t177
    contr[3] = -27/16 * t98 * t73 * t178 * t50 * t48 * (-t6 * t8 / 2 + t9 * t3 * Q2 + 5/2 * t5 * t145 * t8 - 3 * t20 * (t1 - 7/3 * t2 + 1) * Q2 + 5/2 * t4 * t156 * t155 * t8 - Q1 * (t38 + t15 * (-t161 + 3 * t2 + 3) + 2 * t1 + 2 * t2 - 3) * Q2 - t156 * t155 * t145 * t8 / 2)
    t184 = t73 * t54
    t185 = sin(t134)
    t186 = t9 * t3
    t188 = Q2 * P1
    t190 = 10 * t188 * P2 * t5
    t199 = 20 * t31 * P2 * t4
    contr[4] = -27/64 * t98 * (t186 + t190 + t20 * (10 * t15 * t13 + 4/3 * t1 + 4/3 * t2 - 2) - t199 + Q1 * (-t24 * t14 + t15 * (-4 * t1 - 4 * t2 + 6) + t1 - t2) + 2 * t102 * t8 - 2 * Q2 * t8) * t185 * t184 * sdelta * t100
    t219 = (-3/2 + t2 + t1) * t48
    t230 = t47 - 1/5
    t245 = t4 + t15 - 1
    contr[5] = 9/32 * t87 * t76 * t95 * t89 * t85 * t80 * t93 * t184 * t50 * t245 * (t5 * t219 + t4 * (2 * t15 * t219 + t47 * (t161 - 23 * t2 + 12) + 13/3 * t2 - 2 - 5/3 * t1) + 60 * Q1 * t230 * P2 * t188 + t24 * t219 + t15 * (t47 * (-23 * t1 + 7 * t2 + 12) - 2 - 5/3 * t2 + 13/3 * t1) + t219)
    t259 = KK * (k - t61 + 3) - 3 * EE
    t260 = t259 ^ 2
    t261 = P1 - P2
    t263 = P1 + P2
    t264 = t5 * t263
    t268 = t24 - 6 * t15 - 1
    t270 = t4 * t263
    t273 = t37 * t44
    t275 = t24 - 4 * t15 + 1
    t279 = t263 * t261 * t275 * t273 - 5 * t264 * t261 * t145 - 5 * t270 * t261 * t268 + t12 - t23 - t36 + t7
    t283 = -2/3 * t1 - 2/3 * t2 + eta + 1
    t284 = t283 * t54
    t286 = t48 * t53
    t287 = A ^ 2
    t288 = t50 * t287
    t291 = t95 * t85
    t292 = t89 * t93
    t294 = 1 + eta
    t295 = t294 ^ 2
    t297 = 0.1e1 / t295 / t294
    t300 = t81 * t87 * t297 * t292 * t291
    contr[6] = -27/64 * t300 * t288 * t286 * t284 * t279 * t260
    t303 = cdelta * t135
    t304 = t54 * t260
    t311 = t4 * t1 - t2 * t4
    t315 = t5 + 1/5
    t317 = Q2 * t263
    t318 = t317 * t261 * t315
    t320 = t9 - Q1
    t323 = t102 * t13 / 2 + 5 * t106 + 5 * t30 * t311 - 10 * t116 - 5/2 * t318 + P1 * P2 * t320
    t324 = t283 * t323
    t333 = t76 * t80 * t87 * t297 * t89
    t334 = t333 * t96 * t85 * t50
    contr[7] = -27/32 * t334 * t287 * sdelta * t324 * t304 * t303
    t348 = 5 * t24
    t356 = P1 * (t6 - 5 * t5 * t145 + t4 * (-t348 + 30 * t15 - 5) + t24 * t15 - t348 - 5 * t15 + 1) * P2
    t360 = Q1 - Q2
    t362 = Q1 + Q2
    t364 = t362 * t360 * (t4 + t15 - 5) * Q2 * Q1 * t2
    t366 = t1 * (-2 * t10 + 10 * t21 + Q1 * (2 * t102 - 10 * t30)) + t356 + 2 * t364
    t369 = t48 * t177
    contr[8] = -27/32 * t300 * t288 * t369 * t284 * t260 * t366
    t374 = cdelta * t185
    t376 = sdelta * t283
    t380 = -10 * t15 * t1 + 10 * t15 * t2
    t382 = t24 + 1/5
    t388 = 2 * t102 - 2 * Q2
    t391 = 5 * Q1 * t261 * t382 * t263 + P1 * P2 * t388 + t20 * t380 + t186 + t190 - t199
    contr[9] = 27/64 * t334 * t287 * t391 * t376 * t304 * t374
    t398 = P1 * t360 + t362 * P2
    t401 = t230 * t50 * t54 * t398
    t403 = t1 + t2 - 3/2 * eta - 3/2
    t407 = t360 * P2
    t408 = -P1 * t362 + t407
    t413 = t80 * t93
    t417 = t87 * t76 * t297 * t291
    contr[10] = -45/16 * t417 * t413 * t89 * t287 * t245 * t408 * t403 * t260 * t401
    t422 = t48 * t54
    t424 = t50 * t259
    t426 = -t261
    t436 = t263 * t426 * t275 * t273 - 5 * t264 * t426 * t145 - 5 * t270 * t426 * t268 + t6 * t13 - t12 + t23 + t36
    t444 = (-2/3 * k + m / 3 - 1) * KK + EE * (1 + k)
    t450 = t333 * t96 * t85 * A
    contr[11] = -27/16 * t450 * t444 * t436 * t403 * t424 * t422 * t53 * B
    t456 = 2 * t311
    t460 = 2/5 * t320
    t463 = P1 * P2 * t460 + t317 * t426 * t315 - t102 * t101 + t30 * t456 + t107 - t117
    t471 = t93 * t291
    t473 = t333 * t471 * A * t444
    contr[12] = 135/16 * t473 * cdelta * t135 * t403 * t424 * t463 * t54 * B * sdelta
    t477 = 5 * t21
    t479 = t102 - 5 * t30
    t483 = t356 / 2
    t484 = t1 * (Q1 * t479 - t10 + t477) + t483 + t364
    t485 = t484 * t403
    contr[13] = 27/4 * t450 * t444 * t485 * t424 * t422 * t177 * B
    t500 = 5 * Q1 * t263 * t426 * t382 - P1 * P2 * t388 + t9 * t13 - t20 * t380 - t190 + t199
    contr[14] = 27/16 * t473 * cdelta * t185 * t403 * t424 * t133 * t500 * B
    t509 = P1 * t362 - t407
    t513 = t50 * t403
    t515 = t398 * t230 * t54
    t519 = t80 * t292
    t521 = t417 * t519 * t245 * A
    contr[15] = 135/8 * t521 * t515 * t513 * t259 * t444 * t509 * B
    t523 = t50 * t48
    t524 = t523 * t55
    t525 = t259 * t403
    t531 = (-k / 3 - m / 3) * KK + EE * k
    t532 = t531 * C * t436
    contr[16] = 27/16 * t450 * t532 * t525 * t524
    t537 = t50 * t463 * t133
    t539 = t531 * t135 * C
    t544 = t333 * t471 * cdelta * A
    contr[17] = -135/16 * t544 * t539 * t525 * t537
    t547 = t523 * t178
    contr[18] = -27/4 * t450 * t531 * C * t259 * t485 * t547
    t555 = t50 * t54
    t556 = t555 * sdelta * t500
    t558 = t531 * t185 * C
    contr[19] = -27/16 * t544 * t558 * t525 * t556
    t563 = t509 * t531
    contr[20] = -135/8 * t521 * t515 * C * t50 * t525 * t563
    t570 = t403 * t444
    t575 = t333 * t96 * t85 * B
    contr[21] = 81/16 * t575 * t532 * t570 * t524
    t581 = t333 * t471 * cdelta * B
    contr[22] = -405/16 * t581 * t539 * t570 * t537
    contr[23] = -81/4 * t575 * t531 * C * t484 * t570 * t547
    contr[24] = -81/16 * t581 * t558 * t570 * t556
    t596 = t398 * t230
    contr[25] = -405/8 * t417 * t519 * t245 * B * t444 * t596 * t54 * C * t513 * t563
    t606 = t444 ^ 2
    t607 = t283 * t606
    t609 = B ^ 2
    t610 = t50 * t609
    contr[26] = -243/64 * t300 * t610 * t286 * t607 * t54 * t279
    contr[27] = -243/32 * t334 * t609 * sdelta * t607 * t323 * t54 * t303
    contr[28] = -243/32 * t300 * t610 * t369 * t607 * t54 * t366
    contr[29] = 243/64 * t334 * t609 * t391 * t376 * t606 * t54 * t374
    t634 = t408 * t403
    contr[30] = -405/16 * t417 * t413 * t89 * t609 * t606 * t245 * t634 * t401
    t643 = C ^ 2
    t646 = t531 ^ 2
    t647 = t50 * t646
    contr[31] = -243/64 * t300 * t647 * t286 * t284 * t279 * t643
    t653 = t54 * cdelta
    contr[32] = -243/32 * t334 * t646 * sdelta * t324 * t653 * t643 * t135
    contr[33] = -243/32 * t300 * t647 * t369 * t284 * t366 * t643
    contr[34] = 243/64 * t334 * t646 * t391 * t376 * t653 * t643 * t185
    contr[35] = -405/16 * t417 * t413 * t89 * t245 * t634 * t647 * t54 * t643 * t596
    contr[36] = -63/32 * t300 * t48 * t279 * t184 * t53 * t513
    contr[37] = 315/32 * t300 * t135 * (-P1 * P2 * t460 - t30 * t456 + t103 - t107 + t117 + t318) * t184 * sdelta * t403 * t100
    contr[38] = 63/8 * t300 * t48 * t73 * t178 * t403 * t50 * (t1 * (-Q1 * t479 + t10 - t477) - t483 - t364)
    contr[39] = 63/32 * t300 * t185 * t73 * t133 * t513 * t391 * cdelta
    contr[40] = -315/16 * t300 * t245 * t73 * t398 * t403 * t555 * t230 * t509
       
    contr = sum(contr);
    return contr;
end

function meandZ3dcdeltaP2_Gravity(k,m,skm,smk,mM1KK,KK,EE,PP,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,A,B,C,mu)
    
    GG = 1+Q1^2+Q2^2
    contr = zeros(16)
    t1 = P2 ^ 2
    t3 = P1 ^ 2
    t6 = cdelta ^ 2
    t7 = t6 * (t1 / 11 - 9/11 * t3 + 6/11)
    t8 = 61/99 * t3
    t9 = 5/99 * t1
    t11 = Q2 ^ 2
    t12 = t11 ^ 2
    t13 = t12 * Q2
    t15 = P1 * P2
    t16 = t6 - 11/15
    t17 = Q1 * t16
    t28 = Q1 ^ 2
    t37 = t11 * Q2
    t39 = Q1 + 2
    t42 = Q1 - 2
    t54 = t28 ^ 2
    t76 = mu ^ 2
    t78 = cos(psih)
    t79 = skm ^ 2
    t80 = t79 * t78
    t86 = 2 * m
    t98 = (KK * ((A - 2 * B + C) * k + (m - 3) * B + A * (-t86 + 3) + C * m) - 3 * EE * ((-B + C) * k + A - B)) ^ 2
    t101 = 0.1e1 / Jg
    t102 = sma ^ 2
    t103 = t102 ^ 2
    t105 = 0.1e1 / t103 / t102
    t106 = t105 * t101
    t107 = eta ^ 2
    t108 = t107 ^ 2
    t110 = 0.1e1 / t108 / t107
    t112 = 0.1e1 / n
    t113 = k ^ 2
    t114 = 1 / t113
    t116 = GG ^ 2
    t118 = 0.1e1 / t116 / GG
    t119 = KK ^ 2
    t120 = 1 / t119
    t121 = t120 * t118
    t123 = t121 * t114 * t112 * t110 * t106
    contr[1] = -297/64 * t123 * t98 * t80 * t76 * (t13 * (t7 - 14/33 + t8 - t9) + 30/11 * t12 * t17 * t15 + t37 * (t28 * (t6 * (12/11 + 2/11 * t3 - 18/11 * t1) - 10/99 * t3 + 122/99 * t1 - 28/33) + t6 * (32/11 * t3 - 8/11 * t1 - 18/11) - 208/99 * t3 + 56/99 * t1 + 38/33) + 20/11 * t11 * Q1 * t16 * t42 * P1 * P2 * t39 + Q2 * (t54 * (t6 * (6/11 + t3 - 19/11 * t1) - 71/99 * t3 + 127/99 * t1 - 14/33) + t28 * (t6 * (-18/11 - 8/11 * t3 + 32/11 * t1) + 56/99 * t3 - 208/99 * t1 + 38/33) + t7 - 14/33 + t8 - t9) - 10/11 * t17 * t15 * (Q1 - 1) * (t28 + 1) * (Q1 + 1)) * cdelta
    t128 = t6 * (t3 - 9 * t1 + 6)
    t129 = 5/9 * t3
    t130 = 61/9 * t1
    t132 = t54 * Q1
    t134 = Q2 * t16
    t153 = t28 * Q1
    t155 = Q2 + 2
    t158 = Q2 - 2
    t194 = sin(psih)
    t195 = t79 * t194
    contr[2] = -27/64 * t123 * t98 * t195 * t76 * (t132 * (t128 - t129 + t130 - 14/3) + 30 * t54 * t134 * t15 + t153 * (t11 * (t6 * (-18 * t3 + 2 * t1 + 12) + 122/9 * t3 - 10/9 * t1 - 28/3) + t6 * (-8 * t3 + 32 * t1 - 18) - 208/9 * t1 + 56/9 * t3 + 38/3) + 20 * t28 * Q2 * t16 * t158 * P1 * P2 * t155 + Q1 * (t12 * (t6 * (-19 * t3 + 11 * t1 + 6) + 127/9 * t3 - 71/9 * t1 - 14/3) + t11 * (t6 * (32 * t3 - 8 * t1 - 18) - 208/9 * t3 + 56/9 * t1 + 38/3) + t128 - t129 + t130 - 14/3) - 10 * t134 * P1 * (Q2 - 1) * (t11 + 1) * P2 * (Q2 + 1)) * cdelta
    t204 = KK * (k - t86 + 3) - 3 * EE
    t205 = t204 ^ 2
    t207 = t79 * t205 * t16 * cdelta
    t208 = t3 - t1
    t213 = P2 * Q1 * P1 * t12
    t215 = t28 + 2
    t216 = P1 - P2
    t218 = P1 + P2
    t219 = t37 * t218
    t220 = t219 * t216 * t215
    t228 = t54 - 4/3 * t28 - 1/3
    t230 = Q2 * t218
    t231 = t230 * t216 * t228
    t233 = t132 - Q1
    t239 = -2/3 * t3 - 2/3 * t1 + eta + 1
    t240 = t239 * (t13 * t208 / 2 - 3 * t213 - t220 + t11 * P1 * P2 * (-2 * t153 + 8 * Q1) - 3/2 * t231 + P1 * P2 * t233)
    t241 = A ^ 2
    t247 = 1 + eta
    t248 = t247 ^ 2
    t250 = 0.1e1 / t248 / t247
    t253 = t101 * t105 * t112
    t254 = t253 * t250 * t114
    t255 = t254 * t121 * t110 * t76
    contr[3] = -135/32 * t255 * t241 * t78 * t240 * t207
    t259 = t132 * t208
    t263 = 6 * P1 * Q2 * P2 * t54
    t264 = t11 + 2
    t266 = t153 * t218
    t268 = 2 * t266 * t216 * t264
    t276 = t12 - 4/3 * t11 - 1/3
    t280 = 3 * Q1 * t216 * t276 * t218
    t282 = -2 * t13 + 2 * Q2
    t284 = P1 * P2 * t282
    t285 = t259 + t263 - t268 + t28 * P1 * P2 * (4 * t37 - 16 * Q2) - t280 + t284
    contr[4] = 135/64 * t255 * t241 * t285 * t194 * t239 * t207
    t291 = t204 * t79
    t294 = t3 + t1 - 3/2 * eta - 3/2
    t302 = (-2/3 * k + m / 3 - 1) * KK + EE * (1 + k)
    t307 = t208 / 3
    t309 = 2 * t213
    t310 = -t216
    t318 = 4/3 * t11 * t39 * t42 * Q1 * t15
    t321 = 2/3 * t233
    t324 = t13 * t307 - t309 + 2/3 * t219 * t310 * t215 - t318 + t230 * t310 * t228 + P1 * P2 * t321
    t327 = t118 * t120 * t110
    t329 = t254 * t327 * A * t324
    contr[5] = 405/16 * t329 * t16 * cdelta * t302 * t294 * t76 * t291 * t78 * B
    t340 = t15 * Q2
    t351 = -t132 * t208 - t263 - 2 * t266 * t310 * t264 + t28 * (-4 * t37 * t15 + 16 * t340) - 3 * Q1 * t218 * t310 * t276 - P1 * P2 * t282
    contr[6] = 135/16 * t254 * t327 * A * t16 * cdelta * t302 * t294 * t351 * t76 * t291 * t194 * B
    t362 = t76 * t79
    t369 = (-k / 3 - m / 3) * KK + EE * k
    t372 = t294 * cdelta * t369 * C * t16
    contr[7] = -405/16 * t329 * t372 * t362 * t204 * t78
    t381 = cdelta * t369 * C * t16 * t351
    t384 = t110 * t114
    t385 = t120 * t384
    t388 = t253 * t250 * t118
    contr[8] = -135/16 * t388 * t385 * A * t294 * t381 * t362 * t204 * t194
    t392 = t76 * t302
    contr[9] = -1215/16 * t388 * t385 * B * t324 * t372 * t392 * t80
    contr[10] = -405/16 * t388 * t385 * B * t294 * t381 * t392 * t195
    t407 = t302 ^ 2
    t408 = cdelta * t407
    t410 = B ^ 2
    contr[11] = -1215/32 * t255 * t410 * t16 * t80 * t240 * t408
    t416 = t79 * t239
    t418 = t16 * t194
    contr[12] = 1215/64 * t255 * t410 * t285 * t418 * t416 * t408
    t423 = C ^ 2
    t424 = cdelta * t423
    t426 = t369 ^ 2
    contr[13] = -1215/32 * t255 * t426 * t16 * t80 * t240 * t424
    contr[14] = 1215/64 * t255 * t285 * t426 * t418 * t416 * t424
    t445 = t76 * t16
    t447 = t294 * t98
    t453 = t106 * t112 * t250 * t121 * t384
    contr[15] = 945/32 * t453 * t447 * t80 * t445 * cdelta * (-t13 * t307 + t309 + 2/3 * t220 + t318 + t231 - P1 * P2 * t321)
    contr[16] = 315/32 * t453 * t447 * t195 * t445 * (4 * t28 * t155 * t158 * t340 + t259 + t263 - t268 - t280 + t284) * cdelta
       
   
    
    contr = sum(contr)
    return contr;
end

function meandZ3dpsih_Gravity(k,m,skm,smk,mM1KK,KK,EE,PP,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,A,B,C,mu)
    
    GG = 1+Q1^2+Q2^2
    contr = zeros(48)
    t6 = 2 * m
    t18 = (KK * ((A - 2 * B + C) * k + (m - 3) * B + A * (-t6 + 3) + C * m) - 3 * EE * ((-B + C) * k + A - B)) ^ 2
    t19 = sdelta * t18
    t20 = mu ^ 2
    t21 = t20 * t19
    t22 = P2 ^ 2
    t24 = P1 ^ 2
    t27 = sdelta ^ 2
    t28 = t27 * (t22 / 11 - 9/11 * t24 + 6/11)
    t29 = 20/33 * t24
    t30 = 4/33 * t22
    t32 = Q2 ^ 2
    t33 = t32 ^ 2
    t34 = t33 * Q2
    t36 = t27 - 4/5
    t38 = P1 * P2
    t49 = Q1 ^ 2
    t58 = t32 * Q2
    t60 = Q1 + 2
    t63 = Q1 - 2
    t73 = 4/3 * t22
    t75 = t49 ^ 2
    t98 = sin(psih)
    t100 = skm ^ 2
    t103 = GG ^ 2
    t105 = 0.1e1 / t103 / GG
    t106 = sma ^ 2
    t107 = t106 ^ 2
    t109 = 0.1e1 / t107 / t106
    t110 = t109 * t105
    t111 = eta ^ 2
    t112 = t111 ^ 2
    t114 = 0.1e1 / t112 / t111
    t116 = k ^ 2
    t117 = 1 / t116
    t118 = KK ^ 2
    t119 = 1 / t118
    t121 = 0.1e1 / Jg
    t122 = 0.1e1 / n
    t123 = t122 * t121
    t125 = t123 * t119 * t117 * t114 * t110
    contr[1] = 99/64 * t125 * t100 * t98 * (t34 * (t28 - 4/11 + t29 - t30) + 30/11 * t33 * t38 * t36 * Q1 + t58 * (t49 * (t27 * (12/11 + 2/11 * t24 - 18/11 * t22) - 8/33 * t24 + 40/33 * t22 - 8/11) + t27 * (32/11 * t24 - 8/11 * t22 - 18/11) + 16/11 - 80/33 * t24 + 16/33 * t22) + 20/11 * t32 * P2 * P1 * t63 * t36 * Q1 * t60 + Q2 * (t75 * (t27 * (6/11 + t24 - 19/11 * t22) - 28/33 * t24 + t73 - 4/11) + t49 * (t27 * (-18/11 - 8/11 * t24 + 32/11 * t22) + 16/33 * t24 - 80/33 * t22 + 16/11) + t28 - 4/11 + t29 - t30) - 10/11 * (Q1 - 1) * P1 * P2 * (Q1 + 1) * t36 * (t49 + 1) * Q1) * t21
    t127 = t24 - t22
    t128 = t75 * t49
    t129 = t128 * t127
    t130 = t75 * Q1
    t131 = Q2 * t130
    t133 = 8 * t131 * t38
    t134 = -t127
    t135 = 5 * t134
    t137 = 9 * t22
    t140 = t49 * Q1
    t141 = Q2 * t140
    t143 = 40 * t141 * t38
    t149 = P1 * t58
    t154 = 8 * Q1 * (t32 - 5) * P2 * t149
    t155 = Q2 + 1
    t156 = t33 * t127
    t157 = 8 * t24
    t162 = Q2 - 1
    t167 = t27 * t20
    t168 = 2 * psih
    t169 = sin(t168)
    contr[2] = 9/32 * t125 * t169 * t100 * t167 * cdelta * t18 * (t129 + t133 + t75 * (t32 * t135 + t137 - t24 - 6) - t143 + t49 * (30 * t32 * t127 + t33 * t135 - t137 + t24 + 6) - t154 + t162 * (t156 + t32 * (-t157 + 6) + t24 - t22) * t155)
    t174 = t27 * sdelta
    t175 = t174 * t18
    t176 = t127 / 5
    t177 = t34 * t176
    t180 = P2 * Q1 * P1 * t33
    t181 = 2 * t180
    t188 = P1 * t32
    t190 = t140 * P2 * t188
    t191 = 4 * t190
    t203 = Q1 * t38
    t207 = 3 * psih
    t208 = sin(t207)
    t209 = t208 * t20
    contr[3] = -135/64 * t125 * t100 * t209 * (t177 - t181 + t58 * (2 * t49 * t134 - 4/15 * t24 - 4/15 * t22 + 2/5) + t191 + Q2 * (t75 * t127 + t49 * (4/5 * t24 + 4/5 * t22 - 6/5) + t24 / 5 - t22 / 5) - 2/5 * t130 * t38 + 2/5 * t203) * t175
    t214 = cos(psih)
    t216 = t27 * (t24 - t137 + 6)
    t217 = 4/3 * t24
    t218 = 20/3 * t22
    t226 = 2 * t22
    t240 = Q2 + 2
    t243 = Q2 - 2
    t245 = t49 * P2
    t269 = t32 + 1
    contr[4] = -9/64 * t125 * t100 * (t130 * (t216 - 4 - t217 + t218) + 30 * t75 * t38 * t36 * Q2 + t140 * (t32 * (t27 * (-18 * t24 + t226 + 12) + 40/3 * t24 - 8/3 * t22 - 8) + t27 * (-t157 + 32 * t22 - 18) + 16 + 16/3 * t24 - 80/3 * t22) + 20 * t245 * P1 * t243 * t36 * Q2 * t240 + Q1 * (t33 * (t27 * (-19 * t24 + 11 * t22 + 6) - 28/3 * t22 + 44/3 * t24 - 4) + t32 * (t27 * (32 * t24 - 8 * t22 - 18) - 80/3 * t24 + 16/3 * t22 + 16) + t216 - 4 - t217 + t218) - 10 * t162 * P2 * P1 * t269 * t36 * Q2 * t155) * t214 * t21
    t281 = cdelta * t18
    t294 = 2 * Q2
    t295 = t32 + t294 - 1
    t296 = t32 - t294 - 1
    t315 = cos(t168)
    contr[5] = 9/8 * t125 * t315 * t100 * t167 * (-t128 * t38 / 2 + t130 * t127 * Q2 + 5/2 * t75 * t269 * t38 - 3 * t140 * (t24 - 7/3 * t22 + 1) * Q2 + 5/2 * t49 * t296 * t295 * t38 - Q1 * (t156 + t32 * (-7 * t24 + 3 * t22 + 3) + 2 * t24 + t226 - 3) * Q2 - t296 * t295 * t269 * t38 / 2) * t281
    t320 = t20 * t175
    t321 = t130 * t127
    t324 = P1 * Q2 * P2 * t75
    t325 = 10 * t324
    t331 = 20 * t149 * t245
    t342 = Q2 * t38
    t345 = cos(t207)
    contr[6] = 27/64 * t125 * t100 * t345 * (t321 + t325 + t140 * (10 * t32 * t134 + t217 + t73 - 2) - t331 + Q1 * (-t33 * t135 + t32 * (-4 * t24 - 4 * t22 + 6) + t24 - t22) + 2 * t34 * t38 - 2 * t342) * t320
    t353 = KK * (k - t6 + 3) - 3 * EE
    t354 = t353 ^ 2
    t357 = -2/3 * t24 - 2/3 * t22 + eta + 1
    t358 = t357 * t354
    t359 = t36 * sdelta
    t360 = t359 * t358
    t361 = t127 / 2
    t364 = t49 + 2
    t365 = P1 - P2
    t367 = P1 + P2
    t368 = t58 * t367
    t369 = t368 * t365 * t364
    t376 = t75 - 4/3 * t49 - 1/3
    t378 = Q2 * t367
    t379 = t378 * t365 * t376
    t381 = t130 - Q1
    t383 = P1 * P2 * t381
    t384 = t34 * t361 - 3 * t180 - t369 + t188 * P2 * (-2 * t140 + 8 * Q1) - 3/2 * t379 + t383
    t386 = A ^ 2
    t393 = 1 + eta
    t394 = t393 ^ 2
    t396 = 0.1e1 / t394 / t393
    t399 = t122 * t121 * t396 * t114 * t119
    t400 = t399 * t110 * t117 * t20
    contr[7] = 45/32 * t400 * t386 * t98 * t100 * t384 * t360
    t403 = cdelta * t357
    t406 = t75 * t367
    t410 = t33 - 6 * t32 - 1
    t412 = t49 * t367
    t415 = t155 * t162
    t417 = t33 - 4 * t32 + 1
    t421 = t367 * t365 * t417 * t415 - 5 * t406 * t365 * t269 - 5 * t412 * t365 * t410 + t129 + t133 - t143 - t154
    t422 = t100 * t421
    t423 = t386 * t27
    contr[8] = -9/32 * t400 * t423 * t422 * t403 * t169 * t354
    t433 = -t22 * t49 + t49 * t24
    t437 = t75 + 1/5
    t439 = t378 * t365 * t437
    t442 = (-t34 * t361 + 5 * t180 + 5 * t58 * t433 - 10 * t190 - 5/2 * t439 + t383) * t174
    t444 = t208 * t100
    t445 = t20 * t386
    t448 = t105 * t117
    t453 = t123 * t396 * t114 * t119 * t109 * t448
    contr[9] = -27/32 * t453 * t445 * t444 * t442 * t358
    t456 = 6 * t324
    t457 = t32 + 2
    t459 = t140 * t367
    t461 = 2 * t459 * t365 * t457
    t469 = t33 - 4/3 * t32 - 1/3
    t471 = Q1 * t365
    t473 = 3 * t471 * t469 * t367
    t475 = -2 * t34 + 2 * Q2
    t477 = P1 * P2 * t475
    t478 = t321 + t456 - t461 + t49 * P1 * P2 * (4 * t58 - 16 * Q2) - t473 + t477
    t479 = t478 * t100
    contr[10] = 45/64 * t400 * t386 * t214 * t479 * t360
    t497 = 5 * t33
    t505 = P1 * (t128 - 5 * t75 * t269 + t49 * (-t497 + 30 * t32 - 5) + t33 * t32 - t497 - 5 * t32 + 1) * P2
    t513 = (Q1 + Q2) * (Q1 - Q2) * (t49 + t32 - 5) * Q2 * Q1 * t22
    t515 = t24 * (-2 * t131 + 10 * t141 + Q1 * (2 * t34 - 10 * t58)) + t505 + 2 * t513
    t516 = t515 * t100
    contr[11] = 9/16 * t400 * t423 * t516 * t403 * t315 * t354
    t520 = t100 * t174
    t525 = 10 * t32 * t22 - 10 * t32 * t24
    t527 = t33 + 1/5
    t533 = -P1 * P2 * t475
    t534 = 5 * t471 * t527 * t367 + t140 * t525 + t321 + t325 - t331 + t533
    t535 = t345 * t534
    contr[12] = -27/64 * t453 * t445 * t535 * t520 * t358
    t546 = (-2/3 * k + m / 3 - 1) * KK + EE * (1 + k)
    t547 = t546 * B
    t548 = t100 * t98
    t550 = t20 * t36
    t552 = t24 + t22 - 3/2 * eta - 3/2
    t553 = t353 * t552
    t557 = t127 / 3
    t559 = -t365
    t566 = 4/3 * t32 * t60 * t63 * t203
    t569 = 2/3 * t381
    t572 = t34 * t557 - t181 + 2/3 * t368 * t559 * t364 - t566 + t378 * t559 * t376 + P1 * P2 * t569
    t574 = t109 * t448
    t576 = t399 * t574 * A * t572
    contr[13] = -135/16 * t576 * sdelta * t553 * t550 * t548 * t547
    t590 = t27 * (t367 * t559 * t417 * t415 - 5 * t406 * t559 * t269 - 5 * t412 * t559 * t410 + t128 * t134 - t133 + t143 + t154)
    t592 = t20 * t100
    t599 = t399 * t574 * cdelta * A
    contr[14] = -9/8 * t599 * t353 * t169 * t552 * t592 * t590 * t547
    t603 = t552 * t20
    t607 = 2 * t433
    t611 = 2/5 * t381
    t614 = P1 * P2 * t611 + t378 * t559 * t437 - t34 * t176 + t58 * t607 + t181 - t191
    t620 = t399 * t110 * t117 * A
    contr[15] = 135/16 * t620 * t614 * t174 * t353 * t603 * t444 * t547
    t622 = t100 * t214
    t624 = t130 * t134
    t634 = Q1 * t367
    t637 = t624 - t456 - 2 * t459 * t559 * t457 + t49 * (-4 * t58 * t38 + 16 * t342) - 3 * t634 * t559 * t469 + t533
    t638 = t552 * t637
    t644 = t399 * t574 * sdelta * A
    contr[16] = 45/16 * t644 * t353 * t638 * t550 * t622 * t547
    t646 = t100 * t27
    t649 = 5 * t141
    t651 = t34 - 5 * t58
    t655 = t505 / 2
    t656 = t24 * (Q1 * t651 - t131 + t649) + t655 + t513
    contr[17] = -9/2 * t599 * t656 * t353 * t315 * t603 * t646 * t547
    t662 = t100 * t345
    t669 = 5 * t634 * t559 * t527 - t140 * t525 - t325 + t331 + t477 + t624
    contr[18] = -27/16 * t620 * t174 * t553 * t20 * t669 * t662 * t547
    t680 = (-k / 3 - m / 3) * KK + EE * k
    t682 = t36 * t100
    t683 = t682 * t680 * t98
    t684 = t20 * t353
    t685 = C * t552
    contr[19] = 135/16 * t576 * sdelta * t685 * t684 * t683
    t691 = t100 * t680 * t590
    contr[20] = 9/8 * t599 * t169 * t685 * t684 * t691
    t696 = t680 * t208
    t697 = t353 * t100
    t700 = t614 * t174 * C
    contr[21] = -135/16 * t620 * t700 * t603 * t697 * t696
    t706 = t682 * t680 * t214
    contr[22] = -45/16 * t644 * C * t638 * t684 * t706
    t712 = t680 * t27
    t715 = t656 * t315 * C
    contr[23] = 9/2 * t599 * t715 * t603 * t697 * t712
    t721 = t669 * t100 * t680 * t345
    contr[24] = 27/16 * t620 * t174 * t685 * t684 * t721
    t726 = C * t546
    contr[25] = 405/16 * t399 * t574 * B * t572 * sdelta * t726 * t603 * t683
    t739 = t399 * t574 * cdelta * B
    contr[26] = 27/8 * t739 * t169 * t726 * t603 * t691
    t742 = t546 * t552
    t747 = t399 * t110 * t117 * B
    contr[27] = -405/16 * t747 * t700 * t742 * t592 * t696
    contr[28] = -135/16 * t399 * t574 * sdelta * B * C * t742 * t637 * t20 * t706
    contr[29] = 27/2 * t739 * t715 * t742 * t592 * t712
    contr[30] = 81/16 * t747 * t174 * t726 * t603 * t721
    t767 = t546 ^ 2
    t768 = t767 * t357
    t769 = t384 * sdelta
    t771 = B ^ 2
    contr[31] = 405/32 * t400 * t771 * t98 * t682 * t769 * t768
    t778 = t771 * t27
    contr[32] = -81/32 * t400 * t778 * t422 * cdelta * t169 * t768
    t784 = t20 * t771
    contr[33] = -243/32 * t453 * t784 * t444 * t442 * t768
    contr[34] = 405/64 * t400 * t771 * t214 * t479 * t359 * t768
    contr[35] = 81/16 * t400 * t778 * t516 * cdelta * t315 * t768
    contr[36] = -243/64 * t453 * t784 * t535 * t520 * t768
    t804 = C ^ 2
    t805 = t804 * t357
    t807 = t680 ^ 2
    contr[37] = 405/32 * t400 * t548 * t36 * t807 * t769 * t805
    t813 = cdelta * t804
    contr[38] = -81/32 * t400 * t646 * t421 * t807 * t813 * t169 * t357
    t821 = t100 * t807
    contr[39] = -243/32 * t453 * t209 * t821 * t442 * t805
    contr[40] = 405/64 * t400 * t214 * t478 * t682 * t807 * sdelta * t805
    contr[41] = 81/16 * t400 * t27 * t515 * t821 * t813 * t315 * t357
    contr[42] = -243/64 * t453 * t20 * t345 * t534 * t100 * t807 * t174 * t805
    contr[43] = -315/32 * t453 * (-t34 * t557 + t181 + 2/3 * t369 + t566 + t379 - P1 * P2 * t569) * t100 * t98 * t36 * t603 * t19
    contr[44] = -21/16 * t453 * t646 * t552 * t421 * t20 * t169 * t281
    contr[45] = 315/32 * t453 * (-P1 * P2 * t611 - t58 * t607 + t177 - t181 + t191 + t439) * t100 * t208 * t552 * t320
    contr[46] = 105/32 * t453 * t622 * t36 * t552 * t20 * (4 * t49 * t240 * t243 * t342 + t321 + t456 - t461 - t473 + t477) * t19
    contr[47] = -21/4 * t453 * (t24 * (-Q1 * t651 + t131 - t649) - t655 - t513) * t100 * t27 * t552 * t20 * t315 * t281
    contr[48] = -63/32 * t453 * t662 * t603 * t534 * t175
       
    contr = sum(contr);
    return contr;
end

function  meandZ3cdeltadpsigMdpsihOsdelta_Gravity(k,m,skm,smk,mM1KK,KK,EE,PP,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,A,B,C,mu)
    GG = 1+Q1^2+Q2^2
    contr = zeros(48)
    t6 = 2 * m
    t18 = (KK * ((A - 2 * B + C) * k + (m - 3) * B + A * (-t6 + 3) + C * m) - 3 * EE * ((-B + C) * k + A - B)) ^ 2
    t19 = P2 ^ 2
    t21 = P1 ^ 2
    t24 = sdelta ^ 2
    t25 = t24 * (t19 / 11 - 9/11 * t21 + 6/11)
    t26 = 20/33 * t21
    t27 = 4/33 * t19
    t29 = Q2 ^ 2
    t30 = t29 ^ 2
    t31 = t30 * Q2
    t33 = t24 - 4/5
    t35 = P1 * P2
    t46 = Q1 ^ 2
    t55 = t29 * Q2
    t57 = Q1 + 2
    t60 = Q1 - 2
    t70 = 4/3 * t19
    t72 = t46 ^ 2
    t96 = mu ^ 2
    t98 = sin(psih)
    t99 = skm ^ 2
    t100 = t99 * t98
    t101 = 0.1e1 / Jg
    t104 = sma ^ 2
    t105 = t104 ^ 2
    t107 = 0.1e1 / t105 / t104
    t108 = eta ^ 2
    t109 = t108 ^ 2
    t111 = 0.1e1 / t109 / t108
    t113 = 0.1e1 / n
    t115 = k ^ 2
    t116 = 1 / t115
    t117 = GG ^ 2
    t119 = 0.1e1 / t117 / GG
    t120 = t119 * t116
    t121 = KK ^ 2
    t122 = 1 / t121
    t124 = t122 * t120 * t113 * t111 * t107
    contr[1] = -99/64 * t124 * t101 * t100 * t96 * (t31 * (t25 - 4/11 + t26 - t27) + 30/11 * t30 * t35 * t33 * Q1 + t55 * (t46 * (t24 * (12/11 + 2/11 * t21 - 18/11 * t19) - 8/33 * t21 + 40/33 * t19 - 8/11) + t24 * (32/11 * t21 - 8/11 * t19 - 18/11) + 16/11 - 80/33 * t21 + 16/33 * t19) + 20/11 * t29 * P2 * P1 * t60 * t33 * Q1 * t57 + Q2 * (t72 * (t24 * (6/11 + t21 - 19/11 * t19) - 28/33 * t21 + t70 - 4/11) + t46 * (t24 * (-18/11 - 8/11 * t21 + 32/11 * t19) + 16/33 * t21 - 80/33 * t19 + 16/11) + t25 - 4/11 + t26 - t27) - 10/11 * (Q1 - 1) * P1 * P2 * (Q1 + 1) * t33 * (t46 + 1) * Q1) * t18
    t128 = t21 - t19
    t129 = t72 * t46
    t130 = t129 * t128
    t131 = t72 * Q1
    t132 = Q2 * t131
    t134 = 8 * t132 * t35
    t135 = -t128
    t136 = 5 * t135
    t138 = 9 * t19
    t141 = t46 * Q1
    t142 = Q2 * t141
    t144 = 40 * t142 * t35
    t150 = P1 * t55
    t155 = 8 * Q1 * (t29 - 5) * P2 * t150
    t156 = Q2 + 1
    t157 = t30 * t128
    t158 = 8 * t21
    t163 = Q2 - 1
    t167 = 2 * psih
    t168 = sin(t167)
    t170 = t99 * sdelta
    t178 = t122 * t119 * t116 * t113 * t111 * t107 * t101
    contr[2] = -9/32 * t178 * t170 * t96 * t168 * (t130 + t134 + t72 * (t29 * t136 + t138 - t21 - 6) - t144 + t46 * (30 * t29 * t128 + t30 * t136 - t138 + t21 + 6) - t155 + t163 * (t157 + t29 * (-t158 + 6) + t21 - t19) * t156) * t18 * cdelta
    t182 = t96 * t18 * t24
    t183 = 3 * psih
    t184 = sin(t183)
    t185 = t99 * t184
    t186 = t128 / 5
    t187 = t31 * t186
    t190 = P2 * Q1 * P1 * t30
    t191 = 2 * t190
    t198 = P1 * t29
    t200 = t141 * P2 * t198
    t201 = 4 * t200
    t213 = Q1 * t35
    contr[3] = 135/64 * t178 * (t187 - t191 + t55 * (2 * t46 * t135 - 4/15 * t21 - 4/15 * t19 + 2/5) + t201 + Q2 * (t72 * t128 + t46 * (4/5 * t21 + 4/5 * t19 - 6/5) + t21 / 5 - t19 / 5) - 2/5 * t131 * t35 + 2/5 * t213) * t185 * t182
    t220 = cos(psih)
    t223 = cdelta ^ 2
    t224 = t223 * (t21 - t138 + 6)
    t225 = t21 / 3
    t226 = 7/3 * t19
    t229 = t223 - 1/5
    t230 = P2 * t229
    t231 = Q2 * P1
    t236 = 2 * t19
    t240 = 2/3 * t19
    t250 = Q2 - 2
    t252 = Q2 + 2
    t278 = t29 + 1
    contr[4] = -9/64 * t124 * t101 * (t131 * (t224 + t225 - 2 + t226) + 30 * t72 * t231 * t230 + t141 * (t29 * (t223 * (-18 * t21 + t236 + 12) + 14/3 * t21 + t240 - 4) + t223 * (-t158 + 32 * t19 - 18) - 16/3 * t19 + 8/3 * t21 + 2) + 20 * t46 * Q2 * t252 * P1 * t250 * t230 + Q1 * (t30 * (t223 * (-19 * t21 + 11 * t19 + 6) + 13/3 * t21 - 5/3 * t19 - 2) + t29 * (t223 * (32 * t21 - 8 * t19 - 18) + 2 - 16/3 * t21 + 8/3 * t19) + t224 + t225 - 2 + t226) - 10 * Q2 * t163 * P1 * t278 * P2 * t229 * t156) * t99 * t220 * t96 * t18
    t301 = 2 * Q2
    t302 = t29 + t301 - 1
    t303 = t29 - t301 - 1
    t323 = cos(t167)
    contr[5] = -9/8 * t178 * t170 * t96 * t323 * t18 * (-t129 * t35 / 2 + t131 * t128 * Q2 + 5/2 * t72 * t278 * t35 - 3 * t141 * (t21 - t226 + 1) * Q2 + 5/2 * t46 * t303 * t302 * t35 - Q1 * (t157 + t29 * (-7 * t21 + 3 * t19 + 3) + 2 * t21 + t236 - 3) * Q2 - t303 * t302 * t278 * t35 / 2) * cdelta
    t329 = cos(t183)
    t331 = t131 * t128
    t333 = t231 * P2 * t72
    t334 = 10 * t333
    t342 = 20 * t150 * P2 * t46
    t353 = Q2 * t35
    contr[6] = -27/64 * t178 * (t331 + t334 + t141 * (10 * t29 * t135 + 4/3 * t21 + t70 - 2) - t342 + Q1 * (-t30 * t136 + t29 * (-4 * t21 - 4 * t19 + 6) + t21 - t19) + 2 * t31 * t35 - 2 * t353) * t99 * t329 * t182
    t361 = -2/3 * t21 - t240 + eta + 1
    t366 = KK * (k - t6 + 3) - 3 * EE
    t367 = t366 ^ 2
    t368 = t99 * t367
    t370 = t128 / 2
    t373 = t46 + 2
    t374 = P1 - P2
    t376 = P1 + P2
    t377 = t55 * t376
    t378 = t377 * t374 * t373
    t385 = t72 - 4/3 * t46 - 1/3
    t387 = Q2 * t376
    t388 = t387 * t374 * t385
    t390 = t131 - Q1
    t392 = P1 * P2 * t390
    t393 = t31 * t370 - 3 * t190 - t378 + t198 * P2 * (-2 * t141 + 8 * Q1) - 3/2 * t388 + t392
    t394 = t393 * t98
    t395 = A ^ 2
    t396 = t96 * t395
    t401 = 1 + eta
    t402 = t401 ^ 2
    t404 = 0.1e1 / t402 / t401
    t408 = t113 * t101 * t404 * t111 * t122 * t107 * t120
    contr[7] = -45/32 * t408 * t396 * t394 * t368 * t33 * t361
    t415 = t72 * t376
    t419 = t30 - 6 * t29 - 1
    t421 = t46 * t376
    t424 = t156 * t163
    t426 = t30 - 4 * t29 + 1
    t430 = t376 * t374 * t426 * t424 - 5 * t415 * t374 * t278 - 5 * t421 * t374 * t419 + t130 + t134 - t144 - t155
    t431 = t99 * t430
    t432 = t395 * sdelta
    t436 = t107 * t119
    t441 = t113 * t101 * t404 * t111 * t122
    t442 = t441 * t436 * t116 * t96
    contr[8] = 9/32 * t442 * t432 * t431 * t367 * cdelta * t361 * t168
    t444 = t24 * t361
    t450 = -t46 * t19 + t46 * t21
    t454 = t72 + 1/5
    t456 = t387 * t374 * t454
    t458 = -t31 * t370 + 5 * t190 + 5 * t55 * t450 - 10 * t200 - 5/2 * t456 + t392
    contr[9] = 27/32 * t408 * t396 * t185 * t458 * t367 * t444
    t467 = 6 * t333
    t468 = t29 + 2
    t470 = t141 * t376
    t472 = 2 * t470 * t374 * t468
    t480 = t30 - 4/3 * t29 - 1/3
    t482 = Q1 * t374
    t484 = 3 * t482 * t480 * t376
    t486 = -2 * t31 + 2 * Q2
    t488 = P1 * P2 * t486
    t489 = t331 + t467 - t472 + t46 * P1 * P2 * (4 * t55 - 16 * Q2) - t484 + t488
    contr[10] = 45/64 * t408 * t396 * t489 * t220 * t229 * t99 * t367 * t361
    t506 = 5 * t30
    t514 = P1 * (t129 - 5 * t72 * t278 + t46 * (-t506 + 30 * t29 - 5) + t30 * t29 - t506 - 5 * t29 + 1) * P2
    t522 = (Q1 + Q2) * (Q1 - Q2) * (t46 + t29 - 5) * Q2 * Q1 * t19
    t525 = (t21 * (-2 * t132 + 10 * t142 + Q1 * (2 * t31 - 10 * t55)) + t514 + 2 * t522) * cdelta
    contr[11] = -9/16 * t442 * t432 * t368 * t525 * t361 * t323
    t535 = 10 * t29 * t19 - 10 * t29 * t21
    t537 = t30 + 1/5
    t543 = -P1 * P2 * t486
    t544 = 5 * t482 * t537 * t376 + t141 * t535 + t331 + t334 - t342 + t543
    t545 = t544 * t329
    contr[12] = 27/64 * t408 * t396 * t545 * t368 * t444
    t555 = (-2/3 * k + m / 3 - 1) * KK + EE * (1 + k)
    t556 = t555 * B
    t559 = t21 + t19 - 3/2 * eta - 3/2
    t560 = t96 * t559
    t561 = t128 / 3
    t563 = -t374
    t570 = 4/3 * t29 * t57 * t60 * t213
    t573 = 2/3 * t390
    t576 = t31 * t561 - t191 + 2/3 * t377 * t563 * t373 - t570 + t387 * t563 * t385 + P1 * P2 * t573
    t583 = t441 * t436 * t116 * A
    contr[13] = 135/16 * t583 * t366 * t576 * t33 * t560 * t100 * t556
    t585 = t170 * t556
    t596 = t376 * t563 * t426 * t424 - 5 * t415 * t563 * t278 - 5 * t421 * t563 * t419 + t129 * t135 - t134 + t144 + t155
    t602 = t107 * t120
    t604 = t441 * t602 * A * t366
    contr[14] = 9/8 * t604 * cdelta * t168 * t596 * t560 * t585
    t608 = 2 * t450
    t612 = 2/5 * t390
    t616 = (P1 * P2 * t612 + t387 * t563 * t454 - t31 * t186 + t55 * t608 + t191 - t201) * t184
    t618 = t559 * t99
    t621 = t366 * t24 * t96 * t618
    contr[15] = -135/16 * t583 * t621 * t616 * t556
    t625 = t99 * t220
    t628 = t131 * t135
    t638 = Q1 * t376
    t642 = (t628 - t467 - 2 * t470 * t563 * t468 + t46 * (-4 * t55 * t35 + 16 * t353) - 3 * t638 * t563 * t480 + t543) * t96
    contr[16] = 45/16 * t583 * t366 * t642 * t229 * t559 * t625 * t556
    t647 = 5 * t142
    t649 = t31 - 5 * t55
    t653 = t514 / 2
    t654 = t21 * (Q1 * t649 - t132 + t647) + t653 + t522
    contr[17] = 9/2 * t604 * cdelta * t323 * t654 * t560 * t585
    t665 = 5 * t638 * t563 * t537 - t141 * t535 - t334 + t342 + t488 + t628
    contr[18] = 27/16 * t583 * t621 * t329 * t555 * t665 * B
    t671 = t560 * t100
    t676 = (-k / 3 - m / 3) * KK + EE * k
    t678 = C * t366
    contr[19] = -135/16 * t583 * t576 * t678 * t676 * t33 * t671
    t684 = t560 * t170
    t685 = t366 * t676
    t687 = t168 * C * t596
    t692 = t441 * t602 * cdelta * A
    contr[20] = -9/8 * t692 * t687 * t685 * t684
    t695 = t618 * t616
    t698 = t24 * t678 * t676 * t96
    contr[21] = 135/16 * t583 * t698 * t695
    t702 = t618 * t220 * t229
    contr[22] = -45/16 * t583 * C * t685 * t642 * t702
    contr[23] = -9/2 * t692 * t323 * t678 * t676 * t654 * t684
    t715 = t618 * t329 * t665
    contr[24] = -27/16 * t583 * t698 * t715
    t720 = C * t676
    t726 = t441 * t436 * t116 * B
    contr[25] = -405/16 * t726 * t576 * t720 * t555 * t33 * t671
    t729 = t676 * t555
    t734 = t441 * t602 * cdelta * B
    contr[26] = -27/8 * t734 * t687 * t729 * t684
    t739 = t24 * t720 * t555 * t96
    contr[27] = 405/16 * t726 * t739 * t695
    contr[28] = -135/16 * t726 * C * t729 * t642 * t702
    contr[29] = -27/2 * t734 * t323 * t720 * t654 * t555 * t684
    contr[30] = -81/16 * t726 * t739 * t715
    t756 = t555 ^ 2
    t758 = t99 * t361
    t760 = B ^ 2
    t761 = t96 * t760
    contr[31] = -405/32 * t408 * t761 * t394 * t758 * t33 * t756
    t767 = t361 * cdelta
    t769 = t760 * sdelta
    contr[32] = 81/32 * t442 * t769 * t431 * t767 * t168 * t756
    t774 = t758 * t24 * t756
    contr[33] = 243/32 * t408 * t761 * t458 * t184 * t774
    t781 = t229 * t489
    contr[34] = 405/64 * t408 * t761 * t781 * t625 * t361 * t756
    contr[35] = -81/16 * t442 * t769 * t758 * t525 * t323 * t756
    contr[36] = 243/64 * t408 * t761 * t545 * t774
    t794 = C ^ 2
    t798 = t676 ^ 2
    t799 = t96 * t798
    contr[37] = -405/32 * t408 * t799 * t98 * t33 * t758 * t794 * t393
    t806 = t798 * sdelta
    contr[38] = 81/32 * t442 * t806 * t431 * t767 * t794 * t168
    t810 = t24 * t794
    contr[39] = 243/32 * t408 * t799 * t185 * t458 * t361 * t810
    contr[40] = 405/64 * t408 * t799 * t781 * t625 * t361 * t794
    contr[41] = -81/16 * t442 * t806 * t758 * t525 * t794 * t323
    contr[42] = 243/64 * t408 * t799 * t545 * t758 * t810
    contr[43] = 315/32 * t408 * (-t31 * t561 + t191 + 2/3 * t378 + t570 + t388 - P1 * P2 * t573) * t18 * t100 * t96 * t33 * t559
    t846 = sdelta * t96 * t559 * cdelta
    t847 = t18 * t99
    contr[44] = 21/16 * t408 * t168 * t430 * t847 * t846
    t852 = t559 * t24
    contr[45] = -315/32 * t408 * (-P1 * P2 * t612 - t55 * t608 + t187 - t191 + t201 + t456) * t18 * t185 * t96 * t852
    contr[46] = 105/32 * t408 * t847 * t220 * t96 * t229 * (4 * t46 * t252 * t250 * t353 + t331 + t467 - t472 - t484 + t488) * t559
    contr[47] = 21/4 * t408 * (t21 * (-Q1 * t649 + t132 - t647) - t653 - t522) * t323 * t847 * t846
    contr[48] = 63/32 * t408 * t847 * t329 * t96 * t544 * t852
       
    contr = sum(contr;)
    return contr;
end

function meandZ3dcsigma1_Gravity_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,A,B,C,mu)
    GG = 1+Q1^2+Q2^2
    contr = zeros(43)
    t1 = cos(psih)
    t2 = skm - 1/3
    t4 = mu ^ 2
    t7 = (A - C) ^ 2
    t9 = sqrt(skm)
    t10 = t9 * sdelta * t7
    t12 = P1 ^ 2
    t13 = P2 ^ 2
    t16 = sdelta ^ 2
    t17 = t16 * (t12 - 5/13 * t13 + 6/13)
    t18 = 20/13 * t12
    t19 = 4/13 * t13
    t21 = Q2 ^ 2
    t22 = t21 ^ 2
    t23 = Q2 * t22
    t25 = P1 * Q1
    t26 = t16 - 4/3
    t27 = P2 * t26
    t32 = 2 * t13
    t35 = 8/13 * t12
    t38 = Q1 ^ 2
    t47 = Q2 * t21
    t54 = t21 * P2
    t65 = t38 ^ 2
    t76 = Q1 - 1
    t79 = Q1 + 1
    t87 = t38 + t21 + 1
    t88 = t87 ^ 2
    t90 = 0.1e1 / t87 / t88
    t92 = sma ^ 2
    t93 = t92 ^ 2
    t95 = 0.1e1 / t92 / t93
    t97 = eta ^ 2
    t98 = t97 ^ 2
    t100 = 0.1e1 / t97 / t98
    t101 = 0.1e1 / Jg
    t103 = 0.1e1 / n
    t104 = t103 * t101 * t100
    contr[1] = 351/16 * t104 * t95 * t90 * (t23 * (t17 - t18 + t19 - 12/13) - 54/13 * t22 * t27 * t25 + t47 * (t38 * (t16 * (-10/13 * t12 + t32 + 12/13) + t35 - 40/13 * t13 - 24/13) + t16 * (-64/13 * t12 + 8/13 * t13 - 42/13) + 80/13 * t12 - 16/13 * t13 + 48/13) - 36/13 * t54 * (Q1 - 2) * t26 * Q1 * (Q1 + 2) * P1 + Q2 * (t65 * (t16 * (-23/13 * t12 + 31/13 * t13 + 6/13) + 28/13 * t12 - 44/13 * t13 - 12/13) + t38 * (t16 * (t35 - 64/13 * t13 - 42/13) - 16/13 * t12 + 80/13 * t13 + 48/13) + t17 - t18 + t19 - 12/13) + 18/13 * P2 * (t38 + 1) * t79 * t26 * P1 * Q1 * t76) * t10 * t4 * t2 * t1
    t107 = 2 * psih
    t108 = cos(t107)
    t109 = t12 - t13
    t110 = t38 * t65
    t112 = P1 * P2
    t113 = Q1 * t65
    t117 = -t109
    t118 = 5 * t117
    t119 = t21 * t118
    t120 = 9 * t13
    t123 = Q1 * t38
    t132 = t21 - 5
    t137 = t22 * t109
    t142 = -1 + Q2
    t144 = Q2 + 1
    t150 = cdelta * t7 * t4
    t152 = t16 * t2
    t156 = t103 * t101 * t100 * t95
    contr[2] = -81/16 * t156 * t90 * t152 * t150 * t9 * (t110 * t109 + 8 * Q2 * t113 * t112 + t65 * (t119 - t12 + t120 + 6) - 40 * Q2 * t123 * t112 + t38 * (30 * t21 * t109 + t22 * t118 + t12 - t120 - 6) - 8 * Q1 * t132 * t47 * t112 + t144 * t142 * (t137 + t21 * (-8 * t12 - 6) + t12 - t13)) * t108
    t160 = 3 * psih
    t161 = cos(t160)
    t163 = t7 * t4 * t161
    t188 = P2 * t25
    t191 = sdelta * t16
    t195 = t90 * t2
    t197 = t104 * t95 * t195
    contr[3] = -81/16 * t197 * t9 * t191 * (t23 * t109 - 10 * t22 * P2 * t25 + t47 * (10 * t38 * t117 - 4/3 * t12 - 4/3 * t13 - 2) + 20 * t54 * P1 * t123 + Q2 * (-t65 * t118 + t38 * (4 * t12 + 4 * t13 + 6) + t12 - t13) - 2 * P2 * P1 * t113 + 2 * t188) * t163
    t200 = sin(psih)
    t204 = t16 * (1/3 - 5/18 * t12 + 13/18 * t13)
    t205 = 2/9 * t12
    t206 = 10/9 * t13
    t209 = t26 * P1
    t210 = P2 * Q2
    t218 = 4/9 * t13
    t255 = t21 + 1
    t258 = t142 * Q2
    t259 = P2 * t144
    contr[4] = 243/8 * t197 * t10 * t4 * (t113 * (t204 + t205 - t206 - 2/3) - 3 * t65 * t210 * t209 + t123 * (t21 * (t16 * (13/9 * t12 - 5/9 * t13 + 2/3) - 4/3 + t218 - 20/9 * t12) + t16 * (-7/3 + 4/9 * t12 - 32/9 * t13) - 8/9 * t12 + 40/9 * t13 + 8/3) - 2 * t38 * (Q2 + 2) * t210 * t26 * (Q2 - 2) * P1 + Q1 * (t22 * (t16 * (31/18 * t12 - 23/18 * t13 + 1/3) - 2/3 + 14/9 * t13 - 22/9 * t12) + t21 * (t16 * (-32/9 * t12 + t218 - 7/3) + 8/3 + 40/9 * t12 - 8/9 * t13) + t204 + t205 - t206 - 2/3) + t259 * t258 * t26 * P1 * t255) * t200
    t267 = sin(t107)
    t273 = 2 * Q2 * t117
    t283 = 2 * Q2
    t284 = t21 + t283 - 1
    t285 = t21 - t283 - 1
    t291 = 3 * t13
    t294 = 2 * t12
    contr[5] = -81/8 * t156 * t90 * (t110 * t112 + t113 * t273 - 5 * t65 * t255 * t112 + 6 * t123 * (t12 - 7/3 * t13 - 1) * Q2 - 5 * t38 * t285 * t284 * t112 + 2 * Q1 * Q2 * (t137 + t21 * (-7 * t12 + t291 - 3) + t294 + t32 + 3) + t285 * t284 * t255 * t112) * t16 * t150 * t2 * t9 * t267
    t308 = sin(t160)
    t309 = t109 / 2
    t311 = P1 * Q2
    t315 = 2/3 * t12
    t316 = 2/3 * t13
    t325 = -t294 - t32 - 3
    t333 = P2 * t311
    contr[6] = -81/8 * t104 * t95 * t90 * t9 * t191 * t7 * t2 * t4 * (t113 * t309 + 5 * t65 * P2 * t311 + t123 * (t119 + t315 + t316 + 1) - 10 * t38 * P2 * t47 * P1 + Q1 * (5/2 * t22 * t109 + t21 * t325 + t12 / 2 - t13 / 2) + P2 * t23 * P1 - t333) * t308
    t345 = t12 + t13 + 3/2
    t353 = Q2 * Q1 * t112
    t370 = t38 + t21 - 1
    t372 = t9 * t7
    t375 = GG ^ 2
    contr[7] = -27/8 * t104 * t95 / GG / t375 * t4 * cdelta * t372 * t370 * t2 * (t16 * (t65 * t345 + t38 * (-t21 * t325 + 3 * t12 - t291) + 12 * t353 + t22 * t345 + 3 * t21 * t117 + t12 + t13 + 3/2) + t38 * (-t294 + 10 * t13 + 6) - 24 * t353 + 10 * (-t13 / 5 + t12 + 3/5) * t21)
    t384 = A ^ 2
    t386 = -t315 - t316 + eta + 1
    t388 = P1 - P2
    t389 = t388 * t26
    t390 = P1 + P2
    t391 = t47 * t22
    t393 = t391 * t390 * t389
    t395 = t21 * t22
    t397 = t395 * t25 * t27
    t399 = t38 * t26
    t402 = t23 * t390
    t403 = t402 * t388 * (t399 + t16 - 2)
    t405 = 7/15 * t16
    t409 = t22 * Q1 * (t399 + t405 - 2/15) * t112
    t411 = t65 * t26
    t412 = 14/5 * t16
    t415 = t16 / 5
    t418 = t47 * t390
    t419 = t418 * t388 * (t411 + t38 * (t412 - 44/15) + t415 - 2/5)
    t421 = 18 * t16
    t424 = 19/3 * t16
    t427 = t21 * t25
    t428 = t427 * (t411 + t38 * (-t421 + 20) - t424 + 26/3) * P2
    t430 = t110 * t26
    t431 = 25/9 * t16
    t434 = 13/9 * t16
    t437 = t16 / 3
    t440 = t390 * Q2
    t441 = t440 * t388 * (t430 + t65 * (-t431 + 26/9) + t38 * (-t434 + 2) - t437 + 4/9)
    t447 = Q1 * t79 * P1
    t448 = t447 * t76 * (t411 - 2/3 * t38 + t16 - 4/3) * P2
    t451 = (-t393 / 3 + 2 * t397 + t403 / 3 + 10/3 * t409 + 5/3 * t419 + 2/3 * t428 + t441 - 2/3 * t448) * t4
    t454 = t88 ^ 2
    t455 = 0.1e1 / t454
    t457 = 1 + eta
    t458 = t457 ^ 2
    t460 = 0.1e1 / t457 / t458
    t462 = t156 * t460 * t455 * t9
    contr[8] = -729/16 * t462 * t451 * t2 * t386 * t384 * sdelta * t1
    t467 = t65 ^ 2
    t468 = t467 * t109
    t469 = t123 * t65
    t472 = 8 * Q2 * t469 * t112
    t480 = (t21 - 6) * Q2
    t483 = 8 * t113 * t480 * t112
    t486 = t390 * t388
    t487 = t65 * t486
    t489 = 10 * t487 * (t21 - 17/5) * t21
    t490 = 4 * t21
    t492 = (t22 - t490 + 5) * Q2
    t495 = 8 * t123 * t492 * t112
    t500 = t38 * t390
    t502 = 4 * t500 * t388 * (t395 - 3/2 * t22 - 10 * t21 - 3/2)
    t503 = 2 * t21
    t505 = (t22 - t503 - 5) * t47
    t508 = 8 * Q1 * t505 * t112
    t509 = t142 ^ 2
    t512 = t144 ^ 2
    t516 = t390 * t388 * t144 * t512 * t142 * t509 * t255
    t517 = t468 + t472 + t110 * (4 * t21 * t117 - 6 * t12 + 6 * t13) + t483 - t489 - t495 - t502 - t508 + t516
    t519 = t2 * t4
    t523 = t460 * t455
    contr[9] = -81/16 * t156 * t523 * t9 * t16 * t519 * t517 * t386 * t384 * cdelta * t108
    t534 = t16 * t395 * Q1 * t112
    t536 = t16 * t38
    t537 = t16 / 9
    t540 = t402 * t388 * (t536 + t537 - 2/9)
    t542 = 3/5 * t16
    t545 = t22 * t25
    t546 = t545 * P2 * (t536 - t542 - 2/5)
    t548 = t16 * t65
    t549 = t412 - 4/5
    t553 = t418 * (t548 + t38 * t549 + t415 - 2/5) * t388
    t554 = 14/9 * t16
    t555 = t554 - 4/9
    t557 = 7/9 * t16
    t560 = t427 * (t548 + t38 * t555 + t557 - 2/3) * P2
    t562 = t16 * t110
    t563 = t542 + 2/5
    t565 = 7/5 * t16
    t566 = t565 - 6/5
    t570 = t440 * t388 * (t38 * t566 + t65 * t563 + t415 + t562)
    t571 = t79 * t76
    t575 = (t548 + 2 * t38 + t16) * t571 * t188
    t577 = t391 * t109 * t16 / 5 - 2 * t534 - 9/5 * t540 + 2 * t546 - t553 + 18/5 * t560 + t570 - 2/5 * t575
    t580 = t4 * t386
    contr[10] = -405/16 * t462 * t580 * t384 * sdelta * t577 * t2 * t161
    t585 = 4 * psih
    t586 = cos(t585)
    t588 = Q1 * t390
    t589 = t388 * Q2
    t590 = t588 - t589
    t597 = Q1 * t388 + t440
    t601 = t104 * t95 * t460
    contr[11] = 81/16 * t601 * t195 * t597 * t9 * t370 * t16 * t580 * t590 * t384 * cdelta * t586
    t606 = t386 * t384
    t611 = t469 * t390 * t389
    t613 = t110 * t209 * t210
    t615 = t21 * t26
    t616 = 11/3 * t16
    t619 = t113 * t390
    t620 = t619 * t388 * (t615 + t616 - 14/3)
    t621 = 17/15 * t16
    t625 = t65 * P1 * (t615 - t621 + 22/15) * t210
    t627 = t22 * t26
    t628 = 2/3 * t16
    t631 = 11/15 * t16
    t634 = t123 * t390
    t635 = t634 * t388 * (t627 + t21 * (t628 - 4/5) + t631 - 14/15)
    t637 = 22/3 * t16
    t640 = 9 * t16
    t644 = t38 * P1 * (t627 + t21 * (-t637 + 28/3) - t640 + 34/3) * t210
    t646 = t395 * t26
    t649 = 7/3 * t16
    t654 = t588 * (t646 + t22 * (-t537 + 2/9) + t21 * (-t649 + 26/9) - t437 + 4/9) * t388
    t658 = 8/3 * t16
    t663 = (t627 + t21 * (t658 - 10/3) + t16 - 4/3) * P1 * t144 * P2 * t258
    t668 = t156 * t460 * t455 * (t611 + 6 * t613 - t620 + 10 * t625 - 5 * t635 + 2 * t644 - 3 * t654 - 2 * t663)
    contr[12] = -243/16 * t668 * t9 * t4 * t606 * sdelta * t2 * t200
    t673 = t467 * t112
    t677 = t21 + 3/2
    t679 = t110 * P1
    t680 = t679 * P2 * t677
    t682 = t113 * t486
    t683 = t682 * t480
    t687 = t65 * P1
    t688 = t687 * P2 * (t22 - 17/5 * t21 + 1)
    t690 = t123 * t486
    t691 = t690 * t492
    t698 = t38 * P1 * (t21 - 3) * P2 * (t22 + 3/2 * t21 - 1/2)
    t700 = Q1 * t486
    t701 = t700 * t505
    t702 = t22 ^ 2
    t706 = (t702 - 2 * t395 - 10 * t22 - t503 + 1) * t112
    t708 = -t673 / 2 + t469 * t109 * Q2 + 2 * t680 + t683 + 5 * t688 - t691 + 2 * t698 - t701 - t706 / 2
    t712 = t2 * t9
    contr[13] = 81/4 * t156 * t523 * t712 * t16 * t708 * t580 * t384 * cdelta * t267
    t718 = t109 * t16
    t721 = t16 * t679 * t210
    t723 = t16 * t21
    t726 = t619 * t388 * (t723 + t537 - 2/9)
    t730 = t65 * t112
    t731 = t730 * Q2 * (t723 - t542 - 2/5)
    t733 = t16 * t22
    t737 = t634 * t388 * (t733 + t21 * t549 + t415 - 2/5)
    t743 = t38 * P1 * (t733 + t21 * t555 + t557 - 2/3) * t210
    t745 = t16 * t395
    t750 = t588 * t388 * (t21 * t566 + t22 * t563 + t415 + t745)
    t752 = t144 * t142
    t755 = (t733 + t503 + t16) * t752 * t333
    t757 = t469 * t718 + 10 * t721 - 9 * t726 - 10 * t731 - 5 * t737 - 18 * t743 + 5 * t750 + 2 * t755
    contr[14] = -81/16 * t462 * t757 * t4 * t606 * sdelta * t2 * t308
    t763 = sin(t585)
    t767 = -P2 * Q1 + t311
    t771 = 2 * t38 * t21 + t22 + t65 + 1
    t772 = t16 * t771
    t775 = t25 + t210
    t777 = t455 * t2
    contr[15] = -81/8 * t601 * t777 * t775 * t9 * t772 * t767 * t4 * t606 * cdelta * t763
    t783 = cdelta * t4
    t786 = -t16 + 4
    t788 = -t786
    t792 = t16 + 4
    t796 = 4 * t113 * t792 * Q2 * t112
    t797 = t16 - 4/17
    t800 = 17 * t487 * t797 * t21
    t805 = 56 * t123 * t112 * t47 * (t16 - 4/7)
    t811 = 17 * t500 * (t22 * t797 + t16 / 17 - 4/17) * t388
    t813 = 3 * t16
    t817 = 4 * t188 * (t22 * t792 + t813 - 4) * Q2
    t818 = t142 * t21
    t825 = (sdelta - 2) * (sdelta + 2) * t486 * t255 * t144 * t818
    t826 = t110 * (t12 * t786 + t788 * t13) + t796 - t800 - t805 + t811 + t817 + t825
    t827 = t375 ^ 2
    t828 = 0.1e1 / t827
    contr[16] = 81/16 * t156 * t460 * t828 * t826 * t386 * t783 * t384 * t712
    t833 = 6 * t397
    t842 = sdelta * t4
    t843 = t386 * t9
    t844 = t843 * t842
    t848 = t156 * t523 * C * t2
    contr[17] = -243/8 * t848 * t844 * A * (t393 - t833 - t403 - 10 * t409 - 5 * t419 - 2 * t428 - 3 * t441 + 2 * t448) * t1
    t854 = 4 * t110 * t677 * t486
    t859 = t386 * cdelta * t519
    t861 = C * t16
    t863 = t156 * t523 * t861
    contr[18] = 81/8 * t863 * t859 * (t468 + t472 - t854 + t483 - t489 - t495 - t502 - t508 + t516) * A * t9 * t108
    t867 = t391 * t718
    t868 = 10 * t534
    contr[19] = 81/8 * t848 * (t867 - t868 - 9 * t540 + 10 * t546 - 5 * t553 + 18 * t560 + 5 * t570 - 2 * t575) * t9 * t842 * A * t386 * t161
    t881 = A * t9
    t889 = -Q1 * t390 + t589
    contr[20] = 81/8 * t601 * t90 * t889 * t861 * cdelta * t597 * t370 * t519 * t881 * t386 * t586
    t896 = t611 / 2
    t897 = 3 * t613
    contr[21] = -243/4 * t848 * (-t896 - t897 + t620 / 2 - 5 * t625 + 5/2 * t635 - t644 + 3/2 * t654 + t663) * t9 * t842 * A * t386 * t200
    t909 = t469 * t273
    t910 = 4 * t680
    contr[22] = 81/4 * t863 * t783 * t2 * A * (t673 + t909 - t910 - 2 * t683 - 10 * t688 + 2 * t691 - 4 * t698 + 2 * t701 + t706) * t9 * t386 * t267
    t925 = t469 * t309 * t16
    t926 = 5 * t721
    contr[23] = 81/4 * t156 * t523 * C * t9 * sdelta * t2 * t4 * A * (t925 + t926 - 9/2 * t726 - 5 * t731 - 5/2 * t737 - 9 * t743 + 5/2 * t750 + t755) * t386 * t308
    t949 = t455 * t775
    contr[24] = 81/4 * t601 * t949 * C * t767 * t16 * t771 * cdelta * t519 * t881 * t386 * t763
    t955 = t2 * cdelta
    t966 = t156 * t460 * t828 * t4
    contr[25] = 81/8 * t966 * C * (t110 * (t12 * t788 + t13 * t786) - t796 + t800 + t805 - t811 - t817 - t825) * t955 * t9 * t386 * A
    t968 = C ^ 2
    t974 = t156 * t460 * t777
    contr[26] = -729/16 * t974 * t843 * t451 * sdelta * t968 * t1
    t982 = t156 * t523 * t843
    contr[27] = -81/16 * t982 * t152 * t783 * t517 * t968 * t108
    t987 = t843 * t519
    contr[28] = -405/16 * t156 * t460 * t455 * t577 * t987 * sdelta * t968 * t161
    t998 = t16 * t4
    contr[29] = 81/16 * t601 * t90 * t590 * t843 * t998 * t597 * cdelta * t370 * t2 * t968 * t586
    contr[30] = -243/16 * t668 * t987 * sdelta * t968 * t200
    contr[31] = 81/4 * t982 * t998 * cdelta * t708 * t2 * t968 * t267
    contr[32] = -81/16 * t462 * t386 * t757 * t519 * sdelta * t968 * t308
    contr[33] = -81/8 * t601 * t455 * t771 * t775 * t767 * t843 * t998 * t955 * t968 * t763
    contr[34] = 81/16 * t156 * t460 * t828 * t386 * t826 * t783 * t9 * t2 * t968
    t1076 = t712 * t842
    t1080 = t156 * t460 * t455 * t386
    contr[35] = 243/16 * t1080 * t1076 * (t393 - t833 - t402 * t388 * (t399 + t16 - 8/3) - 10 * t545 * P2 * (t399 + t405 + 16/15) - 5 * t418 * t388 * (t411 + 14/5 * t536 + t415 - 8/15) - 2 * t427 * P2 * (t411 + t38 * (-t421 + 16/3) - t424 + 16/3) - 3 * t440 * t388 * (t430 + t65 * (-t431 + 8/9) + t38 * (-t434 + 8/9) - t437 + 4/9) + 2 * t447 * t76 * P2 * (t411 - 4/3 * t38 + t16 - 4/3)) * t7 * t1
    t1084 = t132 * Q2
    t1097 = 11/2 * t22
    t1102 = 3 * t22
    contr[36] = -81/16 * t156 * t523 * t386 * t16 * (t468 + t472 - t854 + 8 * t113 * t1084 * t112 - 10 * t487 * (t21 - 9/5) * t21 - 8 * t123 * (t22 + t503 - 1) * Q2 * t112 - 4 * t500 * t388 * (t395 - t1097 + t503 - 3/2) - 8 * Q1 * (t395 - t1102 + t21 - 1) * Q2 * t112 + t516) * cdelta * t519 * t9 * t7 * t108
    t1126 = t412 - 8/5
    t1132 = t554 - 8/9
    t1138 = t542 + 4/5
    t1140 = t565 - 12/5
    contr[37] = -81/16 * t1080 * (t867 - t868 - 9 * t402 * t388 * (t536 + t537 - 4/9) + 10 * t545 * P2 * (t536 - t542 - 4/5) - 5 * t418 * t388 * (t548 + t38 * t1126 + t415 - 4/5) + 18 * t427 * P2 * (t548 + t38 * t1132 + t557 - 4/3) + 5 * Q2 * (t65 * t1138 + t38 * t1140 + t415 + t562) * t486 - 2 * (t548 + 4 * t38 + t16) * t571 * t188) * t2 * t9 * sdelta * t163
    contr[38] = -81/8 * t601 * t90 * t386 * t16 * t597 * t370 * cdelta * t519 * t889 * t9 * t7 * t586
    contr[39] = 243/8 * t156 * t460 * t455 * (-t896 - t897 + t113 * (t615 + t616 - 16/3) * t486 / 2 - 5 * t730 * (t615 - t621 + 8/5) * Q2 + 5/2 * t634 * (t627 + t21 * (t628 - 16/15) + t631 - 16/15) * t388 - t38 * P1 * (t627 + t21 * (-t637 + 32/3) - t640 + 40/3) * t210 + 3/2 * t588 * (t646 - t733 / 9 + t21 * (-t649 + 32/9) - t437 + 4/9) * t388 + P1 * t259 * Q2 * (t627 + t21 * (t658 - 4) + t16 - 4/3) * t142) * t1076 * t386 * t7 * t200
    t1224 = 11 * t21
    contr[40] = -81/8 * t156 * t523 * t152 * (t673 + t909 - t910 - 2 * t682 * t1084 - 10 * t687 * P2 * (t22 - 9/5 * t21 + 11/5) + 2 * t690 * (t22 + t503 + 11) * Q2 - 4 * t38 * P1 * P2 * (t395 - t1097 - t1224 + 3/2) + 2 * t700 * (t395 - t1102 - t1224 + 1) * Q2 + t285 * t284 * (t22 + t490 + 1) * t112) * cdelta * t580 * t9 * t7 * t267
    contr[41] = -81/8 * t974 * t844 * (t925 + t926 - 9/2 * t619 * t388 * (t723 + t537 - 4/9) - 5 * t65 * P1 * (t723 - t542 - 4/5) * t210 - 5/2 * t634 * t388 * (t733 + t21 * t1126 + t415 - 4/5) - 9 * t38 * (t733 + t21 * t1132 + t557 - 4/3) * P1 * t210 + 5/2 * t588 * t388 * (t22 * t1138 + t21 * t1140 + t415 + t745) + (t733 + t490 + t16) * t752 * t333) * t7 * t308
    contr[42] = -81/4 * t601 * t949 * t772 * t859 * t372 * t767 * t763
    t1290 = t16 - 2
    t1298 = t1290 * t390
    t1307 = t22 * t1290
    contr[43] = -81/8 * t966 * cdelta * (t110 * t1290 * t486 + 4 * t113 * t1290 * Q2 * t112 + t65 * t1298 * t388 * t21 + 8 * t123 * P1 * (t21 * t1290 + t813) * t210 - t500 * t388 * (t1307 + 24 * t723 + t16 - 2) + 4 * t188 * (t1307 - 6 * t723 - t16 + 2) * Q2 - t1298 * t388 * t255 * t144 * t818) * t9 * t2 * t386 * t7
       

    contr = sum(contr)
    return contr;
end

function meandZ3dJgP1_Gravity_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,A,B,C,mu)
    GG = 1+Q1^2+Q2^2
    contr = zeros(43)
    t1 = cos(psih)
    t3 = 3 * skm - 1
    t4 = A * t3
    t10 = (t4 - 2 * C * skm + C * (1 - skm)) ^ 2
    t12 = mu ^ 2
    t13 = sdelta * t12
    t14 = P1 ^ 2
    t15 = P2 ^ 2
    t18 = sdelta ^ 2
    t19 = t18 * (t14 - 5/13 * t15 + 6/13)
    t20 = 20/13 * t14
    t21 = 4/13 * t15
    t23 = Q2 ^ 2
    t24 = t23 ^ 2
    t25 = Q2 * t24
    t27 = P1 * Q1
    t28 = t18 - 4/3
    t29 = P2 * t28
    t34 = 2 * t15
    t37 = 8/13 * t14
    t40 = Q1 ^ 2
    t49 = Q2 * t23
    t56 = t23 * P2
    t67 = t40 ^ 2
    t78 = Q1 - 1
    t81 = Q1 + 1
    t91 = t40 + t23 + 1
    t92 = t91 ^ 2
    t94 = 0.1e1 / t91 / t92
    t95 = sma ^ 2
    t96 = t95 ^ 2
    t98 = 0.1e1 / t95 / t96
    t100 = eta ^ 2
    t101 = t100 ^ 2
    t103 = 0.1e1 / t100 / t101
    t104 = Jg ^ 2
    t105 = 0.1e1 / t104
    t107 = 0.1e1 / n
    t108 = t107 * t105 * t103
    t109 = t108 * t98 * t94
    contr[1] = -39/64 * t109 * (t25 * (t19 - t20 + t21 - 12/13) - 54/13 * t24 * t29 * t27 + t49 * (t40 * (t18 * (-10/13 * t14 + t34 + 12/13) + t37 - 40/13 * t15 - 24/13) + t18 * (-64/13 * t14 + 8/13 * t15 - 42/13) + 80/13 * t14 - 16/13 * t15 + 48/13) - 36/13 * t56 * (Q1 - 2) * t28 * Q1 * (Q1 + 2) * P1 + Q2 * (t67 * (t18 * (-23/13 * t14 + 31/13 * t15 + 6/13) + 28/13 * t14 - 44/13 * t15 - 12/13) + t40 * (t18 * (t37 - 64/13 * t15 - 42/13) - 16/13 * t14 + 80/13 * t15 + 48/13) + t19 - t20 + t21 - 12/13) + 18/13 * P2 * (t40 + 1) * t81 * t28 * P1 * Q1 * t78) * t13 * t10 * t1
    t112 = 2 * psih
    t113 = cos(t112)
    t114 = t14 - t15
    t115 = t40 * t67
    t117 = P1 * P2
    t118 = Q1 * t67
    t122 = -t114
    t123 = 5 * t122
    t124 = t23 * t123
    t125 = 9 * t15
    t128 = Q1 * t40
    t137 = t23 - 5
    t142 = t24 * t114
    t147 = -1 + Q2
    t149 = Q2 + 1
    contr[2] = 9/64 * t108 * t98 * t94 * t18 * t10 * t12 * cdelta * (t115 * t114 + 8 * Q2 * t118 * t117 + t67 * (t124 - t14 + t125 + 6) - 40 * Q2 * t128 * t117 + t40 * (30 * t23 * t114 + t24 * t123 - t125 + t14 - 6) - 8 * Q1 * t137 * t49 * t117 + t149 * t147 * (t142 + t23 * (-8 * t14 - 6) + t14 - t15)) * t113
    t160 = 3 * psih
    t161 = cos(t160)
    t187 = P2 * t27
    t191 = sdelta * t18
    contr[3] = 9/64 * t109 * t191 * (t25 * t114 - 10 * t24 * P2 * t27 + t49 * (10 * t40 * t122 - 4/3 * t14 - 4/3 * t15 - 2) + 20 * t56 * P1 * t128 + Q2 * (-t67 * t123 + t40 * (4 * t14 + 4 * t15 + 6) + t14 - t15) - 2 * P2 * P1 * t118 + 2 * t187) * t12 * t10 * t161
    t195 = sin(psih)
    t199 = t18 * (1/3 - 5/18 * t14 + 13/18 * t15)
    t200 = 2/9 * t14
    t201 = 10/9 * t15
    t204 = t28 * P1
    t205 = P2 * Q2
    t213 = 4/9 * t15
    t250 = t23 + 1
    t253 = t147 * Q2
    t254 = P2 * t149
    t259 = t12 * t10
    t260 = sdelta * t259
    contr[4] = -27/32 * t109 * t260 * (t118 * (t199 + t200 - t201 - 2/3) - 3 * t67 * t205 * t204 + t128 * (t23 * (t18 * (13/9 * t14 - 5/9 * t15 + 2/3) - 4/3 + t213 - 20/9 * t14) + t18 * (-7/3 + 4/9 * t14 - 32/9 * t15) - 8/9 * t14 + 40/9 * t15 + 8/3) - 2 * t40 * (Q2 + 2) * t205 * t28 * (Q2 - 2) * P1 + Q1 * (t24 * (t18 * (31/18 * t14 - 23/18 * t15 + 1/3) - 2/3 + 14/9 * t15 - 22/9 * t14) + t23 * (t18 * (-32/9 * t14 + t213 - 7/3) + 8/3 + 40/9 * t14 - 8/9 * t15) + t199 + t200 - t201 - 2/3) + t254 * t253 * t28 * P1 * t250) * t195
    t264 = sin(t112)
    t265 = cdelta * t264
    t270 = 2 * Q2 * t122
    t280 = 2 * Q2
    t281 = t23 + t280 - 1
    t282 = t23 - t280 - 1
    t288 = 3 * t15
    t291 = 2 * t14
    contr[5] = 9/32 * t108 * t98 * t94 * (t115 * t117 + t118 * t270 - 5 * t67 * t250 * t117 + 6 * t128 * (t14 - 7/3 * t15 - 1) * Q2 - 5 * t40 * t282 * t281 * t117 + 2 * Q1 * Q2 * (t142 + t23 * (-7 * t14 + t288 - 3) + t291 + t34 + 3) + t282 * t281 * t250 * t117) * t18 * t259 * t265
    t304 = sin(t160)
    t305 = t114 / 2
    t307 = P1 * Q2
    t311 = 2/3 * t14
    t312 = 2/3 * t15
    t321 = -t291 - t34 - 3
    t329 = P2 * t307
    contr[6] = 9/32 * t109 * t191 * t259 * (t118 * t305 + 5 * t67 * P2 * t307 + t128 * (t124 + t311 + t312 + 1) - 10 * t40 * P2 * t49 * P1 + Q1 * (5/2 * t24 * t114 + t23 * t321 + t14 / 2 - t15 / 2) + P2 * t25 * P1 - t329) * t304
    t335 = t14 + t15 + 3/2
    t343 = Q2 * Q1 * t117
    t360 = t40 + t23 - 1
    t361 = t12 * t360
    t363 = 1/2 - 3/2 * skm
    t365 = -t3
    t369 = (A * t363 - t365 * C / 2) ^ 2
    t372 = GG ^ 2
    contr[7] = 3/8 * t108 * t98 / GG / t372 * t369 * t361 * cdelta * (t18 * (t67 * t335 + t40 * (-t23 * t321 + 3 * t14 - t288) + 12 * t343 + t24 * t335 + 3 * t23 * t122 + t14 + t15 + 3/2) + t40 * (-t291 + 10 * t15 + 6) - 24 * t343 + 10 * (-t15 / 5 + t14 + 3/5) * t23)
    t379 = A ^ 2
    t381 = -t311 - t312 + eta + 1
    t382 = t12 * t381
    t383 = P1 - P2
    t384 = t383 * t28
    t385 = P1 + P2
    t386 = t49 * t24
    t388 = t386 * t385 * t384
    t390 = t23 * t24
    t392 = t390 * t27 * t29
    t394 = t40 * t28
    t397 = t25 * t385
    t398 = t397 * t383 * (t394 + t18 - 2)
    t400 = 7/15 * t18
    t404 = t24 * Q1 * (t394 + t400 - 2/15) * t117
    t406 = t67 * t28
    t407 = 14/5 * t18
    t410 = t18 / 5
    t413 = t49 * t385
    t414 = t413 * t383 * (t406 + t40 * (t407 - 44/15) + t410 - 2/5)
    t416 = 18 * t18
    t419 = 19/3 * t18
    t422 = t23 * t27
    t423 = t422 * (t406 + t40 * (-t416 + 20) - t419 + 26/3) * P2
    t425 = t115 * t28
    t426 = 25/9 * t18
    t429 = 13/9 * t18
    t432 = t18 / 3
    t435 = t385 * Q2
    t436 = t435 * t383 * (t425 + t67 * (-t426 + 26/9) + t40 * (-t429 + 2) - t432 + 4/9)
    t442 = Q1 * t81 * P1
    t443 = t442 * t78 * (t406 - 2/3 * t40 + t18 - 4/3) * P2
    t446 = (-t388 / 3 + 2 * t392 + t398 / 3 + 10/3 * t404 + 5/3 * t414 + 2/3 * t423 + t436 - 2/3 * t443) * t382
    t448 = t3 ^ 2
    t449 = t92 ^ 2
    t450 = 0.1e1 / t449
    t452 = 1 + eta
    t453 = t452 ^ 2
    t455 = 0.1e1 / t452 / t453
    t459 = t107 * t105 * t103 * t98
    t460 = t459 * t455 * t450 * t448
    contr[8] = 81/64 * t460 * t446 * t379 * sdelta * t1
    t464 = t67 ^ 2
    t465 = t464 * t114
    t466 = t128 * t67
    t469 = 8 * Q2 * t466 * t117
    t477 = (t23 - 6) * Q2
    t480 = 8 * t118 * t477 * t117
    t483 = t385 * t383
    t484 = t67 * t483
    t486 = 10 * t484 * (t23 - 17/5) * t23
    t487 = 4 * t23
    t489 = (t24 - t487 + 5) * Q2
    t492 = 8 * t128 * t489 * t117
    t497 = t40 * t385
    t499 = 4 * t497 * t383 * (t390 - 3/2 * t24 - 10 * t23 - 3/2)
    t500 = 2 * t23
    t502 = (t24 - t500 - 5) * t49
    t505 = 8 * Q1 * t502 * t117
    t506 = t147 ^ 2
    t509 = t149 ^ 2
    t513 = t385 * t383 * t149 * t509 * t147 * t506 * t250
    t514 = t465 + t469 + t115 * (4 * t23 * t122 - 6 * t14 + 6 * t15) + t480 - t486 - t492 - t499 - t505 + t513
    t516 = cdelta * t18
    contr[9] = 9/64 * t460 * t516 * t12 * t514 * t381 * t379 * t113
    t527 = t18 * t390 * Q1 * t117
    t529 = t18 * t40
    t530 = t18 / 9
    t533 = t397 * t383 * (t529 + t530 - 2/9)
    t535 = 3/5 * t18
    t538 = t24 * t27
    t539 = t538 * P2 * (t529 - t535 - 2/5)
    t541 = t18 * t67
    t542 = t407 - 4/5
    t546 = t413 * (t541 + t40 * t542 + t410 - 2/5) * t383
    t547 = 14/9 * t18
    t548 = t547 - 4/9
    t550 = 7/9 * t18
    t553 = t422 * (t541 + t40 * t548 + t550 - 2/3) * P2
    t555 = t18 * t115
    t556 = t535 + 2/5
    t558 = 7/5 * t18
    t559 = t558 - 6/5
    t563 = t435 * t383 * (t40 * t559 + t67 * t556 + t410 + t555)
    t564 = t81 * t78
    t568 = (t541 + 2 * t40 + t18) * t564 * t187
    t572 = t12 * (t386 * t114 * t18 / 5 - 2 * t527 - 9/5 * t533 + 2 * t539 - t546 + 18/5 * t553 + t563 - 2/5 * t568) * t381
    contr[10] = 45/64 * t460 * t572 * t379 * sdelta * t161
    t575 = 4 * psih
    t576 = cos(t575)
    t578 = Q1 * t385
    t579 = t383 * Q2
    t580 = t578 - t579
    t585 = Q1 * t383 + t435
    t590 = t455 * t94
    contr[11] = -9/64 * t459 * t590 * t448 * cdelta * t585 * t360 * t18 * t12 * t381 * t580 * t379 * t576
    t596 = t466 * t385 * t384
    t598 = t115 * t204 * t205
    t600 = t23 * t28
    t601 = 11/3 * t18
    t604 = t118 * t385
    t605 = t604 * t383 * (t600 + t601 - 14/3)
    t606 = 17/15 * t18
    t610 = t67 * P1 * (t600 - t606 + 22/15) * t205
    t612 = t24 * t28
    t613 = 2/3 * t18
    t616 = 11/15 * t18
    t619 = t128 * t385
    t620 = t619 * t383 * (t612 + t23 * (t613 - 4/5) + t616 - 14/15)
    t622 = 22/3 * t18
    t625 = 9 * t18
    t629 = t40 * P1 * (t612 + t23 * (-t622 + 28/3) - t625 + 34/3) * t205
    t631 = t390 * t28
    t634 = 7/3 * t18
    t639 = t578 * (t631 + t24 * (-t530 + 2/9) + t23 * (-t634 + 26/9) - t432 + 4/9) * t383
    t643 = 8/3 * t18
    t648 = (t612 + t23 * (t643 - 10/3) + t18 - 4/3) * P1 * t149 * P2 * t253
    t650 = t596 + 6 * t598 - t605 + 10 * t610 - 5 * t620 + 2 * t629 - 3 * t639 - 2 * t648
    contr[12] = 27/64 * t460 * t12 * t381 * t379 * sdelta * t650 * t195
    t659 = t464 * t117
    t663 = t23 + 3/2
    t665 = t115 * P1
    t666 = t665 * P2 * t663
    t668 = t118 * t483
    t669 = t668 * t477
    t673 = t67 * P1
    t674 = t673 * P2 * (t24 - 17/5 * t23 + 1)
    t676 = t128 * t483
    t677 = t676 * t489
    t684 = t40 * P1 * (t23 - 3) * P2 * (t24 + 3/2 * t23 - 1/2)
    t686 = Q1 * t483
    t687 = t686 * t502
    t688 = t24 ^ 2
    t692 = (t688 - 2 * t390 - 10 * t24 - t500 + 1) * t117
    t694 = -t659 / 2 + t466 * t114 * Q2 + 2 * t666 + t669 + 5 * t674 - t677 + 2 * t684 - t687 - t692 / 2
    contr[13] = -9/16 * t460 * t516 * t694 * t12 * t381 * t379 * t264
    t702 = t114 * t18
    t705 = t18 * t665 * t205
    t707 = t18 * t23
    t710 = t604 * t383 * (t707 + t530 - 2/9)
    t714 = t67 * t117
    t715 = t714 * Q2 * (t707 - t535 - 2/5)
    t717 = t18 * t24
    t721 = t619 * t383 * (t717 + t23 * t542 + t410 - 2/5)
    t727 = t40 * P1 * (t717 + t23 * t548 + t550 - 2/3) * t205
    t729 = t18 * t390
    t734 = t578 * t383 * (t23 * t559 + t24 * t556 + t410 + t729)
    t736 = t149 * t147
    t739 = (t717 + t500 + t18) * t736 * t329
    t742 = (t466 * t702 + 10 * t705 - 9 * t710 - 10 * t715 - 5 * t721 - 18 * t727 + 5 * t734 + 2 * t739) * t382
    contr[14] = 9/64 * t460 * t742 * t379 * sdelta * t304
    t745 = sin(t575)
    t749 = -P2 * Q1 + t307
    t752 = 2 * t40 * t23 + t24 + t67 + 1
    t756 = t27 + t205
    t758 = t455 * t450
    contr[15] = 9/32 * t459 * t758 * t448 * t756 * t516 * t752 * t749 * t382 * t379 * t745
    t762 = t18 - 4
    t768 = t18 + 4
    t773 = t18 - 4/17
    t789 = 3 * t18
    t794 = t147 * t23
    t802 = t115 * (t14 * t762 - t15 * t762) - 4 * t118 * t768 * Q2 * t117 + 17 * t484 * t773 * t23 + 56 * t128 * t117 * t49 * (t18 - 4/7) - 17 * t497 * (t24 * t773 + t18 / 17 - 4/17) * t383 - 4 * t187 * (t24 * t768 + t789 - 4) * Q2 - (sdelta - 2) * (sdelta + 2) * t483 * t250 * t149 * t794
    t803 = t12 * t802
    t806 = t14 + t15 - 3/2 * eta - 3/2
    t807 = cdelta * t806
    t808 = t363 ^ 2
    t811 = t372 ^ 2
    t812 = 0.1e1 / t811
    t815 = t108 * t98 * t455 * t812
    contr[16] = -3/8 * t815 * t808 * t807 * t379 * t803
    t820 = t381 * sdelta
    t821 = -t363
    t822 = 6 * t392
    t834 = t459 * t758 * C * t3
    contr[17] = 27/16 * t834 * (t388 - t822 - t398 - 10 * t404 - 5 * t414 - 2 * t423 - 3 * t436 + 2 * t443) * t821 * t820 * t12 * A * t1
    t836 = cdelta * t113
    t839 = 4 * t115 * t663 * t483
    t843 = t821 * t3
    t846 = C * t18
    t848 = t459 * t758 * t846
    contr[18] = -9/16 * t848 * t843 * t382 * (t465 + t469 - t839 + t480 - t486 - t492 - t499 - t505 + t513) * A * t836
    t853 = t386 * t702
    t854 = 10 * t527
    contr[19] = -9/16 * t834 * t821 * (t853 - t854 - 9 * t533 + 10 * t539 - 5 * t546 + 18 * t553 + 5 * t563 - 2 * t568) * t820 * t12 * A * t161
    t868 = cdelta * A
    t876 = -Q1 * t385 + t579
    t880 = t108 * t98 * t455
    contr[20] = -9/16 * t880 * t94 * t876 * t846 * t821 * t3 * t585 * t361 * t868 * t381 * t576
    t888 = t596 / 2
    t889 = 3 * t598
    contr[21] = 27/8 * t459 * t758 * C * (-t888 - t889 + t605 / 2 - 5 * t610 + 5/2 * t620 - t629 + 3/2 * t639 + t648) * t843 * t13 * A * t381 * t195
    t900 = t466 * t270
    t901 = 4 * t666
    contr[22] = -9/8 * t848 * t843 * t12 * A * cdelta * (t659 + t900 - t901 - 2 * t669 - 10 * t674 + 2 * t677 - 4 * t684 + 2 * t687 + t692) * t381 * t264
    t918 = t466 * t305 * t18
    t919 = 5 * t705
    contr[23] = -9/8 * t834 * t821 * (t918 + t919 - 9/2 * t710 - 5 * t715 - 5/2 * t721 - 9 * t727 + 5/2 * t734 + t739) * t13 * A * t381 * t304
    contr[24] = -9/8 * t880 * t450 * t756 * C * t749 * t18 * t843 * t752 * t12 * t868 * t381 * t745
    contr[25] = 3/8 * t459 * t455 * t812 * t12 * t802 * t3 * C * A * t806 * cdelta * t821
    t953 = C ^ 2
    t957 = t821 ^ 2
    t960 = t459 * t455 * t450 * t957
    contr[26] = 81/16 * t960 * t446 * sdelta * t953 * t1
    t964 = t12 * t957
    t965 = t381 * t18
    t966 = t965 * t964
    t970 = t459 * t455 * t450 * cdelta
    contr[27] = 9/16 * t970 * t966 * t514 * t953 * t113
    contr[28] = 45/16 * t960 * t572 * sdelta * t953 * t161
    contr[29] = -9/16 * t459 * t590 * t580 * cdelta * t965 * t12 * t585 * t957 * t360 * t953 * t576
    contr[30] = 27/16 * t459 * t455 * t450 * t650 * t957 * t382 * sdelta * t953 * t195
    contr[31] = -9/4 * t970 * t966 * t694 * t953 * t264
    contr[32] = 9/16 * t960 * t742 * sdelta * t953 * t304
    contr[33] = 9/8 * t459 * t758 * t752 * t756 * t749 * cdelta * t965 * t964 * t953 * t745
    t1014 = t365 ^ 2
    contr[34] = -3/32 * t815 * cdelta * t806 * t1014 * t953 * t803
    t1059 = t108 * t98 * t758
    contr[35] = -27/64 * t1059 * t381 * sdelta * t10 * (t388 - t822 - t397 * t383 * (t394 + t18 - 8/3) - 10 * t538 * P2 * (t394 + t400 + 16/15) - 5 * t413 * t383 * (t406 + 14/5 * t529 + t410 - 8/15) - 2 * t422 * P2 * (t406 + t40 * (-t416 + 16/3) - t419 + 16/3) - 3 * t435 * t383 * (t425 + t67 * (-t426 + 8/9) + t40 * (-t429 + 8/9) - t432 + 4/9) + 2 * t442 * t78 * P2 * (t406 - 4/3 * t40 + t18 - 4/3)) * t12 * t1
    t1063 = t137 * Q2
    t1076 = 11/2 * t24
    t1081 = 3 * t24
    contr[36] = 9/64 * t459 * t455 * t450 * t381 * t18 * (t465 + t469 - t839 + 8 * t118 * t1063 * t117 - 10 * t484 * (t23 - 9/5) * t23 - 8 * t128 * (t24 + t500 - 1) * Q2 * t117 - 4 * t497 * t383 * (t390 - t1076 + t500 - 3/2) - 8 * Q1 * (t390 - t1081 + t23 - 1) * Q2 * t117 + t513) * t10 * t12 * t836
    t1105 = t407 - 8/5
    t1111 = t547 - 8/9
    t1117 = t535 + 4/5
    t1119 = t558 - 12/5
    contr[37] = 9/64 * t1059 * t381 * (t853 - t854 - 9 * t397 * t383 * (t529 + t530 - 4/9) + 10 * t538 * P2 * (t529 - t535 - 4/5) - 5 * t413 * t383 * (t541 + t40 * t1105 + t410 - 4/5) + 18 * t422 * P2 * (t541 + t40 * t1111 + t550 - 4/3) + 5 * Q2 * (t67 * t1117 + t40 * t1119 + t410 + t555) * t483 - 2 * (t541 + 4 * t40 + t18) * t564 * t187) * sdelta * t10 * t12 * t161
    contr[38] = 9/32 * t459 * t590 * t965 * t10 * t585 * t361 * cdelta * t876 * t576
    contr[39] = -27/32 * t1059 * t381 * (-t888 - t889 + t118 * (t600 + t601 - 16/3) * t483 / 2 - 5 * t714 * (t600 - t606 + 8/5) * Q2 + 5/2 * t619 * (t612 + t23 * (t613 - 16/15) + t616 - 16/15) * t383 - t40 * P1 * (t612 + t23 * (-t622 + 32/3) - t625 + 40/3) * t205 + 3/2 * t578 * (t631 - t717 / 9 + t23 * (-t634 + 32/9) - t432 + 4/9) * t383 + P1 * t254 * Q2 * (t612 + t23 * (t643 - 4) + t18 - 4/3) * t147) * sdelta * t10 * t12 * t195
    t1197 = 11 * t23
    contr[40] = 9/32 * t459 * t455 * t450 * t18 * t10 * (t659 + t900 - t901 - 2 * t668 * t1063 - 10 * t673 * P2 * (t24 - 9/5 * t23 + 11/5) + 2 * t676 * (t24 + t500 + 11) * Q2 - 4 * t40 * P1 * P2 * (t390 - t1076 - t1197 + 3/2) + 2 * t686 * (t390 - t1081 - t1197 + 1) * Q2 + t282 * t281 * (t24 + t487 + 1) * t117) * t12 * t381 * t265
    contr[41] = 9/32 * t1059 * t260 * t381 * (t918 + t919 - 9/2 * t604 * t383 * (t707 + t530 - 4/9) - 5 * t67 * P1 * (t707 - t535 - 4/5) * t205 - 5/2 * t619 * t383 * (t717 + t23 * t1105 + t410 - 4/5) - 9 * t40 * (t717 + t23 * t1111 + t550 - 4/3) * P1 * t205 + 5/2 * t578 * t383 * (t24 * t1117 + t23 * t1119 + t410 + t729) + (t717 + t487 + t18) * t736 * t329) * t304
    contr[42] = 9/16 * t459 * t758 * t756 * t18 * t10 * t752 * t382 * cdelta * t749 * t745
    t1264 = t18 - 2
    t1272 = t1264 * t385
    t1281 = t24 * t1264
    t1295 = t115 * t1264 * t483 + 4 * t118 * t1264 * Q2 * t117 + t67 * t1272 * t383 * t23 + 8 * t128 * P1 * (t23 * t1264 + t789) * t205 - t497 * t383 * (t1281 + 24 * t707 + t18 - 2) + 4 * t187 * (t1281 - 6 * t707 - t18 + 2) * Q2 - t1272 * t383 * t250 * t149 * t794
    t1296 = t1295 * t807
    contr[43] = -3/4 * t815 * t1296 * t379 * t12 * t808 - 3/16 * t815 * t1296 * t1014 * t953 * t12 + 3/4 * t459 * t455 * t812 * t821 * t12 * t806 * t4 * C * cdelta * t1295
       

    contr = sum(contr)
    return contr;
end

function meandZ3dcdelta1_Gravity_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,A,B,C,mu)
    GG = 1+Q1^2+Q2^2
    contr = zeros(25)
    t1 = 2 * psih
    t2 = cos(t1)
    t3 = P1 ^ 2
    t4 = P2 ^ 2
    t5 = t3 - t4
    t6 = Q1 ^ 2
    t7 = t6 ^ 2
    t8 = t6 * t7
    t10 = P1 * P2
    t11 = Q1 * t7
    t15 = -t5
    t16 = 5 * t15
    t17 = Q2 ^ 2
    t18 = t17 * t16
    t19 = 9 * t4
    t22 = Q1 * t6
    t26 = t17 ^ 2
    t32 = Q2 * t17
    t33 = t17 - 5
    t38 = t26 * t5
    t43 = -1 + Q2
    t45 = Q2 + 1
    t50 = 3 * skm - 1
    t57 = (A * t50 - 2 * C * skm + C * (1 - skm)) ^ 2
    t58 = mu ^ 2
    t59 = t58 * t57
    t60 = cdelta ^ 2
    t61 = t60 - 1/3
    t64 = t6 + t17 + 1
    t65 = t64 ^ 2
    t67 = 1 / t64 / t65
    t68 = sma ^ 2
    t69 = t68 ^ 2
    t71 = 0.1e1 / t68 / t69
    t72 = t71 * t67
    t73 = eta ^ 2
    t74 = t73 ^ 2
    t76 = 0.1e1 / t73 / t74
    t77 = 0.1e1 / Jg
    t79 = 0.1e1 / n
    t80 = t79 * t77 * t76
    t81 = t80 * t72
    contr[1] = 27/64 * t81 * t61 * t59 * (t8 * t5 + 8 * Q2 * t11 * t10 + t7 * (t18 - t3 + t19 + 6) - 40 * Q2 * t22 * t10 + t6 * (t26 * t16 + 30 * t17 * t5 - t19 + t3 - 6) - 8 * Q1 * t33 * t32 * t10 + t45 * t43 * (t38 + t17 * (-8 * t3 - 6) + t3 - t4)) * t2
    t83 = 3 * psih
    t84 = cos(t83)
    t86 = Q2 * t26
    t88 = P1 * Q1
    t120 = t79 * t77
    t122 = cdelta * t120 * t76 * t72
    contr[2] = 27/64 * t122 * sdelta * (t86 * t5 - 10 * t26 * P2 * t88 + t32 * (10 * t6 * t15 - 4/3 * t3 - 4/3 * t4 - 2) + 20 * t17 * P2 * P1 * t22 + Q2 * (-t7 * t16 + t6 * (4 * t3 + 4 * t4 + 6) + t3 - t4) - 2 * P2 * P1 * t11 + 2 * P2 * t88) * t58 * t57 * t84
    t124 = sin(t1)
    t125 = t57 * t124
    t126 = t58 * t61
    t129 = 2 * Q2 * t15
    t131 = t17 + 1
    t135 = 7/3 * t4
    t140 = 2 * Q2
    t141 = t17 + t140 - 1
    t142 = t17 - t140 - 1
    t151 = 2 * t3
    t152 = 2 * t4
    contr[3] = 27/32 * t81 * (t8 * t10 + t11 * t129 - 5 * t7 * t131 * t10 + 6 * t22 * (t3 - t135 - 1) * Q2 - 5 * t6 * t142 * t141 * t10 + 2 * Q1 * Q2 * (t38 + t17 * (-7 * t3 + 3 * t4 - 3) + t151 + t152 + 3) + t142 * t141 * t131 * t10) * t126 * t125
    t164 = sin(t83)
    t167 = P1 * Q2
    t171 = 2/3 * t3
    t172 = 2/3 * t4
    contr[4] = 27/32 * t122 * sdelta * t59 * (t11 * t5 / 2 + 5 * t7 * P2 * t167 + t22 * (t18 + t171 + t172 + 1) - 10 * t6 * P2 * t32 * P1 + Q1 * (5/2 * t26 * t5 + t17 * (-t151 - t152 - 3) + t3 / 2 - t4 / 2) + P2 * t86 * P1 - P2 * t167) * t164
    t196 = t61 * (t3 + t4 + 3/2)
    t200 = 3 * t5
    t205 = t60 + 1/3
    t218 = t6 + t17 - 1
    t221 = GG ^ 2
    contr[5] = 9/32 * t80 * t71 / GG / t221 * t59 * t218 * (t7 * t196 + t6 * (2 * t17 * t196 + t60 * t200 - t3 / 3 - 2 - t135) + 12 * Q1 * Q2 * t205 * t10 + t26 * t196 + t17 * (-t60 * t200 - 7/3 * t3 - t4 / 3 - 2) + t196)
    t227 = A ^ 2
    t229 = -t171 - t172 + eta + 1
    t231 = t7 ^ 2
    t232 = t231 * t5
    t233 = t22 * t7
    t236 = 8 * Q2 * t233 * t10
    t244 = (t17 - 6) * Q2
    t247 = 8 * t11 * t244 * t10
    t250 = P1 - P2
    t251 = P1 + P2
    t252 = t251 * t250
    t253 = t7 * t252
    t255 = 10 * t253 * (t17 - 17/5) * t17
    t256 = 4 * t17
    t258 = (t26 - t256 + 5) * Q2
    t261 = 8 * t22 * t258 * t10
    t262 = t17 * t26
    t267 = t6 * t251
    t269 = 4 * t267 * t250 * (t262 - 3/2 * t26 - 10 * t17 - 3/2)
    t270 = 2 * t17
    t272 = (t26 - t270 - 5) * t32
    t275 = 8 * Q1 * t272 * t10
    t276 = t43 ^ 2
    t279 = t45 ^ 2
    t283 = t251 * t250 * t45 * t279 * t43 * t276 * t131
    t286 = t61 * t58 * (t232 + t236 + t8 * (4 * t17 * t15 - 6 * t3 + 6 * t4) + t247 - t255 - t261 - t269 - t275 + t283)
    t288 = t50 ^ 2
    t289 = t65 ^ 2
    t290 = 1 / t289
    t292 = 1 + eta
    t293 = t292 ^ 2
    t295 = 0.1e1 / t292 / t293
    t298 = t120 * t76 * t71
    contr[6] = 27/64 * t298 * t295 * t290 * t288 * t286 * t229 * t227 * t2
    t301 = 4 * psih
    t302 = cos(t301)
    t305 = t250 * Q2
    t306 = Q1 * t251 - t305
    t308 = t58 * t229
    t314 = Q1 * t250 + t251 * Q2
    t316 = t295 * t67
    contr[7] = -27/64 * t298 * t316 * t61 * t314 * t218 * t288 * t308 * t306 * t227 * t302
    t323 = t231 * t10
    t327 = t17 + 3/2
    t330 = t8 * P1 * P2 * t327
    t332 = t11 * t252
    t333 = t332 * t244
    t337 = t7 * P1
    t338 = t337 * P2 * (t26 - 17/5 * t17 + 1)
    t340 = t22 * t252
    t341 = t340 * t258
    t348 = t6 * P1 * (t17 - 3) * P2 * (t26 + 3/2 * t17 - 1/2)
    t350 = Q1 * t252
    t351 = t350 * t272
    t352 = t26 ^ 2
    t356 = (t352 - 2 * t262 - 10 * t26 - t270 + 1) * t10
    t358 = -t323 / 2 + t233 * t5 * Q2 + 2 * t330 + t333 + 5 * t338 - t341 + 2 * t348 - t351 - t356 / 2
    contr[8] = -27/16 * t298 * t295 * t290 * t61 * t288 * t358 * t58 * t229 * t227 * t124
    t367 = sin(t301)
    t371 = -P2 * Q1 + t167
    t375 = 2 * t6 * t17 + t26 + t7 + 1
    t379 = P2 * Q2
    t380 = t88 + t379
    t382 = t295 * t290
    contr[9] = 27/32 * t298 * t382 * t61 * t380 * t288 * t375 * t371 * t58 * t229 * t227 * t367
    t386 = t60 + 1
    t389 = t60 - 5/3
    t394 = t60 - 13/51
    t411 = 3 * t60
    t420 = t131 * t45
    t423 = -t8 * t386 * t252 + 4 * t11 * t389 * P1 * t379 - 17 * t253 * t394 * t17 - 56 * t22 * P1 * (t60 - 1/7) * t32 * P2 + 17 * t267 * t250 * (t26 * t394 + t60 / 17 + 1/17) + 4 * Q1 * P1 * (t26 * t389 + t411 + 1/3) * t379 + t420 * t43 * t386 * t251 * t250 * t17
    t427 = t221 ^ 2
    t428 = 0.1e1 / t427
    t431 = t80 * t71 * t295 * t428
    contr[10] = -27/64 * t431 * t288 * t308 * t227 * t423
    t436 = 3/2 * skm - 1/2
    t440 = 4 * t8 * t327 * t252
    t443 = t229 * t61
    t446 = t50 * C
    t448 = t298 * t382 * t446
    contr[11] = -27/16 * t448 * t443 * t58 * (t232 + t236 - t440 + t247 - t255 - t261 - t269 - t275 + t283) * t436 * A * t2
    t452 = t436 * A
    t455 = t314 * t218 * t126
    t459 = -Q1 * t251 + t305
    t463 = t80 * t71 * t295
    contr[12] = -27/16 * t463 * t67 * t459 * t446 * t455 * t452 * t229 * t302
    t468 = t233 * t129
    t469 = 4 * t330
    contr[13] = -27/8 * t448 * t126 * t452 * (t323 + t468 - t469 - 2 * t333 - 10 * t338 + 2 * t341 - 4 * t348 + 2 * t351 + t356) * t229 * t124
    t489 = t290 * t380
    contr[14] = -27/8 * t463 * t489 * t50 * t436 * C * t371 * t375 * t61 * t58 * A * t229 * t367
    contr[15] = 27/16 * t298 * t295 * t428 * t436 * t58 * C * t229 * t50 * t423 * A
    t505 = C ^ 2
    t507 = t436 ^ 2
    t512 = t298 * t295 * t290 * t229
    contr[16] = 27/16 * t512 * t286 * t507 * t505 * t2
    contr[17] = -27/16 * t298 * t316 * t306 * t229 * t58 * t314 * t218 * t507 * t61 * t505 * t302
    contr[18] = -27/4 * t512 * t58 * t358 * t507 * t61 * t505 * t124
    contr[19] = 27/8 * t298 * t382 * t375 * t380 * t371 * t229 * t58 * t507 * t61 * t505 * t367
    contr[20] = -27/16 * t431 * t229 * t507 * t423 * t58 * t505
    t550 = t33 * Q2
    t563 = 11/2 * t26
    t568 = 3 * t26
    t579 = t80 * t71 * t382
    contr[21] = 27/64 * t579 * t229 * (t232 + t236 - t440 + 8 * t11 * t550 * t10 - 10 * t253 * (t17 - 9/5) * t17 - 8 * t22 * (t26 + t270 - 1) * Q2 * t10 - 4 * t267 * t250 * (t262 - t563 + t270 - 3/2) - 8 * Q1 * (t262 - t568 + t17 - 1) * Q2 * t10 + t283) * t58 * t61 * t57 * t2
    contr[22] = 27/32 * t298 * t295 * t67 * t229 * t455 * t57 * t459 * t302
    t600 = 11 * t17
    contr[23] = 27/32 * t579 * t61 * (t323 + t468 - t469 - 2 * t332 * t550 - 10 * t337 * P2 * (t26 - 9/5 * t17 + 11/5) + 2 * t340 * (t26 + t270 + 11) * Q2 - 4 * t6 * P1 * P2 * (t262 - t563 - t600 + 3/2) + 2 * t350 * (t262 - t568 - t600 + 1) * Q2 + t142 * t141 * (t26 + t256 + 1) * t10) * t58 * t229 * t125
    contr[24] = 27/16 * t298 * t295 * t489 * t375 * t58 * t443 * t57 * t371 * t367
    t627 = t250 * t205
    t643 = t26 * t205
    contr[25] = 27/32 * t463 * t428 * t59 * (t8 * t251 * t627 + 4 * t11 * t379 * t205 * P1 + t7 * t17 * t251 * t627 + 8 * t22 * t379 * (t17 * t205 + t411 - 1) * P1 - t267 * t250 * (t643 + t17 * (24 * t60 - 8) + 1/3 + t60) + 4 * Q1 * t379 * (t643 + t17 * (-6 * t60 + 2) - t60 - 1/3) * P1 - t43 * t17 * t420 * t251 * t627) * t229
    
    
    contr = sum(contr)
    return contr;
end

function meandZ3dcdelta2_Gravity_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,A,B,C,mu)
    GG = 1+Q1^2+Q2^2
    contr = zeros(18)
 
    t1 = cos(psih)
    t2 = cdelta * t1
    t4 = 3 * skm - 1
    t11 = (A * t4 - 2 * C * skm + C * (1 - skm)) ^ 2
    t12 = P1 ^ 2
    t13 = P2 ^ 2
    t14 = 5/13 * t13
    t16 = Q2 ^ 2
    t17 = t16 ^ 2
    t18 = Q2 * t17
    t20 = P1 * Q1
    t22 = t17 * P2 * t20
    t27 = Q1 ^ 2
    t32 = Q2 * t16
    t34 = P2 * t20
    t39 = t16 * (Q1 + 2) * (Q1 - 2) * t34
    t44 = t27 ^ 2
    t52 = Q1 * t44
    t54 = P2 * P1 * t52
    t58 = cdelta ^ 2
    t60 = 19/39 * t12
    t61 = 11/39 * t13
    t88 = mu ^ 2
    t91 = t27 + t16 + 1
    t92 = t91 ^ 2
    t95 = 0.1e1 / Jg
    t97 = sma ^ 2
    t98 = t97 ^ 2
    t101 = eta ^ 2
    t102 = t101 ^ 2
    t105 = 0.1e1 / t101 / t102 / t97 / t98
    t106 = 0.1e1 / n
    t107 = t106 * t105
    t108 = t107 * t95 / t91 / t92
    contr[1] = 117/64 * t108 * t88 * (t58 * (t18 * (t12 - t14 + 6/13) - 54/13 * t22 + t32 * (t27 * (-10/13 * t12 + 2 * t13 + 12/13) - 64/13 * t12 + 8/13 * t13 - 42/13) - 36/13 * t39 + Q2 * (t44 * (-23/13 * t12 + 31/13 * t13 + 6/13) + t27 * (8/13 * t12 - 64/13 * t13 - 42/13) + t12 - t14 + 6/13) + 18/13 * t54 - 18/13 * t34) + t18 * (-t60 + t61 - 2/13) + 30/13 * t22 + t32 * (t27 * (22/39 * t12 - 38/39 * t13 - 4/13) + 112/39 * t12 - 8/39 * t13 + 2) + 20/13 * t39 + Q2 * (t44 * (41/39 * t12 - 49/39 * t13 - 2/13) + t27 * (-8/39 * t12 + 112/39 * t13 + 2) - t60 + t61 - 2/13) - 10/13 * t54 + 10/13 * t34) * t11 * t2
    t110 = sin(psih)
    t111 = cdelta * t110
    t112 = t88 * t11
    t113 = 5/18 * t12
    t114 = 13/18 * t13
    t117 = P1 * Q2
    t119 = t44 * P2 * t117
    t128 = Q1 * t27
    t133 = P2 * t117
    t148 = P2 * t18 * P1
    t151 = 11/54 * t12
    t152 = 19/54 * t13
    contr[2] = 81/32 * t108 * (t58 * (t52 * (1/3 - t113 + t114) - 3 * t119 + t128 * (t16 * (13/9 * t12 - 5/9 * t13 + 2/3) - 7/3 + 4/9 * t12 - 32/9 * t13) + t27 * (-2 * P2 * t32 * P1 + 8 * t133) + Q1 * (t17 * (31/18 * t12 - 23/18 * t13 + 1/3) + t16 * (-32/9 * t12 + 4/9 * t13 - 7/3) + 1/3 - t113 + t114) + t148 - t133) + t52 * (t151 - t152 - 1/9) + 5/3 * t119 + t128 * (t16 * (-2/9 + 11/27 * t13 - 19/27 * t12) - 4/27 * t12 + 56/27 * t13 + 13/9) + 10/9 * t27 * (Q2 + 2) * (Q2 - 2) * t133 + Q1 * (t17 * (-1/9 + 41/54 * t13 - 49/54 * t12) + t16 * (13/9 + 56/27 * t12 - 4/27 * t13) + t151 - t152 - 1/9) + 5/9 * t133 - 5/9 * t148) * t112 * t111
    t186 = A ^ 2
    t190 = -2/3 * t12 - 2/3 * t13 + eta + 1
    t192 = t4 ^ 2
    t194 = cdelta * t192 * t88
    t196 = -t12 + t13
    t198 = t32 * t17
    t200 = P1 * P2
    t201 = t17 * t16
    t203 = t201 * Q1 * t200
    t204 = 2 * t203
    t206 = P1 - P2
    t208 = P1 + P2
    t209 = t18 * t208
    t210 = t209 * t206 * (t27 + 1)
    t214 = t17 * t200
    t215 = t214 * (t27 + 7/15) * Q1
    t220 = t32 * t208
    t221 = t220 * (t44 + 14/5 * t27 + 1/5) * t206
    t227 = t16 * (t44 - 18 * t27 - 19/3) * P2 * t20
    t229 = t27 * t44
    t234 = Q2 * t208
    t235 = t234 * t206 * (-1/3 + t229 - 25/9 * t44 - 13/9 * t27)
    t236 = Q1 - 1
    t237 = Q1 + 1
    t238 = t237 * t236
    t241 = (t44 + 1) * t238 * t34
    t245 = -t196
    t251 = t209 * t206 * (t27 + 3/5)
    t255 = t214 * (t27 + 19/25) * Q1
    t260 = t220 * (t44 + 82/25 * t27 + 3/25) * t206
    t266 = t16 * P2 * (t44 - 102/5 * t27 - 31/5) * t20
    t269 = 7/5 * t27
    t272 = t234 * t206 * (t229 - 49/15 * t44 - t269 - 1/3)
    t274 = t237 * Q1
    t280 = P2 * t236 * P1 * (t44 - 2/5 * t27 + 1) * t274
    t283 = t92 ^ 2
    t284 = 1 / t283
    t286 = 1 + eta
    t287 = t286 ^ 2
    t289 = 0.1e1 / t286 / t287
    t292 = t106 * t95 * t105
    t293 = t292 * t289 * t284 * (t58 * (t198 * t196 / 3 + t204 + t210 / 3 + 10/3 * t215 + 5/3 * t221 + 2/3 * t227 + t235 - 2/3 * t241) + 5/27 * t198 * t245 - 10/9 * t203 - 5/27 * t251 - 50/27 * t255 - 25/27 * t260 - 10/27 * t266 - 5/9 * t272 + 10/27 * t280)
    contr[3] = -243/64 * t293 * t194 * t190 * t186 * t1
    t296 = 3 * psih
    t297 = cos(t296)
    t301 = t245 / 5
    t310 = t17 * P2 * (t27 - 3/5) * t20
    t316 = t16 * t200 * (t44 + 14/9 * t27 + 7/9) * Q1
    t321 = t234 * t206 * (3/5 * t44 + t269 + t229 + 1/5)
    t327 = t208 * t206
    t330 = t18 * (t27 + 1/27) * t327
    t335 = t17 * P2 * (t27 - 11/15) * t20
    t340 = t220 * t206 * (38/15 * t27 + t44 + 1/15)
    t345 = t16 * P2 * (t44 + 38/27 * t27 + 5/9) * t20
    t350 = t234 * t206 * (t229 + 11/15 * t44 + t27 + 1/5)
    t356 = P2 * t236 * (t44 + 2/3 * t27 + 1) * P1 * t274
    t361 = t292 * t289 * t284 * (t58 * (t198 * t301 - t204 - 9/5 * t209 * (t27 + 1/9) * t206 + 2 * t310 - t221 + 18/5 * t316 + t321 - 2/5 * t241) - t198 * t301 + t204 + 9/5 * t330 - 2 * t335 + t340 - 18/5 * t345 - t350 + 2/5 * t356)
    contr[4] = -135/64 * t361 * t194 * t190 * t186 * t297
    t367 = t128 * t44
    t368 = t367 * t245
    t369 = P2 * Q2
    t371 = t229 * P1 * t369
    t375 = t52 * t208
    t376 = t375 * t206 * (t16 + 11/3)
    t380 = t44 * P2 * (t16 - 17/15) * t117
    t382 = 2/3 * t16
    t385 = t128 * t208
    t386 = t385 * (t17 + t382 + 11/15) * t206
    t392 = t27 * P2 * (t17 - 22/3 * t16 - 9) * t117
    t398 = Q1 * t208
    t399 = t398 * (t201 - t17 / 9 - 7/3 * t16 - 1/3) * t206
    t404 = -1 + Q2
    t405 = Q2 + 1
    t406 = t405 * t404
    t407 = P2 * t406
    t408 = t407 * (t17 + 8/3 * t16 + 1) * t117
    t412 = 5/9 * t196
    t417 = t375 * (t16 + 19/5) * t206
    t422 = t44 * t200 * Q2 * (t16 - 29/25)
    t427 = t385 * t206 * (t17 + 18/25 * t16 + 19/25)
    t433 = t27 * P2 * (t17 - 38/5 * t16 - 47/5) * t117
    t441 = Q1 * (t16 - 5/3) * t208 * (t17 + 8/5 * t16 + 1/5) * t206
    t445 = 14/5 * t16
    t448 = (t17 + t445 + 1) * P2 * t405 * t404 * t117
    t450 = t58 * (t368 + 6 * t371 - t376 + 10 * t380 - 5 * t386 + 2 * t392 - 3 * t399 - 2 * t408) + t367 * t412 - 10/3 * t371 + 5/9 * t417 - 50/9 * t422 + 25/9 * t427 - 10/9 * t433 + 5/3 * t441 + 10/9 * t448
    contr[5] = -81/64 * t292 * t284 * t289 * t450 * t194 * t190 * t186 * t110
    t456 = sin(t296)
    t457 = 10 * t371
    t458 = 9 * t196
    t465 = t44 * P2 * (t16 - 3/5) * t117
    t469 = t385 * (t17 + t445 + 1/5) * t206
    t475 = t27 * t200 * Q2 * (t17 + 14/9 * t16 + 7/9)
    t481 = Q1 * (t201 + 3/5 * t17 + 7/5 * t16 + 1/5) * t327
    t485 = (t17 + 1) * t406 * t133
    t492 = t375 * t206 * (t16 + 1/27)
    t497 = t44 * P2 * (t16 - 11/15) * t117
    t502 = t128 * (t17 + 38/15 * t16 + 1/15) * t327
    t508 = t27 * P2 * (t17 + 38/27 * t16 + 5/9) * t117
    t513 = Q1 * (t201 + 11/15 * t17 + t16 + 1/5) * t327
    t517 = t407 * (t17 + t382 + 1) * t117
    t519 = t58 * (t368 + t457 + t52 * (t16 * t458 - t12 + t13) - 10 * t465 - 5 * t469 - 18 * t475 + 5 * t481 + 2 * t485) + t367 * t196 - t457 + 9 * t492 + 10 * t497 + 5 * t502 + 18 * t508 - 5 * t513 - 2 * t517
    t522 = t88 * t190
    contr[6] = -27/64 * t292 * t284 * t289 * cdelta * t192 * t522 * t186 * t519 * t456
    t530 = t198 * t245
    t533 = 5 * t221
    t536 = 2 * t241
    t538 = t58 * (t530 - 6 * t203 - t210 - 10 * t215 - t533 - 2 * t227 - 3 * t235 + t536)
    t539 = t198 * t412
    t540 = 10/3 * t203
    t551 = 3/2 * skm - 1/2
    t552 = t551 * A
    t553 = t522 * t552
    t556 = t284 * t289
    t558 = t292 * t556 * t4 * C
    contr[7] = -81/16 * t558 * t553 * cdelta * (t538 + t539 + t540 + 5/9 * t251 + 50/9 * t255 + 25/9 * t260 + 10/9 * t266 + 5/3 * t272 - 10/9 * t280) * t1
    t561 = 10 * t203
    t569 = t58 * (t530 - t561 + t18 * (t27 * t458 - t12 + t13) + 10 * t310 - t533 + 18 * t316 + 5 * t321 - t536)
    t570 = t198 * t196
    contr[8] = 27/16 * t558 * t553 * cdelta * (t569 + t570 + t561 + 9 * t330 - 10 * t335 + 5 * t340 - 18 * t345 - 5 * t350 + 2 * t356) * t297
    t584 = t196 / 2
    t585 = t367 * t584
    t592 = t58 * (t585 - 3 * t371 + t376 / 2 - 5 * t380 + 5/2 * t386 - t392 + 3/2 * t399 + t408)
    t594 = 5/18 * t367 * t245
    t595 = 5/3 * t371
    contr[9] = -81/8 * t558 * (t592 + t594 + t595 - 5/18 * t417 + 25/9 * t422 - 25/18 * t427 + 5/9 * t433 - 5/6 * t441 - 5/9 * t448) * t88 * t552 * cdelta * t190 * t110
    t613 = 5 * t371
    t623 = t58 * (-t367 * t584 + t613 - 9/2 * t375 * t206 * (t16 + 1/9) - 5 * t465 - 5/2 * t469 - 9 * t475 + 5/2 * t481 + t485)
    contr[10] = 27/8 * t292 * t556 * t4 * t551 * C * (t623 + t585 - t613 + 9/2 * t492 + 5 * t497 + 5/2 * t502 + 9 * t508 - 5/2 * t513 - t517) * t88 * A * cdelta * t190 * t456
    t637 = C ^ 2
    t639 = t551 ^ 2
    t642 = t190 * cdelta * t88
    contr[11] = -243/16 * t293 * t642 * t639 * t637 * t1
    contr[12] = -135/16 * t361 * t642 * t639 * t637 * t297
    contr[13] = -81/16 * t292 * t284 * t289 * t190 * cdelta * t88 * t450 * t639 * t637 * t110
    contr[14] = -27/16 * t292 * t284 * t289 * t519 * t642 * t639 * t637 * t456
    t676 = t17 * t20
    t684 = P2 * Q1
    t700 = P1 * t238
    t707 = t107 * t95 * t556
    contr[15] = 81/64 * t707 * (t538 + t539 + t540 + 5/9 * t18 * (t27 + 1/5) * t327 + 50/9 * t676 * (t27 + 37/25) * P2 + 25/9 * t220 * t206 * (t44 + 126/25 * t27 + 1/25) + 10/9 * t16 * P1 * (t44 - 146/5 * t27 - 41/5) * t684 + 5/3 * t234 * t206 * (t229 - 67/15 * t44 - 31/15 * t27 - 1/3) - 10/9 * t700 * (t44 - 4/5 * t27 + 1) * t684) * t522 * t11 * t2
    t742 = t190 * t112
    contr[16] = -27/64 * t707 * t742 * cdelta * (t569 + t570 + t561 + 9 * t18 * (t27 - 1/27) * t327 - 10 * t676 * (t27 - 13/15) * P2 + 5 * t32 * (t44 + 34/15 * t27 - 1/15) * t327 - 18 * t16 * P1 * (t44 + 34/27 * t27 + 1/3) * t684 - 5 * Q2 * (t229 + 13/15 * t44 + 3/5 * t27 + 1/5) * t327 + 2 * t700 * (t44 + 4/3 * t27 + 1) * t684) * t297
    t775 = P1 * t406
    contr[17] = 81/32 * t707 * t742 * (t592 + t594 + t595 - 5/18 * t375 * t206 * (t16 + 17/5) + 25/9 * t44 * P1 * (t16 - 27/25) * t369 - 25/18 * t128 * (t17 + 14/25 * t16 + 17/25) * t327 + 5/9 * t27 * P1 * (t17 - 34/5 * t16 - 41/5) * t369 - 5/6 * t398 * t206 * (t201 - t17 / 5 - 31/15 * t16 - 1/3) - 5/9 * t775 * (t17 + 12/5 * t16 + 1) * t369) * t111
    contr[18] = -27/32 * t707 * (t623 + t585 - t613 + 9/2 * t52 * (t16 - 1/27) * t327 + 5 * t44 * P1 * (t16 - 13/15) * t369 + 5/2 * t128 * (t17 + 34/15 * t16 - 1/15) * t327 + 9 * t27 * (t17 + 34/27 * t16 + 1/3) * P1 * t369 - 5/2 * t398 * t206 * (t201 + 13/15 * t17 + 3/5 * t16 + 1/5) - t775 * Q2 * P2 * (t17 + 4/3 * t16 + 1)) * t522 * t11 * cdelta * t456
        

    contr = sum(contr)
    return contr;
end

function meandZ3dpsih_Gravity_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,A,B,C,mu)
    GG = 1+Q1^2+Q2^2
    contr = zeros(38)
   
    t2 = 3 * skm - 1
    t9 = (A * t2 - 2 * C * skm + C * (1 - skm)) ^ 2
    t10 = mu ^ 2
    t11 = t10 * t9
    t12 = P1 ^ 2
    t13 = P2 ^ 2
    t16 = sdelta ^ 2
    t17 = t16 * (t12 - 5/13 * t13 + 6/13)
    t18 = 20/13 * t12
    t19 = 4/13 * t13
    t21 = Q2 ^ 2
    t22 = t21 ^ 2
    t23 = Q2 * t22
    t25 = P1 * Q1
    t26 = t16 - 4/3
    t27 = P2 * t26
    t32 = 2 * t13
    t35 = 8/13 * t12
    t38 = Q1 ^ 2
    t47 = Q2 * t21
    t54 = t21 * P2
    t65 = t38 ^ 2
    t76 = Q1 - 1
    t79 = Q1 + 1
    t88 = t38 + t21 + 1
    t89 = t88 ^ 2
    t91 = 0.1e1 / t88 / t89
    t94 = sma ^ 2
    t95 = t94 ^ 2
    t97 = 0.1e1 / t94 / t95
    t98 = eta ^ 2
    t99 = t98 ^ 2
    t101 = 0.1e1 / t98 / t99
    t102 = t101 * t97
    t103 = 0.1e1 / Jg
    t104 = 0.1e1 / n
    t105 = t104 * t103
    t106 = sin(psih)
    t107 = t106 * t105
    contr[1] = -39/64 * t107 * t102 * t91 * (t23 * (t17 - t18 + t19 - 12/13) - 54/13 * t22 * t27 * t25 + t47 * (t38 * (t16 * (-10/13 * t12 + t32 + 12/13) + t35 - 40/13 * t13 - 24/13) + t16 * (-64/13 * t12 + 8/13 * t13 - 42/13) + 80/13 * t12 - 16/13 * t13 + 48/13) - 36/13 * t54 * (Q1 - 2) * t26 * Q1 * (Q1 + 2) * P1 + Q2 * (t65 * (t16 * (-23/13 * t12 + 31/13 * t13 + 6/13) + 28/13 * t12 - 44/13 * t13 - 12/13) + t38 * (t16 * (t35 - 64/13 * t13 - 42/13) - 16/13 * t12 + 80/13 * t13 + 48/13) + t17 - t18 + t19 - 12/13) + 18/13 * P2 * (t38 + 1) * t79 * t26 * P1 * Q1 * t76) * sdelta * t11
    t111 = t12 - t13
    t112 = t38 * t65
    t114 = P1 * P2
    t115 = Q1 * t65
    t119 = -t111
    t120 = 5 * t119
    t121 = t21 * t120
    t122 = 9 * t13
    t125 = Q1 * t38
    t134 = t21 - 5
    t139 = t22 * t111
    t144 = -1 + Q2
    t146 = Q2 + 1
    t153 = t101 * t97 * t91
    t154 = 2 * psih
    t155 = sin(t154)
    contr[2] = 9/32 * t155 * t105 * t153 * t16 * t11 * cdelta * (t112 * t111 + 8 * Q2 * t115 * t114 + t65 * (t121 - t12 + t122 + 6) - 40 * Q2 * t125 * t114 + t38 * (30 * t21 * t111 + t22 * t120 + t12 - t122 - 6) - 8 * Q1 * t134 * t47 * t114 + t146 * t144 * (t139 + t21 * (-8 * t12 - 6) + t12 - t13))
    t183 = P2 * t25
    t186 = sdelta * t16
    t190 = 3 * psih
    t191 = sin(t190)
    t192 = t191 * t105
    contr[3] = 27/64 * t192 * t102 * t91 * t186 * (t23 * t111 - 10 * t22 * P2 * t25 + t47 * (10 * t38 * t119 - 4/3 * t12 - 4/3 * t13 - 2) + 20 * t54 * P1 * t125 + Q2 * (-t65 * t120 + t38 * (4 * t12 + 4 * t13 + 6) + t12 - t13) - 2 * P2 * P1 * t115 + 2 * t183) * t11
    t198 = t16 * (1/3 - 5/18 * t12 + 13/18 * t13)
    t199 = 2/9 * t12
    t200 = 10/9 * t13
    t203 = t26 * P1
    t204 = P2 * Q2
    t212 = 4/9 * t13
    t249 = t21 + 1
    t252 = t144 * Q2
    t253 = P2 * t146
    t261 = cos(psih)
    t262 = t261 * t105
    contr[4] = 27/32 * t262 * t102 * t91 * sdelta * t10 * t9 * (t115 * (t198 + t199 - t200 - 2/3) - 3 * t65 * t204 * t203 + t125 * (t21 * (t16 * (13/9 * t12 - 5/9 * t13 + 2/3) - 4/3 + t212 - 20/9 * t12) + t16 * (-7/3 + 4/9 * t12 - 32/9 * t13) - 8/9 * t12 + 40/9 * t13 + 8/3) - 2 * t38 * (Q2 + 2) * t204 * t26 * (Q2 - 2) * P1 + Q1 * (t22 * (t16 * (31/18 * t12 - 23/18 * t13 + 1/3) - 2/3 + 14/9 * t13 - 22/9 * t12) + t21 * (t16 * (-32/9 * t12 + t212 - 7/3) + 8/3 + 40/9 * t12 - 8/9 * t13) + t198 + t199 - t200 - 2/3) + t253 * t252 * t26 * P1 * t249)
    t265 = t10 * cdelta
    t266 = t16 * t9
    t269 = 2 * Q2 * t119
    t279 = 2 * Q2
    t280 = t21 + t279 - 1
    t281 = t21 - t279 - 1
    t290 = 2 * t12
    t301 = cos(t154)
    contr[5] = -9/16 * t301 * t105 * t153 * (t112 * t114 + t115 * t269 - 5 * t65 * t249 * t114 + 6 * t125 * (t12 - 7/3 * t13 - 1) * Q2 - 5 * t38 * t281 * t280 * t114 + 2 * Q1 * Q2 * (t139 + t21 * (-7 * t12 + 3 * t13 - 3) + t290 + t32 + 3) + t281 * t280 * t249 * t114) * t266 * t265
    t306 = t111 / 2
    t308 = P1 * Q2
    t312 = 2/3 * t12
    t313 = 2/3 * t13
    t330 = P2 * t308
    t336 = cos(t190)
    t337 = t336 * t105
    contr[6] = -27/32 * t337 * t102 * t91 * t186 * t10 * t9 * (t115 * t306 + 5 * t65 * P2 * t308 + t125 * (t121 + t312 + t313 + 1) - 10 * t38 * P2 * t47 * P1 + Q1 * (5/2 * t22 * t111 + t21 * (-t290 - t32 - 3) + t12 / 2 - t13 / 2) + P2 * t23 * P1 - t330)
    t341 = A ^ 2
    t343 = -t312 - t313 + eta + 1
    t344 = t343 * t341 * sdelta
    t345 = P1 - P2
    t346 = t345 * t26
    t347 = P1 + P2
    t348 = t47 * t22
    t350 = t348 * t347 * t346
    t352 = t21 * t22
    t354 = t352 * t25 * t27
    t356 = t38 * t26
    t359 = t23 * t347
    t360 = t359 * t345 * (t356 + t16 - 2)
    t362 = 7/15 * t16
    t366 = t22 * Q1 * (t356 + t362 - 2/15) * t114
    t368 = t65 * t26
    t369 = 14/5 * t16
    t372 = t16 / 5
    t375 = t47 * t347
    t376 = t375 * t345 * (t368 + t38 * (t369 - 44/15) + t372 - 2/5)
    t378 = 18 * t16
    t381 = 19/3 * t16
    t384 = t21 * t25
    t385 = t384 * (t368 + t38 * (-t378 + 20) - t381 + 26/3) * P2
    t387 = t112 * t26
    t388 = 25/9 * t16
    t391 = 13/9 * t16
    t394 = t16 / 3
    t397 = t347 * Q2
    t398 = t397 * t345 * (t387 + t65 * (-t388 + 26/9) + t38 * (-t391 + 2) - t394 + 4/9)
    t404 = Q1 * t79 * P1
    t405 = t404 * t76 * (t368 - 2/3 * t38 + t16 - 4/3) * P2
    t407 = -t350 / 3 + 2 * t354 + t360 / 3 + 10/3 * t366 + 5/3 * t376 + 2/3 * t385 + t398 - 2/3 * t405
    t409 = t2 ^ 2
    t412 = t89 ^ 2
    t413 = 0.1e1 / t412
    t414 = 1 + eta
    t415 = t414 ^ 2
    t417 = 0.1e1 / t414 / t415
    t418 = t417 * t413
    t419 = t97 * t418
    t420 = t103 * t101
    t422 = t106 * t104 * t420
    t423 = t422 * t419
    contr[7] = 81/64 * t423 * t409 * t407 * t10 * t344
    t425 = t343 * t341
    t426 = t65 ^ 2
    t427 = t426 * t111
    t428 = t125 * t65
    t431 = 8 * Q2 * t428 * t114
    t439 = (t21 - 6) * Q2
    t442 = 8 * t115 * t439 * t114
    t445 = t347 * t345
    t446 = t65 * t445
    t448 = 10 * t446 * (t21 - 17/5) * t21
    t449 = 4 * t21
    t451 = (t22 - t449 + 5) * Q2
    t454 = 8 * t125 * t451 * t114
    t459 = t38 * t347
    t461 = 4 * t459 * t345 * (t352 - 3/2 * t22 - 10 * t21 - 3/2)
    t462 = 2 * t21
    t464 = (t22 - t462 - 5) * t47
    t467 = 8 * Q1 * t464 * t114
    t468 = t144 ^ 2
    t471 = t146 ^ 2
    t475 = t347 * t345 * t146 * t471 * t144 * t468 * t249
    t476 = t427 + t431 + t112 * (4 * t21 * t119 - 6 * t12 + 6 * t13) + t442 - t448 - t454 - t461 - t467 + t475
    t478 = t16 * t10
    t479 = t409 * cdelta
    t483 = t155 * t104 * t420
    t484 = t483 * t419
    contr[8] = 9/32 * t484 * t479 * t478 * t476 * t425
    t491 = t16 * t352 * Q1 * t114
    t493 = t16 * t38
    t494 = t16 / 9
    t497 = t359 * t345 * (t493 + t494 - 2/9)
    t499 = 3/5 * t16
    t502 = t22 * t25
    t503 = t502 * P2 * (t493 - t499 - 2/5)
    t505 = t16 * t65
    t506 = t369 - 4/5
    t510 = t375 * (t505 + t38 * t506 + t372 - 2/5) * t345
    t511 = 14/9 * t16
    t512 = t511 - 4/9
    t514 = 7/9 * t16
    t517 = t384 * (t505 + t38 * t512 + t514 - 2/3) * P2
    t519 = t16 * t112
    t520 = t499 + 2/5
    t522 = 7/5 * t16
    t523 = t522 - 6/5
    t527 = t397 * t345 * (t38 * t523 + t65 * t520 + t372 + t519)
    t528 = t79 * t76
    t532 = (t505 + 2 * t38 + t16) * t528 * t183
    t534 = t348 * t111 * t16 / 5 - 2 * t491 - 9/5 * t497 + 2 * t503 - t510 + 18/5 * t517 + t527 - 2/5 * t532
    t539 = t191 * t104 * t420
    t540 = t539 * t419
    contr[9] = 135/64 * t540 * t409 * t10 * t534 * t344
    t542 = Q1 * t347
    t543 = t345 * Q2
    t544 = t542 - t543
    t546 = t10 * t343
    t548 = t38 + t21 - 1
    t551 = Q1 * t345 + t397
    t556 = t97 * t417
    t558 = 4 * psih
    t559 = sin(t558)
    t561 = t559 * t104 * t420
    contr[10] = -9/16 * t561 * t556 * t91 * t409 * cdelta * t551 * t548 * t16 * t546 * t544 * t341
    t566 = t428 * t347 * t346
    t568 = t112 * t203 * t204
    t570 = t21 * t26
    t571 = 11/3 * t16
    t574 = t115 * t347
    t575 = t574 * t345 * (t570 + t571 - 14/3)
    t576 = 17/15 * t16
    t580 = t65 * P1 * (t570 - t576 + 22/15) * t204
    t582 = t22 * t26
    t583 = 2/3 * t16
    t586 = 11/15 * t16
    t589 = t125 * t347
    t590 = t589 * t345 * (t582 + t21 * (t583 - 4/5) + t586 - 14/15)
    t592 = 22/3 * t16
    t595 = 9 * t16
    t599 = t38 * P1 * (t582 + t21 * (-t592 + 28/3) - t595 + 34/3) * t204
    t601 = t352 * t26
    t604 = 7/3 * t16
    t609 = t542 * (t601 + t22 * (-t494 + 2/9) + t21 * (-t604 + 26/9) - t394 + 4/9) * t345
    t613 = 8/3 * t16
    t618 = (t582 + t21 * (t613 - 10/3) + t16 - 4/3) * P1 * t146 * P2 * t252
    t620 = t566 + 6 * t568 - t575 + 10 * t580 - 5 * t590 + 2 * t599 - 3 * t609 - 2 * t618
    t626 = t261 * t104 * t420
    t627 = t626 * t419
    contr[11] = -27/64 * t627 * t409 * t546 * t341 * sdelta * t620
    t631 = t426 * t114
    t635 = t21 + 3/2
    t637 = t112 * P1
    t638 = t637 * P2 * t635
    t640 = t115 * t445
    t641 = t640 * t439
    t645 = t65 * P1
    t646 = t645 * P2 * (t22 - 17/5 * t21 + 1)
    t648 = t125 * t445
    t649 = t648 * t451
    t656 = t38 * P1 * (t21 - 3) * P2 * (t22 + 3/2 * t21 - 1/2)
    t658 = Q1 * t445
    t659 = t658 * t464
    t660 = t22 ^ 2
    t664 = (t660 - 2 * t352 - 10 * t22 - t462 + 1) * t114
    t666 = -t631 / 2 + t428 * t111 * Q2 + 2 * t638 + t641 + 5 * t646 - t649 + 2 * t656 - t659 - t664 / 2
    t671 = t301 * t104 * t420
    t672 = t671 * t419
    contr[12] = 9/8 * t672 * t479 * t16 * t666 * t10 * t425
    t674 = t111 * t16
    t677 = t16 * t637 * t204
    t679 = t16 * t21
    t682 = t574 * t345 * (t679 + t494 - 2/9)
    t686 = t65 * t114
    t687 = t686 * Q2 * (t679 - t499 - 2/5)
    t689 = t16 * t22
    t693 = t589 * t345 * (t689 + t21 * t506 + t372 - 2/5)
    t699 = t38 * P1 * (t689 + t21 * t512 + t514 - 2/3) * t204
    t701 = t16 * t352
    t706 = t542 * t345 * (t21 * t523 + t22 * t520 + t372 + t701)
    t708 = t146 * t144
    t711 = (t689 + t462 + t16) * t708 * t330
    t713 = t428 * t674 + 10 * t677 - 9 * t682 - 10 * t687 - 5 * t693 - 18 * t699 + 5 * t706 + 2 * t711
    t718 = t336 * t104 * t420
    t719 = t718 * t419
    contr[13] = -27/64 * t719 * t409 * t713 * t10 * t344
    t723 = -P2 * Q1 + t308
    t728 = 2 * t38 * t21 + t22 + t65 + 1
    t730 = t25 + t204
    t736 = cos(t558)
    t738 = t736 * t104 * t420
    contr[14] = -9/8 * t738 * t556 * t413 * t409 * t730 * cdelta * t16 * t728 * t723 * t10 * t425
    t742 = t10 * A
    t743 = sdelta * t742
    t745 = 3/2 * skm - 1/2
    t747 = 6 * t354
    t758 = t556 * t413 * C
    contr[15] = 27/16 * t422 * t758 * t2 * (t350 - t747 - t360 - 10 * t366 - 5 * t376 - 2 * t385 - 3 * t398 + 2 * t405) * t745 * t343 * t743
    t761 = cdelta * A
    t764 = 4 * t112 * t635 * t445
    t769 = t16 * t745
    contr[16] = -9/8 * t483 * t758 * t769 * t2 * t343 * t10 * (t427 + t431 - t764 + t442 - t448 - t454 - t461 - t467 + t475) * t761
    t775 = t348 * t674
    t776 = 10 * t491
    t785 = t2 * t745
    contr[17] = -27/16 * t539 * t758 * t785 * (t775 - t776 - 9 * t497 + 10 * t503 - 5 * t510 + 18 * t517 + 5 * t527 - 2 * t532) * t343 * t743
    t791 = cdelta * t343
    t792 = t742 * t791
    t793 = t551 * t548
    t799 = -Q1 * t347 + t543
    contr[18] = -9/4 * t559 * t105 * t102 * t417 * t91 * t799 * C * t16 * t785 * t793 * t792
    t809 = t10 * A * t343
    t811 = t566 / 2
    t812 = 3 * t568
    contr[19] = -27/8 * t626 * t758 * (-t811 - t812 + t575 / 2 - 5 * t580 + 5/2 * t590 - t599 + 3/2 * t609 + t618) * t2 * t745 * sdelta * t809
    t824 = t428 * t269
    t825 = 4 * t638
    contr[20] = 9/4 * t671 * t758 * t769 * t2 * t10 * t761 * (t631 + t824 - t825 - 2 * t641 - 10 * t646 + 2 * t649 - 4 * t656 + 2 * t659 + t664) * t343
    t840 = t428 * t306 * t16
    t841 = 5 * t677
    contr[21] = 27/8 * t718 * t758 * t785 * (t840 + t841 - 9/2 * t682 - 5 * t687 - 5/2 * t693 - 9 * t699 + 5/2 * t706 + t711) * sdelta * t809
    contr[22] = 9/2 * t736 * t105 * t102 * t418 * t730 * C * t723 * t769 * t2 * t728 * t792
    t863 = C ^ 2
    t864 = sdelta * t863
    t866 = t745 ^ 2
    contr[23] = 81/16 * t423 * t866 * t546 * t407 * t864
    t872 = t791 * t478
    contr[24] = 9/8 * t484 * t872 * t866 * t476 * t863
    t875 = t10 * t864
    contr[25] = 135/16 * t540 * t866 * t534 * t343 * t875
    contr[26] = -9/4 * t561 * t556 * t91 * t544 * t872 * t551 * t866 * t548 * t863
    contr[27] = -27/16 * t627 * t620 * t866 * t343 * t875
    contr[28] = 9/2 * t672 * t872 * t866 * t666 * t863
    contr[29] = -27/16 * t719 * t866 * t343 * t713 * t875
    contr[30] = -9/2 * t738 * t556 * t413 * t728 * t730 * t723 * t791 * t478 * t866 * t863
    t951 = t101 * t556
    contr[31] = -27/64 * t107 * t951 * t413 * t343 * sdelta * t9 * (t350 - t747 - t359 * t345 * (t356 + t16 - 8/3) - 10 * t502 * P2 * (t356 + t362 + 16/15) - 5 * t375 * t345 * (t368 + 14/5 * t493 + t372 - 8/15) - 2 * t384 * P2 * (t368 + t38 * (-t378 + 16/3) - t381 + 16/3) - 3 * t397 * t345 * (t387 + t65 * (-t388 + 8/9) + t38 * (-t391 + 8/9) - t394 + 4/9) + 2 * t404 * t76 * P2 * (t368 - 4/3 * t38 + t16 - 4/3)) * t10
    t956 = t134 * Q2
    t969 = 11/2 * t22
    t974 = 3 * t22
    contr[32] = 9/32 * t484 * t343 * t16 * (t427 + t431 - t764 + 8 * t115 * t956 * t114 - 10 * t446 * (t21 - 9/5) * t21 - 8 * t125 * (t22 + t462 - 1) * Q2 * t114 - 4 * t459 * t345 * (t352 - t969 + t462 - 3/2) - 8 * Q1 * (t352 - t974 + t21 - 1) * Q2 * t114 + t475) * t9 * t265
    t985 = sdelta * t11
    t994 = t369 - 8/5
    t1000 = t511 - 8/9
    t1006 = t499 + 4/5
    t1008 = t522 - 12/5
    contr[33] = 27/64 * t192 * t951 * t413 * t343 * (t775 - t776 - 9 * t359 * t345 * (t493 + t494 - 4/9) + 10 * t502 * P2 * (t493 - t499 - 4/5) - 5 * t375 * t345 * (t505 + t38 * t994 + t372 - 4/5) + 18 * t384 * P2 * (t505 + t38 * t1000 + t514 - 4/3) + 5 * Q2 * (t65 * t1006 + t38 * t1008 + t372 + t519) * t445 - 2 * (t505 + 4 * t38 + t16) * t528 * t183) * t985
    contr[34] = 9/8 * t561 * t556 * t91 * t343 * t266 * t793 * t10 * cdelta * t799
    contr[35] = 27/32 * t262 * t951 * t413 * t343 * (-t811 - t812 + t115 * (t570 + t571 - 16/3) * t445 / 2 - 5 * t686 * (t570 - t576 + 8/5) * Q2 + 5/2 * t589 * (t582 + t21 * (t583 - 16/15) + t586 - 16/15) * t345 - t38 * P1 * (t582 + t21 * (-t592 + 32/3) - t595 + 40/3) * t204 + 3/2 * t542 * (t601 - t689 / 9 + t21 * (-t604 + 32/9) - t394 + 4/9) * t345 + P1 * t253 * Q2 * (t582 + t21 * (t613 - 4) + t16 - 4/3) * t144) * t985
    t1085 = 11 * t21
    contr[36] = -9/16 * t672 * t16 * t9 * (t631 + t824 - t825 - 2 * t640 * t956 - 10 * t645 * P2 * (t22 - 9/5 * t21 + 11/5) + 2 * t648 * (t22 + t462 + 11) * Q2 - 4 * t38 * P1 * P2 * (t352 - t969 - t1085 + 3/2) + 2 * t658 * (t352 - t974 - t1085 + 1) * Q2 + t281 * t280 * (t22 + t449 + 1) * t114) * t10 * t791
    contr[37] = -27/32 * t337 * t951 * t413 * sdelta * t9 * t10 * t343 * (t840 + t841 - 9/2 * t574 * t345 * (t679 + t494 - 4/9) - 5 * t65 * P1 * (t679 - t499 - 4/5) * t204 - 5/2 * t589 * t345 * (t689 + t21 * t994 + t372 - 4/5) - 9 * t38 * (t689 + t21 * t1000 + t514 - 4/3) * P1 * t204 + 5/2 * t542 * t345 * (t22 * t1006 + t21 * t1008 + t372 + t701) + (t689 + t449 + t16) * t708 * t330)
    contr[38] = -9/4 * t738 * t556 * t413 * t730 * t266 * t728 * t10 * t343 * cdelta * t723
    
    contr = sum(contr)
    return contr;
end

function meandZ3cdeltadpsigMdpsihOsdelta_Gravity_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,A,B,C,mu)
    GG = 1+Q1^2+Q2^2
    contr = zeros(38)
    t1 = sin(psih)
    t3 = 3 * skm - 1
    t10 = (A * t3 - 2 * C * skm + C * (1 - skm)) ^ 2
    t12 = mu ^ 2
    t13 = P1 ^ 2
    t14 = P2 ^ 2
    t17 = sdelta ^ 2
    t18 = t17 * (t13 - 5/13 * t14 + 6/13)
    t19 = 20/13 * t13
    t20 = 4/13 * t14
    t22 = Q2 ^ 2
    t23 = t22 ^ 2
    t24 = Q2 * t23
    t26 = P1 * Q1
    t27 = t17 - 4/3
    t28 = P2 * t27
    t33 = 2 * t14
    t36 = 8/13 * t13
    t39 = Q1 ^ 2
    t48 = Q2 * t22
    t55 = t22 * P2
    t66 = t39 ^ 2
    t77 = Q1 - 1
    t80 = Q1 + 1
    t90 = t39 + t22 + 1
    t91 = t90 ^ 2
    t93 = 0.1e1 / t90 / t91
    t94 = sma ^ 2
    t95 = t94 ^ 2
    t97 = 0.1e1 / t94 / t95
    t99 = eta ^ 2
    t100 = t99 ^ 2
    t102 = 0.1e1 / t99 / t100
    t103 = 0.1e1 / Jg
    t105 = 0.1e1 / n
    t106 = t105 * t103 * t102
    t107 = t106 * t97 * t93
    contr[1] = 39/64 * t107 * (t24 * (t18 - t19 + t20 - 12/13) - 54/13 * t23 * t28 * t26 + t48 * (t39 * (t17 * (-10/13 * t13 + t33 + 12/13) + t36 - 40/13 * t14 - 24/13) + t17 * (-64/13 * t13 + 8/13 * t14 - 42/13) + 80/13 * t13 - 16/13 * t14 + 48/13) - 36/13 * t55 * (Q1 - 2) * t27 * Q1 * (Q1 + 2) * P1 + Q2 * (t66 * (t17 * (-23/13 * t13 + 31/13 * t14 + 6/13) + 28/13 * t13 - 44/13 * t14 - 12/13) + t39 * (t17 * (t36 - 64/13 * t14 - 42/13) - 16/13 * t13 + 80/13 * t14 + 48/13) + t18 - t19 + t20 - 12/13) + 18/13 * P2 * (t39 + 1) * t80 * t27 * P1 * Q1 * t77) * t12 * t10 * t1
    t109 = 2 * psih
    t110 = sin(t109)
    t111 = sdelta * t110
    t112 = t13 - t14
    t113 = t39 * t66
    t115 = P1 * P2
    t116 = Q1 * t66
    t120 = -t112
    t121 = 5 * t120
    t122 = t22 * t121
    t123 = 9 * t14
    t126 = Q1 * t39
    t135 = t22 - 5
    t140 = t23 * t112
    t145 = -1 + Q2
    t147 = Q2 + 1
    contr[2] = -9/32 * t106 * t97 * t93 * t10 * t12 * cdelta * (t113 * t112 + 8 * Q2 * t116 * t115 + t66 * (t122 - t13 + t123 + 6) - 40 * Q2 * t126 * t115 + t39 * (30 * t22 * t112 + t23 * t121 - t123 + t13 - 6) - 8 * Q1 * t135 * t48 * t115 + t147 * t145 * (t140 + t22 * (-8 * t13 - 6) + t13 - t14)) * t111
    t158 = 3 * psih
    t159 = sin(t158)
    t161 = t12 * t10
    t186 = P2 * t26
    contr[3] = -27/64 * t107 * (t24 * t112 - 10 * t23 * P2 * t26 + t48 * (10 * t39 * t120 - 4/3 * t13 - 4/3 * t14 - 2) + 20 * t55 * P1 * t126 + Q2 * (-t66 * t121 + t39 * (4 * t13 + 4 * t14 + 6) + t13 - t14) - 2 * P2 * P1 * t116 + 2 * t186) * t161 * t17 * t159
    t193 = cos(psih)
    t197 = t17 * (1/3 - 5/18 * t13 + 13/18 * t14)
    t198 = 2/9 * t13
    t199 = 10/9 * t14
    t202 = t27 * P1
    t203 = P2 * Q2
    t211 = 4/9 * t14
    t248 = t22 + 1
    t251 = t145 * Q2
    t252 = P2 * t147
    contr[4] = -27/32 * t107 * t161 * (t116 * (t197 + t198 - t199 - 2/3) - 3 * t66 * t203 * t202 + t126 * (t22 * (t17 * (13/9 * t13 - 5/9 * t14 + 2/3) - 4/3 + t211 - 20/9 * t13) + t17 * (-7/3 + 4/9 * t13 - 32/9 * t14) - 8/9 * t13 + 40/9 * t14 + 8/3) - 2 * t39 * (Q2 + 2) * t203 * t27 * (Q2 - 2) * P1 + Q1 * (t23 * (t17 * (31/18 * t13 - 23/18 * t14 + 1/3) - 2/3 + 14/9 * t14 - 22/9 * t13) + t22 * (t17 * (-32/9 * t13 + t211 - 7/3) + 8/3 + 40/9 * t13 - 8/9 * t14) + t197 + t198 - t199 - 2/3) + t252 * t251 * t27 * P1 * t248) * t193
    t260 = cos(t109)
    t261 = sdelta * t260
    t262 = t12 * cdelta
    t267 = 2 * Q2 * t120
    t277 = 2 * Q2
    t278 = t22 + t277 - 1
    t279 = t22 - t277 - 1
    t288 = 2 * t13
    contr[5] = 9/16 * t106 * t97 * t93 * (t113 * t115 + t116 * t267 - 5 * t66 * t248 * t115 + 6 * t126 * (t13 - 7/3 * t14 - 1) * Q2 - 5 * t39 * t279 * t278 * t115 + 2 * Q1 * Q2 * (t140 + t22 * (-7 * t13 + 3 * t14 - 3) + t288 + t33 + 3) + t279 * t278 * t248 * t115) * t10 * t262 * t261
    t301 = cos(t158)
    t303 = t112 / 2
    t305 = P1 * Q2
    t309 = 2/3 * t13
    t310 = 2/3 * t14
    t327 = P2 * t305
    contr[6] = 27/32 * t107 * t12 * t10 * (t116 * t303 + 5 * t66 * P2 * t305 + t126 * (t122 + t309 + t310 + 1) - 10 * t39 * P2 * t48 * P1 + Q1 * (5/2 * t23 * t112 + t22 * (-t288 - t33 - 3) + t13 / 2 - t14 / 2) + P2 * t24 * P1 - t327) * t17 * t301
    t333 = A ^ 2
    t335 = -t309 - t310 + eta + 1
    t337 = P1 - P2
    t338 = t337 * t27
    t339 = P1 + P2
    t340 = t48 * t23
    t342 = t340 * t339 * t338
    t344 = t22 * t23
    t346 = t344 * t26 * t28
    t348 = t39 * t27
    t351 = t24 * t339
    t352 = t351 * t337 * (t348 + t17 - 2)
    t354 = 7/15 * t17
    t358 = t23 * Q1 * (t348 + t354 - 2/15) * t115
    t360 = t66 * t27
    t361 = 14/5 * t17
    t364 = t17 / 5
    t367 = t48 * t339
    t368 = t367 * t337 * (t360 + t39 * (t361 - 44/15) + t364 - 2/5)
    t370 = 18 * t17
    t373 = 19/3 * t17
    t376 = t22 * t26
    t377 = t376 * (t360 + t39 * (-t370 + 20) - t373 + 26/3) * P2
    t379 = t113 * t27
    t380 = 25/9 * t17
    t383 = 13/9 * t17
    t386 = t17 / 3
    t389 = t339 * Q2
    t390 = t389 * t337 * (t379 + t66 * (-t380 + 26/9) + t39 * (-t383 + 2) - t386 + 4/9)
    t396 = Q1 * t80 * P1
    t397 = t396 * t77 * (t360 - 2/3 * t39 + t17 - 4/3) * P2
    t399 = -t342 / 3 + 2 * t346 + t352 / 3 + 10/3 * t358 + 5/3 * t368 + 2/3 * t377 + t390 - 2/3 * t397
    t401 = t3 ^ 2
    t404 = t91 ^ 2
    t405 = 0.1e1 / t404
    t406 = 1 + eta
    t407 = t406 ^ 2
    t409 = 0.1e1 / t406 / t407
    t410 = t409 * t405
    t412 = t106 * t97 * t410
    contr[7] = -81/64 * t412 * t401 * t399 * t12 * t335 * t333 * t1
    t416 = t66 ^ 2
    t417 = t416 * t112
    t418 = t126 * t66
    t421 = 8 * Q2 * t418 * t115
    t429 = (t22 - 6) * Q2
    t432 = 8 * t116 * t429 * t115
    t435 = t339 * t337
    t436 = t66 * t435
    t438 = 10 * t436 * (t22 - 17/5) * t22
    t439 = 4 * t22
    t441 = (t23 - t439 + 5) * Q2
    t444 = 8 * t126 * t441 * t115
    t449 = t39 * t339
    t451 = 4 * t449 * t337 * (t344 - 3/2 * t23 - 10 * t22 - 3/2)
    t452 = 2 * t22
    t454 = (t23 - t452 - 5) * t48
    t457 = 8 * Q1 * t454 * t115
    t458 = t145 ^ 2
    t461 = t147 ^ 2
    t465 = t339 * t337 * t147 * t461 * t145 * t458 * t248
    t466 = t417 + t421 + t113 * (4 * t22 * t120 - 6 * t13 + 6 * t14) + t432 - t438 - t444 - t451 - t457 + t465
    t474 = t105 * t103 * t102 * t97
    t475 = t474 * t409 * t405 * t401
    contr[8] = -9/32 * t475 * t262 * t466 * t335 * t333 * t111
    t485 = t17 * t344 * Q1 * t115
    t487 = t17 * t39
    t488 = t17 / 9
    t491 = t351 * t337 * (t487 + t488 - 2/9)
    t493 = 3/5 * t17
    t496 = t23 * t26
    t497 = t496 * P2 * (t487 - t493 - 2/5)
    t499 = t17 * t66
    t500 = t361 - 4/5
    t504 = t367 * (t499 + t39 * t500 + t364 - 2/5) * t337
    t505 = 14/9 * t17
    t506 = t505 - 4/9
    t508 = 7/9 * t17
    t511 = t376 * (t499 + t39 * t506 + t508 - 2/3) * P2
    t513 = t17 * t113
    t514 = t493 + 2/5
    t516 = 7/5 * t17
    t517 = t516 - 6/5
    t521 = t389 * t337 * (t39 * t517 + t66 * t514 + t364 + t513)
    t522 = t80 * t77
    t526 = (t499 + 2 * t39 + t17) * t522 * t186
    t528 = t340 * t112 * t17 / 5 - 2 * t485 - 9/5 * t491 + 2 * t497 - t504 + 18/5 * t511 + t521 - 2/5 * t526
    contr[9] = -135/64 * t412 * t401 * t12 * t528 * t335 * t333 * t159
    t534 = 4 * psih
    t535 = sin(t534)
    t536 = sdelta * t535
    t537 = Q1 * t339
    t538 = t337 * Q2
    t539 = t537 - t538
    t542 = t12 * t335
    t543 = t39 + t22 - 1
    t545 = Q1 * t337 + t389
    t546 = t545 * t543
    t550 = t409 * t93
    contr[10] = 9/16 * t474 * t550 * t401 * cdelta * t546 * t542 * t539 * t333 * t536
    t555 = t418 * t339 * t338
    t557 = t113 * t202 * t203
    t559 = t22 * t27
    t560 = 11/3 * t17
    t563 = t116 * t339
    t564 = t563 * t337 * (t559 + t560 - 14/3)
    t565 = 17/15 * t17
    t569 = t66 * P1 * (t559 - t565 + 22/15) * t203
    t571 = t23 * t27
    t572 = 2/3 * t17
    t575 = 11/15 * t17
    t578 = t126 * t339
    t579 = t578 * t337 * (t571 + t22 * (t572 - 4/5) + t575 - 14/15)
    t581 = 22/3 * t17
    t584 = 9 * t17
    t588 = t39 * P1 * (t571 + t22 * (-t581 + 28/3) - t584 + 34/3) * t203
    t590 = t344 * t27
    t593 = 7/3 * t17
    t598 = t537 * (t590 + t23 * (-t488 + 2/9) + t22 * (-t593 + 26/9) - t386 + 4/9) * t337
    t602 = 8/3 * t17
    t607 = (t571 + t22 * (t602 - 10/3) + t17 - 4/3) * P1 * t147 * P2 * t251
    t609 = t555 + 6 * t557 - t564 + 10 * t569 - 5 * t579 + 2 * t588 - 3 * t598 - 2 * t607
    contr[11] = 27/64 * t412 * t401 * t542 * t333 * t609 * t193
    t616 = t416 * t115
    t620 = t22 + 3/2
    t622 = t113 * P1
    t623 = t622 * P2 * t620
    t625 = t116 * t435
    t626 = t625 * t429
    t630 = t66 * P1
    t631 = t630 * P2 * (t23 - 17/5 * t22 + 1)
    t633 = t126 * t435
    t634 = t633 * t441
    t641 = t39 * P1 * (t22 - 3) * P2 * (t23 + 3/2 * t22 - 1/2)
    t643 = Q1 * t435
    t644 = t643 * t454
    t645 = t23 ^ 2
    t649 = (t645 - 2 * t344 - 10 * t23 - t452 + 1) * t115
    t651 = -t616 / 2 + t418 * t112 * Q2 + 2 * t623 + t626 + 5 * t631 - t634 + 2 * t641 - t644 - t649 / 2
    contr[12] = -9/8 * t475 * cdelta * t651 * t542 * t333 * t261
    t659 = t112 * t17
    t662 = t17 * t622 * t203
    t664 = t17 * t22
    t667 = t563 * t337 * (t664 + t488 - 2/9)
    t671 = t66 * t115
    t672 = t671 * Q2 * (t664 - t493 - 2/5)
    t674 = t17 * t23
    t678 = t578 * t337 * (t674 + t22 * t500 + t364 - 2/5)
    t684 = t39 * P1 * (t674 + t22 * t506 + t508 - 2/3) * t203
    t686 = t17 * t344
    t691 = t537 * t337 * (t22 * t517 + t23 * t514 + t364 + t686)
    t693 = t147 * t145
    t696 = (t674 + t452 + t17) * t693 * t327
    t698 = t418 * t659 + 10 * t662 - 9 * t667 - 10 * t672 - 5 * t678 - 18 * t684 + 5 * t691 + 2 * t696
    contr[13] = 27/64 * t412 * t401 * t698 * t12 * t335 * t333 * t301
    t703 = cos(t534)
    t704 = sdelta * t703
    t708 = -P2 * Q1 + t305
    t712 = 2 * t39 * t22 + t23 + t66 + 1
    t716 = t26 + t203
    contr[14] = 9/8 * t474 * t410 * t401 * t716 * cdelta * t712 * t708 * t12 * t335 * t333 * t704
    t724 = 3/2 * skm - 1/2
    t726 = 6 * t346
    t738 = t474 * t409 * t405 * C
    contr[15] = -27/16 * t738 * t3 * (t342 - t726 - t352 - 10 * t358 - 5 * t368 - 2 * t377 - 3 * t390 + 2 * t397) * t724 * t335 * t12 * A * t1
    t741 = cdelta * A
    t745 = 4 * t113 * t620 * t435
    t751 = C * t724
    t753 = t474 * t410 * t751
    contr[16] = 9/8 * t753 * t3 * t335 * t12 * (t417 + t421 - t745 + t432 - t438 - t444 - t451 - t457 + t465) * t741 * t111
    t757 = t340 * t659
    t758 = 10 * t485
    t767 = t3 * t724
    contr[17] = 27/16 * t738 * t767 * (t757 - t758 - 9 * t491 + 10 * t497 - 5 * t504 + 18 * t511 + 5 * t521 - 2 * t526) * t335 * t12 * A * t159
    t771 = cdelta * t335
    t773 = t12 * A
    t779 = -Q1 * t339 + t538
    t783 = t106 * t97 * t409
    contr[18] = 9/4 * t783 * t93 * t779 * t751 * t3 * t546 * t773 * t771 * t536
    t789 = t555 / 2
    t790 = 3 * t557
    contr[19] = 27/8 * t738 * (-t789 - t790 + t564 / 2 - 5 * t569 + 5/2 * t579 - t588 + 3/2 * t598 + t607) * t3 * t724 * t12 * A * t335 * t193
    t800 = t418 * t267
    t801 = 4 * t623
    contr[20] = -9/4 * t753 * t3 * t12 * t741 * (t616 + t800 - t801 - 2 * t626 - 10 * t631 + 2 * t634 - 4 * t641 + 2 * t644 + t649) * t335 * t261
    t818 = t418 * t303 * t17
    t819 = 5 * t662
    contr[21] = -27/8 * t738 * t767 * (t818 + t819 - 9/2 * t667 - 5 * t672 - 5/2 * t678 - 9 * t684 + 5/2 * t691 + t696) * t12 * A * t335 * t301
    contr[22] = -9/2 * t783 * t405 * t716 * C * t708 * t724 * t3 * t712 * t773 * t771 * t704
    t842 = C ^ 2
    t845 = t724 ^ 2
    contr[23] = -81/16 * t412 * t845 * t542 * t399 * t842 * t1
    t856 = t474 * t409 * t405 * cdelta
    contr[24] = -9/8 * t856 * t542 * t845 * t466 * t842 * t111
    contr[25] = -135/16 * t412 * t845 * t528 * t335 * t12 * t842 * t159
    contr[26] = 9/4 * t474 * t550 * t539 * cdelta * t542 * t545 * t845 * t543 * t842 * t536
    contr[27] = 27/16 * t412 * t609 * t845 * t335 * t12 * t842 * t193
    contr[28] = -9/2 * t856 * t542 * t845 * t651 * t842 * t261
    contr[29] = 27/16 * t412 * t845 * t335 * t698 * t12 * t842 * t301
    contr[30] = 9/2 * t474 * t410 * t712 * t716 * t708 * cdelta * t542 * t845 * t842 * t704
    contr[31] = 27/64 * t412 * t335 * t10 * (t342 - t726 - t351 * t337 * (t348 + t17 - 8/3) - 10 * t496 * P2 * (t348 + t354 + 16/15) - 5 * t367 * t337 * (t360 + 14/5 * t487 + t364 - 8/15) - 2 * t376 * P2 * (t360 + t39 * (-t370 + 16/3) - t373 + 16/3) - 3 * t389 * t337 * (t379 + t66 * (-t380 + 8/9) + t39 * (-t383 + 8/9) - t386 + 4/9) + 2 * t396 * t77 * P2 * (t360 - 4/3 * t39 + t17 - 4/3)) * t12 * t1
    t941 = t135 * Q2
    t954 = 11/2 * t23
    t959 = 3 * t23
    contr[32] = -9/32 * t474 * t409 * t405 * t335 * (t417 + t421 - t745 + 8 * t116 * t941 * t115 - 10 * t436 * (t22 - 9/5) * t22 - 8 * t126 * (t23 + t452 - 1) * Q2 * t115 - 4 * t449 * t337 * (t344 - t954 + t452 - 3/2) - 8 * Q1 * (t344 - t959 + t22 - 1) * Q2 * t115 + t465) * t161 * cdelta * t111
    t982 = t361 - 8/5
    t988 = t505 - 8/9
    t994 = t493 + 4/5
    t996 = t516 - 12/5
    contr[33] = -27/64 * t412 * t335 * (t757 - t758 - 9 * t351 * t337 * (t487 + t488 - 4/9) + 10 * t496 * P2 * (t487 - t493 - 4/5) - 5 * t367 * t337 * (t499 + t39 * t982 + t364 - 4/5) + 18 * t376 * P2 * (t499 + t39 * t988 + t508 - 4/3) + 5 * Q2 * (t39 * t996 + t66 * t994 + t364 + t513) * t435 - 2 * (t499 + 4 * t39 + t17) * t522 * t186) * t10 * t12 * t159
    contr[34] = -9/8 * t474 * t550 * t335 * t10 * t546 * t262 * t779 * t536
    contr[35] = -27/32 * t412 * t335 * (-t789 - t790 + t116 * (t559 + t560 - 16/3) * t435 / 2 - 5 * t671 * (t559 - t565 + 8/5) * Q2 + 5/2 * t578 * (t571 + t22 * (t572 - 16/15) + t575 - 16/15) * t337 - t39 * P1 * (t571 + t22 * (-t581 + 32/3) - t584 + 40/3) * t203 + 3/2 * t537 * (t590 - t674 / 9 + t22 * (-t593 + 32/9) - t386 + 4/9) * t337 + P1 * t252 * Q2 * (t571 + t22 * (t602 - 4) + t17 - 4/3) * t145) * t10 * t12 * t193
    t1074 = 11 * t22
    contr[36] = 9/16 * t474 * t409 * t405 * t10 * (t616 + t800 - t801 - 2 * t625 * t941 - 10 * t630 * P2 * (t23 - 9/5 * t22 + 11/5) + 2 * t633 * (t23 + t452 + 11) * Q2 - 4 * t39 * P1 * P2 * (t344 - t954 - t1074 + 3/2) + 2 * t643 * (t344 - t959 - t1074 + 1) * Q2 + t279 * t278 * (t23 + t439 + 1) * t115) * t542 * cdelta * t261
    contr[37] = 27/32 * t412 * t10 * t542 * (t818 + t819 - 9/2 * t563 * t337 * (t664 + t488 - 4/9) - 5 * t66 * P1 * (t664 - t493 - 4/5) * t203 - 5/2 * t578 * t337 * (t674 + t22 * t982 + t364 - 4/5) - 9 * t39 * (t674 + t22 * t988 + t508 - 4/3) * P1 * t203 + 5/2 * t537 * t337 * (t22 * t996 + t23 * t994 + t364 + t686) + (t674 + t439 + t17) * t693 * t327) * t301
    contr[38] = 9/4 * t474 * t410 * t716 * t10 * t712 * t12 * t771 * t708 * t704
       

    contr = sum(contr)
    return contr;
end

###################################

function gethigherorderterms_magnetic(k,m,skm,smk,mM1KK,KK,EE,PP,T2,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,IMz,muM,cpa1,cpa2,cpa3,typeofvariables)

    GG = 1+Q1^2+Q2^2;
    cpa1EQ = ((-Q1^2 + Q2^2 + 1)*cpa1 + 2*Q1*(Q2*cpa2 - cpa3))/GG;
    cpa2EQ = ((Q1^2 - Q2^2 + 1)*cpa2 + 2*Q2*(Q1*cpa1 + cpa3))/GG
    cpa3EQ = (-Q1^2*cpa3 - Q2^2*cpa3 + 2*Q1*cpa1 - 2*Q2*cpa2 + cpa3)/GG

    if k!=0.0

        dmdJl        = -pi*(m + k)^(3/2)/(sqrt(k)*sqrt(1 + k)*KK*Jg);
        dmdJg        = 2*(m + k)^2.0*(PP - smk*KK)/(KK*k*Jg);
        dcdeltadJh   = 1/Jg;
        dcdeltadJg   = -cdelta*dcdeltadJh 
        dZ3dm        = meandZ3dm_Magnetic(k,m,skm,smk,mM1KK,KK,EE,PP,T2,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ);
        dZ3dJgP1     = meandZ3dJgP1_Magnetic(k,m,skm,smk,mM1KK,KK,EE,PP,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ);
        dZ3dcdeltaP1 = meandZ3dcdeltaP1_Magnetic(k,m,skm,smk,mM1KK,KK,EE,PP,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ);
        dZ3dcdeltaP2 = meandZ3dcdeltaP2_Magnetic(k,m,skm,smk,mM1KK,KK,EE,PP,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ);
        dZ3dJl       = dmdJl*dZ3dm;
        dZ3dJgP1     = dmdJg*dZ3dm + dZ3dJgP1 + dZ3dcdeltaP1*dcdeltadJg;
        dZ3dJgP2     = dZ3dcdeltaP2*dcdeltadJg;
        dZ3dJhP1     = dZ3dcdeltaP1*dcdeltadJh;
        dZ3dJhP2     = dZ3dcdeltaP2*dcdeltadJh;
        dZ3dpsih     = meandZ3dpsih_Magnetic(k,m,skm,smk,mM1KK,KK,EE,PP,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ);
        if typeofvariables != 1
            cdeltadZ3dpsigMdZ3psihOsdelta = meandZ3cdeltadpsigMdpsihOsdelta_Magnetic(k,m,skm,smk,mM1KK,KK,EE,PP,T2,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ);
        end
    else
        dcsigmadJl   = 1/Jg
        dcsigmadJg   = -sqrt(skm)*dcsigmadJl
        dcdeltadJh   = 1/Jg;
        dcdeltadJg   = -cdelta*dcdeltadJh 
        dZ3dcsigma   = meandZ3dcsigma1_Magnetic_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ);
        dZ3dJgP1     = meandZ3dJgP1_Magnetic_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ);
        dZ3dcdeltaP1 = meandZ3dcdelta1_Magnetic_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ);
        dZ3dcdeltaP2 = meandZ3dcdelta2_Magnetic_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ);
        dZ3dJl       = dZ3dcsigma*dcsigmadJl;
        dZ3dJgP1     = dZ3dcsigma*dcsigmadJg + dZ3dJgP1 + dZ3dcdeltaP1*dcdeltadJg;
        dZ3dJgP2     = dZ3dcdeltaP2*dcdeltadJg;
        dZ3dJhP1     = dZ3dcdeltaP1*dcdeltadJh;
        dZ3dJhP2     = dZ3dcdeltaP2*dcdeltadJh;
        dZ3dpsih     = meandZ3dpsih_Magnetic_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ);
        if typeofvariables != 1
            cdeltadZ3dpsigMdZ3psihOsdelta = meandZ3cdeltadpsigMdpsihOsdelta_Magnetic_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ);
        end
    end

    
    if typeofvariables == 1
        dZ3dJg     =  dZ3dJgP1 + dZ3dJgP2/sdelta;
        dZ3dJh     =  dZ3dJhP1 + dZ3dJhP2/sdelta;
        out = zeros(6);
        out[3] = -dZ3dpsih;
        out[4] = dZ3dJl;
        out[5] = dZ3dJg;
        out[6] = dZ3dJh;

    else        
        out = zeros(7);
        out[3] = -dZ3dpsih;
        out[4] = dZ3dJl;
        out[5] = dZ3dJgP1 + cdelta*dZ3dJhP1 - psih/Jg*dZ3dpsih;
        out[6] = -Jg*sdelta*sin(psih)*dZ3dJhP1 - Jg*sin(psih)*dZ3dJhP2 + cdelta*cos(psih)*cdeltadZ3dpsigMdZ3psihOsdelta;
        out[7] =  Jg*sdelta*cos(psih)*dZ3dJhP1 + Jg*cos(psih)*dZ3dJhP2 + cdelta*sin(psih)*cdeltadZ3dpsigMdZ3psihOsdelta;
    end

    return out;


end

function meandZ3dm_Magnetic(k,m,skm,smk,mM1KK,KK,EE,PP,T2,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ)
    contr = zeros(9)
    t1 = muM ^ 2
    t8 = m - 2
    t10 = (-1 + (T2 + 1) * m) * k * KK + t8 * EE
    t11 = IMz ^ 2
    t13 = t11 * t10 * t1 * sdelta
    t14 = P1 ^ 2
    t15 = P2 ^ 2
    t16 = t14 - t15
    t20 = cpa1EQ * P1 * P2
    t22 = cpa3EQ * (cpa2EQ * t16 / 2 + t20)
    t23 = Q2 ^ 2
    t26 = P1 * P2
    t28 = 2 * cpa2EQ * t26
    t36 = cpa2EQ ^ 2
    t39 = t26 * cpa1EQ * cpa2EQ
    t41 = cpa1EQ ^ 2
    t43 = t14 + 3 * t15 - 3
    t44 = t43 * t41
    t48 = Q1 ^ 2
    t49 = t48 + 1
    t52 = pi ^ 2
    t54 = cos(psih)
    t55 = skm ^ 2
    t56 = t55 * t54
    t59 = KK ^ 2
    t60 = 1 / t59
    t61 = 1 / t8
    t62 = t61 * t60
    t63 = 0.1e1 / GG
    t64 = sma ^ 2
    t65 = t64 ^ 2
    t67 = 0.1e1 / t65 / t64
    t68 = t67 * t63
    t70 = eta ^ 2
    t71 = t70 ^ 2
    t73 = 0.1e1 / t71 / t70
    t74 = 0.1e1 / Jg
    t76 = 0.1e1 / n
    t77 = 0.1e1 / mM1KK
    t79 = 1 / k
    t82 = t79 * t77 * t76 * t74 * t73 * t68 * t62
    contr[1] = -3/16 * t82 * t56 * t52 * (-t23 * t22 + Q2 * (-cpa3EQ * (cpa1EQ * t14 - cpa1EQ * t15 - t28) * Q1 + t36 * (-3/2 * t14 - t15 / 2 + 3/2) - 2 * t39 - t44 / 2) + t49 * t22) * t13
    t86 = t16 * cpa1EQ - t28
    t99 = t14 + t15 / 3 - 1
    t104 = t23 + 1
    t111 = t52 * t11
    t112 = sin(psih)
    contr[2] = 3/32 * t82 * t55 * t112 * t111 * t10 * t1 * sdelta * (t48 * cpa3EQ * t86 + Q1 * (4 * cpa3EQ * Q2 * (cpa2EQ * t14 / 2 - t15 * cpa2EQ / 2 + t20) + t44 + 4 * t39 + 3 * t36 * t99) - cpa3EQ * t104 * t86)
    t117 = t10 * t55
    t120 = t48 + t23 - 1
    t123 = cpa2EQ * t120
    t153 = t73 * t67 * t63 * t61
    contr[3] = -3/64 * t79 * t77 * t76 * t74 * t153 * t60 * (t41 * t43 * t120 + cpa1EQ * (4 * t123 * t26 - 4 * (t14 * Q1 - t15 * Q1 + 2 * Q2 * t26) * cpa3EQ) + 3 * cpa2EQ * (cpa2EQ * t120 * t99 + 8/3 * cpa3EQ * (Q1 * t26 - t14 * Q2 / 2 + t15 * Q2 / 2))) * t1 * cdelta * t111 * t117
    t160 = t23 * cpa2EQ
    t162 = Q2 * Q1
    t163 = cpa1EQ * t162
    t164 = t49 * cpa2EQ
    t170 = 2 * cpa2EQ * t162
    t175 = 2 * t163
    t181 = cpa1EQ + cpa2EQ
    t183 = cpa1EQ - cpa2EQ
    t185 = P1 * t181 + t183 * P2
    t188 = P1 * t183 - t181 * P2
    t196 = -2/3 * t14 - 2/3 * t15 + eta + 1
    t202 = 1 + eta
    t203 = t202 ^ 2
    t209 = t79 * t77 * t74 * t76 / t203 / t202
    t210 = t209 * t73 * t68 * t62
    t211 = t210 * t196 * t56 * t52 * (cpa3EQ * (t14 * (-t160 / 2 - t163 + t164 / 2) + P1 * P2 * (-t23 * cpa1EQ + t49 * cpa1EQ + t170) - t15 * (-t160 - t175 + t164) / 2) + Q2 * t188 * t185 / 2) * t13
    contr[4] = 3/16 * t211
    t215 = -t104
    t217 = cpa1EQ * t215 + t48 * cpa1EQ + t170
    t234 = t210 * (cpa3EQ * (t14 * t217 - 2 * P1 * (cpa2EQ * t215 + cpa2EQ * t48 - t175) * P2 - t15 * t217) - t188 * Q1 * t185) * t196 * t55 * t112 * t52 * t13
    contr[5] = -3/32 * t234
    t240 = cpa3EQ * Q2
    t244 = t41 * t120 + 4 * cpa3EQ * Q1 * cpa1EQ - cpa2EQ * (t123 - 4 * t240)
    t266 = t209 * t153 * t60 * t1 * t196 * cdelta * t11 * t52 * (t14 * t244 - 4 * P1 * P2 * (cpa1EQ * (t123 - 2 * t240) + 2 * cpa2EQ * cpa3EQ * Q1) - t15 * t244) * t117
    contr[6] = -3/64 * t266
    contr[7] = -21/16 * t211
    contr[8] = 21/32 * t234
    contr[9] = 21/64 * t266
      
    
    contr=sum(contr);
    return contr;
end

function meandZ3dJgP1_Magnetic(k,m,skm,smk,mM1KK,KK,EE,PP,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ)
    contr = zeros(9)
    t1 = cos(psih)
    t2 = P1 ^ 2
    t3 = P2 ^ 2
    t4 = t2 - t3
    t8 = cpa1EQ * P1 * P2
    t10 = cpa3EQ * (cpa2EQ * t4 / 2 + t8)
    t11 = Q2 ^ 2
    t15 = P1 * P2
    t17 = 2 * t15 * cpa2EQ
    t25 = cpa2EQ ^ 2
    t29 = 4 * t15 * cpa1EQ * cpa2EQ
    t30 = cpa1EQ ^ 2
    t32 = t2 + 3 * t3 - 3
    t33 = t32 * t30
    t36 = Q1 ^ 2
    t37 = t36 + 1
    t42 = muM ^ 2
    t45 = pi ^ 2
    t48 = IMz ^ 2
    t49 = 0.1e1 / GG
    t51 = sma ^ 2
    t52 = t51 ^ 2
    t54 = 0.1e1 / t52 / t51
    t56 = eta ^ 2
    t57 = t56 ^ 2
    t59 = 0.1e1 / t57 / t56
    t60 = Jg ^ 2
    t61 = 0.1e1 / t60
    t63 = KK ^ 2
    t64 = 0.1e1 / t63
    t65 = 0.1e1 / n
    t67 = t65 * t64 * t61 * t59
    contr[1] = -3/32 * t67 * t54 * t49 * t48 * t45 * skm * sdelta * t42 * (2 * t11 * t10 + Q2 * (2 * cpa3EQ * (cpa1EQ * t2 - t3 * cpa1EQ - t17) * Q1 + t25 * (3 * t2 + t3 - 3) + t29 + t33) - 2 * t37 * t10) * t1
    t71 = sin(psih)
    t78 = t4 * cpa1EQ - t17
    t90 = t2 + t3 / 3 - 1
    t95 = t11 + 1
    contr[2] = -3/32 * t67 * t54 * t49 * (t36 * cpa3EQ * t78 + Q1 * (4 * cpa3EQ * Q2 * (t2 * cpa2EQ / 2 - cpa2EQ * t3 / 2 + t8) + t33 + t29 + 3 * t25 * t90) - cpa3EQ * t95 * t78) * t48 * t45 * skm * sdelta * t42 * t71
    t106 = t36 + t11 - 1
    t109 = cpa2EQ * t106
    contr[3] = 3/64 * t65 * t64 * t61 * t59 * t54 * t49 * skm * t42 * (t30 * t32 * t106 + cpa1EQ * (4 * t109 * t15 - 4 * (t2 * Q1 - t3 * Q1 + 2 * t15 * Q2) * cpa3EQ) + 3 * cpa2EQ * (cpa2EQ * t106 * t90 - 4/3 * (-2 * t15 * Q1 + t2 * Q2 - t3 * Q2) * cpa3EQ)) * cdelta * t45 * t48
    t142 = t11 * cpa2EQ
    t143 = Q2 * Q1
    t144 = cpa1EQ * t143
    t146 = t37 * cpa2EQ
    t151 = 2 * cpa2EQ * t143
    t164 = cpa1EQ + cpa2EQ
    t166 = cpa1EQ - cpa2EQ
    t168 = P1 * t164 + t166 * P2
    t171 = P1 * t166 - t164 * P2
    t177 = -2/3 * t2 - 2/3 * t3 + eta + 1
    t187 = 1 + eta
    t188 = t187 ^ 2
    t190 = 0.1e1 / t188 / t187
    t194 = t61 * t65 * t190 * t59 * t64 * t54 * t49 * skm
    t195 = t194 * t42 * sdelta * t48 * t1 * t45 * t177 * (cpa3EQ * (t2 * (-t142 - 2 * t144 + t146) + 2 * P1 * P2 * (-t11 * cpa1EQ + t37 * cpa1EQ + t151) + 2 * (t142 / 2 + t144 - t146 / 2) * t3) + Q2 * t171 * t168)
    contr[4] = -3/32 * t195
    t197 = t45 * t177
    t200 = t36 * cpa1EQ
    t224 = t194 * (cpa3EQ * (t2 * (t95 * cpa1EQ - t151 - t200) - 4 * P1 * P2 * (-t36 * cpa2EQ / 2 + t144 + t95 * cpa2EQ / 2) + t3 * (-t95 * cpa1EQ + t151 + t200)) + t171 * Q1 * t168) * t42 * sdelta * t48 * t71 * t197
    contr[5] = -3/32 * t224
    t231 = cpa3EQ * Q2
    t235 = t30 * t106 + 4 * cpa3EQ * Q1 * cpa1EQ - cpa2EQ * (t109 - 4 * t231)
    t259 = t65 * t59 * t64 * t190 * t54 * t61 * t49 * cdelta * skm * (t2 * t235 - 4 * P1 * P2 * (cpa1EQ * (t109 - 2 * t231) + 2 * cpa2EQ * cpa3EQ * Q1) - t3 * t235) * t42 * t48 * t197
    contr[6] = 3/64 * t259
    contr[7] = 21/32 * t195
    contr[8] = 21/32 * t224
    contr[9] = -21/64 * t259
        

    contr=sum(contr);
    return contr;
end

function meandZ3dcdeltaP1_Magnetic(k,m,skm,smk,mM1KK,KK,EE,PP,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ)
    contr = zeros(3)
    t1 = IMz ^ 2
    t2 = Q1 ^ 2
    t3 = Q2 ^ 2
    t4 = t2 + t3 - 1
    t5 = P1 ^ 2
    t6 = P2 ^ 2
    t10 = cpa1EQ ^ 2
    t12 = P1 * P2
    t13 = cpa2EQ * t4
    t40 = pi ^ 2
    t41 = muM ^ 2
    t45 = 0.1e1 / GG
    t46 = sma ^ 2
    t47 = t46 ^ 2
    t49 = 0.1e1 / t47 / t46
    t51 = eta ^ 2
    t52 = t51 ^ 2
    t54 = 0.1e1 / t52 / t51
    t56 = 0.1e1 / Jg
    t57 = KK ^ 2
    t58 = 0.1e1 / t57
    t60 = 0.1e1 / n
    contr[1] = -3/64 * t60 * t58 * t56 * t54 * t49 * t45 * skm * t41 * t40 * (t10 * (t5 + 3 * t6 - 3) * t4 + cpa1EQ * (4 * t13 * t12 - 4 * (t5 * Q1 - t6 * Q1 + 2 * Q2 * t12) * cpa3EQ) + 3 * cpa2EQ * (cpa2EQ * t4 * (t5 + t6 / 3 - 1) - 4/3 * (-2 * Q1 * t12 + t5 * Q2 - t6 * Q2) * cpa3EQ)) * t1
    t74 = cpa3EQ * Q2
    t78 = t10 * t4 + 4 * cpa3EQ * Q1 * cpa1EQ - cpa2EQ * (t13 - 4 * t74)
    t97 = 1 + eta
    t98 = t97 ^ 2
    t105 = t60 * t54 * t58 / t98 / t97 * t49 * t56 * t45 * skm * (t5 * t78 - 4 * P1 * P2 * (cpa1EQ * (t13 - 2 * t74) + 2 * cpa2EQ * cpa3EQ * Q1) - t6 * t78) * t41 * t1 * (-2/3 * t5 - 2/3 * t6 + eta + 1) * t40
    contr[2] = -3/64 * t105
    contr[3] = 21/64 * t105   
    contr=sum(contr);
    return contr;
end

function meandZ3dcdeltaP2_Magnetic(k,m,skm,smk,mM1KK,KK,EE,PP,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ)
    contr = zeros(6)
    t1 = P1 ^ 2
    t2 = P2 ^ 2
    t3 = t1 - t2
    t7 = cpa1EQ * P1 * P2
    t9 = cpa3EQ * (cpa2EQ * t3 / 2 + t7)
    t10 = Q2 ^ 2
    t14 = P1 * P2
    t16 = 2 * cpa2EQ * t14
    t24 = cpa2EQ ^ 2
    t28 = 4 * t14 * cpa1EQ * cpa2EQ
    t29 = cpa1EQ ^ 2
    t32 = (t1 + 3 * t2 - 3) * t29
    t35 = Q1 ^ 2
    t36 = t35 + 1
    t40 = muM ^ 2
    t43 = pi ^ 2
    t44 = IMz ^ 2
    t46 = 0.1e1 / GG
    t49 = sma ^ 2
    t50 = t49 ^ 2
    t52 = 0.1e1 / t50 / t49
    t53 = eta ^ 2
    t54 = t53 ^ 2
    t56 = 0.1e1 / t54 / t53
    t58 = 0.1e1 / Jg
    t59 = t58 * t56 * t52
    t60 = KK ^ 2
    t61 = 0.1e1 / t60
    t62 = 0.1e1 / n
    t63 = t62 * t61
    t64 = cos(psih)
    contr[1] = -3/32 * t64 * cdelta * t63 * t59 * t46 * t44 * t43 * skm * t40 * (2 * t10 * t9 + Q2 * (2 * cpa3EQ * (cpa1EQ * t1 - cpa1EQ * t2 - t16) * Q1 + t24 * (3 * t1 + t2 - 3) + t28 + t32) - 2 * t36 * t9)
    t70 = skm * t40
    t73 = t3 * cpa1EQ - t16
    t90 = t10 + 1
    t97 = sin(psih)
    contr[2] = -3/32 * t97 * cdelta * t63 * t59 * t46 * (t35 * cpa3EQ * t73 + Q1 * (4 * cpa3EQ * Q2 * (t1 * cpa2EQ / 2 - t2 * cpa2EQ / 2 + t7) + t32 + t28 + 3 * t24 * (t1 + t2 / 3 - 1)) - cpa3EQ * t90 * t73) * t44 * t43 * t70
    t107 = cdelta * t43 * (-2/3 * t1 - 2/3 * t2 + eta + 1)
    t108 = t10 * cpa2EQ
    t109 = Q2 * Q1
    t110 = cpa1EQ * t109
    t112 = t36 * cpa2EQ
    t117 = 2 * cpa2EQ * t109
    t130 = cpa1EQ + cpa2EQ
    t132 = cpa1EQ - cpa2EQ
    t134 = P1 * t130 + t132 * P2
    t137 = P1 * t132 - t130 * P2
    t146 = t56 * t61 * t52 * t46
    t147 = 1 + eta
    t148 = t147 ^ 2
    t151 = t62 / t148 / t147
    t155 = t64 * t58 * t151 * t146 * t70 * (cpa3EQ * (t1 * (-t108 - 2 * t110 + t112) + 2 * P1 * P2 * (-t10 * cpa1EQ + t36 * cpa1EQ + t117) + 2 * (t108 / 2 + t110 - t112 / 2) * t2) + Q2 * t137 * t134) * t44 * t107
    contr[3] = -3/32 * t155
    t158 = t35 * cpa1EQ
    t185 = t97 * t58 * t151 * t146 * skm * (cpa3EQ * (t1 * (t90 * cpa1EQ - t117 - t158) - 4 * P1 * P2 * (-cpa2EQ * t35 / 2 + t110 + t90 * cpa2EQ / 2) + t2 * (-t90 * cpa1EQ + t117 + t158)) + t137 * Q1 * t134) * t40 * t44 * t107
    contr[4] = -3/32 * t185
    contr[5] = 21/32 * t155
    contr[6] = 21/32 * t185

    contr=sum(contr);
    return contr;
end

function meandZ3dpsih_Magnetic(k,m,skm,smk,mM1KK,KK,EE,PP,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ)
    contr = zeros(6)

    t1 = P1 ^ 2
    t2 = P2 ^ 2
    t3 = t1 - t2
    t7 = cpa1EQ * P1 * P2
    t9 = cpa3EQ * (cpa2EQ * t3 / 2 + t7)
    t10 = Q2 ^ 2
    t14 = P1 * P2
    t16 = 2 * cpa2EQ * t14
    t24 = cpa2EQ ^ 2
    t28 = 4 * t14 * cpa1EQ * cpa2EQ
    t29 = cpa1EQ ^ 2
    t32 = (t1 + 3 * t2 - 3) * t29
    t35 = Q1 ^ 2
    t36 = t35 + 1
    t40 = muM ^ 2
    t43 = pi ^ 2
    t45 = IMz ^ 2
    t48 = 0.1e1 / GG
    t49 = sma ^ 2
    t50 = t49 ^ 2
    t52 = 0.1e1 / t50 / t49
    t54 = eta ^ 2
    t55 = t54 ^ 2
    t57 = 0.1e1 / t55 / t54
    t58 = t57 * t52 * t48
    t59 = 0.1e1 / Jg
    t60 = KK ^ 2
    t61 = 0.1e1 / t60
    t62 = t61 * t59
    t63 = 0.1e1 / n
    t64 = sin(psih)
    contr[1] = -3/32 * t64 * t63 * t62 * t58 * t45 * t43 * skm * sdelta * t40 * (2 * t10 * t9 + Q2 * (2 * cpa3EQ * (cpa1EQ * t1 - cpa1EQ * t2 - t16) * Q1 + t24 * (3 * t1 + t2 - 3) + t28 + t32) - 2 * t36 * t9)
    t74 = t3 * cpa1EQ - t16
    t91 = t10 + 1
    t97 = cos(psih)
    contr[2] = 3/32 * t97 * t63 * t62 * t58 * (t35 * cpa3EQ * t74 + Q1 * (4 * cpa3EQ * Q2 * (t1 * cpa2EQ / 2 - t2 * cpa2EQ / 2 + t7) + t32 + t28 + 3 * t24 * (t1 + t2 / 3 - 1)) - cpa3EQ * t91 * t74) * t45 * t43 * skm * sdelta * t40
    t106 = -2/3 * t1 - 2/3 * t2 + eta + 1
    t108 = t10 * cpa2EQ
    t109 = Q2 * Q1
    t110 = cpa1EQ * t109
    t112 = t36 * cpa2EQ
    t117 = 2 * cpa2EQ * t109
    t130 = cpa1EQ + cpa2EQ
    t132 = cpa1EQ - cpa2EQ
    t134 = P1 * t130 + t132 * P2
    t137 = P1 * t132 - t130 * P2
    t147 = 1 + eta
    t148 = t147 ^ 2
    t154 = t59 * t63 / t148 / t147 * t57 * t61 * t52 * t48 * skm
    t155 = t154 * t40 * (cpa3EQ * (t1 * (-t108 - 2 * t110 + t112) + 2 * P1 * P2 * (-t10 * cpa1EQ + t36 * cpa1EQ + t117) + 2 * (t108 / 2 + t110 - t112 / 2) * t2) + Q2 * t137 * t134) * t106 * t45 * sdelta * t43 * t64
    contr[3] = -3/32 * t155
    t159 = t35 * cpa1EQ
    t184 = t154 * t40 * t106 * (cpa3EQ * (t1 * (t91 * cpa1EQ - t117 - t159) - 4 * P1 * P2 * (-cpa2EQ * t35 / 2 + t110 + t91 * cpa2EQ / 2) + t2 * (-t91 * cpa1EQ + t117 + t159)) + t137 * Q1 * t134) * t45 * sdelta * t43 * t97
    contr[4] = 3/32 * t184
    contr[5] = 21/32 * t155
    contr[6] = -21/32 * t184
      
    contr=sum(contr);
    return contr;
end

function meandZ3cdeltadpsigMdpsihOsdelta_Magnetic(k,m,skm,smk,mM1KK,KK,EE,PP,T2,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ)
    contr = zeros(6)

    t1 = sin(psih)
    t2 = P1 ^ 2
    t3 = P2 ^ 2
    t4 = t2 - t3
    t8 = cpa1EQ * P1 * P2
    t10 = cpa3EQ * (cpa2EQ * t4 / 2 + t8)
    t11 = Q2 ^ 2
    t15 = P1 * P2
    t17 = 2 * t15 * cpa2EQ
    t25 = cpa2EQ ^ 2
    t29 = 4 * t15 * cpa1EQ * cpa2EQ
    t30 = cpa1EQ ^ 2
    t33 = (t2 + 3 * t3 - 3) * t30
    t36 = Q1 ^ 2
    t37 = t36 + 1
    t42 = muM ^ 2
    t44 = pi ^ 2
    t46 = IMz ^ 2
    t49 = 0.1e1 / GG
    t50 = sma ^ 2
    t51 = t50 ^ 2
    t53 = 0.1e1 / t51 / t50
    t55 = eta ^ 2
    t56 = t55 ^ 2
    t58 = 0.1e1 / t56 / t55
    t60 = 0.1e1 / Jg
    t61 = KK ^ 2
    t62 = 0.1e1 / t61
    t64 = 0.1e1 / n
    t66 = t64 * t62 * t60 * t58 * t53 * t49
    contr[1] = 3/32 * t66 * t46 * t44 * skm * t42 * (2 * t11 * t10 + Q2 * (2 * cpa3EQ * (cpa1EQ * t2 - t3 * cpa1EQ - t17) * Q1 + t25 * (3 * t2 + t3 - 3) + t29 + t33) - 2 * t37 * t10) * t1
    t68 = cos(psih)
    t73 = t4 * cpa1EQ - t17
    t90 = t11 + 1
    contr[2] = -3/32 * t66 * (t36 * cpa3EQ * t73 + Q1 * (4 * cpa3EQ * Q2 * (t2 * cpa2EQ / 2 - cpa2EQ * t3 / 2 + t8) + t33 + t29 + 3 * t25 * (t2 + t3 / 3 - 1)) - cpa3EQ * t90 * t73) * t46 * t44 * skm * t42 * t68
    t101 = t44 * (-2/3 * t2 - 2/3 * t3 + eta + 1)
    t103 = t11 * cpa2EQ
    t104 = Q2 * Q1
    t105 = cpa1EQ * t104
    t107 = t37 * cpa2EQ
    t112 = 2 * cpa2EQ * t104
    t125 = cpa1EQ + cpa2EQ
    t127 = cpa1EQ - cpa2EQ
    t129 = P1 * t125 + t127 * P2
    t132 = P1 * t127 - t125 * P2
    t140 = 1 + eta
    t141 = t140 ^ 2
    t149 = skm * t49 * t53 * t62 * t58 / t141 / t140 * t64
    t150 = t149 * t60 * t42 * (cpa3EQ * (t2 * (-t103 - 2 * t105 + t107) + 2 * P1 * P2 * (-t11 * cpa1EQ + t37 * cpa1EQ + t112) + 2 * (t103 / 2 + t105 - t107 / 2) * t3) + Q2 * t132 * t129) * t46 * t1 * t101
    contr[3] = 3/32 * t150
    t153 = t36 * cpa1EQ
    t177 = t149 * t60 * (cpa3EQ * (t2 * (t90 * cpa1EQ - t112 - t153) - 4 * P1 * P2 * (-t36 * cpa2EQ / 2 + t105 + t90 * cpa2EQ / 2) + t3 * (-t90 * cpa1EQ + t112 + t153)) + t132 * Q1 * t129) * t42 * t46 * t68 * t101
    contr[4] = -3/32 * t177
    contr[5] = -21/32 * t150
    contr[6] = 21/32 * t177
       

    contr=sum(contr);
    return contr;
end

function  meandZ3dcsigma1_Magnetic_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ)
    contr = zeros(9)

    t1 = cos(psih)
    t2 = IMz ^ 2
    t4 = muM ^ 2
    t5 = P1 ^ 2
    t6 = P2 ^ 2
    t7 = t5 - t6
    t10 = P1 * P2
    t11 = cpa1EQ * t10
    t12 = cpa2EQ * t7 / 2 + t11
    t14 = Q2 ^ 2
    t19 = 2 * cpa2EQ * t10
    t27 = cpa2EQ ^ 2
    t31 = 4 * cpa1EQ * cpa2EQ * t10
    t32 = cpa1EQ ^ 2
    t34 = t5 + 3 * t6 + 3
    t35 = t34 * t32
    t38 = Q1 ^ 2
    t39 = t38 + 1
    t47 = sqrt(skm)
    t49 = 1 / (t38 + t14 + 1)
    t51 = sma ^ 2
    t52 = t51 ^ 2
    t54 = 0.1e1 / t51 / t52
    t56 = eta ^ 2
    t57 = t56 ^ 2
    t59 = 0.1e1 / t56 / t57
    t60 = 0.1e1 / Jg
    t62 = 0.1e1 / n
    t63 = t62 * t60 * t59
    t64 = t63 * t54 * t49 * t47
    contr[1] = -3/4 * t64 * sdelta * (2 * t14 * cpa3EQ * t12 + Q2 * (2 * cpa3EQ * (cpa1EQ * t5 - t6 * cpa1EQ - t19) * Q1 + t27 * (3 * t5 + t6 + 3) + t31 + t35) - 2 * cpa3EQ * t39 * t12) * t4 * t2 * t1
    t67 = sin(psih)
    t71 = cpa3EQ * (t7 * cpa1EQ - t19)
    t82 = t5 + t6 / 3 + 1
    t87 = t14 + 1
    contr[2] = -3/4 * t64 * sdelta * (t38 * t71 + Q1 * (4 * cpa3EQ * Q2 * (t11 + cpa2EQ * t5 / 2 - cpa2EQ * t6 / 2) + t35 + t31 + 3 * t82 * t27) - t87 * t71) * t4 * t2 * t67
    t97 = t38 + t14 - 1
    t100 = cpa2EQ * t97
    t128 = 0.1e1 / GG
    contr[3] = -3/8 * t63 * t54 * t128 * (t32 * t34 * t97 + cpa1EQ * (4 * t100 * t10 - 4 * (2 * P1 * Q2 * P2 + t5 * Q1 - t6 * Q1) * cpa3EQ) + 3 * cpa2EQ * (cpa2EQ * t97 * t82 - 4/3 * (-2 * Q1 * P1 * P2 + t5 * Q2 - t6 * Q2) * cpa3EQ)) * t4 * cdelta * t2 * t47
    t133 = t14 * cpa2EQ
    t134 = Q2 * Q1
    t135 = cpa1EQ * t134
    t137 = t39 * cpa2EQ
    t142 = 2 * cpa2EQ * t134
    t155 = cpa1EQ + cpa2EQ
    t157 = cpa1EQ - cpa2EQ
    t159 = P1 * t155 + t157 * P2
    t163 = P1 * t157 - t155 * P2
    t170 = -2/3 * t5 - 2/3 * t6 + eta + 1
    t172 = t47 * t170 * t2
    t175 = 1 + eta
    t176 = t175 ^ 2
    t178 = 0.1e1 / t175 / t176
    t183 = t62 * t60 * t59 * t54 * t178 * t49 * t4
    contr[4] = 3/4 * t183 * t172 * t1 * sdelta * (cpa3EQ * (t5 * (-t133 - 2 * t135 + t137) + 2 * P1 * P2 * (-t14 * cpa1EQ + t39 * cpa1EQ + t142) + 2 * t6 * (t133 / 2 + t135 - t137 / 2)) + t163 * Q2 * t159)
    t187 = t38 * cpa1EQ
    contr[5] = 3/4 * t183 * t47 * t170 * (cpa3EQ * (t5 * (t87 * cpa1EQ - t142 - t187) - 4 * P1 * (-t38 * cpa2EQ / 2 + t135 + t87 * cpa2EQ / 2) * P2 + (-t87 * cpa1EQ + t142 + t187) * t6) + Q1 * t163 * t159) * t2 * t67 * sdelta
    t216 = Q2 * cpa3EQ
    t220 = t32 * t97 + 4 * cpa3EQ * Q1 * cpa1EQ - (t100 - 4 * t216) * cpa2EQ
    contr[6] = 3/8 * t63 * t54 * t178 * t128 * t4 * (t5 * t220 - 4 * P1 * P2 * (cpa1EQ * (t100 - 2 * t216) + 2 * cpa2EQ * cpa3EQ * Q1) - t6 * t220) * cdelta * t172
    contr[7] = contr[4]
    contr[8] = contr[5]
    contr[9] = contr[6]
    
    
    contr=sum(contr);
    return contr;
end

function  meandZ3dJgP1_Magnetic_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ)
    contr = zeros(9)
   
    t1 = cos(psih)
    t2 = IMz ^ 2
    t3 = t2 * t1
    t4 = muM ^ 2
    t5 = P1 ^ 2
    t6 = P2 ^ 2
    t7 = t5 - t6
    t10 = P1 * P2
    t11 = cpa1EQ * t10
    t12 = cpa2EQ * t7 / 2 + t11
    t14 = Q2 ^ 2
    t19 = 2 * cpa2EQ * t10
    t27 = cpa2EQ ^ 2
    t31 = 4 * cpa1EQ * cpa2EQ * t10
    t32 = cpa1EQ ^ 2
    t34 = t5 + 3 * t6 + 3
    t35 = t34 * t32
    t38 = Q1 ^ 2
    t39 = t38 + 1
    t48 = 1 / (t38 + t14 + 1)
    t50 = sma ^ 2
    t51 = t50 ^ 2
    t53 = 0.1e1 / t50 / t51
    t55 = eta ^ 2
    t56 = t55 ^ 2
    t58 = 0.1e1 / t55 / t56
    t59 = Jg ^ 2
    t60 = 0.1e1 / t59
    t62 = 0.1e1 / n
    t63 = t62 * t60 * t58
    t64 = t63 * t53 * t48 * skm
    contr[1] = 3/8 * t64 * sdelta * (2 * t14 * cpa3EQ * t12 + Q2 * (2 * cpa3EQ * (cpa1EQ * t5 - t6 * cpa1EQ - t19) * Q1 + t27 * (3 * t5 + t6 + 3) + t31 + t35) - 2 * cpa3EQ * t39 * t12) * t4 * t3
    t66 = sin(psih)
    t67 = t2 * t66
    t70 = cpa3EQ * (t7 * cpa1EQ - t19)
    t81 = t5 + t6 / 3 + 1
    t86 = t14 + 1
    contr[2] = 3/8 * t64 * sdelta * (t38 * t70 + Q1 * (4 * cpa3EQ * Q2 * (t11 + cpa2EQ * t5 / 2 - cpa2EQ * t6 / 2) + t35 + t31 + 3 * t81 * t27) - t86 * t70) * t4 * t67
    t94 = t38 + t14 - 1
    t98 = cpa2EQ * t94
    t125 = 0.1e1 / GG
    contr[3] = -3/4 * t63 * t53 * t125 * t2 * skm * (-t32 * t34 * t94 / 4 + cpa1EQ * (-t98 * t10 + (2 * P1 * Q2 * P2 + t5 * Q1 - t6 * Q1) * cpa3EQ) + (-3/4 * cpa2EQ * t94 * t81 + (-2 * Q1 * P1 * P2 + t5 * Q2 - t6 * Q2) * cpa3EQ) * cpa2EQ) * cdelta * t4
    t131 = t14 * cpa2EQ
    t132 = Q2 * Q1
    t133 = cpa1EQ * t132
    t135 = t39 * cpa2EQ
    t140 = 2 * cpa2EQ * t132
    t153 = cpa1EQ + cpa2EQ
    t155 = cpa1EQ - cpa2EQ
    t157 = P1 * t153 + t155 * P2
    t161 = P1 * t155 - t153 * P2
    t168 = t5 + t6 - 3/2 * eta - 3/2
    t170 = 1 + eta
    t171 = t170 ^ 2
    t173 = 0.1e1 / t170 / t171
    t178 = t62 * t60 * t58 * t53 * t173 * t48 * t168
    contr[4] = t178 * skm * (cpa3EQ * (t5 * (-t131 - 2 * t133 + t135) + 2 * P1 * P2 * (-t14 * cpa1EQ + t39 * cpa1EQ + t140) + 2 * t6 * (t131 / 2 + t133 - t135 / 2)) + t161 * Q2 * t157) * sdelta * t4 * t3 / 4
    t181 = t38 * cpa1EQ
    contr[5] = t178 * skm * (cpa3EQ * (t5 * (t86 * cpa1EQ - t140 - t181) - 4 * P1 * (-t38 * cpa2EQ / 2 + t133 + t86 * cpa2EQ / 2) * P2 + (-t86 * cpa1EQ + t140 + t181) * t6) + Q1 * t161 * t157) * sdelta * t4 * t67 / 4
    t213 = Q2 * cpa3EQ
    t217 = -t32 * t94 - 4 * cpa3EQ * Q1 * cpa1EQ + (t98 - 4 * t213) * cpa2EQ
    contr[6] = -t63 * t53 * t173 * t125 * t2 * t168 * (t5 * t217 + 8 * P1 * (cpa1EQ * (cpa2EQ * t94 / 2 - t213) + cpa2EQ * cpa3EQ * Q1) * P2 - t217 * t6) * cdelta * t4 * skm / 8
    contr[7] = contr[4]
    contr[8] = contr[5]
    contr[9] = contr[6]
    

    contr=sum(contr);
    return contr;
end

function  meandZ3dcdelta1_Magnetic_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ)
    contr = zeros(3)

    t1 = IMz ^ 2
    t3 = muM ^ 2
    t4 = Q1 ^ 2
    t5 = Q2 ^ 2
    t6 = t4 + t5 - 1
    t7 = P1 ^ 2
    t8 = P2 ^ 2
    t12 = cpa1EQ ^ 2
    t15 = cpa2EQ * t6
    t45 = 0.1e1 / GG
    t46 = sma ^ 2
    t47 = t46 ^ 2
    t49 = 0.1e1 / t46 / t47
    t51 = eta ^ 2
    t52 = t51 ^ 2
    t58 = 0.1e1 / n / Jg / t51 / t52
    contr[1] = -3/16 * t58 * t49 * t45 * (t12 * (t7 + 3 * t8 + 3) * t6 + cpa1EQ * (4 * t15 * P1 * P2 - 4 * (2 * P1 * Q2 * P2 + t7 * Q1 - t8 * Q1) * cpa3EQ) + 3 * cpa2EQ * (cpa2EQ * t6 * (t7 + t8 / 3 + 1) - 4/3 * (-2 * Q1 * P1 * P2 + t7 * Q2 - t8 * Q2) * cpa3EQ)) * t3 * skm * t1
    t66 = Q2 * cpa3EQ
    t70 = t12 * t6 + 4 * cpa3EQ * Q1 * cpa1EQ - (t15 - 4 * t66) * cpa2EQ
    t91 = 1 + eta
    t92 = t91 ^ 2
    contr[2] = 3/16 * t58 * t49 / t91 / t92 * t45 * t3 * skm * (-2/3 * t7 - 2/3 * t8 + eta + 1) * t1 * (t7 * t70 - 4 * P1 * P2 * (cpa1EQ * (t15 - 2 * t66) + 2 * cpa2EQ * cpa3EQ * Q1) - t8 * t70)
    contr[3] = contr[2]    

    contr=sum(contr);
    return contr;
end

function  meandZ3dcdelta2_Magnetic_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ)
    contr = zeros(6)

    t1 = cos(psih)
    t2 = IMz ^ 2
    t3 = t2 * t1
    t4 = muM ^ 2
    t5 = P1 ^ 2
    t6 = P2 ^ 2
    t7 = t5 - t6
    t10 = P1 * P2
    t11 = cpa1EQ * t10
    t12 = cpa2EQ * t7 / 2 + t11
    t14 = Q2 ^ 2
    t19 = 2 * cpa2EQ * t10
    t27 = cpa2EQ ^ 2
    t31 = 4 * cpa1EQ * cpa2EQ * t10
    t32 = cpa1EQ ^ 2
    t35 = (t5 + 3 * t6 + 3) * t32
    t38 = Q1 ^ 2
    t39 = t38 + 1
    t48 = 1 / (t38 + t14 + 1)
    t49 = sma ^ 2
    t50 = t49 ^ 2
    t52 = 0.1e1 / t49 / t50
    t54 = eta ^ 2
    t55 = t54 ^ 2
    t57 = 0.1e1 / t54 / t55
    t59 = 0.1e1 / Jg
    t60 = 0.1e1 / n
    t63 = cdelta * t60 * t59 * t57 * t52 * t48
    contr[1] = 3/8 * t63 * skm * (2 * t14 * cpa3EQ * t12 + Q2 * (2 * cpa3EQ * (cpa1EQ * t5 - cpa1EQ * t6 - t19) * Q1 + t27 * (3 * t5 + t6 + 3) + t31 + t35) - 2 * cpa3EQ * t39 * t12) * t4 * t3
    t65 = sin(psih)
    t66 = t2 * t65
    t69 = cpa3EQ * (t7 * cpa1EQ - t19)
    t85 = t14 + 1
    contr[2] = 3/8 * t63 * skm * (t38 * t69 + Q1 * (4 * cpa3EQ * Q2 * (t11 + cpa2EQ * t5 / 2 - cpa2EQ * t6 / 2) + t35 + t31 + 3 * (t5 + t6 / 3 + 1) * t27) - t85 * t69) * t4 * t66
    t93 = t14 * cpa2EQ
    t94 = Q2 * Q1
    t95 = cpa1EQ * t94
    t97 = t39 * cpa2EQ
    t102 = 2 * cpa2EQ * t94
    t115 = cpa1EQ + cpa2EQ
    t117 = cpa1EQ - cpa2EQ
    t119 = P1 * t115 + t117 * P2
    t123 = P1 * t117 - t115 * P2
    t128 = t5 + t6 - 3/2 * eta - 3/2
    t131 = 1 + eta
    t132 = t131 ^ 2
    t140 = cdelta * t60 * t59 * t57 * t52 / t131 / t132 * t48
    contr[3] = t140 * t128 * skm * (cpa3EQ * (t5 * (-t93 - 2 * t95 + t97) + 2 * P1 * P2 * (-t14 * cpa1EQ + t39 * cpa1EQ + t102) + 2 * t6 * (t93 / 2 + t95 - t97 / 2)) + t123 * Q2 * t119) * t4 * t3 / 4
    t143 = cpa1EQ * t38
    contr[4] = t140 * t128 * skm * (cpa3EQ * (t5 * (t85 * cpa1EQ - t102 - t143) - 4 * P1 * (-cpa2EQ * t38 / 2 + t95 + t85 * cpa2EQ / 2) * P2 + (-t85 * cpa1EQ + t102 + t143) * t6) + Q1 * t123 * t119) * t4 * t66 / 4
    contr[5] = contr[3]
    contr[6] = contr[4]
    
    
    contr=sum(contr);
    return contr;
end

function  meandZ3dpsih_Magnetic_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ)
    contr = zeros(6)

    t1 = IMz ^ 2
    t2 = muM ^ 2
    t3 = t2 * t1
    t4 = P1 ^ 2
    t5 = P2 ^ 2
    t6 = t4 - t5
    t9 = P1 * P2
    t10 = cpa1EQ * t9
    t11 = cpa2EQ * t6 / 2 + t10
    t13 = Q2 ^ 2
    t18 = 2 * cpa2EQ * t9
    t26 = cpa2EQ ^ 2
    t30 = 4 * cpa1EQ * cpa2EQ * t9
    t31 = cpa1EQ ^ 2
    t34 = (t4 + 3 * t5 + 3) * t31
    t37 = Q1 ^ 2
    t38 = t37 + 1
    t47 = 1 / (t37 + t13 + 1)
    t48 = sma ^ 2
    t49 = t48 ^ 2
    t51 = 0.1e1 / t48 / t49
    t53 = eta ^ 2
    t54 = t53 ^ 2
    t56 = 0.1e1 / t53 / t54
    t57 = t56 * t51 * t47
    t58 = 0.1e1 / Jg
    t59 = 0.1e1 / n
    t60 = t59 * t58
    t61 = sin(psih)
    contr[1] = 3/8 * t61 * t60 * t57 * skm * sdelta * (2 * t13 * cpa3EQ * t11 + Q2 * (2 * cpa3EQ * (cpa1EQ * t4 - cpa1EQ * t5 - t18) * Q1 + t26 * (3 * t4 + t5 + 3) + t30 + t34) - 2 * cpa3EQ * t38 * t11) * t3
    t67 = cpa3EQ * (t6 * cpa1EQ - t18)
    t83 = t13 + 1
    t89 = cos(psih)
    contr[2] = -3/8 * t89 * t60 * t57 * skm * sdelta * (t37 * t67 + Q1 * (4 * cpa3EQ * Q2 * (t10 + cpa2EQ * t4 / 2 - cpa2EQ * t5 / 2) + t34 + t30 + 3 * (t4 + t5 / 3 + 1) * t26) - t83 * t67) * t3
    t94 = sdelta * t3
    t95 = t13 * cpa2EQ
    t96 = Q2 * Q1
    t97 = cpa1EQ * t96
    t99 = t38 * cpa2EQ
    t104 = 2 * cpa2EQ * t96
    t117 = cpa1EQ + cpa2EQ
    t119 = cpa1EQ - cpa2EQ
    t121 = P1 * t117 + t119 * P2
    t125 = P1 * t119 - t117 * P2
    t130 = t4 + t5 - 3/2 * eta - 3/2
    t133 = 1 + eta
    t134 = t133 ^ 2
    t138 = t51 / t133 / t134 * t47
    t139 = t58 * t56
    contr[3] = t61 * t59 * t139 * t138 * t130 * skm * (cpa3EQ * (t4 * (-t95 - 2 * t97 + t99) + 2 * P1 * P2 * (-t13 * cpa1EQ + t38 * cpa1EQ + t104) + 2 * t5 * (t95 / 2 + t97 - t99 / 2)) + t125 * Q2 * t121) * t94 / 4
    t144 = cpa1EQ * t37
    contr[4] = -t89 * t59 * t139 * t138 * t130 * skm * (cpa3EQ * (t4 * (t83 * cpa1EQ - t104 - t144) - 4 * P1 * (-cpa2EQ * t37 / 2 + t97 + t83 * cpa2EQ / 2) * P2 + (-t83 * cpa1EQ + t104 + t144) * t5) + Q1 * t125 * t121) * t94 / 4
    contr[5] = contr[3]
    contr[6] = contr[4]
    
    
    contr=sum(contr);
    return contr;
end

function  meandZ3cdeltadpsigMdpsihOsdelta_Magnetic_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ)
    contr = zeros(6)

    t1 = sin(psih)
    t2 = IMz ^ 2
    t3 = t2 * t1
    t4 = muM ^ 2
    t5 = P1 ^ 2
    t6 = P2 ^ 2
    t7 = t5 - t6
    t10 = P1 * P2
    t11 = cpa1EQ * t10
    t12 = cpa2EQ * t7 / 2 + t11
    t14 = Q2 ^ 2
    t19 = 2 * cpa2EQ * t10
    t27 = cpa2EQ ^ 2
    t31 = 4 * cpa1EQ * cpa2EQ * t10
    t32 = cpa1EQ ^ 2
    t35 = (t5 + 3 * t6 + 3) * t32
    t38 = Q1 ^ 2
    t39 = t38 + 1
    t48 = 1 / (t38 + t14 + 1)
    t49 = sma ^ 2
    t50 = t49 ^ 2
    t52 = 0.1e1 / t49 / t50
    t54 = eta ^ 2
    t55 = t54 ^ 2
    t61 = 0.1e1 / n / Jg / t54 / t55
    t62 = t61 * t52 * t48
    contr[1] = -3/8 * t62 * skm * (2 * t14 * cpa3EQ * t12 + Q2 * (2 * cpa3EQ * (cpa1EQ * t5 - cpa1EQ * t6 - t19) * Q1 + t27 * (3 * t5 + t6 + 3) + t31 + t35) - 2 * cpa3EQ * t39 * t12) * t4 * t3
    t65 = cos(psih)
    t66 = t2 * t65
    t69 = cpa3EQ * (t7 * cpa1EQ - t19)
    t85 = t14 + 1
    contr[2] = 3/8 * t62 * skm * (t38 * t69 + Q1 * (4 * cpa3EQ * Q2 * (t11 + cpa2EQ * t5 / 2 - cpa2EQ * t6 / 2) + t35 + t31 + 3 * (t5 + t6 / 3 + 1) * t27) - t85 * t69) * t4 * t66
    t93 = t14 * cpa2EQ
    t94 = Q2 * Q1
    t95 = cpa1EQ * t94
    t97 = t39 * cpa2EQ
    t102 = 2 * cpa2EQ * t94
    t115 = cpa1EQ + cpa2EQ
    t117 = cpa1EQ - cpa2EQ
    t119 = P1 * t115 + t117 * P2
    t123 = P1 * t117 - t115 * P2
    t128 = t5 + t6 - 3/2 * eta - 3/2
    t131 = 1 + eta
    t132 = t131 ^ 2
    t137 = t61 * t52 / t131 / t132 * t48
    contr[3] = -t137 * t128 * skm * (cpa3EQ * (t5 * (-t93 - 2 * t95 + t97) + 2 * P1 * P2 * (-t14 * cpa1EQ + t39 * cpa1EQ + t102) + 2 * t6 * (t93 / 2 + t95 - t97 / 2)) + t123 * Q2 * t119) * t4 * t3 / 4
    t141 = cpa1EQ * t38
    contr[4] = t137 * t128 * skm * (cpa3EQ * (t5 * (t85 * cpa1EQ - t102 - t141) - 4 * P1 * (-cpa2EQ * t38 / 2 + t95 + t85 * cpa2EQ / 2) * P2 + (-t85 * cpa1EQ + t102 + t141) * t6) + Q1 * t123 * t119) * t4 * t66 / 4
    contr[5] = contr[3]
    contr[6] = contr[4]
    
   
    contr=sum(contr);
    return contr;
end


####################################

function gethigherorderterms_mixgravitymagnetic(k,m,skm,smk,mM1KK,KK,EE,PP,T2,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,A,B,C,mu,IMz,muM,cpa1,cpa2,cpa3,typeofvariables)

    GG = 1+Q1^2+Q2^2;
    cpa1EQ = ((-Q1^2 + Q2^2 + 1)*cpa1 + 2*Q1*(Q2*cpa2 - cpa3))/GG;
    cpa2EQ = ((Q1^2 - Q2^2 + 1)*cpa2 + 2*Q2*(Q1*cpa1 + cpa3))/GG
    cpa3EQ = (-Q1^2*cpa3 - Q2^2*cpa3 + 2*Q1*cpa1 - 2*Q2*cpa2 + cpa3)/GG
    if k!=0.0
        dmdJl        = -pi*(m + k)^(3/2)/(sqrt(k)*sqrt(1 + k)*KK*Jg);
        dmdJg        = 2*(m + k)^2.0*(PP - smk*KK)/(KK*k*Jg);
        dcdeltadJh   = 1/Jg;
        dcdeltadJg   = -cdelta*dcdeltadJh 
        dZ3dm        = meandZ3dm_mixGravityMagnetic(k,m,skm,smk,mM1KK,KK,EE,PP,T2,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,A,B,C,mu,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ);
        dZ3dJgP1     = meandZ3dJgP1_mixGravityMagnetic(k,m,skm,smk,mM1KK,KK,EE,PP,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,A,B,C,mu,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ);
        dZ3dcdeltaP1 = meandZ3dcdeltaP1_mixGravityMagnetic(k,m,skm,smk,mM1KK,KK,EE,PP,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,A,B,C,mu,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ);
        dZ3dcdeltaP2 = meandZ3dcdeltaP2_mixGravityMagnetic(k,m,skm,smk,mM1KK,KK,EE,PP,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,A,B,C,mu,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ);
        dZ3dJl       = dmdJl*dZ3dm;
        dZ3dJgP1     = dmdJg*dZ3dm + dZ3dJgP1 + dZ3dcdeltaP1*dcdeltadJg;
        dZ3dJgP2     = dZ3dcdeltaP2*dcdeltadJg;
        dZ3dJhP1     = dZ3dcdeltaP1*dcdeltadJh;
        dZ3dJhP2     = dZ3dcdeltaP2*dcdeltadJh;
        dZ3dpsih     = meandZ3dpsih_mixGravityMagnetic(k,m,skm,smk,mM1KK,KK,EE,PP,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,A,B,C,mu,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ);
        if typeofvariables != 1
            cdeltadZ3dpsigMdZ3psihOsdelta = meandZ3cdeltadpsigMdpsihOsdelta_Magnetic(k,m,skm,smk,mM1KK,KK,EE,PP,T2,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ);
        end
    else
        dcsigmadJl   = 1/Jg
        dcsigmadJg   = -sqrt(skm)*dcsigmadJl
        dcdeltadJh   = 1/Jg;
        dcdeltadJg   = -cdelta*dcdeltadJh 
        dZ3dcsigma   = meandZ3dcsigma1_mixGravityMagnetic_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,A,B,C,mu,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ);
        dZ3dJgP1     = meandZ3dJgP1_mixGravityMagnetic_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,A,B,C,mu,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ);
        dZ3dcdeltaP1 = meandZ3dcdelta1_mixGravityMagnetic_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,A,B,C,mu,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ);
        dZ3dcdeltaP2 = meandZ3dcdelta2_mixGravityMagnetic_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,A,B,C,mu,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ);
        dZ3dJl       = dZ3dcsigma*dcsigmadJl;
        dZ3dJgP1     = dZ3dcsigma*dcsigmadJg + dZ3dJgP1 + dZ3dcdeltaP1*dcdeltadJg;
        dZ3dJgP2     = dZ3dcdeltaP2*dcdeltadJg;
        dZ3dJhP1     = dZ3dcdeltaP1*dcdeltadJh;
        dZ3dJhP2     = dZ3dcdeltaP2*dcdeltadJh;
        dZ3dpsih     = meandZ3dpsih_mixGravityMagnetic_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,A,B,C,mu,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ);
        if typeofvariables != 1
            cdeltadZ3dpsigMdZ3psihOsdelta = meandZ3cdeltadpsigMdpsihOsdelta_mixGravityMagnetic_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,A,B,C,mu,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ);
        end
    end
    
    if typeofvariables == 1
        dZ3dJg     =  dZ3dJgP1 + dZ3dJgP2/sdelta;
        dZ3dJh     =  dZ3dJhP1 + dZ3dJhP2/sdelta;
        out = zeros(6);
        out[3] = -dZ3dpsih;
        out[4] = dZ3dJl;
        out[5] = dZ3dJg;
        out[6] = dZ3dJh;
    else
        out = zeros(7);
        out[3] = -dZ3dpsih;
        out[4] = dZ3dJl;
        out[5] = dZ3dJgP1 + cdelta*dZ3dJhP1 - psih/Jg*dZ3dpsih;
        out[6] = -Jg*sdelta*sin(psih)*dZ3dJhP1 - Jg*sin(psih)*dZ3dJhP2 + cdelta*cos(psih)*cdeltadZ3dpsigMdZ3psihOsdelta;
        out[7] =  Jg*sdelta*cos(psih)*dZ3dJhP1 + Jg*cos(psih)*dZ3dJhP2 + cdelta*sin(psih)*cdeltadZ3dpsigMdZ3psihOsdelta;
    end

    return out;

end

function meandZ3dm_mixGravityMagnetic(k,m,skm,smk,mM1KK,KK,EE,PP,T2,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,A,B,C,mu,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ)
    contr = zeros(15)
    t1 = T2 ^ 2
    t2 = B - C
    t4 = k ^ 2
    t16 = m ^ 2
    t30 = 2 * T2
    t35 = 10/3 * C
    t42 = T2 / 3
    t73 = KK ^ 2
    t76 = (m - 2) ^ 2
    t82 = -t2
    t96 = EE ^ 2
    t101 = t73 * (t16 * m * (-t4 * t2 * t1 + k * (B * (-t1 - 2/3) + t1 * A + 4/3 * A - 2/3 * C) + A / 2 - B / 2) + t16 * (t4 * ((-13/6 * T2 + 5/6) * B + (-T2 / 6 - 1/6) * A + 7/3 * C * (T2 - 2/7)) + k * (B * (-t30 + 13/3) + A * (t30 - 23/3) + t35) - 5/2 * A + 5/2 * B) + m * (t4 * (B * (t42 - 9/2) + A * (t42 + 1/2) - 2/3 * C * (T2 - 6)) + (47/3 * A - 31/3 * B - 16/3 * C) * k + 4 * A - 4 * B) + t4 * (-A / 3 + 11/3 * B - t35) + (-28/3 * A + 20/3 * B + 8/3 * C) * k - 2 * A + 2 * B) + 5/3 * EE * KK * ((A / 5 - B / 10 - C / 10) * m + 9/10 * t4 * t82 + (A - 4/5 * B - C / 5) * k - 3/10 * A + 3/10 * B) * t76 + (k * t82 + A - B) * t96 * t76
    t102 = muM * t101
    t103 = 3/4 * cpa2EQ
    t104 = P1 ^ 2
    t105 = t104 * cpa2EQ
    t106 = P1 * cpa1EQ
    t107 = P2 * t106
    t108 = t103 - t105 - t107
    t109 = Q2 ^ 2
    t110 = t109 ^ 2
    t112 = P2 ^ 2
    t113 = cpa1EQ * t112
    t115 = P2 * P1
    t116 = cpa2EQ * t115
    t117 = 2 * t116
    t119 = 2 * t113 + t117 - 3/2 * cpa1EQ
    t121 = t104 * cpa3EQ
    t122 = t112 * cpa3EQ
    t124 = t109 * Q2
    t127 = 6 * t105
    t129 = cpa3EQ * P1
    t130 = P2 * Q1
    t131 = t130 * t129
    t135 = Q1 ^ 2
    t136 = t135 * Q1
    t138 = -t121 + t122
    t142 = 6 * t113
    t148 = t135 + 1
    t149 = -t108
    t158 = cos(psih)
    t159 = skm ^ 2
    t163 = sqrt(0.1e1 / skm)
    t164 = 0.1e1 / t163
    t165 = t164 * mu * sdelta
    t168 = 0.1e1 / t4
    t169 = t168 * pi
    t170 = 1 / t76
    t171 = GG ^ 2
    t172 = 0.1e1 / t171
    t173 = t172 * t170
    t174 = sma ^ 2
    t175 = t174 ^ 2
    t177 = 0.1e1 / t175 / t174
    t178 = t177 * t173
    t180 = eta ^ 2
    t181 = t180 ^ 2
    t183 = 0.1e1 / t181 / t180
    t184 = 0.1e1 / Jg
    t185 = t184 * t183
    t190 = 0.1e1 / t73 / mM1KK / n
    t191 = t190 * t185
    t192 = t191 * t178 * t169
    contr[1] = 9/8 * t192 * t165 * t159 * t158 * cdelta * (t110 * t108 + t124 * (Q1 * t119 + t121 - t122) + t109 * (-9/2 * cpa2EQ + t127 + 6 * t107 - 6 * t131) + Q2 * (t136 * t119 + 3 * t135 * t138 + Q1 * (9/2 * cpa1EQ - t142 - 6 * t116) - t121 + t122) + (t135 * t149 + t103 - t105 - t107 + 2 * t131) * t148) * IMz * t102
    t194 = -t138
    t195 = t135 ^ 2
    t197 = cpa3EQ * Q2
    t198 = t197 * t115
    t200 = 4 * t116
    t201 = 4 * t113
    t202 = 3 * cpa1EQ
    t205 = Q2 * t194
    t206 = 2 * t107
    t213 = t124 * cpa3EQ
    t227 = 4 * t105 + 4 * t107 - 3 * cpa2EQ
    t234 = sdelta ^ 2
    t235 = 2 * psih
    t236 = cos(t235)
    t238 = mu * t159
    t240 = t164 * t238 * t236 * t234
    contr[2] = 9/32 * t192 * t240 * (t195 * t194 + t136 * (8 * t198 + t200 + t201 - t202) - 6 * t135 * (t205 + t206 + 2 * t105 - 3/2 * cpa2EQ) * Q2 + Q1 * (-8 * t115 * t213 + t109 * (-12 * t116 - 12 * t113 + 9 * cpa1EQ) - t201 - t200 + t202) + t110 * t194 + t124 * t227 - Q2 * t227 + t121 - t122) * IMz * t102
    t244 = sin(psih)
    t248 = t164 * mu
    t259 = t107 + (-3/4 + t104) * cpa2EQ
    t261 = t121 / 2
    t262 = t122 / 2
    t277 = 9/4 * cpa2EQ - 3 * t105 - 3 * t107
    t281 = 3/4 * cpa1EQ
    t282 = -t281 + t116 + t113
    t284 = 2 * t198
    t286 = t109 + 1
    contr[3] = -9/4 * t191 * t178 * t168 * (t195 * (-t113 / 2 + 3/8 * cpa1EQ - t116 / 2) + t136 * (Q2 * t259 + t261 - t262) + t135 * (3 * t113 - 9/4 * cpa1EQ + 3 * t116 + 3 * t198) + Q1 * (t124 * t259 + 3/2 * t109 * t138 + Q2 * t277 - t261 + t262) + t286 * (t109 * t282 - t113 - t116 + t281 - t284) / 2) * pi * t248 * sdelta * t159 * t244 * cdelta * IMz * t102
    t297 = sin(t235)
    t298 = t159 * t297
    t305 = (-3/4 + t112) * cpa1EQ
    t314 = cpa3EQ * t109
    contr[4] = -9/8 * t192 * (-t195 * P2 * t129 / 2 + t136 * (t205 + t105 + t107 - t103) + 3 * t135 * (t198 + t116 + t305) * Q2 + Q1 * (t109 * t277 + t124 * t138 - t103 + t105 + t107) - (-P2 * t129 + Q2 * t119 + t115 * t314) * t286 / 2) * t248 * t298 * t234 * IMz * t102
    t327 = -t282
    t345 = IMz * (t234 - 2/3) * t164
    t348 = t170 * t168
    contr[5] = 27/8 * t191 * t177 * t172 * t348 * t345 * t102 * (t136 * t327 + t135 * (Q2 * t149 + t261 - t262) + Q1 * (t109 * t327 + t116 + t284 + t305) + (t109 * t149 + Q2 * t138 / 2 - t107 - t105 + t103) * Q2) * pi * t238
    t353 = t112 * cpa2EQ
    t356 = Q1 * cpa1EQ
    t357 = -t356 + cpa3EQ
    t368 = Q1 * cpa3EQ
    t376 = cpa1EQ * t136
    t377 = 2 * t376
    t378 = cpa3EQ * t135
    t381 = 2 * cpa3EQ
    t398 = cpa2EQ * t135 - cpa2EQ
    t400 = cpa1EQ * t135
    t413 = t104 + t112 - 3/2 * eta - 3/2
    t420 = 1 + eta
    t421 = t420 ^ 2
    t423 = 0.1e1 / t421 / t420
    t428 = t190 * t177 * t185 * t423 * t173 * t169
    t429 = t428 * t165 * t159 * t158 * cdelta * t413 * (t110 * (-t105 - t206 + t353) + t124 * (4 * t130 * cpa2EQ * P1 + 2 * t104 * t357 - 2 * t357 * t112) + t109 * (t127 - 12 * P1 * (t368 - cpa1EQ) * P2 - 6 * t353) + Q2 * (t104 * (-t377 - 6 * t378 + 6 * t356 - t381) + 4 * P1 * (t135 - 3) * Q1 * cpa2EQ * P2 + 2 * (t376 + 3 * t378 - 3 * t356 + cpa3EQ) * t112) + (t104 * t398 + 2 * P1 * (t400 + 2 * t368 - cpa1EQ) * P2 - t112 * t398) * t148) * IMz * t102
    contr[6] = 3/8 * t429
    t430 = t413 * IMz
    t431 = t195 * cpa3EQ
    t432 = Q2 * cpa2EQ
    t435 = t135 * (-6 * t314 - 6 * t432)
    t436 = cpa1EQ * t109
    t437 = 6 * t436
    t438 = 2 * cpa1EQ
    t442 = t124 * cpa2EQ
    t443 = 2 * t442
    t444 = 2 * t432
    t445 = t431 - t377 + t435 + Q1 * (t437 + t438) + t110 * cpa3EQ + t443 - t444 + cpa3EQ
    t447 = cpa2EQ / 2
    t449 = t136 * (t197 + t447)
    t450 = Q2 * t400
    t451 = 3/2 * t450
    t452 = t109 * cpa2EQ
    t453 = 3/2 * t452
    t456 = t124 * cpa1EQ
    t458 = cpa1EQ * Q2
    t469 = t428 * t240 * (t104 * t445 + 8 * P1 * (t449 - t451 + Q1 * (-t213 - t453 - t447) + t456 / 2 - t458 / 2) * P2 - t445 * t112) * t430 * t102
    contr[7] = 3/16 * t469
    t474 = cpa1EQ * t104
    t477 = t432 + cpa3EQ
    t511 = t436 - cpa1EQ
    t514 = t452 - 2 * t197 - cpa2EQ
    t527 = t428 * t164 * (t195 * (t474 - t117 - t113) + t136 * (4 * P2 * Q2 * t106 + 2 * t104 * t477 - 2 * t477 * t112) + t135 * (-6 * t474 + 12 * P1 * (t197 + cpa2EQ) * P2 + t142) + Q1 * (t104 * (t443 - 6 * t314 - 6 * t432 - t381) + 4 * P1 * (t109 - 3) * Q2 * cpa1EQ * P2 - 2 * (t442 - 3 * t314 - 3 * t432 - cpa3EQ) * t112) - t286 * (-2 * P1 * t514 * P2 + t104 * t511 - t112 * t511)) * mu * sdelta * t159 * t244 * cdelta * t430 * t102
    contr[8] = -3/8 * t527
    t535 = t449 - t451 + Q1 * (t447 - t453 - t213) + t286 * t458 / 2
    t550 = t428 * (t104 * t535 - P1 * (t431 - t377 + t435 + Q1 * (t437 - t438) + (t314 + t444 - cpa3EQ) * t286) * P2 / 2 - t535 * t112) * t248 * t298 * t234 * t430 * t102
    contr[9] = -3/4 * t550
    t556 = t376 + t135 * t477 + Q1 * t511 + (t452 - t197 - cpa2EQ) * Q2
    t579 = t190 * t177 * t183 * t184 * t423 * t172 * t348 * t345 * muM * t413 * t101 * pi * mu * t159 * (t104 * t556 - 2 * P1 * P2 * (Q1 * t514 + cpa2EQ * t136 - t450 - t456 + t458) - t556 * t112)
    contr[10] = 9/8 * t579
    contr[11] = -21/8 * t429
    contr[12] = -21/16 * t469
    contr[13] = 21/8 * t527
    contr[14] = 21/4 * t550
    contr[15] = -63/8 * t579   

    contr=sum(contr);
    return contr;
end

function meandZ3dJgP1_mixGravityMagnetic(k,m,skm,smk,mM1KK,KK,EE,PP,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,A,B,C,mu,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ)
    contr = zeros(15)
    t1 = sdelta * skm
    t2 = 3/4 * cpa2EQ
    t3 = P1 ^ 2
    t4 = t3 * cpa2EQ
    t5 = P1 * cpa1EQ
    t6 = P2 * t5
    t7 = t2 - t4 - t6
    t8 = Q2 ^ 2
    t9 = t8 ^ 2
    t11 = P2 ^ 2
    t12 = cpa1EQ * t11
    t14 = P2 * P1
    t15 = cpa2EQ * t14
    t16 = 2 * t15
    t18 = 2 * t12 + t16 - 3/2 * cpa1EQ
    t20 = t3 * cpa3EQ
    t21 = t11 * cpa3EQ
    t23 = t8 * Q2
    t26 = 6 * t4
    t28 = cpa3EQ * P1
    t29 = P2 * Q1
    t30 = t29 * t28
    t34 = Q1 ^ 2
    t35 = t34 * Q1
    t37 = -t20 + t21
    t41 = 6 * t12
    t47 = t34 + 1
    t48 = -t7
    t56 = cos(psih)
    t73 = ((A - 2 * B + C) * k + (m - 3) * B + (-2 * m + 3) * A + C * m) * KK - 3 * EE * ((-B + C) * k + A - B)
    t77 = sqrt(0.1e1 / skm)
    t78 = 0.1e1 / t77
    t79 = t78 * IMz * cdelta
    t82 = muM * pi
    t83 = 1 / k
    t84 = GG ^ 2
    t85 = 0.1e1 / t84
    t86 = t85 * t83
    t88 = sma ^ 2
    t89 = t88 ^ 2
    t91 = 0.1e1 / t89 / t88
    t92 = eta ^ 2
    t93 = t92 ^ 2
    t95 = 0.1e1 / t93 / t92
    t97 = Jg ^ 2
    t98 = 0.1e1 / t97
    t99 = KK ^ 2
    t100 = 1 / t99
    t102 = 0.1e1 / n
    t104 = t102 * t100 * t98 * t95 * t91
    contr[1] = 3/8 * t104 * t86 * t82 * t79 * t73 * t56 * (t9 * t7 + t23 * (Q1 * t18 + t20 - t21) + t8 * (-9/2 * cpa2EQ + t26 + 6 * t6 - 6 * t30) + Q2 * (t35 * t18 + 3 * t34 * t37 + Q1 * (9/2 * cpa1EQ - t41 - 6 * t15) - t20 + t21) + (t34 * t48 + t2 + 2 * t30 - t4 - t6) * t47) * mu * t1
    t107 = -t37
    t108 = t34 ^ 2
    t110 = cpa3EQ * Q2
    t111 = t110 * t14
    t113 = 4 * t15
    t114 = 4 * t12
    t115 = 3 * cpa1EQ
    t118 = Q2 * t107
    t119 = 2 * t6
    t126 = t23 * cpa3EQ
    t140 = 4 * t4 + 4 * t6 - 3 * cpa2EQ
    t146 = skm * mu
    t148 = 2 * psih
    t149 = cos(t148)
    t151 = IMz * muM
    t154 = sdelta ^ 2
    t155 = pi * t154
    t157 = t104 * t86 * t155
    contr[2] = 3/32 * t157 * t151 * t73 * t149 * t146 * (t108 * t107 + t35 * (8 * t111 + t113 + t114 - t115) - 6 * t34 * (t118 + t119 + 2 * t4 - 3/2 * cpa2EQ) * Q2 + Q1 * (-8 * t14 * t126 + t8 * (-12 * t15 - 12 * t12 + 9 * cpa1EQ) - t114 - t113 + t115) + t9 * t107 + t23 * t140 - Q2 * t140 + t20 - t21) * t78
    t159 = sin(psih)
    t165 = muM * t78 * IMz * cdelta * t73
    t174 = t6 + (-3/4 + t3) * cpa2EQ
    t176 = t20 / 2
    t177 = t21 / 2
    t192 = 9/4 * cpa2EQ - 3 * t4 - 3 * t6
    t196 = 3/4 * cpa1EQ
    t197 = -t196 + t15 + t12
    t199 = 2 * t111
    t201 = t8 + 1
    contr[3] = -3/4 * t104 * t86 * pi * (t108 * (-t12 / 2 + 3/8 * cpa1EQ - t15 / 2) + t35 * (Q2 * t174 + t176 - t177) + t34 * (3 * t12 - 9/4 * cpa1EQ + 3 * t15 + 3 * t111) + Q1 * (t23 * t174 + 3/2 * t8 * t37 + Q2 * t192 - t176 + t177) + t201 * (t8 * t197 - t12 - t15 + t196 - t199) / 2) * t165 * t159 * mu * t1
    t210 = skm * t78
    t217 = (-3/4 + t11) * cpa1EQ
    t226 = cpa3EQ * t8
    t236 = sin(t148)
    t237 = t73 * t236
    contr[4] = -3/8 * t157 * t151 * t237 * (-t108 * P2 * t28 / 2 + t35 * (t118 + t4 + t6 - t2) + 3 * t34 * (t111 + t15 + t217) * Q2 + Q1 * (t8 * t192 + t23 * t37 - t2 + t4 + t6) - (-P2 * t28 + Q2 * t18 + t14 * t226) * t201 / 2) * mu * t210
    t244 = t151 * (t154 - 2/3) * t78
    t245 = t73 * pi
    t248 = -t197
    contr[5] = 9/8 * t102 * t100 * t98 * t95 * t91 * t85 * t83 * (t35 * t248 + t34 * (Q2 * t48 + t176 - t177) + Q1 * (t8 * t248 + t15 + t199 + t217) + (t8 * t48 + Q2 * t37 / 2 - t6 - t4 + t2) * Q2) * t146 * t245 * t244
    t271 = t3 + t11 - 3/2 * eta - 3/2
    t272 = t271 * mu
    t276 = t11 * cpa2EQ
    t279 = Q1 * cpa1EQ
    t280 = -t279 + cpa3EQ
    t291 = Q1 * cpa3EQ
    t299 = cpa1EQ * t35
    t300 = 2 * t299
    t301 = cpa3EQ * t34
    t304 = 2 * cpa3EQ
    t321 = cpa2EQ * t34 - cpa2EQ
    t323 = t34 * cpa1EQ
    t335 = 1 + eta
    t336 = t335 ^ 2
    t338 = 0.1e1 / t336 / t335
    t339 = t338 * t86
    t342 = t104 * t339 * pi * (t9 * (-t4 - t119 + t276) + t23 * (4 * t29 * cpa2EQ * P1 - 2 * t280 * t11 + 2 * t3 * t280) + t8 * (t26 - 12 * P1 * (t291 - cpa1EQ) * P2 - 6 * t276) + Q2 * (t3 * (-t300 - 6 * t301 + 6 * t279 - t304) + 4 * P1 * (t34 - 3) * Q1 * cpa2EQ * P2 + 2 * (t299 + 3 * t301 - 3 * t279 + cpa3EQ) * t11) + (t3 * t321 + 2 * P1 * (t323 + 2 * t291 - cpa1EQ) * P2 - t11 * t321) * t47) * t165 * t56 * t272 * t1
    contr[6] = t342 / 8
    t343 = t108 * cpa3EQ
    t344 = Q2 * cpa2EQ
    t347 = t34 * (-6 * t226 - 6 * t344)
    t348 = t8 * cpa1EQ
    t349 = 6 * t348
    t350 = 2 * cpa1EQ
    t354 = t23 * cpa2EQ
    t355 = 2 * t354
    t356 = 2 * t344
    t357 = t343 - t300 + t347 + Q1 * (t349 + t350) + t9 * cpa3EQ + t355 - t356 + cpa3EQ
    t359 = cpa2EQ / 2
    t361 = t35 * (t110 + t359)
    t362 = Q2 * t323
    t363 = 3/2 * t362
    t364 = t8 * cpa2EQ
    t365 = 3/2 * t364
    t368 = t23 * cpa1EQ
    t370 = cpa1EQ * Q2
    t386 = t104 * t339 * t155
    t387 = t386 * muM * IMz * t73 * t149 * t271 * (t3 * t357 + 8 * P1 * (t361 - t363 + Q1 * (-t126 - t365 - t359) + t368 / 2 - t370 / 2) * P2 - t357 * t11) * mu * t210
    contr[7] = t387 / 16
    t388 = cpa1EQ * t3
    t391 = t344 + cpa3EQ
    t425 = t348 - cpa1EQ
    t428 = t364 - 2 * t110 - cpa2EQ
    t445 = t104 * t339 * t82 * t79 * t73 * t159 * t271 * mu * (t108 * (t388 - t16 - t12) + t35 * (4 * P2 * Q2 * t5 - 2 * t391 * t11 + 2 * t3 * t391) + t34 * (-6 * t388 + 12 * P1 * (t110 + cpa2EQ) * P2 + t41) + Q1 * (t3 * (t355 - 6 * t226 - 6 * t344 - t304) + 4 * P1 * (t8 - 3) * Q2 * cpa1EQ * P2 - 2 * (t354 - 3 * t226 - 3 * t344 - cpa3EQ) * t11) - t201 * (-2 * P1 * t428 * P2 - t11 * t425 + t3 * t425)) * t1
    contr[8] = -t445 / 8
    t452 = t361 - t363 + Q1 * (t359 - t365 - t126) + t201 * t370 / 2
    t468 = t386 * muM * (t3 * t452 - P1 * (t343 - t300 + t347 + Q1 * (t349 - t350) + (t226 + t356 - cpa3EQ) * t201) * P2 / 2 - t452 * t11) * IMz * t237 * t272 * t210
    contr[9] = -t468 / 4
    t474 = t299 + t34 * t391 + Q1 * t425 + (t364 - t110 - cpa2EQ) * Q2
    t492 = t104 * t338 * t85 * t83 * mu * skm * t271 * (t3 * t474 - 2 * P1 * P2 * (Q1 * t428 + cpa2EQ * t35 - t362 - t368 + t370) - t474 * t11) * t245 * t244
    contr[10] = 3/8 * t492
    contr[11] = -7/8 * t342
    contr[12] = -7/16 * t387
    contr[13] = 7/8 * t445
    contr[14] = 7/4 * t468
    contr[15] = -21/8 * t492   
    

    contr=sum(contr);
    return contr;
end

function meandZ3dcdeltaP1_mixGravityMagnetic(k,m,skm,smk,mM1KK,KK,EE,PP,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,A,B,C,mu,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ)
    contr = zeros(9)
    t2 = sqrt(0.1e1 / skm)
    t3 = 0.1e1 / t2
    t4 = skm * t3
    t5 = P1 ^ 2
    t6 = t5 * cpa3EQ
    t7 = P2 ^ 2
    t8 = t7 * cpa3EQ
    t9 = t6 - t8
    t10 = Q1 ^ 2
    t11 = t10 ^ 2
    t13 = P2 * P1
    t14 = cpa3EQ * Q2
    t15 = t14 * t13
    t17 = cpa2EQ * t13
    t18 = 4 * t17
    t19 = cpa1EQ * t7
    t20 = 4 * t19
    t21 = 3 * cpa1EQ
    t23 = t10 * Q1
    t25 = t9 * Q2
    t27 = cpa1EQ * P1 * P2
    t29 = t5 * cpa2EQ
    t36 = Q2 ^ 2
    t37 = t36 * Q2
    t38 = t37 * cpa3EQ
    t48 = t36 ^ 2
    t53 = 4 * t29 + 4 * t27 - 3 * cpa2EQ
    t60 = 2 * psih
    t61 = cos(t60)
    t78 = ((A - 2 * B + C) * k + (m - 3) * B + (-2 * m + 3) * A + C * m) * KK - 3 * EE * ((-B + C) * k + A - B)
    t79 = t78 * t61
    t80 = cdelta * IMz
    t83 = muM * pi
    t84 = 1 / k
    t85 = GG ^ 2
    t86 = 0.1e1 / t85
    t87 = t86 * t84
    t89 = sma ^ 2
    t90 = t89 ^ 2
    t92 = 0.1e1 / t90 / t89
    t93 = eta ^ 2
    t94 = t93 ^ 2
    t96 = 0.1e1 / t94 / t93
    t98 = 0.1e1 / Jg
    t99 = KK ^ 2
    t100 = 1 / t99
    t102 = 0.1e1 / n
    t104 = t102 * t100 * t98 * t96 * t92
    t105 = t104 * t87 * t83
    contr[1] = 3/16 * t105 * t80 * t79 * (t11 * t9 + t23 * (8 * t15 + t18 + t20 - t21) - 6 * t10 * (t25 + 2 * t27 + 2 * t29 - 3/2 * cpa2EQ) * Q2 + Q1 * (-8 * t13 * t38 + t36 * (-12 * t17 - 12 * t19 + 9 * cpa1EQ) - t20 - t18 + t21) + t48 * t9 + t37 * t53 - Q2 * t53 + t6 - t8) * mu * t4
    t107 = cpa3EQ * P1
    t111 = 3/4 * cpa2EQ
    t115 = (-3/4 + t7) * cpa1EQ
    t120 = -t9
    t129 = t36 + 1
    t130 = cpa3EQ * t36
    t144 = sin(t60)
    t145 = t78 * t144
    contr[2] = -3/4 * t105 * t80 * t145 * (-t11 * P2 * t107 / 2 + t23 * (t25 + t29 + t27 - t111) + 3 * t10 * (t15 + t17 + t115) * Q2 + Q1 * (t37 * t120 + t36 * (9/4 * cpa2EQ - 3 * t29 - 3 * t27) + t29 + t27 - t111) - (t13 * t130 + Q2 * (2 * t19 + 2 * t17 - 3/2 * cpa1EQ) - P2 * t107) * t129 / 2) * mu * t4
    t152 = IMz * pi * muM * t3
    t154 = 3/4 * cpa1EQ - t17 - t19
    t156 = t29 + t27 - t111
    t176 = t84 * mu
    contr[3] = 9/4 * t102 * t100 * t98 * t96 * t92 * t86 * t176 * cdelta * skm * (t23 * t154 + t10 * (Q2 * t156 + t6 / 2 - t8 / 2) + Q1 * (t36 * t154 + t115 + 2 * t15 + t17) + (t36 * t156 + Q2 * t120 / 2 - t27 - t29 + t111) * Q2) * t78 * t152
    t185 = t5 + t7 - 3/2 * eta - 3/2
    t187 = t185 * mu * t4
    t191 = t11 * cpa3EQ
    t192 = t23 * cpa1EQ
    t193 = 2 * t192
    t194 = Q2 * cpa2EQ
    t197 = t10 * (-6 * t130 - 6 * t194)
    t198 = cpa1EQ * t36
    t199 = 6 * t198
    t200 = 2 * cpa1EQ
    t206 = 2 * t194
    t207 = t191 - t193 + t197 + Q1 * (t199 + t200) + t48 * cpa3EQ + 2 * t37 * cpa2EQ - t206 + cpa3EQ
    t209 = cpa2EQ / 2
    t211 = t23 * (t14 + t209)
    t213 = Q2 * t10 * cpa1EQ
    t214 = 3/2 * t213
    t215 = t36 * cpa2EQ
    t216 = 3/2 * t215
    t219 = t37 * cpa1EQ
    t221 = cpa1EQ * Q2
    t230 = 1 + eta
    t231 = t230 ^ 2
    t233 = 0.1e1 / t231 / t230
    t234 = t233 * t87
    t237 = t104 * t234 * pi * (t5 * t207 + 8 * P1 * (t211 - t214 + Q1 * (-t38 - t216 - t209) + t219 / 2 - t221 / 2) * P2 - t207 * t7) * muM * t80 * t79 * t187
    contr[4] = t237 / 8
    t242 = t211 - t214 + Q1 * (t209 - t216 - t38) + t129 * t221 / 2
    t259 = t104 * t234 * t83 * (t5 * t242 - P1 * (t191 - t193 + t197 + Q1 * (t199 - t200) + (t130 + t206 - cpa3EQ) * t129) * P2 / 2 - t242 * t7) * t80 * t145 * t187
    contr[5] = -t259 / 2
    t268 = t192 + t10 * (t194 + cpa3EQ) + Q1 * (t198 - cpa1EQ) + (t215 - t14 - cpa2EQ) * Q2
    t287 = t104 * t233 * t86 * t176 * skm * cdelta * (t5 * t268 - 2 * P1 * P2 * (t23 * cpa2EQ - t213 + Q1 * (t215 - 2 * t14 - cpa2EQ) - t219 + t221) - t268 * t7) * t185 * t78 * t152
    contr[6] = 3/4 * t287
    contr[7] = -7/8 * t237
    contr[8] = 7/2 * t259
    contr[9] = -21/4 * t287
       
    contr=sum(contr);
    return contr;
end

function meandZ3dcdeltaP2_mixGravityMagnetic(k,m,skm,smk,mM1KK,KK,EE,PP,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,A,B,C,mu,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ)
    contr = zeros(6)
    t1 = 3/4 * cpa2EQ
    t2 = P1 ^ 2
    t3 = t2 * cpa2EQ
    t4 = P1 * cpa1EQ
    t5 = P2 * t4
    t6 = t1 - t3 - t5
    t7 = Q2 ^ 2
    t8 = t7 ^ 2
    t10 = P2 ^ 2
    t11 = cpa1EQ * t10
    t13 = P2 * P1
    t14 = cpa2EQ * t13
    t15 = 2 * t14
    t17 = 2 * t11 + t15 - 3/2 * cpa1EQ
    t19 = t2 * cpa3EQ
    t20 = t10 * cpa3EQ
    t22 = t7 * Q2
    t25 = 6 * t3
    t28 = P2 * Q1
    t29 = t28 * cpa3EQ * P1
    t33 = Q1 ^ 2
    t34 = t33 * Q1
    t36 = -t19 + t20
    t40 = 6 * t11
    t46 = t33 + 1
    t53 = cos(psih)
    t55 = skm * mu
    t57 = cdelta ^ 2
    t58 = t57 - 1/2
    t60 = sqrt(0.1e1 / skm)
    t61 = 0.1e1 / t60
    t62 = t61 * t58
    t79 = ((A - 2 * B + C) * k + (m - 3) * B + (-2 * m + 3) * A + C * m) * KK - 3 * EE * ((-B + C) * k + A - B)
    t80 = IMz * t79
    t81 = t80 * t62
    t83 = muM * pi
    t85 = GG ^ 2
    t87 = 1 / t85 / k
    t89 = sma ^ 2
    t90 = t89 ^ 2
    t93 = eta ^ 2
    t94 = t93 ^ 2
    t99 = KK ^ 2
    t104 = 1 / n / t99 / Jg / t94 / t93 / t90 / t89
    t105 = t104 * t87 * t83
    contr[1] = 3/4 * t105 * t81 * t55 * t53 * (t8 * t6 + t22 * (Q1 * t17 + t19 - t20) + t7 * (-9/2 * cpa2EQ + t25 + 6 * t5 - 6 * t29) + Q2 * (t34 * t17 + 3 * t33 * t36 + Q1 * (9/2 * cpa1EQ - t40 - 6 * t14) - t19 + t20) + (-t33 * t6 + t1 + 2 * t29 - t3 - t5) * t46)
    t111 = t33 ^ 2
    t115 = t5 + (-3/4 + t2) * cpa2EQ
    t117 = t19 / 2
    t118 = t20 / 2
    t124 = cpa3EQ * Q2
    t125 = t124 * t13
    t139 = 3/4 * cpa1EQ
    t144 = t7 + 1
    t148 = sin(psih)
    contr[2] = -3/2 * t105 * t81 * t55 * t148 * (t111 * (-t11 / 2 + 3/8 * cpa1EQ - t14 / 2) + t34 * (Q2 * t115 + t117 - t118) + t33 * (3 * t11 - 9/4 * cpa1EQ + 3 * t14 + 3 * t125) + Q1 * (t22 * t115 + 3/2 * t7 * t36 + Q2 * (9/4 * cpa2EQ - 3 * t3 - 3 * t5) - t117 + t118) + t144 * (t7 * (-t139 + t14 + t11) - 2 * t125 + t139 - t14 - t11) / 2)
    t156 = t2 + t10 - 3/2 * eta - 3/2
    t163 = t10 * cpa2EQ
    t166 = Q1 * cpa1EQ
    t167 = -t166 + cpa3EQ
    t178 = Q1 * cpa3EQ
    t186 = t34 * cpa1EQ
    t188 = cpa3EQ * t33
    t191 = 2 * cpa3EQ
    t208 = cpa2EQ * t33 - cpa2EQ
    t222 = 1 + eta
    t223 = t222 ^ 2
    t226 = 0.1e1 / t223 / t222 * t87
    t229 = t104 * t226 * pi * (t8 * (-t3 - 2 * t5 + t163) + t22 * (4 * t28 * cpa2EQ * P1 - 2 * t167 * t10 + 2 * t2 * t167) + t7 * (t25 - 12 * P1 * (t178 - cpa1EQ) * P2 - 6 * t163) + Q2 * (t2 * (-2 * t186 - 6 * t188 + 6 * t166 - t191) + 4 * P1 * (t33 - 3) * Q1 * cpa2EQ * P2 + 2 * (t186 + 3 * t188 - 3 * t166 + cpa3EQ) * t10) + (t2 * t208 + 2 * P1 * (t33 * cpa1EQ - cpa1EQ + 2 * t178) * P2 - t10 * t208) * t46) * muM * t80 * t62 * t156 * mu * skm * t53
    contr[3] = t229 / 4
    t231 = cpa1EQ * t2
    t234 = Q2 * cpa2EQ
    t235 = t234 + cpa3EQ
    t252 = t22 * cpa2EQ
    t254 = t7 * cpa3EQ
    t273 = cpa1EQ * t7 - cpa1EQ
    t295 = t104 * t226 * t83 * IMz * t79 * t61 * t58 * t156 * mu * (t111 * (t231 - t15 - t11) + t34 * (4 * P2 * Q2 * t4 - 2 * t235 * t10 + 2 * t2 * t235) + t33 * (-6 * t231 + 12 * P1 * (t124 + cpa2EQ) * P2 + t40) + Q1 * (t2 * (2 * t252 - 6 * t254 - 6 * t234 - t191) + 4 * P1 * (t7 - 3) * Q2 * cpa1EQ * P2 - 2 * (t252 - 3 * t254 - 3 * t234 - cpa3EQ) * t10) - t144 * (t2 * t273 - 2 * P1 * (t7 * cpa2EQ - cpa2EQ - 2 * t124) * P2 - t10 * t273)) * skm * t148
    contr[4] = -t295 / 4
    contr[5] = -7/4 * t229
    contr[6] = 7/4 * t295
        

    contr=sum(contr);
    return contr;
end

function meandZ3dpsih_mixGravityMagnetic(k,m,skm,smk,mM1KK,KK,EE,PP,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,A,B,C,mu,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ)
    contr = zeros(12)
    t1 = sdelta * skm
    t2 = sin(psih)
    t3 = t2 * mu
    t5 = cdelta * IMz
    t7 = sqrt(0.1e1 / skm)
    t8 = 0.1e1 / t7
    t25 = ((A - 2 * B + C) * k + (m - 3) * B + (-2 * m + 3) * A + C * m) * KK - 3 * EE * ((-B + C) * k + A - B)
    t26 = t25 * t8
    t27 = 3/4 * cpa2EQ
    t28 = P1 ^ 2
    t29 = t28 * cpa2EQ
    t30 = P1 * cpa1EQ
    t31 = P2 * t30
    t32 = t27 - t29 - t31
    t33 = Q2 ^ 2
    t34 = t33 ^ 2
    t36 = P2 ^ 2
    t37 = cpa1EQ * t36
    t39 = P2 * P1
    t40 = cpa2EQ * t39
    t41 = 2 * t40
    t43 = 2 * t37 + t41 - 3/2 * cpa1EQ
    t45 = t28 * cpa3EQ
    t46 = t36 * cpa3EQ
    t48 = t33 * Q2
    t51 = 6 * t29
    t53 = cpa3EQ * P1
    t54 = P2 * Q1
    t55 = t54 * t53
    t59 = Q1 ^ 2
    t60 = t59 * Q1
    t62 = -t45 + t46
    t66 = 6 * t37
    t72 = t59 + 1
    t84 = GG ^ 2
    t86 = 1 / t84 / k
    t88 = sma ^ 2
    t89 = t88 ^ 2
    t92 = eta ^ 2
    t93 = t92 ^ 2
    t98 = KK ^ 2
    t103 = 1 / n / t98 / Jg / t93 / t92 / t89 / t88
    contr[1] = 3/8 * t103 * t86 * muM * pi * (t34 * t32 + t48 * (Q1 * t43 + t45 - t46) + t33 * (-9/2 * cpa2EQ + t51 + 6 * t31 - 6 * t55) + Q2 * (t60 * t43 + 3 * t59 * t62 + Q1 * (9/2 * cpa1EQ - t66 - 6 * t40) - t45 + t46) + (-t59 * t32 + t27 - t29 - t31 + 2 * t55) * t72) * t26 * t5 * t3 * t1
    t106 = skm * t8
    t107 = 2 * psih
    t108 = sin(t107)
    t112 = -t62
    t113 = t59 ^ 2
    t115 = cpa3EQ * Q2
    t116 = t115 * t39
    t118 = 4 * t40
    t119 = 4 * t37
    t120 = 3 * cpa1EQ
    t123 = Q2 * t112
    t124 = 2 * t31
    t131 = t48 * cpa3EQ
    t145 = 4 * t29 + 4 * t31 - 3 * cpa2EQ
    t153 = sdelta ^ 2
    t156 = t103 * t86 * pi * t153
    contr[2] = 3/16 * t156 * (t113 * t112 + t60 * (8 * t116 + t118 + t119 - t120) - 6 * t59 * (t123 + t124 + 2 * t29 - 3/2 * cpa2EQ) * Q2 + Q1 * (-8 * t39 * t131 + t33 * (-12 * t40 - 12 * t37 + 9 * cpa1EQ) - t119 - t118 + t120) + t34 * t112 + t48 * t145 - Q2 * t145 + t45 - t46) * muM * t25 * IMz * t108 * mu * t106
    t158 = cos(psih)
    t162 = muM * t26 * t5
    t171 = t31 + (-3/4 + t28) * cpa2EQ
    t173 = t45 / 2
    t174 = t46 / 2
    t189 = 9/4 * cpa2EQ - 3 * t29 - 3 * t31
    t193 = 3/4 * cpa1EQ
    t198 = t33 + 1
    contr[3] = 3/4 * t103 * t86 * pi * (t113 * (-t37 / 2 + 3/8 * cpa1EQ - t40 / 2) + t60 * (Q2 * t171 + t173 - t174) + t59 * (3 * t37 - 9/4 * cpa1EQ + 3 * t40 + 3 * t116) + Q1 * (t48 * t171 + 3/2 * t33 * t62 + Q2 * t189 - t173 + t174) + t198 * (t33 * (-t193 + t40 + t37) - 2 * t116 + t193 - t40 - t37) / 2) * t162 * t158 * mu * t1
    t221 = cpa3EQ * t33
    t231 = cos(t107)
    t233 = muM * t25
    contr[4] = 3/4 * t156 * t233 * IMz * t231 * (-t113 * P2 * t53 / 2 + t60 * (t123 + t29 + t31 - t27) + 3 * t59 * (t116 + t40 + (-3/4 + t36) * cpa1EQ) * Q2 + Q1 * (t33 * t189 + t48 * t62 - t27 + t29 + t31) - (-P2 * t53 + Q2 * t43 + t39 * t221) * t198 / 2) * mu * t106
    t240 = t36 * cpa2EQ
    t243 = Q1 * cpa1EQ
    t244 = -t243 + cpa3EQ
    t255 = Q1 * cpa3EQ
    t263 = cpa1EQ * t60
    t264 = 2 * t263
    t265 = cpa3EQ * t59
    t268 = 2 * cpa3EQ
    t285 = cpa2EQ * t59 - cpa2EQ
    t287 = t59 * cpa1EQ
    t305 = 1 + eta
    t306 = t305 ^ 2
    t311 = t103 / t306 / t305 * t86 * pi * (t28 + t36 - 3/2 * eta - 3/2)
    t312 = t311 * muM * (t34 * (-t29 - t124 + t240) + t48 * (4 * t54 * cpa2EQ * P1 + 2 * t28 * t244 - 2 * t244 * t36) + t33 * (t51 - 12 * P1 * (t255 - cpa1EQ) * P2 - 6 * t240) + Q2 * (t28 * (-t264 - 6 * t265 + 6 * t243 - t268) + 4 * P1 * (t59 - 3) * Q1 * cpa2EQ * P2 + 2 * (t263 + 3 * t265 - 3 * t243 + cpa3EQ) * t36) + (t28 * t285 + 2 * P1 * (t287 + 2 * t255 - cpa1EQ) * P2 - t36 * t285) * t72) * t25 * t8 * IMz * cdelta * t3 * t1
    contr[5] = t312 / 8
    t313 = t113 * cpa3EQ
    t314 = Q2 * cpa2EQ
    t317 = t59 * (-6 * t221 - 6 * t314)
    t318 = t33 * cpa1EQ
    t319 = 6 * t318
    t320 = 2 * cpa1EQ
    t324 = t48 * cpa2EQ
    t325 = 2 * t324
    t326 = 2 * t314
    t327 = t313 - t264 + t317 + Q1 * (t319 + t320) + t34 * cpa3EQ + t325 - t326 + cpa3EQ
    t329 = cpa2EQ / 2
    t331 = t60 * (t115 + t329)
    t333 = 3/2 * Q2 * t287
    t334 = t33 * cpa2EQ
    t335 = 3/2 * t334
    t340 = cpa1EQ * Q2
    t351 = t153 * t233
    t354 = t311 * t351 * IMz * t108 * (t28 * t327 + 8 * P1 * (t331 - t333 + Q1 * (-t131 - t335 - t329) + t48 * cpa1EQ / 2 - t340 / 2) * P2 - t327 * t36) * mu * t106
    contr[6] = t354 / 8
    t355 = cpa1EQ * t28
    t358 = t314 + cpa3EQ
    t392 = t318 - cpa1EQ
    t409 = t311 * t162 * t158 * mu * skm * sdelta * (t113 * (t355 - t41 - t37) + t60 * (4 * P2 * Q2 * t30 + 2 * t28 * t358 - 2 * t358 * t36) + t59 * (-6 * t355 + 12 * P1 * (t115 + cpa2EQ) * P2 + t66) + Q1 * (t28 * (t325 - 6 * t221 - 6 * t314 - t268) + 4 * P1 * (t33 - 3) * Q2 * cpa1EQ * P2 - 2 * (t324 - 3 * t221 - 3 * t314 - cpa3EQ) * t36) - t198 * (t28 * t392 - 2 * P1 * (t334 - 2 * t115 - cpa2EQ) * P2 - t36 * t392))
    contr[7] = t409 / 8
    t416 = t331 - t333 + Q1 * (t329 - t335 - t131) + t198 * t340 / 2
    t431 = t311 * t351 * IMz * (t28 * t416 - P1 * (t313 - t264 + t317 + Q1 * (t319 - t320) + (t221 + t326 - cpa3EQ) * t198) * P2 / 2 - t416 * t36) * t231 * mu * t106
    contr[8] = t431 / 2
    contr[9] = -7/8 * t312
    contr[10] = -7/8 * t354
    contr[11] = -7/8 * t409
    contr[12] = -7/2 * t431
       

    contr=sum(contr);
    return contr;
end

function meandZ3cdeltadpsigMdpsihOsdelta_mixGravityMagnetic(k,m,skm,smk,mM1KK,KK,EE,PP,T2,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,A,B,C,mu,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ)
    contr = zeros(12)
    t1 = sin(psih)
    t2 = skm * t1
    t3 = 3/4 * cpa2EQ
    t4 = P1 ^ 2
    t5 = t4 * cpa2EQ
    t6 = P1 * cpa1EQ
    t7 = P2 * t6
    t8 = t3 - t5 - t7
    t9 = Q2 ^ 2
    t10 = t9 ^ 2
    t12 = P2 ^ 2
    t13 = cpa1EQ * t12
    t15 = P2 * P1
    t16 = cpa2EQ * t15
    t17 = 2 * t16
    t19 = 2 * t13 + t17 - 3/2 * cpa1EQ
    t21 = t4 * cpa3EQ
    t22 = t12 * cpa3EQ
    t24 = t9 * Q2
    t27 = 6 * t5
    t29 = cpa3EQ * P1
    t30 = P2 * Q1
    t31 = t30 * t29
    t35 = Q1 ^ 2
    t36 = t35 * Q1
    t38 = -t21 + t22
    t42 = 6 * t13
    t48 = t35 + 1
    t58 = sqrt(0.1e1 / skm)
    t59 = 0.1e1 / t58
    t76 = ((A - 2 * B + C) * k + (m - 3) * B + (-2 * m + 3) * A + C * m) * KK - 3 * EE * ((-B + C) * k + A - B)
    t77 = t76 * t59
    t78 = cdelta * IMz
    t81 = muM * pi
    t83 = GG ^ 2
    t85 = 1 / t83 / k
    t87 = sma ^ 2
    t88 = t87 ^ 2
    t91 = eta ^ 2
    t92 = t91 ^ 2
    t97 = KK ^ 2
    t102 = 1 / n / t97 / Jg / t92 / t91 / t88 / t87
    contr[1] = -3/8 * t102 * t85 * t81 * t78 * t77 * (t10 * t8 + t24 * (Q1 * t19 + t21 - t22) + t9 * (-9/2 * cpa2EQ + t27 + 6 * t7 - 6 * t31) + Q2 * (t36 * t19 + 3 * t35 * t38 + Q1 * (9/2 * cpa1EQ - t42 - 6 * t16) - t21 + t22) + (-t35 * t8 + t3 + 2 * t31 - t5 - t7) * t48) * mu * t2
    t106 = -t38
    t107 = t35 ^ 2
    t109 = cpa3EQ * Q2
    t110 = t109 * t15
    t112 = 4 * t16
    t113 = 4 * t13
    t114 = 3 * cpa1EQ
    t117 = Q2 * t106
    t118 = 2 * t7
    t125 = t24 * cpa3EQ
    t139 = 4 * t5 + 4 * t7 - 3 * cpa2EQ
    t147 = 2 * psih
    t148 = sin(t147)
    t150 = IMz * muM
    t153 = sdelta * pi
    t155 = t102 * t85 * t153
    contr[2] = -3/16 * t155 * t150 * t76 * t148 * skm * mu * (t107 * t106 + t36 * (8 * t110 + t112 + t113 - t114) - 6 * t35 * (t117 + t118 + 2 * t5 - 3/2 * cpa2EQ) * Q2 + Q1 * (-8 * t15 * t125 + t9 * (-12 * t16 - 12 * t13 + 9 * cpa1EQ) - t113 - t112 + t114) + t10 * t106 + t24 * t139 - Q2 * t139 + t21 - t22) * t59
    t158 = cos(psih)
    t159 = skm * t158
    t162 = cdelta * t76
    t172 = t7 + (-3/4 + t4) * cpa2EQ
    t174 = t21 / 2
    t175 = t22 / 2
    t190 = 9/4 * cpa2EQ - 3 * t5 - 3 * t7
    t194 = 3/4 * cpa1EQ
    t199 = t9 + 1
    contr[3] = -3/4 * t102 * t85 * pi * (t107 * (-t13 / 2 + 3/8 * cpa1EQ - t16 / 2) + t36 * (Q2 * t172 + t174 - t175) + t35 * (3 * t13 - 9/4 * cpa1EQ + 3 * t16 + 3 * t110) + Q1 * (t24 * t172 + 3/2 * t9 * t38 + Q2 * t190 - t174 + t175) + t199 * (t9 * (-t194 + t16 + t13) - 2 * t110 + t194 - t16 - t13) / 2) * t150 * t162 * t59 * mu * t159
    t208 = skm * t59
    t224 = t9 * cpa3EQ
    t234 = cos(t147)
    t235 = t76 * t234
    contr[4] = -3/4 * t155 * t150 * t235 * (-t107 * P2 * t29 / 2 + t36 * (t117 + t5 + t7 - t3) + 3 * t35 * (t110 + t16 + (-3/4 + t12) * cpa1EQ) * Q2 + Q1 * (t9 * t190 + t24 * t38 - t3 + t5 + t7) - (-P2 * t29 + Q2 * t19 + t15 * t224) * t199 / 2) * mu * t208
    t241 = t4 + t12 - 3/2 * eta - 3/2
    t242 = t241 * mu
    t247 = t12 * cpa2EQ
    t250 = Q1 * cpa1EQ
    t251 = -t250 + cpa3EQ
    t262 = Q1 * cpa3EQ
    t270 = cpa1EQ * t36
    t271 = 2 * t270
    t272 = cpa3EQ * t35
    t275 = 2 * cpa3EQ
    t292 = cpa2EQ * t35 - cpa2EQ
    t294 = cpa1EQ * t35
    t306 = 1 + eta
    t307 = t306 ^ 2
    t310 = 0.1e1 / t307 / t306 * t85
    t313 = t102 * t310 * pi * (t10 * (-t5 - t118 + t247) + t24 * (4 * t30 * cpa2EQ * P1 - 2 * t251 * t12 + 2 * t4 * t251) + t9 * (t27 - 12 * P1 * (t262 - cpa1EQ) * P2 - 6 * t247) + Q2 * (t4 * (-t271 - 6 * t272 + 6 * t250 - t275) + 4 * P1 * (t35 - 3) * Q1 * cpa2EQ * P2 + 2 * (t270 + 3 * t272 - 3 * t250 + cpa3EQ) * t12) + (t4 * t292 + 2 * P1 * (t294 + 2 * t262 - cpa1EQ) * P2 - t12 * t292) * t48) * muM * t78 * t77 * t242 * t2
    contr[5] = -t313 / 8
    t315 = t107 * cpa3EQ
    t316 = Q2 * cpa2EQ
    t319 = t35 * (-6 * t224 - 6 * t316)
    t320 = t9 * cpa1EQ
    t321 = 6 * t320
    t322 = 2 * cpa1EQ
    t326 = t24 * cpa2EQ
    t327 = 2 * t326
    t328 = 2 * t316
    t329 = t315 - t271 + t319 + Q1 * (t321 + t322) + t10 * cpa3EQ + t327 - t328 + cpa3EQ
    t331 = cpa2EQ / 2
    t333 = t36 * (t109 + t331)
    t335 = 3/2 * Q2 * t294
    t336 = t9 * cpa2EQ
    t337 = 3/2 * t336
    t342 = cpa1EQ * Q2
    t358 = t102 * t310 * t153
    t359 = t358 * muM * IMz * t76 * t148 * t241 * (t4 * t329 + 8 * P1 * (t333 - t335 + Q1 * (-t125 - t337 - t331) + t24 * cpa1EQ / 2 - t342 / 2) * P2 - t329 * t12) * mu * t208
    contr[6] = -t359 / 8
    t361 = cpa1EQ * t4
    t364 = t316 + cpa3EQ
    t398 = t320 - cpa1EQ
    t418 = t102 * t310 * t81 * IMz * t162 * t59 * t241 * mu * (t107 * (t361 - t17 - t13) + t36 * (4 * P2 * Q2 * t6 - 2 * t364 * t12 + 2 * t4 * t364) + t35 * (-6 * t361 + 12 * P1 * (t109 + cpa2EQ) * P2 + t42) + Q1 * (t4 * (t327 - 6 * t224 - 6 * t316 - t275) + 4 * P1 * (t9 - 3) * Q2 * cpa1EQ * P2 - 2 * (t326 - 3 * t224 - 3 * t316 - cpa3EQ) * t12) - t199 * (t4 * t398 - 2 * P1 * (t336 - 2 * t109 - cpa2EQ) * P2 - t12 * t398)) * t159
    contr[7] = -t418 / 8
    t425 = t333 - t335 + Q1 * (t331 - t337 - t125) + t199 * t342 / 2
    t441 = t358 * muM * (t4 * t425 - P1 * (t315 - t271 + t319 + Q1 * (t321 - t322) + (t224 + t328 - cpa3EQ) * t199) * P2 / 2 - t425 * t12) * IMz * t235 * t242 * t208
    contr[8] = -t441 / 2
    contr[9] = 7/8 * t313
    contr[10] = 7/8 * t359
    contr[11] = 7/8 * t418
    contr[12] = 7/2 * t441
       

    contr=sum(contr);
    return contr;
end


function meandZ3dcsigma1_mixGravityMagnetic_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,A,B,C,mu,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ)
    contr = zeros(19)

    t1 = cos(psih)
    t2 = A - C
    t5 = 3/4 * cpa2EQ
    t6 = P2 * P1
    t7 = cpa1EQ * t6
    t8 = P1 ^ 2
    t9 = cpa2EQ * t8
    t10 = t5 + t7 + t9
    t11 = Q2 ^ 2
    t12 = t11 ^ 2
    t13 = t11 * t12
    t15 = cpa2EQ * t6
    t16 = P2 ^ 2
    t18 = (t16 + 3/4) * cpa1EQ
    t19 = t15 + t18
    t21 = Q2 * t12
    t24 = Q1 ^ 2
    t26 = 2 * t9
    t27 = 5 * t7
    t29 = (t16 - 3/4) * cpa2EQ
    t32 = 3/8 * cpa1EQ
    t33 = cpa1EQ * t16
    t34 = t33 / 2
    t35 = t15 / 2
    t36 = t32 + t34 + t35
    t38 = cpa1EQ * t8
    t41 = Q2 * t11
    t44 = -t10
    t45 = t24 ^ 2
    t47 = 9/2 * cpa2EQ
    t48 = 6 * t9
    t49 = 6 * t7
    t53 = Q1 * cpa3EQ * t6
    t58 = 3/4 * cpa1EQ
    t59 = 3 * t15
    t62 = cpa3EQ * t8
    t63 = cpa3EQ * t16
    t64 = -t62 + t63
    t65 = 2 * t64
    t67 = t38 / 2
    t73 = t24 * t45
    t75 = 3 * t7
    t77 = -5 * t16 - 15/4
    t81 = cpa3EQ * P1
    t82 = Q1 * t24
    t90 = t13 * t10 - 2 * t21 * t19 * Q1 + t12 * (t24 * t10 - t26 - t27 + t29) - 8 * t41 * Q1 * (t24 * t36 + t32 - t34 - t35 + t38) + t11 * (t45 * t44 + t24 * (-t47 - t48 + t49) + 8 * t53 - t26 - t27 + t29) - 4 * Q2 * (t45 * t36 + t24 * (t38 + t58 - t59) + Q1 * t65 - t67 - t33 - 9/8 * cpa1EQ + t35) * Q1 + t73 * t44 + t45 * (t77 * cpa2EQ + t75) - 8 * t82 * P2 * t81 + t24 * (-t77 * cpa2EQ - t75) + t9 + t7 + t5
    t92 = sqrt(skm)
    t93 = t92 + 1/3
    t98 = t92 - 1/3
    t99 = t24 + t11 + 1
    t100 = t99 ^ 2
    t102 = 0.1e1 / t99 / t100
    t103 = t102 * t98
    t105 = sma ^ 2
    t106 = t105 ^ 2
    t108 = 0.1e1 / t105 / t106
    t109 = eta ^ 2
    t110 = t109 ^ 2
    t112 = 0.1e1 / t109 / t110
    t114 = 0.1e1 / Jg
    t115 = 0.1e1 / n
    t117 = t115 * t114 * t112 * t108
    contr[1] = 27/4 * t117 * t103 * IMz * sdelta * cdelta * t93 * muM * t90 * mu * t2 * t1
    t120 = 2 * psih
    t121 = cos(t120)
    t122 = t2 * t121
    t124 = sdelta ^ 2
    t125 = mu * t124
    t126 = -t64
    t129 = P2 * Q2 * t81
    t130 = 8 * t129
    t131 = 4 * t15
    t132 = 4 * t33
    t133 = 3 * cpa1EQ
    t137 = 2 * t7
    t138 = 3/2 * cpa2EQ
    t145 = 8 * t41 * P2 * t81
    t146 = 12 * t15
    t153 = t12 * t126
    t154 = 4 * t9
    t155 = 4 * t7
    t157 = t154 + t155 + 3 * cpa2EQ
    t166 = 0.1e1 / t100
    contr[2] = 27/16 * t117 * t166 * t98 * IMz * muM * (t45 * t126 + t82 * (t130 + t131 + t132 + t133) - 6 * t24 * (Q2 * t126 + t137 + t138 + t26) * Q2 + Q1 * (-t145 + t11 * (-t146 - 12 * t33 - 9 * cpa1EQ) - t132 - t131 - t133) + t153 + t41 * t157 - Q2 * t157 + t62 - t63) * t125 * t93 * t122
    t170 = sin(psih)
    t171 = t2 * t170
    t174 = cdelta * IMz
    t177 = -t15 - t58 - t33
    t181 = t7 + (t8 + 3/4) * cpa2EQ
    t183 = Q1 * t45
    t187 = 2 * t33
    t188 = 5 * t15
    t190 = (3/4 - t8) * cpa1EQ
    t194 = cpa2EQ * t16
    t195 = 2 * t194
    t200 = -t177
    t202 = 6 * t15
    t203 = 6 * t33
    t221 = 5 * t8 + 15/4
    t229 = t73 * t177 + 2 * t183 * Q2 * t181 + t45 * (t11 * t177 + t187 + t188 + t190) + 4 * t82 * (t11 * t181 + t195 + t5 - t7 - t9) * Q2 + t24 * (t12 * t200 + t11 * (-t202 + t203 + 9/2 * cpa1EQ) + t130 + t187 + t188 + t190) + 2 * Q1 * Q2 * (t12 * t181 + t11 * (-t49 + t195 + t138) + 4 * Q2 * t64 + t7 - t26 - t194 - 9/4 * cpa2EQ) + t13 * t200 + t12 * (t221 * cpa1EQ - t59) - t145 + t11 * (-t221 * cpa1EQ + t59) - t15 - t58 - t33
    contr[3] = 27/4 * t117 * t103 * sdelta * t229 * t174 * t93 * muM * mu * t171
    t234 = sin(t120)
    t235 = t2 * t234
    t237 = mu * muM
    t240 = Q2 * t65
    t247 = -t65
    t248 = t41 * t247
    t253 = t11 + 1
    t255 = t11 * P2 * t81
    t256 = 2 * t15
    t260 = P2 * t81
    t267 = t93 * t98
    contr[4] = 27/8 * t117 * t166 * t267 * (t45 * P2 * t81 + t82 * (t240 - t137 - t138 - t26) - 6 * t24 * Q2 * (t129 + t15 + t18) + Q1 * (t248 + t11 * (t49 + t48 + t47) - t137 - t138 - t26) + (t255 + Q2 * (t187 + t256 + 3/2 * cpa1EQ) - t260) * t253) * IMz * t237 * t124 * t235
    t271 = t2 * t93
    t275 = t62 / 2
    t276 = t63 / 2
    t285 = Q2 * t64 / 2
    t289 = t124 - 2
    t293 = mu * t98
    t294 = GG ^ 2
    t295 = 0.1e1 / t294
    contr[5] = 27/4 * t117 * t295 * t293 * muM * t289 * (t82 * t19 + t24 * (Q2 * t44 - t275 + t276) + Q1 * (t11 * t19 - 2 * t129 - t15 - t33 - t58) - Q2 * (t11 * t10 + t285 - t5 - t7 - t9)) * IMz * t271
    t299 = t93 * t1
    t300 = t9 / 2
    t301 = t194 / 2
    t302 = -t7 - t300 + t301
    t303 = t73 * t302
    t304 = t38 - t256 - t33
    t305 = t304 * Q2
    t306 = t183 * t305
    t307 = t11 * t302
    t308 = 21/4 * t7
    t309 = 29/8 * t9
    t310 = 29/8 * t194
    t313 = 2 * t38
    t315 = t41 * (t313 - t131 - t187)
    t316 = 5 * t38
    t318 = 5 * t33
    t321 = 8 * t260
    t324 = -t302
    t325 = t12 * t324
    t332 = 8 * Q2 * t126
    t335 = t12 * t304
    t336 = 3 * t38
    t337 = 3 * t33
    t346 = 7/8 * t9
    t347 = 7/8 * t194
    t355 = t174 * t237
    t359 = -2/3 * t8 - 2/3 * t16 + eta + 1
    t360 = t98 * t359
    t361 = t102 * sdelta
    t363 = 1 + eta
    t364 = t363 ^ 2
    t366 = 0.1e1 / t363 / t364
    t370 = t115 * t114 * t112 * t108 * t366
    t371 = t370 * t361 * t360
    contr[6] = 27/4 * t371 * t355 * (t303 + t306 + t45 * (t307 + t308 + t309 - t310) + t82 * (t315 + Q2 * (-t316 + 18 * t15 + t318) - t321) + t24 * (t325 + t11 * (-27/4 * t9 + 27/4 * t194 - 3/2 * t7) + t332 - t308 - t309 + t310) + Q1 * (t335 + t11 * (-t336 - t256 + t337) + t130 - 7/4 * t38 + 7/4 * t33 - t35) * Q2 + t253 * (t325 + t11 * (-15/4 * t7 - t346 + t347) + t7 + t300 - t301)) * t2 * t299
    t373 = t125 * t122
    t374 = t45 * cpa3EQ
    t375 = t82 * cpa1EQ
    t376 = 2 * t375
    t377 = t11 * cpa3EQ
    t378 = Q2 * cpa2EQ
    t381 = t24 * (-6 * t377 - 6 * t378)
    t382 = t11 * cpa1EQ
    t383 = 6 * t382
    t384 = 2 * cpa1EQ
    t387 = t12 * cpa3EQ
    t390 = 2 * t378
    t391 = t374 - t376 + t381 + Q1 * (t383 + t384) + t387 + 2 * t41 * cpa2EQ - t390 + cpa3EQ
    t393 = Q2 * cpa3EQ
    t394 = 2 * t393
    t395 = t394 + cpa2EQ
    t396 = t82 * t395
    t398 = Q2 * t24 * cpa1EQ
    t399 = 3 * t398
    t401 = 2 * t41 * cpa3EQ
    t402 = t11 * cpa2EQ
    t403 = 3 * t402
    t406 = t41 * cpa1EQ
    t407 = cpa1EQ * Q2
    t415 = t359 * IMz
    t420 = t117 * t366 * t166 * t267
    contr[7] = 27/16 * t420 * t415 * muM * (t8 * t391 + 4 * P1 * (t396 - t399 + Q1 * (-t401 - t403 - cpa2EQ) + t406 - t407) * P2 - t391 * t16) * t373
    t422 = 3 * psih
    t423 = cos(t422)
    t427 = muM * cdelta
    t430 = cpa2EQ * t45
    t435 = Q2 * Q1
    t436 = cpa1EQ * t435
    t437 = t253 * t402
    t441 = t45 * cpa1EQ
    t442 = 2 * t382
    t446 = 2 * cpa2EQ * t435
    t451 = 2 * t402
    t454 = 2 * t436
    t460 = t102 * t93
    t463 = t370 * t460 * t98 * (t8 * (t430 / 2 + t24 * (t11 - 1/2) * cpa2EQ + t436 + t437 / 2) + P1 * P2 * (t441 + t24 * (t442 - cpa1EQ) - t446 + t253 * t382) - t16 * (t430 + t24 * (t451 - cpa2EQ) + t454 + t437) / 2) * t415 * t427 * sdelta * mu * t2 * t423
    contr[8] = 81/16 * t463
    t465 = t13 * t304
    t468 = 4 * t21 * Q1 * t324
    t469 = t24 * t304
    t470 = 17/4 * t33
    t471 = 9/2 * t15
    t472 = 17/4 * t38
    t476 = 4 * t194
    t477 = -t154 - 8 * t7 + t476
    t484 = t41 * (t82 * t477 + Q1 * (t154 + 24 * t7 - t476) + 16 * t260)
    t485 = -t304
    t486 = t45 * t485
    t493 = 16 * Q1 * t126
    t496 = t45 * t324
    t497 = 3 * t9
    t498 = 3 * t194
    t500 = t24 * (-t497 - t137 + t498)
    t501 = 4 * t53
    t507 = t24 + 1
    t508 = t45 * t304
    contr[9] = -27/8 * t371 * t355 * (t465 - t468 + t12 * (t469 + t470 + t471 - t472) + t484 + t11 * (t486 + t24 * (15/2 * t38 + 9 * t15 - 15/2 * t33) + t493 - t471 - t470 + t472) - 4 * Q2 * (t496 + t500 + t501 + t7 / 4 - t346 + t347) * Q1 - (t508 + t24 * (-19/4 * t38 + 19/4 * t33 + 27/2 * t15) + t38 - t33 - t256) * t507) * t2 * t93 * t170
    t524 = t401 + t403 - cpa2EQ
    t526 = t253 * t407
    contr[10] = 27/8 * t420 * t415 * t237 * (t8 * (Q1 * t524 - t82 * t395 + t399 - t526) + P1 * (t374 - t376 + t381 + Q1 * (t383 - t384) + (t377 + t390 - cpa3EQ) * t253) * P2 + (-Q1 * t524 + t396 - t399 + t526) * t16) * t124 * t235
    t546 = sin(t422)
    t551 = t441 + t24 * (t442 + cpa1EQ) + t446 + t12 * cpa1EQ - t382
    t567 = t370 * t460 * t360 * t355 * sdelta * (t8 * t551 - 2 * P1 * (t430 + t24 * (t451 + cpa2EQ) - t454 + t12 * cpa2EQ - t402) * P2 - t551 * t16) * t2 * t546
    contr[11] = -81/32 * t567
    t580 = t375 + t24 * (t378 + cpa3EQ) + Q1 * (t382 - cpa1EQ) + (t402 - t393 - cpa2EQ) * Q2
    contr[12] = -27/8 * t117 * t366 * t295 * (t8 * t580 - 2 * P1 * (cpa2EQ * t82 - t398 + Q1 * (t402 - t394 - cpa2EQ) - t406 + t407) * P2 - t16 * t580) * mu * t98 * muM * t289 * IMz * t359 * t271
    t597 = 13/4 * t9
    t598 = 13/4 * t194
    t599 = 9/2 * t7
    t613 = 6 * t38
    t619 = 5/4 * t9
    t620 = 5/4 * t194
    contr[13] = 27/4 * t371 * t355 * (t303 + t306 + t45 * (t307 + t597 - t598 + t599) + t82 * (t315 + Q2 * (-t313 + t146 + t187) - t321) + t24 * (t325 + t11 * (-3/2 * t9 + 3/2 * t194 + 9 * t7) + t332 - t597 + t598 - t599) + Q1 * (t335 + t11 * (-t613 + t131 + t203) + t130 - t188 + t67 - t34) * Q2 + t253 * (t325 + t11 * (-t599 - t619 + t620) + t300 - t301 + t7)) * t2 * t299
    t633 = 5 * t64
    t643 = (t305 + 2 * t260) * Q2
    t665 = t26 + t155 - t195
    t675 = t366 * t102
    contr[14] = 27/16 * t117 * t675 * t267 * t415 * (t73 * t126 + t183 * (t130 - t313 + t131 + t187) + t45 * (t11 * t633 + Q2 * (-t48 - 12 * t7 + 6 * t194) + t62 - t63) + 4 * t82 * t643 + t24 * (-Q2 * t477 + 6 * t11 * t64 + t12 * t633 + t41 * t477 + t62 - t63) + Q1 * (-8 * t21 * P2 * t81 + t12 * (t613 - t146 - t203) - t145 + t11 * (-4 * t38 + 8 * t15 + t132) + t313 - t187 - t131) + (-Q2 * t665 + t41 * t665 + t153 + t62 - t63) * t253) * muM * t373
    contr[15] = 81/8 * t463
    t679 = 7/2 * t38
    t680 = 7/2 * t33
    contr[16] = -27/8 * t370 * t361 * t93 * IMz * t427 * t293 * (t465 - t468 + t12 * (t469 - t679 + t680 + t59) + t484 + t11 * (t486 + t24 * (9 * t38 + t202 - 9 * t33) + t493 - t59 - t680 + t679) - 4 * Q2 * Q1 * (t496 + t500 + t501 - t7 / 2 - t619 + t620) - t507 * (t508 + t24 * (-11/2 * t38 + 11/2 * t33 + 15 * t15) + t38 - t33 - t256)) * t359 * t171
    t727 = 10 * t7
    t728 = 5 * t9
    t729 = 5 * t194
    t732 = t387 * t6
    t736 = t316 - 10 * t15 - t318
    t753 = cpa3EQ * t73 * t6 + t183 * (t240 - t137 - t9 + t194) + t45 * (-5 * t255 + Q2 * (t336 - t202 - t337) + t260) + t82 * (t11 * t665 + t240 - t727 - t728 + t729) + t24 * (Q2 * t736 - 6 * t255 - t260 + t315 - 5 * t732) + Q1 * (t21 * t247 + t12 * (t497 + t49 - t498) + t248 + t11 * (t728 + t727 - t729) - t137 - t9 + t194) + cpa3EQ * t13 * t6 + t21 * t485 + t732 - t41 * t736 - t255 + Q2 * t485 - t260
    contr[17] = 27/8 * t117 * t675 * t98 * t753 * muM * IMz * mu * t93 * t124 * t359 * t235
    contr[18] = -81/16 * t567
    t763 = t304 * t289
    t787 = cpa3EQ * P2
    t788 = t289 * P1
    contr[19] = -27/8 * t117 * t366 / GG / t294 * (t183 * t763 + 2 * t45 * t289 * (Q2 * t324 + t275 - t276) + 2 * t82 * t289 * t643 + t24 * (4 * t41 * t324 * t289 - 12 * Q2 * t324 * t124 + t289 * (P1 + P2) * cpa3EQ * (P1 - P2)) + Q1 * (4 * Q2 * t788 * t787 + 6 * t11 * t304 * t124 + 4 * t41 * t788 * t787 + t12 * t763 - t763) + 2 * t253 * t289 * (t11 * t324 + t285 - t300 + t301 - t7) * Q2) * t237 * t267 * IMz * t359 * t2
    
  
    contr = sum(contr)
    return contr

end

function meandZ3dJgP1_mixGravityMagnetic_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,A,B,C,mu,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ)
    contr = zeros(19)

    t1 = cos(psih)
    t2 = 3/4 * cpa2EQ
    t3 = P2 * P1
    t4 = cpa1EQ * t3
    t5 = P1 ^ 2
    t6 = cpa2EQ * t5
    t7 = t2 + t4 + t6
    t8 = Q2 ^ 2
    t9 = t8 ^ 2
    t10 = t8 * t9
    t12 = cpa2EQ * t3
    t13 = P2 ^ 2
    t15 = (t13 + 3/4) * cpa1EQ
    t18 = Q2 * t9
    t21 = Q1 ^ 2
    t23 = 2 * t6
    t24 = 5 * t4
    t26 = (t13 - 3/4) * cpa2EQ
    t29 = 3/8 * cpa1EQ
    t30 = cpa1EQ * t13
    t31 = t30 / 2
    t32 = t12 / 2
    t33 = t29 + t31 + t32
    t35 = cpa1EQ * t5
    t38 = Q2 * t8
    t41 = -t7
    t42 = t21 ^ 2
    t44 = 9/2 * cpa2EQ
    t45 = 6 * t6
    t46 = 6 * t4
    t50 = Q1 * cpa3EQ * t3
    t55 = 3/4 * cpa1EQ
    t56 = 3 * t12
    t59 = cpa3EQ * t5
    t60 = cpa3EQ * t13
    t61 = -t59 + t60
    t62 = 2 * t61
    t64 = t35 / 2
    t70 = t21 * t42
    t72 = 3 * t4
    t74 = -5 * t13 - 15/4
    t78 = cpa3EQ * P1
    t79 = Q1 * t21
    t87 = t10 * t7 - 2 * t18 * (t12 + t15) * Q1 + t9 * (t21 * t7 - t23 - t24 + t26) - 8 * t38 * Q1 * (t21 * t33 + t29 - t31 - t32 + t35) + t8 * (t42 * t41 + t21 * (-t44 - t45 + t46) + 8 * t50 - t23 - t24 + t26) - 4 * Q2 * (t42 * t33 + t21 * (t35 + t55 - t56) + Q1 * t62 - t64 - t30 - 9/8 * cpa1EQ + t32) * Q1 + t70 * t41 + t42 * (t74 * cpa2EQ + t72) - 8 * t79 * P2 * t78 + t21 * (-t74 * cpa2EQ - t72) + t6 + t4 + t2
    t92 = 1 - skm
    t96 = (A - 2 * C) * skm - 2 * t92 * A + t92 * C + A
    t98 = sqrt(skm)
    t99 = mu * t98
    t100 = muM * IMz
    t101 = t100 * t99
    t103 = sdelta * cdelta
    t104 = t21 + t8 + 1
    t105 = t104 ^ 2
    t107 = 0.1e1 / t104 / t105
    t109 = sma ^ 2
    t110 = t109 ^ 2
    t112 = 0.1e1 / t109 / t110
    t113 = eta ^ 2
    t114 = t113 ^ 2
    t116 = 0.1e1 / t113 / t114
    t118 = Jg ^ 2
    t119 = 0.1e1 / t118
    t120 = 0.1e1 / n
    t122 = t120 * t119 * t116 * t112
    contr[1] = -3/4 * t122 * t107 * t103 * t101 * t96 * t87 * t1
    t126 = 2 * psih
    t127 = cos(t126)
    t128 = sdelta ^ 2
    t129 = t128 * t127
    t130 = -t61
    t133 = P2 * Q2 * t78
    t134 = 8 * t133
    t135 = 4 * t12
    t136 = 4 * t30
    t137 = 3 * cpa1EQ
    t141 = 2 * t4
    t142 = 3/2 * cpa2EQ
    t149 = 8 * t38 * P2 * t78
    t150 = 12 * t12
    t157 = t9 * t130
    t158 = 4 * t6
    t159 = 4 * t4
    t161 = t158 + t159 + 3 * cpa2EQ
    t167 = t96 * mu
    t168 = muM * t167
    t170 = t98 * IMz
    t171 = 0.1e1 / t105
    t173 = t122 * t171 * t170
    contr[2] = -3/16 * t173 * t168 * (t42 * t130 + t79 * (t134 + t135 + t136 + t137) - 6 * t21 * (Q2 * t130 + t141 + t142 + t23) * Q2 + Q1 * (-t149 + t8 * (-t150 - 12 * t30 - 9 * cpa1EQ) - t136 - t135 - t137) + t157 + t38 * t161 - Q2 * t161 + t59 - t60) * t129
    t176 = sin(psih)
    t177 = t96 * t176
    t179 = mu * muM
    t183 = -t12 - t55 - t30
    t187 = t4 + (t5 + 3/4) * cpa2EQ
    t189 = Q1 * t42
    t192 = t8 * t183
    t193 = 2 * t30
    t194 = 5 * t12
    t196 = (3/4 - t5) * cpa1EQ
    t200 = cpa2EQ * t13
    t201 = 2 * t200
    t206 = -t183
    t208 = 6 * t12
    t209 = 6 * t30
    t227 = 5 * t5 + 15/4
    t235 = t70 * t183 + 2 * t189 * Q2 * t187 + t42 * (t192 + t193 + t194 + t196) + 4 * t79 * (t8 * t187 + t2 + t201 - t4 - t6) * Q2 + t21 * (t9 * t206 + t8 * (-t208 + t209 + 9/2 * cpa1EQ) + t134 + t193 + t194 + t196) + 2 * Q1 * Q2 * (t9 * t187 + t8 * (-t46 + t201 + t142) + 4 * Q2 * t61 + t4 - t23 - t200 - 9/4 * cpa2EQ) + t10 * t206 + t9 * (t227 * cpa1EQ - t56) - t149 + t8 * (-t227 * cpa1EQ + t56) - t12 - t55 - t30
    contr[3] = -3/4 * t122 * t107 * sdelta * t235 * IMz * cdelta * t179 * t98 * t177
    t241 = sin(t126)
    t244 = Q2 * t62
    t251 = -t62
    t252 = t38 * t251
    t257 = t8 + 1
    t259 = t8 * P2 * t78
    t260 = 2 * t12
    t264 = P2 * t78
    contr[4] = -3/8 * t173 * t168 * t128 * (t42 * P2 * t78 + t79 * (t244 - t141 - t142 - t23) - 6 * t21 * Q2 * (t133 + t12 + t15) + Q1 * (t252 + t8 * (t46 + t45 + t44) - t141 - t142 - t23) + (t259 + Q2 * (t193 + t260 + 3/2 * cpa1EQ) - t264) * t257) * t241
    t276 = t59 / 2
    t277 = t60 / 2
    t285 = Q2 * t61 / 2
    t290 = t128 - 2
    t294 = GG ^ 2
    t295 = 0.1e1 / t294
    contr[5] = 3/4 * t120 * t119 * t116 * t112 * t295 * t96 * mu * t290 * IMz * (t79 * t183 + t21 * (Q2 * t7 + t276 - t277) + Q1 * (t192 + 2 * t133 + t12 + t15) + Q2 * (t8 * t7 - t2 + t285 - t4 - t6)) * t98 * muM
    t303 = t99 * t96 * t1
    t304 = t6 / 2
    t305 = t200 / 2
    t306 = -t4 - t304 + t305
    t307 = t70 * t306
    t308 = t35 - t260 - t30
    t309 = t308 * Q2
    t310 = t189 * t309
    t311 = t8 * t306
    t312 = 21/4 * t4
    t313 = 29/8 * t6
    t314 = 29/8 * t200
    t317 = 2 * t35
    t319 = t38 * (t317 - t135 - t193)
    t320 = 5 * t35
    t322 = 5 * t30
    t325 = 8 * t264
    t328 = -t306
    t329 = t9 * t328
    t336 = 8 * Q2 * t130
    t339 = t9 * t308
    t340 = 3 * t35
    t341 = 3 * t30
    t350 = 7/8 * t6
    t351 = 7/8 * t200
    t360 = -2/3 * t5 - 2/3 * t13 + eta + 1
    t361 = t360 * IMz
    t364 = 1 + eta
    t365 = t364 ^ 2
    t367 = 0.1e1 / t364 / t365
    t368 = t367 * t107
    t370 = t122 * t368 * t103
    contr[6] = -3/4 * t370 * t361 * muM * (t307 + t310 + t42 * (t311 + t312 + t313 - t314) + t79 * (t319 + Q2 * (-t320 + 18 * t12 + t322) - t325) + t21 * (t329 + t8 * (-27/4 * t6 + 27/4 * t200 - 3/2 * t4) + t336 - t312 - t313 + t314) + Q1 * (t339 + t8 * (-t340 - t260 + t341) + t134 - 7/4 * t35 + 7/4 * t30 - t32) * Q2 + t257 * (t329 + t8 * (-15/4 * t4 - t350 + t351) + t4 + t304 - t305)) * t303
    t373 = mu * t129
    t374 = muM * t96
    t375 = t170 * t374
    t377 = t42 * cpa3EQ
    t378 = t79 * cpa1EQ
    t379 = 2 * t378
    t380 = cpa3EQ * t8
    t381 = Q2 * cpa2EQ
    t384 = t21 * (-6 * t380 - 6 * t381)
    t385 = cpa1EQ * t8
    t386 = 6 * t385
    t387 = 2 * cpa1EQ
    t390 = t9 * cpa3EQ
    t393 = 2 * t381
    t394 = t377 - t379 + t384 + Q1 * (t386 + t387) + t390 + 2 * t38 * cpa2EQ - t393 + cpa3EQ
    t396 = Q2 * cpa3EQ
    t397 = 2 * t396
    t398 = t397 + cpa2EQ
    t399 = t79 * t398
    t401 = Q2 * t21 * cpa1EQ
    t402 = 3 * t401
    t404 = 2 * t38 * cpa3EQ
    t405 = cpa2EQ * t8
    t406 = 3 * t405
    t409 = t38 * cpa1EQ
    t410 = cpa1EQ * Q2
    t418 = t367 * t171
    contr[7] = -3/16 * t122 * t418 * (t5 * t394 + 4 * P1 * (t399 - t402 + Q1 * (-t404 - t406 - cpa2EQ) + t409 - t410) * P2 - t394 * t13) * t360 * t375 * t373
    t423 = 3 * psih
    t424 = cos(t423)
    t426 = cpa2EQ * t42
    t431 = Q2 * Q1
    t432 = cpa1EQ * t431
    t433 = t257 * t405
    t437 = t42 * cpa1EQ
    t438 = 2 * t385
    t442 = 2 * cpa2EQ * t431
    t447 = 2 * t405
    t450 = 2 * t432
    t461 = t122 * t368 * cdelta * t360 * t375 * mu * (t5 * (t426 / 2 + t21 * (t8 - 1/2) * cpa2EQ + t432 + t433 / 2) + P1 * P2 * (t437 + t21 * (t438 - cpa1EQ) - t442 + t257 * t385) - t13 * (t426 + t21 * (t447 - cpa2EQ) + t450 + t433) / 2) * sdelta * t424
    contr[8] = -9/16 * t461
    t463 = t10 * t308
    t466 = 4 * t18 * Q1 * t328
    t467 = t21 * t308
    t468 = 17/4 * t30
    t469 = 9/2 * t12
    t470 = 17/4 * t35
    t474 = 4 * t200
    t475 = -t158 - 8 * t4 + t474
    t482 = t38 * (t79 * t475 + Q1 * (t158 + 24 * t4 - t474) + 16 * t264)
    t483 = -t308
    t484 = t42 * t483
    t491 = 16 * Q1 * t130
    t494 = t42 * t328
    t495 = 3 * t6
    t496 = 3 * t200
    t498 = t21 * (-t495 - t141 + t496)
    t499 = 4 * t50
    t505 = t21 + 1
    t506 = t42 * t308
    contr[9] = 3/8 * t370 * t361 * t179 * t98 * (t463 - t466 + t9 * (t467 + t468 + t469 - t470) + t482 + t8 * (t484 + t21 * (15/2 * t35 + 9 * t12 - 15/2 * t30) + t491 - t469 - t468 + t470) - 4 * Q2 * (t494 + t498 + t499 + t4 / 4 - t350 + t351) * Q1 - (t506 + t21 * (-19/4 * t35 + 19/4 * t30 + 27/2 * t12) + t35 - t30 - t260) * t505) * t177
    t523 = t404 + t406 - cpa2EQ
    t525 = t257 * t410
    t543 = t360 * t98
    contr[10] = -3/8 * t122 * t418 * t543 * t100 * t167 * (t5 * (Q1 * t523 - t79 * t398 + t402 - t525) + P1 * (t377 - t379 + t384 + Q1 * (t386 - t387) + (t380 + t393 - cpa3EQ) * t257) * P2 + (-Q1 * t523 + t399 - t402 + t525) * t13) * t128 * t241
    t548 = sin(t423)
    t556 = t437 + t21 * (t438 + cpa1EQ) + t442 + t9 * cpa1EQ - t385
    t570 = t122 * t368 * (t5 * t556 - 2 * P1 * (t426 + t21 * (t447 + cpa2EQ) - t450 + t9 * cpa2EQ - t405) * P2 - t556 * t13) * cdelta * t543 * t100 * t167 * sdelta * t548
    contr[11] = 9/32 * t570
    t578 = t378 + t21 * (t381 + cpa3EQ) + Q1 * (t385 - cpa1EQ) + (t405 - t396 - cpa2EQ) * Q2
    t588 = t5 * t578 + 2 * P1 * P2 * (-cpa2EQ * t79 + t401 + Q1 * (-t405 + t397 + cpa2EQ) + t409 - t410) - t13 * t578
    t592 = IMz * (3 * skm - 1)
    t596 = t5 + t13 - 3/2 * eta - 3/2
    t600 = t122 * t367 * t295 * t596 * t290
    t604 = 3/2 * skm - 1/2
    t607 = t98 * C
    contr[12] = -t600 * t592 * t588 * t98 * A * t179 / 4 + t600 * IMz * t588 * t607 * mu * muM * t604 / 2
    t613 = 13/4 * t6
    t614 = 13/4 * t200
    t615 = 9/2 * t4
    t629 = 6 * t35
    t635 = 5/4 * t6
    t636 = 5/4 * t200
    contr[13] = -3/4 * t370 * t361 * (t307 + t310 + t42 * (t311 + t613 - t614 + t615) + t79 * (t319 + Q2 * (-t317 + t150 + t193) - t325) + t21 * (t329 + t8 * (-3/2 * t6 + 3/2 * t200 + 9 * t4) + t336 - t613 + t614 - t615) + Q1 * (t339 + t8 * (-t629 + t135 + t209) + t134 - t194 + t64 - t31) * Q2 + t257 * (t329 + t8 * (-t615 - t635 + t636) + t304 - t305 + t4)) * muM * t303
    t650 = 5 * t61
    t660 = (t309 + 2 * t264) * Q2
    t682 = t23 + t159 - t201
    contr[14] = -3/16 * t122 * t368 * t543 * t100 * t96 * (t70 * t130 + t189 * (t134 - t317 + t135 + t193) + t42 * (t8 * t650 + Q2 * (-t45 - 12 * t4 + 6 * t200) + t59 - t60) + 4 * t79 * t660 + t21 * (-Q2 * t475 + t38 * t475 + 6 * t8 * t61 + t9 * t650 + t59 - t60) + Q1 * (-8 * t18 * P2 * t78 + t9 * (t629 - t150 - t209) - t149 + t8 * (-4 * t35 + 8 * t12 + t136) + t317 - t193 - t135) + (-Q2 * t682 + t38 * t682 + t157 + t59 - t60) * t257) * t373
    contr[15] = -9/8 * t461
    t697 = 7/2 * t35
    t698 = 7/2 * t30
    contr[16] = 3/8 * t370 * t101 * t96 * t360 * (t463 - t466 + t9 * (t467 - t697 + t698 + t56) + t482 + t8 * (t484 + t21 * (9 * t35 + t208 - 9 * t30) + t491 - t56 - t698 + t697) - 4 * Q2 * Q1 * (t494 + t498 + t499 - t4 / 2 - t635 + t636) - t505 * (t506 + t21 * (-11/2 * t35 + 11/2 * t30 + 15 * t12) + t35 - t30 - t260)) * t176
    t737 = 10 * t4
    t738 = 5 * t6
    t739 = 5 * t200
    t742 = t390 * t3
    t746 = t320 - 10 * t12 - t322
    t763 = cpa3EQ * t70 * t3 + t189 * (t244 - t141 - t6 + t200) + t42 * (-5 * t259 + Q2 * (t340 - t208 - t341) + t264) + t79 * (t8 * t682 + t244 - t737 - t738 + t739) + t21 * (Q2 * t746 - 6 * t259 - t264 + t319 - 5 * t742) + Q1 * (t18 * t251 + t9 * (t495 + t46 - t496) + t252 + t8 * (t738 + t737 - t739) - t141 - t6 + t200) + cpa3EQ * t10 * t3 + t18 * t483 + t742 - t38 * t746 - t259 + Q2 * t483 - t264
    contr[17] = -3/8 * t122 * t368 * t170 * t374 * t763 * mu * t128 * t360 * t241
    contr[18] = 9/16 * t570
    t771 = t308 * t290
    t795 = cpa3EQ * P2
    t796 = t290 * P1
    t816 = mu * (t189 * t771 + 2 * t42 * t290 * (Q2 * t328 + t276 - t277) + 2 * t79 * t290 * t660 + t21 * (4 * t38 * t328 * t290 - 12 * Q2 * t328 * t128 + t290 * (P1 + P2) * cpa3EQ * (P1 - P2)) + Q1 * (4 * Q2 * t796 * t795 + 6 * t8 * t308 * t128 + 4 * t38 * t796 * t795 + t9 * t771 - t771) + 2 * t257 * t290 * (t8 * t328 + t285 - t304 + t305 - t4) * Q2) * muM
    t824 = t122 * t367 / GG / t294 * t596
    contr[19] = -t824 * t592 * t98 * A * t816 / 4 + t824 * IMz * t604 * t607 * t816 / 2
        

    contr = sum(contr)
    return contr

end

function meandZ3dcdelta1_mixGravityMagnetic_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,A,B,C,mu,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ)
    contr = zeros(9)

    t1 = 2 * psih
    t2 = cos(t1)
    t3 = P1 ^ 2
    t4 = cpa3EQ * t3
    t5 = P2 ^ 2
    t6 = cpa3EQ * t5
    t7 = t4 - t6
    t8 = Q1 ^ 2
    t9 = t8 ^ 2
    t11 = cpa3EQ * P1
    t13 = P2 * Q2 * t11
    t14 = 8 * t13
    t15 = P2 * P1
    t16 = cpa2EQ * t15
    t17 = 4 * t16
    t18 = cpa1EQ * t5
    t19 = 4 * t18
    t20 = 3 * cpa1EQ
    t22 = Q1 * t8
    t25 = cpa1EQ * t15
    t26 = 2 * t25
    t27 = cpa2EQ * t3
    t28 = 2 * t27
    t29 = 3/2 * cpa2EQ
    t34 = Q2 ^ 2
    t35 = Q2 * t34
    t37 = t35 * P2 * t11
    t38 = 8 * t37
    t39 = 12 * t16
    t46 = t34 ^ 2
    t47 = t46 * t7
    t48 = 4 * t27
    t49 = 4 * t25
    t51 = t48 + t49 + 3 * cpa2EQ
    t61 = 1 - skm
    t65 = (A - 2 * C) * skm - 2 * t61 * A + t61 * C + A
    t66 = muM * t65
    t67 = IMz * t66
    t69 = sqrt(skm)
    t70 = t8 + t34 + 1
    t71 = t70 ^ 2
    t72 = 1 / t71
    t74 = sma ^ 2
    t75 = t74 ^ 2
    t77 = 0.1e1 / t74 / t75
    t79 = eta ^ 2
    t80 = t79 ^ 2
    t82 = 0.1e1 / t79 / t80
    t83 = 0.1e1 / Jg
    t84 = t83 * t82
    t85 = 0.1e1 / n
    t87 = cdelta * t85 * t84
    t88 = t87 * t77 * t72 * t69
    contr[1] = -3/8 * t88 * t67 * mu * (t9 * t7 + t22 * (t14 + t17 + t19 + t20) - 6 * t8 * (Q2 * t7 + t26 + t28 + t29) * Q2 + Q1 * (-t38 + t34 * (-t39 - 12 * t18 - 9 * cpa1EQ) - t19 - t17 - t20) + t47 + t35 * t51 - Q2 * t51 + t4 - t6) * t2
    t91 = sin(t1)
    t94 = -t7
    t95 = 2 * t94
    t96 = Q2 * t95
    t100 = (t5 + 3/4) * cpa1EQ
    t105 = -t95
    t106 = t35 * t105
    t107 = 6 * t25
    t108 = 6 * t27
    t114 = t34 + 1
    t116 = t34 * P2 * t11
    t117 = 2 * t18
    t118 = 2 * t16
    t122 = P2 * t11
    contr[2] = -3/4 * t88 * t67 * mu * (t9 * P2 * t11 + t22 * (t96 - t26 - t29 - t28) - 6 * t8 * Q2 * (t13 + t16 + t100) + Q1 * (t106 + t34 * (t107 + t108 + 9/2 * cpa2EQ) - t26 - t29 - t28) + (t116 + Q2 * (t117 + t118 + 3/2 * cpa1EQ) - t122) * t114) * t91
    t132 = t16 + t100
    t134 = 3/4 * cpa2EQ
    t135 = -t134 - t27 - t25
    t149 = Q2 * t94 / 2
    t156 = GG ^ 2
    t157 = 0.1e1 / t156
    contr[3] = -3/2 * t85 * t84 * t77 * t157 * mu * t69 * t66 * (t22 * t132 + t8 * (Q2 * t135 - t4 / 2 + t6 / 2) + Q1 * (t34 * t132 - 2 * t13 - t18 - t16 - 3/4 * cpa1EQ) - Q2 * (-t34 * t135 - t134 + t149 - t25 - t27)) * IMz * cdelta
    t164 = mu * t2
    t166 = muM * IMz
    t169 = -2/3 * t3 - 2/3 * t5 + eta + 1
    t173 = t9 * cpa3EQ
    t174 = t22 * cpa1EQ
    t175 = 2 * t174
    t176 = t34 * cpa3EQ
    t177 = Q2 * cpa2EQ
    t180 = t8 * (-6 * t176 - 6 * t177)
    t181 = t34 * cpa1EQ
    t182 = 6 * t181
    t183 = 2 * cpa1EQ
    t186 = t46 * cpa3EQ
    t189 = 2 * t177
    t190 = t173 - t175 + t180 + Q1 * (t182 + t183) + t186 + 2 * t35 * cpa2EQ - t189 + cpa3EQ
    t192 = Q2 * cpa3EQ
    t193 = 2 * t192
    t194 = t193 + cpa2EQ
    t195 = t22 * t194
    t197 = Q2 * t8 * cpa1EQ
    t198 = 3 * t197
    t200 = 2 * t35 * cpa3EQ
    t201 = t34 * cpa2EQ
    t202 = 3 * t201
    t205 = t35 * cpa1EQ
    t206 = cpa1EQ * Q2
    t214 = 1 + eta
    t215 = t214 ^ 2
    t217 = 0.1e1 / t214 / t215
    t218 = t77 * t217
    contr[4] = -3/8 * t87 * t218 * t72 * (t3 * t190 + 4 * P1 * (t195 - t198 + Q1 * (-t200 - t202 - cpa2EQ) + t205 - t206) * P2 - t190 * t5) * t169 * t69 * t166 * t65 * t164
    t225 = t200 + t202 - cpa2EQ
    t227 = t114 * t206
    t245 = t69 * IMz * t66
    contr[5] = -3/4 * t87 * t218 * t72 * t169 * t245 * mu * (t3 * (Q1 * t225 - t22 * t194 + t198 - t227) + P1 * (t173 - t175 + t180 + Q1 * (t182 - t183) + (t176 + t189 - cpa3EQ) * t114) * P2 + (-Q1 * t225 + t195 - t198 + t227) * t5) * t91
    t253 = IMz * t169 * cdelta
    t263 = t174 + t8 * (t177 + cpa3EQ) + Q1 * (t181 - cpa1EQ) + (t201 - t192 - cpa2EQ) * Q2
    t278 = t85 * t83 * t82 * t77
    contr[6] = 3/4 * t278 * t217 * t157 * (t3 * t263 - 2 * P1 * (cpa2EQ * t22 - t197 + Q1 * (t201 - t193 - cpa2EQ) - t205 + t206) * P2 - t5 * t263) * mu * t69 * t66 * t253
    t281 = t8 * t9
    t283 = cpa1EQ * t3
    t284 = 2 * t283
    t286 = Q1 * t9
    t288 = 5 * t94
    t291 = cpa2EQ * t5
    t294 = Q2 * (-t108 - 12 * t25 + 6 * t291)
    t297 = t283 - t118 - t18
    t302 = t22 * (Q2 * t297 + 2 * t122) * Q2
    t307 = -t48 - 8 * t25 + 4 * t291
    t315 = Q2 * t46
    t321 = 6 * t283 - t39 - 6 * t18
    t330 = t28 + t49 - 2 * t291
    t331 = t35 * t330
    t340 = 1 / t70 / t71
    contr[7] = -3/8 * t87 * t218 * t340 * t169 * t245 * (t281 * t7 + t286 * (t14 - t284 + t17 + t117) + t9 * (t34 * t288 + t294 + t4 - t6) + 4 * t302 + t8 * (-Q2 * t307 + t46 * t288 + t35 * t307 + 6 * t34 * t94 + t4 - t6) + Q1 * (-8 * t315 * P2 * t11 + t46 * t321 - t38 + t34 * (-4 * t283 + 8 * t16 + t19) + t284 - t117 - t17) + (-Q2 * t330 + t331 + t4 + t47 - t6) * t114) * t164
    t361 = 10 * t25
    t362 = 5 * t27
    t363 = 5 * t291
    t366 = t186 * t15
    t374 = 5 * t283 - 10 * t16 - 5 * t18
    t390 = -t297
    t395 = cpa3EQ * t281 * t15 + t286 * (t96 - t26 - t27 + t291) + t9 * (-5 * t116 + Q2 * (3 * t283 - 6 * t16 - 3 * t18) + t122) + t22 * (t34 * t330 - t361 - t362 + t363 + t96) + t8 * (-5 * t366 + t35 * (t284 - t17 - t117) - 6 * t116 + Q2 * t374 - t122) + Q1 * (t315 * t105 + t46 * (3 * t27 + t107 - 3 * t291) + t106 + t34 * (t362 + t361 - t363) - t26 - t27 + t291) + cpa3EQ * t34 * t46 * t15 + t315 * t390 + t366 - t35 * t374 - t116 + Q2 * t390 - t122
    contr[8] = -3/4 * t87 * t218 * t340 * t69 * t166 * t65 * t395 * mu * t169 * t91
    t419 = t27 / 2
    t420 = t291 / 2
    contr[9] = 3/4 * t278 * t217 / GG / t156 * mu * t69 * muM * t65 * (t286 * t297 + t9 * (Q2 * (t27 + t26 - t291) + t4 - t6) + 2 * t302 + t8 * (t331 + t294 + t4 - t6) + Q1 * (t46 * t297 + t34 * t321 + t118 + 4 * t13 + t18 - t283 + 4 * t37) + 2 * (t34 * (t25 + t419 - t420) + t149 - t25 - t419 + t420) * Q2 * t114) * t253
    
  
    contr = sum(contr)
    return contr

end

function meandZ3dcdelta2_mixGravityMagnetic_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,A,B,C,mu,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ)
    contr = zeros(10)

    t1 = cos(psih)
    t2 = 3/4 * cpa2EQ
    t3 = P2 * P1
    t4 = cpa1EQ * t3
    t5 = P1 ^ 2
    t6 = cpa2EQ * t5
    t7 = t2 + t4 + t6
    t8 = Q2 ^ 2
    t9 = t8 ^ 2
    t10 = t8 * t9
    t12 = cpa2EQ * t3
    t13 = P2 ^ 2
    t18 = Q2 * t9
    t21 = Q1 ^ 2
    t23 = 2 * t6
    t24 = 5 * t4
    t26 = (t13 - 3/4) * cpa2EQ
    t29 = 3/8 * cpa1EQ
    t30 = cpa1EQ * t13
    t31 = t30 / 2
    t32 = t12 / 2
    t33 = t29 + t31 + t32
    t35 = cpa1EQ * t5
    t38 = Q2 * t8
    t41 = -t7
    t42 = t21 ^ 2
    t46 = 6 * t4
    t50 = Q1 * cpa3EQ * t3
    t55 = 3/4 * cpa1EQ
    t56 = 3 * t12
    t61 = cpa3EQ * t13 - cpa3EQ * t5
    t64 = t35 / 2
    t70 = t21 * t42
    t72 = 3 * t4
    t74 = -5 * t13 - 15/4
    t78 = cpa3EQ * P1
    t79 = Q1 * t21
    t87 = t10 * t7 - 2 * t18 * (t12 + (t13 + 3/4) * cpa1EQ) * Q1 + t9 * (t21 * t7 - t23 - t24 + t26) - 8 * t38 * Q1 * (t21 * t33 + t29 - t31 - t32 + t35) + t8 * (t42 * t41 + t21 * (-9/2 * cpa2EQ - 6 * t6 + t46) + 8 * t50 - t23 - t24 + t26) - 4 * Q2 * (t42 * t33 + t21 * (t35 + t55 - t56) + 2 * Q1 * t61 - t64 - t30 - 9/8 * cpa1EQ + t32) * Q1 + t70 * t41 + t42 * (t74 * cpa2EQ + t72) - 8 * t79 * P2 * t78 + t21 * (-t74 * cpa2EQ - t72) + t6 + t4 + t2
    t89 = cdelta ^ 2
    t90 = t89 - 1/2
    t92 = sqrt(skm)
    t93 = mu * t92
    t99 = 1 - skm
    t103 = (A - 2 * C) * skm - 2 * t99 * A + t99 * C + A
    t105 = t21 + t8 + 1
    t106 = t105 ^ 2
    t108 = 0.1e1 / t105 / t106
    t110 = sma ^ 2
    t111 = t110 ^ 2
    t114 = eta ^ 2
    t115 = t114 ^ 2
    t122 = 0.1e1 / Jg / n / t114 / t115 / t110 / t111
    contr[1] = -3/2 * t122 * t108 * t103 * IMz * muM * t93 * t90 * t87 * t1
    t126 = sin(psih)
    t127 = t90 * t126
    t129 = muM * mu
    t132 = -t12 - t55 - t30
    t136 = t4 + (t5 + 3/4) * cpa2EQ
    t138 = Q1 * t42
    t142 = 2 * t30
    t143 = 5 * t12
    t145 = (3/4 - t5) * cpa1EQ
    t149 = cpa2EQ * t13
    t150 = 2 * t149
    t155 = -t132
    t157 = 6 * t12
    t158 = 6 * t30
    t164 = 8 * P2 * Q2 * t78
    t180 = 5 * t5 + 15/4
    t191 = t70 * t132 + 2 * t138 * Q2 * t136 + t42 * (t8 * t132 + t142 + t143 + t145) + 4 * t79 * (t8 * t136 + t150 + t2 - t4 - t6) * Q2 + t21 * (t9 * t155 + t8 * (-t157 + t158 + 9/2 * cpa1EQ) + t164 + t142 + t143 + t145) + 2 * Q1 * Q2 * (t9 * t136 + t8 * (-t46 + t150 + 3/2 * cpa2EQ) + 4 * Q2 * t61 + t4 - t23 - t149 - 9/4 * cpa2EQ) + t10 * t155 + t9 * (t180 * cpa1EQ - t56) - 8 * t38 * P2 * t78 + t8 * (-t180 * cpa1EQ + t56) - t12 - t55 - t30
    contr[2] = -3/2 * t122 * t108 * t191 * t103 * IMz * t129 * t92 * t127
    t198 = t92 * t90 * t1
    t199 = t6 / 2
    t200 = t149 / 2
    t201 = -t4 - t199 + t200
    t202 = t70 * t201
    t203 = 2 * t12
    t204 = t35 - t203 - t30
    t206 = t138 * t204 * Q2
    t207 = t8 * t201
    t208 = 21/4 * t4
    t209 = 29/8 * t6
    t210 = 29/8 * t149
    t213 = 2 * t35
    t214 = 4 * t12
    t216 = t38 * (t213 - t214 - t142)
    t222 = P2 * t78
    t223 = 8 * t222
    t226 = -t201
    t227 = t9 * t226
    t233 = -t61
    t235 = 8 * Q2 * t233
    t238 = t9 * t204
    t249 = 7/8 * t6
    t250 = 7/8 * t149
    t254 = t8 + 1
    t258 = muM * IMz
    t263 = -2/3 * t5 - 2/3 * t13 + eta + 1
    t265 = 1 + eta
    t266 = t265 ^ 2
    t269 = 0.1e1 / t265 / t266 * t108
    t271 = t122 * t269 * t263 * t103
    contr[3] = -3/2 * t271 * t258 * (t202 + t206 + t42 * (t207 + t208 + t209 - t210) + t79 * (t216 + Q2 * (-5 * t35 + 18 * t12 + 5 * t30) - t223) + t21 * (t227 + t8 * (-27/4 * t6 + 27/4 * t149 - 3/2 * t4) + t235 - t208 - t209 + t210) + Q1 * (t238 + t8 * (-3 * t35 - t203 + 3 * t30) + t164 - 7/4 * t35 + 7/4 * t30 - t32) * Q2 + t254 * (t227 + t8 * (-15/4 * t4 - t249 + t250) + t4 + t199 - t200)) * mu * t198
    t274 = 3 * psih
    t275 = cos(t274)
    t276 = cpa2EQ * t42
    t281 = Q2 * Q1
    t282 = cpa1EQ * t281
    t283 = t8 * cpa2EQ
    t284 = t254 * t283
    t288 = t42 * cpa1EQ
    t289 = t8 * cpa1EQ
    t290 = 2 * t289
    t294 = 2 * cpa2EQ * t281
    t299 = 2 * t283
    t302 = 2 * t282
    t314 = t122 * t269 * t103 * t90
    t315 = t314 * t263 * t92 * t258 * mu * (t5 * (t276 / 2 + t21 * (t8 - 1/2) * cpa2EQ + t282 + t284 / 2) + P1 * P2 * (t288 + t21 * (t290 - cpa1EQ) - t294 + t254 * t289) - t13 * (t276 + t21 * (t299 - cpa2EQ) + t302 + t284) / 2) * t275
    contr[4] = -9/8 * t315
    t317 = t10 * t204
    t320 = 4 * t18 * Q1 * t226
    t321 = t21 * t204
    t322 = 17/4 * t30
    t323 = 9/2 * t12
    t324 = 17/4 * t35
    t327 = 4 * t6
    t329 = 4 * t149
    t337 = t38 * (t79 * (-t327 - 8 * t4 + t329) + Q1 * (t327 + 24 * t4 - t329) + 16 * t222)
    t339 = -t42 * t204
    t346 = 16 * Q1 * t233
    t349 = t42 * t226
    t354 = t21 * (-3 * t6 - 2 * t4 + 3 * t149)
    t355 = 4 * t50
    t361 = t21 + 1
    t362 = t42 * t204
    t372 = t258 * t93
    contr[5] = 3/4 * t271 * t372 * (t317 - t320 + t9 * (t321 + t322 + t323 - t324) + t337 + t8 * (t339 + t21 * (15/2 * t35 + 9 * t12 - 15/2 * t30) + t346 - t323 - t322 + t324) - 4 * Q2 * (t349 + t354 + t355 + t4 / 4 - t249 + t250) * Q1 - (t362 + t21 * (-19/4 * t35 + 19/4 * t30 + 27/2 * t12) + t35 - t30 - t203) * t361) * t127
    t375 = sin(t274)
    t385 = t288 + t21 * (t290 + cpa1EQ) + t294 + t9 * cpa1EQ - t289
    t399 = t122 * t269 * (t5 * t385 - 2 * P1 * (t276 + t21 * (t299 + cpa2EQ) - t302 + t9 * cpa2EQ - t283) * P2 - t385 * t13) * t103 * t90 * t263 * t92 * IMz * muM * mu * t375
    contr[6] = 9/16 * t399
    t400 = 13/4 * t6
    t401 = 13/4 * t149
    t402 = 9/2 * t4
    t423 = 5/4 * t6
    t424 = 5/4 * t149
    contr[7] = -3/2 * t271 * IMz * (t202 + t206 + t42 * (t207 + t400 - t401 + t402) + t79 * (t216 + Q2 * (-t213 + 12 * t12 + t142) - t223) + t21 * (t227 + t8 * (-3/2 * t6 + 3/2 * t149 + 9 * t4) + t235 - t400 + t401 - t402) + Q1 * (t238 + t8 * (-6 * t35 + t214 + t158) + t164 - t143 + t64 - t31) * Q2 + t254 * (t227 + t8 * (-t402 - t423 + t424) + t199 - t200 + t4)) * t129 * t198
    contr[8] = -9/4 * t315
    t436 = 7/2 * t35
    t437 = 7/2 * t30
    contr[9] = 3/4 * t314 * t372 * t263 * (t317 - t320 + t9 * (t321 - t436 + t437 + t56) + t337 + t8 * (t339 + t21 * (9 * t35 + t157 - 9 * t30) + t346 - t56 - t437 + t436) - 4 * Q2 * Q1 * (t349 + t354 + t355 - t4 / 2 - t423 + t424) - t361 * (t362 + t21 * (-11/2 * t35 + 11/2 * t30 + 15 * t12) + t35 - t30 - t203)) * t126
    contr[10] = 9/8 * t399
    
    
    contr = sum(contr)
    return contr

end

function meandZ3dpsih_mixGravityMagnetic_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,A,B,C,mu,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ)
    contr = zeros(16)

    t1 = 3/4 * cpa2EQ
    t2 = P2 * P1
    t3 = cpa1EQ * t2
    t4 = P1 ^ 2
    t5 = cpa2EQ * t4
    t6 = t1 + t3 + t5
    t7 = Q2 ^ 2
    t8 = t7 ^ 2
    t9 = t7 * t8
    t11 = cpa2EQ * t2
    t12 = P2 ^ 2
    t14 = (t12 + 3/4) * cpa1EQ
    t17 = Q2 * t8
    t20 = Q1 ^ 2
    t22 = 2 * t5
    t23 = 5 * t3
    t25 = (t12 - 3/4) * cpa2EQ
    t28 = 3/8 * cpa1EQ
    t29 = cpa1EQ * t12
    t30 = t29 / 2
    t31 = t11 / 2
    t32 = t28 + t30 + t31
    t34 = cpa1EQ * t4
    t37 = Q2 * t7
    t40 = -t6
    t41 = t20 ^ 2
    t43 = 9/2 * cpa2EQ
    t44 = 6 * t5
    t45 = 6 * t3
    t49 = Q1 * cpa3EQ * t2
    t54 = 3/4 * cpa1EQ
    t55 = 3 * t11
    t58 = cpa3EQ * t4
    t59 = cpa3EQ * t12
    t60 = -t58 + t59
    t61 = 2 * t60
    t63 = t34 / 2
    t69 = t20 * t41
    t71 = 3 * t3
    t73 = -5 * t12 - 15/4
    t77 = cpa3EQ * P1
    t78 = Q1 * t20
    t86 = t9 * t6 - 2 * t17 * (t11 + t14) * Q1 + t8 * (t20 * t6 - t22 - t23 + t25) - 8 * t37 * Q1 * (t20 * t32 + t28 - t30 - t31 + t34) + t7 * (t41 * t40 + t20 * (-t43 - t44 + t45) + 8 * t49 - t22 - t23 + t25) - 4 * Q2 * (t41 * t32 + t20 * (t34 + t54 - t55) + Q1 * t61 - t63 - t29 - 9/8 * cpa1EQ + t31) * Q1 + t69 * t40 + t41 * (t73 * cpa2EQ + t71) - 8 * t78 * P2 * t77 + t20 * (-t73 * cpa2EQ - t71) + t5 + t3 + t1
    t90 = 1 - skm
    t94 = (A - 2 * C) * skm - 2 * t90 * A + t90 * C + A
    t96 = sqrt(skm)
    t98 = mu * muM
    t100 = IMz * cdelta * t98
    t102 = t20 + t7 + 1
    t103 = t102 ^ 2
    t105 = 0.1e1 / t102 / t103
    t106 = t105 * sdelta
    t107 = sma ^ 2
    t108 = t107 ^ 2
    t110 = 0.1e1 / t107 / t108
    t111 = t110 * t106
    t112 = eta ^ 2
    t113 = t112 ^ 2
    t117 = 0.1e1 / Jg / t112 / t113
    t118 = 0.1e1 / n
    t119 = sin(psih)
    t121 = t119 * t118 * t117
    contr[1] = -3/4 * t121 * t111 * t100 * t96 * t94 * t86
    t125 = sdelta ^ 2
    t126 = -t60
    t129 = P2 * Q2 * t77
    t130 = 8 * t129
    t131 = 4 * t11
    t132 = 4 * t29
    t133 = 3 * cpa1EQ
    t137 = 2 * t3
    t138 = 3/2 * cpa2EQ
    t145 = 8 * t37 * P2 * t77
    t146 = 12 * t11
    t153 = t8 * t126
    t154 = 4 * t5
    t155 = 4 * t3
    t157 = t154 + t155 + 3 * cpa2EQ
    t164 = muM * t94
    t165 = IMz * t164
    t167 = 0.1e1 / t103
    t169 = t110 * t167 * t96
    t170 = 2 * psih
    t171 = sin(t170)
    t173 = t171 * t118 * t117
    contr[2] = -3/8 * t173 * t169 * t165 * mu * (t41 * t126 + t78 * (t130 + t131 + t132 + t133) - 6 * t20 * (Q2 * t126 + t137 + t138 + t22) * Q2 + Q1 * (-t145 + t7 * (-t146 - 12 * t29 - 9 * cpa1EQ) - t132 - t131 - t133) + t153 + t37 * t157 - Q2 * t157 + t58 - t59) * t125
    t177 = t96 * t94
    t179 = muM * IMz
    t180 = -t11 - t54 - t29
    t184 = t3 + (t4 + 3/4) * cpa2EQ
    t186 = Q1 * t41
    t190 = 2 * t29
    t191 = 5 * t11
    t193 = (3/4 - t4) * cpa1EQ
    t197 = cpa2EQ * t12
    t198 = 2 * t197
    t203 = -t180
    t205 = 6 * t11
    t206 = 6 * t29
    t224 = 5 * t4 + 15/4
    t232 = t69 * t180 + 2 * t186 * Q2 * t184 + t41 * (t7 * t180 + t190 + t191 + t193) + 4 * t78 * (t7 * t184 + t1 + t198 - t3 - t5) * Q2 + t20 * (t8 * t203 + t7 * (-t205 + t206 + 9/2 * cpa1EQ) + t130 + t190 + t191 + t193) + 2 * Q1 * Q2 * (t8 * t184 + t7 * (-t45 + t198 + t138) + 4 * Q2 * t60 + t3 - t22 - t197 - 9/4 * cpa2EQ) + t9 * t203 + t8 * (t224 * cpa1EQ - t55) - t145 + t7 * (-t224 * cpa1EQ + t55) - t11 - t54 - t29
    t236 = cos(psih)
    t238 = t236 * t118 * t117
    contr[3] = 3/4 * t238 * t111 * t232 * cdelta * t179 * mu * t177
    t243 = Q2 * t61
    t250 = -t61
    t251 = t37 * t250
    t256 = t7 + 1
    t258 = t7 * P2 * t77
    t259 = 2 * t11
    t263 = P2 * t77
    t270 = cos(t170)
    t272 = t270 * t118 * t117
    contr[4] = 3/4 * t272 * t169 * t165 * mu * t125 * (t41 * P2 * t77 + t78 * (t243 - t137 - t138 - t22) - 6 * t20 * Q2 * (t129 + t11 + t14) + Q1 * (t251 + t7 * (t45 + t44 + t43) - t137 - t138 - t22) + (t258 + Q2 * (t190 + t259 + 3/2 * cpa1EQ) - t263) * t256)
    t275 = t5 / 2
    t276 = t197 / 2
    t277 = -t3 - t275 + t276
    t278 = t69 * t277
    t279 = t34 - t259 - t29
    t280 = t279 * Q2
    t281 = t186 * t280
    t282 = t7 * t277
    t283 = 21/4 * t3
    t284 = 29/8 * t5
    t285 = 29/8 * t197
    t288 = 2 * t34
    t290 = t37 * (t288 - t131 - t190)
    t291 = 5 * t34
    t293 = 5 * t29
    t296 = 8 * t263
    t299 = -t277
    t300 = t8 * t299
    t307 = 8 * Q2 * t126
    t310 = t8 * t279
    t311 = 3 * t34
    t312 = 3 * t29
    t321 = 7/8 * t5
    t322 = 7/8 * t197
    t332 = -2/3 * t4 - 2/3 * t12 + eta + 1
    t333 = cdelta * t332
    t334 = t333 * t179
    t336 = 1 + eta
    t337 = t336 ^ 2
    t340 = t110 / t336 / t337
    t341 = t340 * t106
    t342 = t121 * t341
    contr[5] = -3/4 * t342 * t334 * (t278 + t281 + t41 * (t282 + t283 + t284 - t285) + t78 * (t290 + Q2 * (-t291 + 18 * t11 + t293) - t296) + t20 * (t300 + t7 * (-27/4 * t5 + 27/4 * t197 - 3/2 * t3) + t307 - t283 - t284 + t285) + Q1 * (t310 + t7 * (-t311 - t259 + t312) + t130 - 7/4 * t34 + 7/4 * t29 - t31) * Q2 + t256 * (t300 + t7 * (-15/4 * t3 - t321 + t322) + t3 + t275 - t276)) * mu * t177
    t345 = mu * t125
    t348 = t332 * t96 * t179
    t350 = t41 * cpa3EQ
    t352 = 2 * t78 * cpa1EQ
    t353 = t7 * cpa3EQ
    t354 = Q2 * cpa2EQ
    t357 = t20 * (-6 * t353 - 6 * t354)
    t358 = t7 * cpa1EQ
    t359 = 6 * t358
    t360 = 2 * cpa1EQ
    t363 = t8 * cpa3EQ
    t366 = 2 * t354
    t367 = t350 - t352 + t357 + Q1 * (t359 + t360) + t363 + 2 * t37 * cpa2EQ - t366 + cpa3EQ
    t371 = 2 * Q2 * cpa3EQ + cpa2EQ
    t372 = t78 * t371
    t375 = 3 * Q2 * t20 * cpa1EQ
    t377 = 2 * t37 * cpa3EQ
    t378 = t7 * cpa2EQ
    t379 = 3 * t378
    t383 = cpa1EQ * Q2
    contr[6] = -3/8 * t173 * t340 * t167 * (t4 * t367 + 4 * P1 * (t372 - t375 + Q1 * (-t377 - t379 - cpa2EQ) + t37 * cpa1EQ - t383) * P2 - t367 * t12) * t348 * t94 * t345
    t395 = cpa2EQ * t41
    t400 = Q1 * Q2
    t401 = cpa1EQ * t400
    t402 = t256 * t378
    t406 = t41 * cpa1EQ
    t407 = 2 * t358
    t411 = 2 * cpa2EQ * t400
    t416 = 2 * t378
    t419 = 2 * t401
    t430 = 3 * psih
    t431 = sin(t430)
    t435 = t431 * t118 * t117 * t340 * t105 * cdelta * t348 * t94 * mu * (t4 * (t395 / 2 + t20 * (t7 - 1/2) * cpa2EQ + t401 + t402 / 2) + P1 * P2 * (t406 + t20 * (t407 - cpa1EQ) - t411 + t256 * t358) - t12 * (t395 + t20 * (t416 - cpa2EQ) + t419 + t402) / 2) * sdelta
    contr[7] = -27/16 * t435
    t437 = t9 * t279
    t440 = 4 * t17 * Q1 * t299
    t441 = t20 * t279
    t442 = 17/4 * t29
    t443 = 9/2 * t11
    t444 = 17/4 * t34
    t448 = 4 * t197
    t449 = -t154 - 8 * t3 + t448
    t456 = t37 * (t78 * t449 + Q1 * (t154 + 24 * t3 - t448) + 16 * t263)
    t457 = -t279
    t458 = t41 * t457
    t465 = 16 * Q1 * t126
    t468 = t41 * t299
    t469 = 3 * t5
    t470 = 3 * t197
    t472 = t20 * (-t469 - t137 + t470)
    t473 = 4 * t49
    t479 = t20 + 1
    t480 = t41 * t279
    t493 = t238 * t341
    contr[8] = -3/8 * t493 * t334 * mu * t96 * (t437 - t440 + t8 * (t441 + t442 + t443 - t444) + t456 + t7 * (t458 + t20 * (15/2 * t34 + 9 * t11 - 15/2 * t29) + t465 - t443 - t442 + t444) - 4 * Q2 * (t468 + t472 + t473 + t3 / 4 - t321 + t322) * Q1 - (t480 + t20 * (-19/4 * t34 + 19/4 * t29 + 27/2 * t11) + t34 - t29 - t259) * t479) * t94
    t498 = t377 + t379 - cpa2EQ
    t500 = t256 * t383
    t517 = t96 * IMz
    t518 = t517 * t164
    contr[9] = 3/4 * t272 * t340 * t167 * t332 * t518 * mu * (t4 * (Q1 * t498 - t78 * t371 + t375 - t500) + P1 * (t350 - t352 + t357 + Q1 * (t359 - t360) + (t353 + t366 - cpa3EQ) * t256) * P2 + (-Q1 * t498 + t372 - t375 + t500) * t12) * t125
    t531 = t406 + t20 * (t407 + cpa1EQ) + t411 + t8 * cpa1EQ - t358
    t544 = cos(t430)
    t548 = t544 * t118 * t117 * t340 * t105 * (t4 * t531 - 2 * P1 * (t395 + t20 * (t416 + cpa2EQ) - t419 + t8 * cpa2EQ - t378) * P2 - t531 * t12) * t333 * t517 * t164 * sdelta * mu
    contr[10] = -27/32 * t548
    t551 = 13/4 * t5
    t552 = 13/4 * t197
    t553 = 9/2 * t3
    t567 = 6 * t34
    t573 = 5/4 * t5
    t574 = 5/4 * t197
    contr[11] = -3/4 * t342 * t333 * IMz * (t278 + t281 + t41 * (t282 + t551 - t552 + t553) + t78 * (t290 + Q2 * (-t288 + t146 + t190) - t296) + t20 * (t300 + t7 * (-3/2 * t5 + 3/2 * t197 + 9 * t3) + t307 - t551 + t552 - t553) + Q1 * (t310 + t7 * (-t567 + t131 + t206) + t130 - t191 + t63 - t30) * Q2 + t256 * (t300 + t7 * (-t553 - t573 + t574) + t275 - t276 + t3)) * t98 * t177
    t588 = 5 * t60
    t620 = t22 + t155 - t198
    contr[12] = -3/8 * t173 * t340 * t105 * t332 * t518 * (t69 * t126 + t186 * (t130 - t288 + t131 + t190) + t41 * (t7 * t588 + Q2 * (-t44 - 12 * t3 + 6 * t197) + t58 - t59) + 4 * t78 * (t280 + 2 * t263) * Q2 + t20 * (-Q2 * t449 + t37 * t449 + t8 * t588 + 6 * t7 * t60 + t58 - t59) + Q1 * (-8 * t17 * P2 * t77 + t8 * (t567 - t146 - t206) - t145 + t7 * (-4 * t34 + 8 * t11 + t132) + t288 - t190 - t131) + (-Q2 * t620 + t37 * t620 + t153 + t58 - t59) * t256) * t345
    contr[13] = -27/8 * t435
    t635 = 7/2 * t34
    t636 = 7/2 * t29
    contr[14] = -3/8 * t493 * t100 * t177 * t332 * (t437 - t440 + t8 * (t441 - t635 + t636 + t55) + t456 + t7 * (t458 + t20 * (9 * t34 + t205 - 9 * t29) + t465 - t55 - t636 + t635) - 4 * Q2 * Q1 * (t468 + t472 + t473 - t3 / 2 - t573 + t574) - t479 * (t480 + t20 * (-11/2 * t34 + 11/2 * t29 + 15 * t11) + t34 - t29 - t259))
    t675 = 10 * t3
    t676 = 5 * t5
    t677 = 5 * t197
    t680 = t363 * t2
    t684 = t291 - 10 * t11 - t293
    t701 = cpa3EQ * t69 * t2 + t186 * (t243 - t137 - t5 + t197) + t41 * (-5 * t258 + Q2 * (t311 - t205 - t312) + t263) + t78 * (t7 * t620 + t243 - t675 - t676 + t677) + t20 * (Q2 * t684 - 6 * t258 - t263 + t290 - 5 * t680) + Q1 * (t17 * t250 + t8 * (t469 + t45 - t470) + t251 + t7 * (t676 + t675 - t677) - t137 - t5 + t197) + cpa3EQ * t9 * t2 + t17 * t457 + t680 - t37 * t684 - t258 + Q2 * t457 - t263
    contr[15] = 3/4 * t272 * t340 * t105 * t96 * t179 * t94 * t701 * mu * t125 * t332
    contr[16] = -27/16 * t548
    
   
    contr = sum(contr)
    return contr

end

function meandZ3cdeltadpsigMdpsihOsdelta_mixGravityMagnetic_k0(skm,Jg,cdelta,sdelta,psih,sma,n,eta,P1,P2,Q1,Q2,GG,A,B,C,mu,IMz,muM,cpa1EQ,cpa2EQ,cpa3EQ)
    contr = zeros(16)

    t1 = sin(psih)
    t2 = 3/4 * cpa2EQ
    t3 = P2 * P1
    t4 = cpa1EQ * t3
    t5 = P1 ^ 2
    t6 = cpa2EQ * t5
    t7 = t2 + t4 + t6
    t8 = Q2 ^ 2
    t9 = t8 ^ 2
    t10 = t8 * t9
    t12 = cpa2EQ * t3
    t13 = P2 ^ 2
    t15 = (t13 + 3/4) * cpa1EQ
    t18 = Q2 * t9
    t21 = Q1 ^ 2
    t23 = 2 * t6
    t24 = 5 * t4
    t26 = (t13 - 3/4) * cpa2EQ
    t29 = 3/8 * cpa1EQ
    t30 = cpa1EQ * t13
    t31 = t30 / 2
    t32 = t12 / 2
    t33 = t29 + t31 + t32
    t35 = cpa1EQ * t5
    t38 = Q2 * t8
    t41 = -t7
    t42 = t21 ^ 2
    t44 = 9/2 * cpa2EQ
    t45 = 6 * t6
    t46 = 6 * t4
    t50 = Q1 * cpa3EQ * t3
    t55 = 3/4 * cpa1EQ
    t56 = 3 * t12
    t59 = cpa3EQ * t5
    t60 = cpa3EQ * t13
    t61 = -t59 + t60
    t62 = 2 * t61
    t64 = t35 / 2
    t70 = t21 * t42
    t72 = 3 * t4
    t74 = -5 * t13 - 15/4
    t78 = cpa3EQ * P1
    t79 = Q1 * t21
    t87 = t10 * t7 - 2 * t18 * (t12 + t15) * Q1 + t9 * (t21 * t7 - t23 - t24 + t26) - 8 * t38 * Q1 * (t21 * t33 + t29 - t31 - t32 + t35) + t8 * (t42 * t41 + t21 * (-t44 - t45 + t46) + 8 * t50 - t23 - t24 + t26) - 4 * Q2 * (t42 * t33 + t21 * (t35 + t55 - t56) + Q1 * t62 - t64 - t30 - 9/8 * cpa1EQ + t32) * Q1 + t70 * t41 + t42 * (t74 * cpa2EQ + t72) - 8 * t79 * P2 * t78 + t21 * (-t74 * cpa2EQ - t72) + t6 + t4 + t2
    t92 = 1 - skm
    t96 = (A - 2 * C) * skm - 2 * t92 * A + t92 * C + A
    t98 = sqrt(skm)
    t99 = mu * t98
    t102 = cdelta * IMz
    t103 = t21 + t8 + 1
    t104 = t103 ^ 2
    t106 = 0.1e1 / t103 / t104
    t108 = sma ^ 2
    t109 = t108 ^ 2
    t112 = eta ^ 2
    t113 = t112 ^ 2
    t120 = 0.1e1 / Jg / n / t112 / t113 / t108 / t109
    contr[1] = 3/4 * t120 * t106 * t102 * muM * t99 * t96 * t87 * t1
    t123 = 2 * psih
    t124 = sin(t123)
    t125 = sdelta * t124
    t126 = -t61
    t129 = P2 * Q2 * t78
    t130 = 8 * t129
    t131 = 4 * t12
    t132 = 4 * t30
    t133 = 3 * cpa1EQ
    t137 = 2 * t4
    t138 = 3/2 * cpa2EQ
    t145 = 8 * t38 * P2 * t78
    t146 = 12 * t12
    t153 = t9 * t126
    t154 = 4 * t6
    t155 = 4 * t4
    t157 = t154 + t155 + 3 * cpa2EQ
    t163 = t96 * mu
    t164 = muM * t163
    t166 = t98 * IMz
    t167 = 0.1e1 / t104
    t169 = t120 * t167 * t166
    contr[2] = 3/8 * t169 * t164 * (t42 * t126 + t79 * (t130 + t131 + t132 + t133) - 6 * t21 * (Q2 * t126 + t137 + t138 + t23) * Q2 + Q1 * (-t145 + t8 * (-t146 - 12 * t30 - 9 * cpa1EQ) - t132 - t131 - t133) + t153 + t38 * t157 - Q2 * t157 + t59 - t60) * t125
    t171 = cos(psih)
    t172 = t96 * t171
    t174 = muM * mu
    t177 = -t12 - t55 - t30
    t181 = t4 + (t5 + 3/4) * cpa2EQ
    t183 = Q1 * t42
    t187 = 2 * t30
    t188 = 5 * t12
    t190 = (3/4 - t5) * cpa1EQ
    t194 = cpa2EQ * t13
    t195 = 2 * t194
    t200 = -t177
    t202 = 6 * t12
    t203 = 6 * t30
    t221 = 5 * t5 + 15/4
    t229 = t70 * t177 + 2 * t183 * Q2 * t181 + t42 * (t8 * t177 + t187 + t188 + t190) + 4 * t79 * (t8 * t181 + t195 + t2 - t4 - t6) * Q2 + t21 * (t9 * t200 + t8 * (-t202 + t203 + 9/2 * cpa1EQ) + t130 + t187 + t188 + t190) + 2 * Q1 * Q2 * (t9 * t181 + t8 * (-t46 + t195 + t138) + 4 * Q2 * t61 + t4 - t23 - t194 - 9/4 * cpa2EQ) + t10 * t200 + t9 * (t221 * cpa1EQ - t56) - t145 + t8 * (-t221 * cpa1EQ + t56) - t12 - t55 - t30
    contr[3] = -3/4 * t120 * t106 * t229 * cdelta * IMz * t174 * t98 * t172
    t235 = cos(t123)
    t236 = sdelta * t235
    t239 = Q2 * t62
    t246 = -t62
    t247 = t38 * t246
    t252 = t8 + 1
    t254 = t8 * P2 * t78
    t255 = 2 * t12
    t259 = P2 * t78
    contr[4] = -3/4 * t169 * t164 * (t42 * P2 * t78 + t79 * (t239 - t137 - t138 - t23) - 6 * t21 * Q2 * (t129 + t12 + t15) + Q1 * (t247 + t8 * (t46 + t45 + t44) - t137 - t138 - t23) + (t254 + Q2 * (t187 + t255 + 3/2 * cpa1EQ) - t259) * t252) * t236
    t268 = t98 * t96 * t1
    t269 = t6 / 2
    t270 = t194 / 2
    t271 = -t4 - t269 + t270
    t272 = t70 * t271
    t273 = t35 - t255 - t30
    t274 = t273 * Q2
    t275 = t183 * t274
    t276 = t8 * t271
    t277 = 21/4 * t4
    t278 = 29/8 * t6
    t279 = 29/8 * t194
    t282 = 2 * t35
    t284 = t38 * (t282 - t131 - t187)
    t285 = 5 * t35
    t287 = 5 * t30
    t290 = 8 * t259
    t293 = -t271
    t294 = t9 * t293
    t301 = 8 * Q2 * t126
    t304 = t9 * t273
    t305 = 3 * t35
    t306 = 3 * t30
    t315 = 7/8 * t6
    t316 = 7/8 * t194
    t323 = muM * IMz
    t328 = -2/3 * t5 - 2/3 * t13 + eta + 1
    t330 = 1 + eta
    t331 = t330 ^ 2
    t333 = 0.1e1 / t330 / t331
    t334 = t333 * t106
    t336 = t120 * t334 * cdelta * t328
    contr[5] = 3/4 * t336 * t323 * (t272 + t275 + t42 * (t276 + t277 + t278 - t279) + t79 * (t284 + Q2 * (-t285 + 18 * t12 + t287) - t290) + t21 * (t294 + t8 * (-27/4 * t6 + 27/4 * t194 - 3/2 * t4) + t301 - t277 - t278 + t279) + Q1 * (t304 + t8 * (-t305 - t255 + t306) + t130 - 7/4 * t35 + 7/4 * t30 - t32) * Q2 + t252 * (t294 + t8 * (-15/4 * t4 - t315 + t316) + t4 + t269 - t270)) * mu * t268
    t338 = mu * t125
    t339 = muM * t96
    t340 = t166 * t339
    t342 = t42 * cpa3EQ
    t344 = 2 * t79 * cpa1EQ
    t345 = t8 * cpa3EQ
    t346 = Q2 * cpa2EQ
    t349 = t21 * (-6 * t345 - 6 * t346)
    t350 = t8 * cpa1EQ
    t351 = 6 * t350
    t352 = 2 * cpa1EQ
    t355 = t9 * cpa3EQ
    t358 = 2 * t346
    t359 = t342 - t344 + t349 + Q1 * (t351 + t352) + t355 + 2 * t38 * cpa2EQ - t358 + cpa3EQ
    t363 = 2 * Q2 * cpa3EQ + cpa2EQ
    t364 = t79 * t363
    t367 = 3 * Q2 * t21 * cpa1EQ
    t369 = 2 * t38 * cpa3EQ
    t370 = t8 * cpa2EQ
    t371 = 3 * t370
    t375 = cpa1EQ * Q2
    t383 = t333 * t167
    contr[6] = 3/8 * t120 * t383 * (t5 * t359 + 4 * P1 * (t364 - t367 + Q1 * (-t369 - t371 - cpa2EQ) + t38 * cpa1EQ - t375) * P2 - t359 * t13) * t328 * t340 * t338
    t387 = 3 * psih
    t388 = sin(t387)
    t389 = cpa2EQ * t42
    t394 = Q2 * Q1
    t395 = cpa1EQ * t394
    t396 = t252 * t370
    t400 = t42 * cpa1EQ
    t401 = 2 * t350
    t405 = 2 * cpa2EQ * t394
    t410 = 2 * t370
    t413 = 2 * t395
    t421 = t336 * t340 * mu * (t5 * (t389 / 2 + t21 * (t8 - 1/2) * cpa2EQ + t395 + t396 / 2) + P1 * P2 * (t400 + t21 * (t401 - cpa1EQ) - t405 + t252 * t350) - t13 * (t389 + t21 * (t410 - cpa2EQ) + t413 + t396) / 2) * t388
    contr[7] = 27/16 * t421
    t422 = t10 * t273
    t425 = 4 * t18 * Q1 * t293
    t426 = t21 * t273
    t427 = 17/4 * t30
    t428 = 9/2 * t12
    t429 = 17/4 * t35
    t433 = 4 * t194
    t434 = -t154 - 8 * t4 + t433
    t441 = t38 * (t79 * t434 + Q1 * (t154 + 24 * t4 - t433) + 16 * t259)
    t442 = -t273
    t443 = t42 * t442
    t450 = 16 * Q1 * t126
    t453 = t42 * t293
    t454 = 3 * t6
    t455 = 3 * t194
    t457 = t21 * (-t454 - t137 + t455)
    t458 = 4 * t50
    t464 = t21 + 1
    t465 = t42 * t273
    contr[8] = 3/8 * t336 * t323 * t99 * (t422 - t425 + t9 * (t426 + t427 + t428 - t429) + t441 + t8 * (t443 + t21 * (15/2 * t35 + 9 * t12 - 15/2 * t30) + t450 - t428 - t427 + t429) - 4 * Q2 * (t453 + t457 + t458 + t4 / 4 - t315 + t316) * Q1 - (t465 + t21 * (-19/4 * t35 + 19/4 * t30 + 27/2 * t12) + t35 - t30 - t255) * t464) * t172
    t480 = t369 + t371 - cpa2EQ
    t482 = t252 * t375
    t500 = t328 * t98
    contr[9] = -3/4 * t120 * t383 * t500 * t323 * t163 * (t5 * (Q1 * t480 - t79 * t363 + t367 - t482) + P1 * (t342 - t344 + t349 + Q1 * (t351 - t352) + (t345 + t358 - cpa3EQ) * t252) * P2 + (-Q1 * t480 + t364 - t367 + t482) * t13) * t236
    t505 = cos(t387)
    t513 = t400 + t21 * (t401 + cpa1EQ) + t405 + t9 * cpa1EQ - t350
    t527 = t120 * t334 * (t5 * t513 - 2 * P1 * (t389 + t21 * (t410 + cpa2EQ) - t413 + t9 * cpa2EQ - t370) * P2 - t513 * t13) * cdelta * t500 * t323 * t96 * mu * t505
    contr[10] = 27/32 * t527
    t528 = 13/4 * t6
    t529 = 13/4 * t194
    t530 = 9/2 * t4
    t544 = 6 * t35
    t550 = 5/4 * t6
    t551 = 5/4 * t194
    contr[11] = 3/4 * t336 * IMz * (t272 + t275 + t42 * (t276 + t528 - t529 + t530) + t79 * (t284 + Q2 * (-t282 + t146 + t187) - t290) + t21 * (t294 + t8 * (-3/2 * t6 + 3/2 * t194 + 9 * t4) + t301 - t528 + t529 - t530) + Q1 * (t304 + t8 * (-t544 + t131 + t203) + t130 - t188 + t64 - t31) * Q2 + t252 * (t294 + t8 * (-t530 - t550 + t551) + t269 - t270 + t4)) * t174 * t268
    t564 = 5 * t61
    t596 = t23 + t155 - t195
    contr[12] = 3/8 * t120 * t334 * t500 * t323 * t96 * (t70 * t126 + t183 * (t130 - t282 + t131 + t187) + t42 * (t8 * t564 + Q2 * (-t45 - 12 * t4 + 6 * t194) + t59 - t60) + 4 * t79 * (t274 + 2 * t259) * Q2 + t21 * (-Q2 * t434 + t38 * t434 + t9 * t564 + 6 * t8 * t61 + t59 - t60) + Q1 * (-8 * t18 * P2 * t78 + t9 * (t544 - t146 - t203) - t145 + t8 * (-4 * t35 + 8 * t12 + t132) + t282 - t187 - t131) + (-Q2 * t596 + t38 * t596 + t153 + t59 - t60) * t252) * t338
    contr[13] = 27/8 * t421
    t609 = 7/2 * t35
    t610 = 7/2 * t30
    contr[14] = 3/8 * t120 * t334 * t102 * t174 * t98 * t96 * t328 * (t422 - t425 + t9 * (t426 - t609 + t610 + t56) + t441 + t8 * (t443 + t21 * (9 * t35 + t202 - 9 * t30) + t450 - t56 - t610 + t609) - 4 * Q2 * Q1 * (t453 + t457 + t458 - t4 / 2 - t550 + t551) - t464 * (t465 + t21 * (-11/2 * t35 + 11/2 * t30 + 15 * t12) + t35 - t30 - t255)) * t171
    t651 = 10 * t4
    t652 = 5 * t6
    t653 = 5 * t194
    t656 = t355 * t3
    t660 = t285 - 10 * t12 - t287
    t677 = cpa3EQ * t70 * t3 + t183 * (t239 - t137 - t6 + t194) + t42 * (-5 * t254 + Q2 * (t305 - t202 - t306) + t259) + t79 * (t8 * t596 + t239 - t651 - t652 + t653) + t21 * (Q2 * t660 - 6 * t254 - t259 + t284 - 5 * t656) + Q1 * (t18 * t246 + t9 * (t454 + t46 - t455) + t247 + t8 * (t652 + t651 - t653) - t137 - t6 + t194) + cpa3EQ * t10 * t3 + t18 * t442 + t656 - t38 * t660 - t254 + Q2 * t442 - t259
    contr[15] = -3/4 * t120 * t334 * t166 * t339 * t677 * mu * t328 * t236
    contr[16] = 27/16 * t527
    
 
    contr = sum(contr)
    return contr

end